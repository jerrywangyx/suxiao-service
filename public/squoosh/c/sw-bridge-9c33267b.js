define(["exports","./idb-keyval-edaaeadc"],(function(e,a){async function t(e){if(e.waiting)return;const a=await async function(e){return e.installing?e.installing:new Promise((a=>{e.addEventListener("updatefound",(()=>a(e.installing)),{once:!0})}))}(e);return new Promise((e=>{a.addEventListener("statechange",(()=>{"installed"===a.state&&e()}))}))}e.getSharedImage=function(){return new Promise((e=>{const a=t=>{"load-image"===t.data.action&&(e(t.data.file),navigator.serviceWorker.removeEventListener("message",a))};navigator.serviceWorker.addEventListener("message",a),navigator.serviceWorker.controller.postMessage("share-ready")}))},e.mainAppLoaded=async function(){if(await a.get("user-interacted"))return;a.set("user-interacted",!0);const e=await async function(){const e=await navigator.serviceWorker.getRegistration();return e?e.active||e.waiting||e.installing:null}();e&&e.postMessage("cache-all")},e.offliner=async function(e){navigator.serviceWorker.register(a.swUrl);const n=!!navigator.serviceWorker.controller;if(navigator.serviceWorker.addEventListener("controllerchange",(async()=>{n?location.reload():e("Ready to work offline",{timeout:5e3})})),!n)return;const i=await navigator.serviceWorker.getRegistration();if(!i)return;await t(i),"reload"===await e("Update available",{actions:["reload","dismiss"]})&&async function(){const e=await navigator.serviceWorker.getRegistration();e&&e.waiting&&e.waiting.postMessage("skip-waiting")}()}}));
