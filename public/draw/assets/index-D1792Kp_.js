var LZ=Object.defineProperty;var DZ=(e,t,n)=>t in e?LZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var F=(e,t,n)=>(DZ(e,typeof t!="symbol"?t+"":t,n),n);function PZ(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in e)){const r=Object.getOwnPropertyDescriptor(i,s);r&&Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();var $a=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var MP={exports:{}},C5={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NZ=Symbol.for("react.transitional.element"),OZ=Symbol.for("react.fragment");function kP(e,t,n){var i=null;if(n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),"key"in t){n={};for(var s in t)s!=="key"&&(n[s]=t[s])}else n=t;return t=n.ref,{$$typeof:NZ,type:e,key:i,ref:t!==void 0?t:null,props:n}}C5.Fragment=OZ;C5.jsx=kP;C5.jsxs=kP;MP.exports=C5;var v9=MP.exports;const he=v9.Fragment,g=v9.jsx,N=v9.jsxs;var RP={exports:{}},Je={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _9=Symbol.for("react.transitional.element"),FZ=Symbol.for("react.portal"),BZ=Symbol.for("react.fragment"),zZ=Symbol.for("react.strict_mode"),HZ=Symbol.for("react.profiler"),VZ=Symbol.for("react.consumer"),$Z=Symbol.for("react.context"),GZ=Symbol.for("react.forward_ref"),XZ=Symbol.for("react.suspense"),jZ=Symbol.for("react.memo"),LP=Symbol.for("react.lazy"),ix=Symbol.iterator;function YZ(e){return e===null||typeof e!="object"?null:(e=ix&&e[ix]||e["@@iterator"],typeof e=="function"?e:null)}var DP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PP=Object.assign,NP={};function yg(e,t,n){this.props=e,this.context=t,this.refs=NP,this.updater=n||DP}yg.prototype.isReactComponent={};yg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function OP(){}OP.prototype=yg.prototype;function w9(e,t,n){this.props=e,this.context=t,this.refs=NP,this.updater=n||DP}var T9=w9.prototype=new OP;T9.constructor=w9;PP(T9,yg.prototype);T9.isPureReactComponent=!0;var sx=Array.isArray,bn={H:null,A:null,T:null,S:null},FP=Object.prototype.hasOwnProperty;function I9(e,t,n,i,s,r){return n=r.ref,{$$typeof:_9,type:e,key:t,ref:n!==void 0?n:null,props:r}}function WZ(e,t){return I9(e.type,t,void 0,void 0,void 0,e.props)}function S9(e){return typeof e=="object"&&e!==null&&e.$$typeof===_9}function KZ(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var rx=/\/+/g;function FE(e,t){return typeof e=="object"&&e!==null&&e.key!=null?KZ(""+e.key):t.toString(36)}function ox(){}function ZZ(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(ox,ox):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function yf(e,t,n,i,s){var r=typeof e;(r==="undefined"||r==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(r){case"bigint":case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case _9:case FZ:o=!0;break;case LP:return o=e._init,yf(o(e._payload),t,n,i,s)}}if(o)return s=s(e),o=i===""?"."+FE(e,0):i,sx(s)?(n="",o!=null&&(n=o.replace(rx,"$&/")+"/"),yf(s,t,n,"",function(c){return c})):s!=null&&(S9(s)&&(s=WZ(s,n+(s.key==null||e&&e.key===s.key?"":(""+s.key).replace(rx,"$&/")+"/")+o)),t.push(s)),1;o=0;var a=i===""?".":i+":";if(sx(e))for(var l=0;l<e.length;l++)i=e[l],r=a+FE(i,l),o+=yf(i,t,n,r,s);else if(l=YZ(e),typeof l=="function")for(e=l.call(e),l=0;!(i=e.next()).done;)i=i.value,r=a+FE(i,l++),o+=yf(i,t,n,r,s);else if(r==="object"){if(typeof e.then=="function")return yf(ZZ(e),t,n,i,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return o}function EU(e,t,n){if(e==null)return e;var i=[],s=0;return yf(e,i,"","",function(r){return t.call(n,r,s++)}),i}function qZ(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ax=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function QZ(){}Je.Children={map:EU,forEach:function(e,t,n){EU(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return EU(e,function(){t++}),t},toArray:function(e){return EU(e,function(t){return t})||[]},only:function(e){if(!S9(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Je.Component=yg;Je.Fragment=BZ;Je.Profiler=HZ;Je.PureComponent=w9;Je.StrictMode=zZ;Je.Suspense=XZ;Je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=bn;Je.act=function(){throw Error("act(...) is not supported in production builds of React.")};Je.cache=function(e){return function(){return e.apply(null,arguments)}};Je.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var i=PP({},e.props),s=e.key,r=void 0;if(t!=null)for(o in t.ref!==void 0&&(r=void 0),t.key!==void 0&&(s=""+t.key),t)!FP.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(i[o]=t[o]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}return I9(e.type,s,void 0,void 0,r,i)};Je.createContext=function(e){return e={$$typeof:$Z,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:VZ,_context:e},e};Je.createElement=function(e,t,n){var i,s={},r=null;if(t!=null)for(i in t.key!==void 0&&(r=""+t.key),t)FP.call(t,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(s[i]=t[i]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];s.children=a}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)s[i]===void 0&&(s[i]=o[i]);return I9(e,r,void 0,void 0,null,s)};Je.createRef=function(){return{current:null}};Je.forwardRef=function(e){return{$$typeof:GZ,render:e}};Je.isValidElement=S9;Je.lazy=function(e){return{$$typeof:LP,_payload:{_status:-1,_result:e},_init:qZ}};Je.memo=function(e,t){return{$$typeof:jZ,type:e,compare:t===void 0?null:t}};Je.startTransition=function(e){var t=bn.T,n={};bn.T=n;try{var i=e(),s=bn.S;s!==null&&s(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(QZ,ax)}catch(r){ax(r)}finally{bn.T=t}};Je.unstable_useCacheRefresh=function(){return bn.H.useCacheRefresh()};Je.use=function(e){return bn.H.use(e)};Je.useActionState=function(e,t,n){return bn.H.useActionState(e,t,n)};Je.useCallback=function(e,t){return bn.H.useCallback(e,t)};Je.useContext=function(e){return bn.H.useContext(e)};Je.useDebugValue=function(){};Je.useDeferredValue=function(e,t){return bn.H.useDeferredValue(e,t)};Je.useEffect=function(e,t){return bn.H.useEffect(e,t)};Je.useId=function(){return bn.H.useId()};Je.useImperativeHandle=function(e,t,n){return bn.H.useImperativeHandle(e,t,n)};Je.useInsertionEffect=function(e,t){return bn.H.useInsertionEffect(e,t)};Je.useLayoutEffect=function(e,t){return bn.H.useLayoutEffect(e,t)};Je.useMemo=function(e,t){return bn.H.useMemo(e,t)};Je.useOptimistic=function(e,t){return bn.H.useOptimistic(e,t)};Je.useReducer=function(e,t,n){return bn.H.useReducer(e,t,n)};Je.useRef=function(e){return bn.H.useRef(e)};Je.useState=function(e){return bn.H.useState(e)};Je.useSyncExternalStore=function(e,t,n){return bn.H.useSyncExternalStore(e,t,n)};Je.useTransition=function(){return bn.H.useTransition()};Je.version="19.0.0";RP.exports=Je;var L=RP.exports;const de=Sl(L),JZ=PZ({__proto__:null,default:de},[L]);var BP={exports:{}},A5={},zP={exports:{}},HP={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,B){var z=V.length;V.push(B);e:for(;0<z;){var X=z-1>>>1,Y=V[X];if(0<s(Y,B))V[X]=B,V[z]=Y,z=X;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var B=V[0],z=V.pop();if(z!==B){V[0]=z;e:for(var X=0,Y=V.length,ee=Y>>>1;X<ee;){var se=2*(X+1)-1,oe=V[se],Fe=se+1,Ge=V[Fe];if(0>s(oe,z))Fe<Y&&0>s(Ge,oe)?(V[X]=Ge,V[Fe]=z,X=Fe):(V[X]=oe,V[se]=z,X=se);else if(Fe<Y&&0>s(Ge,z))V[X]=Ge,V[Fe]=z,X=Fe;else break e}}return B}function s(V,B){var z=V.sortIndex-B.sortIndex;return z!==0?z:V.id-B.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;e.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,u=null,f=3,h=!1,m=!1,p=!1,U=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function v(V){for(var B=n(c);B!==null;){if(B.callback===null)i(c);else if(B.startTime<=V)i(c),B.sortIndex=B.expirationTime,t(l,B);else break;B=n(c)}}function _(V){if(p=!1,v(V),!m)if(n(l)!==null)m=!0,j();else{var B=n(c);B!==null&&G(_,B.startTime-V)}}var I=!1,R=-1,T=5,w=-1;function S(){return!(e.unstable_now()-w<T)}function x(){if(I){var V=e.unstable_now();w=V;var B=!0;try{e:{m=!1,p&&(p=!1,b(R),R=-1),h=!0;var z=f;try{t:{for(v(V),u=n(l);u!==null&&!(u.expirationTime>V&&S());){var X=u.callback;if(typeof X=="function"){u.callback=null,f=u.priorityLevel;var Y=X(u.expirationTime<=V);if(V=e.unstable_now(),typeof Y=="function"){u.callback=Y,v(V),B=!0;break t}u===n(l)&&i(l),v(V)}else i(l);u=n(l)}if(u!==null)B=!0;else{var ee=n(c);ee!==null&&G(_,ee.startTime-V),B=!1}}break e}finally{u=null,f=z,h=!1}B=void 0}}finally{B?k():I=!1}}}var k;if(typeof y=="function")k=function(){y(x)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,D=P.port2;P.port1.onmessage=x,k=function(){D.postMessage(null)}}else k=function(){U(x,0)};function j(){I||(I=!0,k())}function G(V,B){R=U(function(){V(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,j())},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(V){switch(f){case 1:case 2:case 3:var B=3;break;default:B=f}var z=f;f=B;try{return V()}finally{f=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,B){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var z=f;f=V;try{return B()}finally{f=z}},e.unstable_scheduleCallback=function(V,B,z){var X=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?X+z:X):z=X,V){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=z+Y,V={id:d++,callback:B,priorityLevel:V,startTime:z,expirationTime:Y,sortIndex:-1},z>X?(V.sortIndex=z,t(c,V),n(l)===null&&V===n(c)&&(p?(b(R),R=-1):p=!0,G(_,z-X))):(V.sortIndex=Y,t(l,V),m||h||(m=!0,j())),V},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(V){var B=f;return function(){var z=f;f=B;try{return V.apply(this,arguments)}finally{f=z}}}})(HP);zP.exports=HP;var eq=zP.exports,VP={exports:{}},_s={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tq=L;function $P(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Nl(){}var gs={d:{f:Nl,r:function(){throw Error($P(522))},D:Nl,C:Nl,L:Nl,m:Nl,X:Nl,S:Nl,M:Nl},p:0,findDOMNode:null},nq=Symbol.for("react.portal");function iq(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nq,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}var cm=tq.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function M5(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}_s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=gs;_s.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error($P(299));return iq(e,t,null,n)};_s.flushSync=function(e){var t=cm.T,n=gs.p;try{if(cm.T=null,gs.p=2,e)return e()}finally{cm.T=t,gs.p=n,gs.d.f()}};_s.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,gs.d.C(e,t))};_s.prefetchDNS=function(e){typeof e=="string"&&gs.d.D(e)};_s.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var n=t.as,i=M5(n,t.crossOrigin),s=typeof t.integrity=="string"?t.integrity:void 0,r=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;n==="style"?gs.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:i,integrity:s,fetchPriority:r}):n==="script"&&gs.d.X(e,{crossOrigin:i,integrity:s,fetchPriority:r,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};_s.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var n=M5(t.as,t.crossOrigin);gs.d.M(e,{crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&gs.d.M(e)};_s.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var n=t.as,i=M5(n,t.crossOrigin);gs.d.L(e,n,{crossOrigin:i,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};_s.preloadModule=function(e,t){if(typeof e=="string")if(t){var n=M5(t.as,t.crossOrigin);gs.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else gs.d.m(e)};_s.requestFormReset=function(e){gs.d.r(e)};_s.unstable_batchedUpdates=function(e,t){return e(t)};_s.useFormState=function(e,t,n){return cm.H.useFormState(e,t,n)};_s.useFormStatus=function(){return cm.H.useHostTransitionStatus()};_s.version="19.0.0";function GP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(GP)}catch(e){console.error(e)}}GP(),VP.exports=_s;var cn=VP.exports;const sq=Sl(cn);/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ci=eq,XP=L,rq=cn;function ne(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function jP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var oq=Symbol.for("react.element"),vU=Symbol.for("react.transitional.element"),F1=Symbol.for("react.portal"),Lf=Symbol.for("react.fragment"),YP=Symbol.for("react.strict_mode"),f7=Symbol.for("react.profiler"),aq=Symbol.for("react.provider"),WP=Symbol.for("react.consumer"),Ga=Symbol.for("react.context"),x9=Symbol.for("react.forward_ref"),h7=Symbol.for("react.suspense"),g7=Symbol.for("react.suspense_list"),C9=Symbol.for("react.memo"),jl=Symbol.for("react.lazy"),KP=Symbol.for("react.offscreen"),lq=Symbol.for("react.memo_cache_sentinel"),lx=Symbol.iterator;function o1(e){return e===null||typeof e!="object"?null:(e=lx&&e[lx]||e["@@iterator"],typeof e=="function"?e:null)}var cq=Symbol.for("react.client.reference");function m7(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===cq?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Lf:return"Fragment";case F1:return"Portal";case f7:return"Profiler";case YP:return"StrictMode";case h7:return"Suspense";case g7:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ga:return(e.displayName||"Context")+".Provider";case WP:return(e._context.displayName||"Context")+".Consumer";case x9:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case C9:return t=e.displayName||null,t!==null?t:m7(e.type)||"Memo";case jl:t=e._payload,e=e._init;try{return m7(e(t))}catch{}}return null}var qe=XP.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,on=Object.assign,BE,cx;function B1(e){if(BE===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);BE=t&&t[1]||"",cx=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+BE+e+cx}var zE=!1;function HE(e,t){if(!e||zE)return"";zE=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var u=function(){throw Error()};if(Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(h){var f=h}Reflect.construct(e,[],u)}else{try{u.call()}catch(h){f=h}e.call(u.prototype)}}else{try{throw Error()}catch(h){f=h}(u=e())&&typeof u.catch=="function"&&u.catch(function(){})}}catch(h){if(h&&f&&typeof h.stack=="string")return[h.stack,f.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=i.DetermineComponentFrameRoot(),o=r[0],a=r[1];if(o&&a){var l=o.split(`
`),c=a.split(`
`);for(s=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(i===l.length||s===c.length)for(i=l.length-1,s=c.length-1;1<=i&&0<=s&&l[i]!==c[s];)s--;for(;1<=i&&0<=s;i--,s--)if(l[i]!==c[s]){if(i!==1||s!==1)do if(i--,s--,0>s||l[i]!==c[s]){var d=`
`+l[i].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=i&&0<=s);break}}}finally{zE=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?B1(n):""}function dq(e){switch(e.tag){case 26:case 27:case 5:return B1(e.type);case 16:return B1("Lazy");case 13:return B1("Suspense");case 19:return B1("SuspenseList");case 0:case 15:return e=HE(e.type,!1),e;case 11:return e=HE(e.type.render,!1),e;case 1:return e=HE(e.type,!0),e;default:return""}}function dx(e){try{var t="";do t+=dq(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Eg(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ZP(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ux(e){if(Eg(e)!==e)throw Error(ne(188))}function uq(e){var t=e.alternate;if(!t){if(t=Eg(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){n=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===n)return ux(s),e;if(r===i)return ux(s),t;r=r.sibling}throw Error(ne(188))}if(n.return!==i.return)n=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==i)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?e:t}function qP(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=qP(e),t!==null)return t;e=e.sibling}return null}var z1=Array.isArray,rn=rq.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Yd={pending:!1,data:null,method:null,action:null},p7=[],Df=-1;function ha(e){return{current:e}}function _i(e){0>Df||(e.current=p7[Df],p7[Df]=null,Df--)}function hn(e,t){Df++,p7[Df]=e.current,e.current=t}var Wo=ha(null),Jm=ha(null),pc=ha(null),Eb=ha(null);function vb(e,t){switch(hn(pc,t),hn(Jm,e),hn(Wo,null),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?fC(t):0;break;default:if(e=e===8?t.parentNode:t,t=e.tagName,e=e.namespaceURI)e=fC(e),t=cF(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}_i(Wo),hn(Wo,t)}function Ch(){_i(Wo),_i(Jm),_i(pc)}function U7(e){e.memoizedState!==null&&hn(Eb,e);var t=Wo.current,n=cF(t,e.type);t!==n&&(hn(Jm,e),hn(Wo,n))}function _b(e){Jm.current===e&&(_i(Wo),_i(Jm)),Eb.current===e&&(_i(Eb),d0._currentValue=Yd)}var b7=Object.prototype.hasOwnProperty,A9=ci.unstable_scheduleCallback,VE=ci.unstable_cancelCallback,fq=ci.unstable_shouldYield,hq=ci.unstable_requestPaint,Ko=ci.unstable_now,gq=ci.unstable_getCurrentPriorityLevel,QP=ci.unstable_ImmediatePriority,JP=ci.unstable_UserBlockingPriority,wb=ci.unstable_NormalPriority,mq=ci.unstable_LowPriority,eN=ci.unstable_IdlePriority,pq=ci.log,Uq=ci.unstable_setDisableYieldValue,lp=null,nr=null;function bq(e){if(nr&&typeof nr.onCommitFiberRoot=="function")try{nr.onCommitFiberRoot(lp,e,void 0,(e.current.flags&128)===128)}catch{}}function ac(e){if(typeof pq=="function"&&Uq(e),nr&&typeof nr.setStrictMode=="function")try{nr.setStrictMode(lp,e)}catch{}}var ir=Math.clz32?Math.clz32:vq,yq=Math.log,Eq=Math.LN2;function vq(e){return e>>>=0,e===0?32:31-(yq(e)/Eq|0)|0}var _U=128,wU=4194304;function Td(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function k5(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,s=e.suspendedLanes,r=e.pingedLanes,o=e.warmLanes;e=e.finishedLanes!==0;var a=n&134217727;return a!==0?(n=a&~s,n!==0?i=Td(n):(r&=a,r!==0?i=Td(r):e||(o=a&~o,o!==0&&(i=Td(o))))):(a=n&~s,a!==0?i=Td(a):r!==0?i=Td(r):e||(o=n&~o,o!==0&&(i=Td(o)))),i===0?0:t!==0&&t!==i&&!(t&s)&&(s=i&-i,o=t&-t,s>=o||s===32&&(o&4194176)!==0)?t:i}function cp(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function _q(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tN(){var e=_U;return _U<<=1,!(_U&4194176)&&(_U=128),e}function nN(){var e=wU;return wU<<=1,!(wU&62914560)&&(wU=4194304),e}function $E(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function dp(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function wq(e,t,n,i,s,r){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var d=31-ir(n),u=1<<d;a[d]=0,l[d]=-1;var f=c[d];if(f!==null)for(c[d]=null,d=0;d<f.length;d++){var h=f[d];h!==null&&(h.lane&=-536870913)}n&=~u}i!==0&&iN(e,i,0),r!==0&&s===0&&e.tag!==0&&(e.suspendedLanes|=r&~(o&~t))}function iN(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-ir(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&4194218}function sN(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ir(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}function rN(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function oN(){var e=rn.p;return e!==0?e:(e=window.event,e===void 0?32:yF(e.type))}function Tq(e,t){var n=rn.p;try{return rn.p=e,t()}finally{rn.p=n}}var rd=Math.random().toString(36).slice(2),Qi="__reactFiber$"+rd,Ds="__reactProps$"+rd,vg="__reactContainer$"+rd,y7="__reactEvents$"+rd,Iq="__reactListeners$"+rd,Sq="__reactHandles$"+rd,fx="__reactResources$"+rd,e0="__reactMarker$"+rd;function M9(e){delete e[Qi],delete e[Ds],delete e[y7],delete e[Iq],delete e[Sq]}function Nd(e){var t=e[Qi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vg]||n[Qi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=gC(e);e!==null;){if(n=e[Qi])return n;e=gC(e)}return t}e=n,n=e.parentNode}return null}function _g(e){if(e=e[Qi]||e[vg]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function H1(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(ne(33))}function ih(e){var t=e[fx];return t||(t=e[fx]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ui(e){e[e0]=!0}var aN=new Set,lN={};function Nu(e,t){Ah(e,t),Ah(e+"Capture",t)}function Ah(e,t){for(lN[e]=t,e=0;e<t.length;e++)aN.add(t[e])}var al=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xq=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hx={},gx={};function Cq(e){return b7.call(gx,e)?!0:b7.call(hx,e)?!1:xq.test(e)?gx[e]=!0:(hx[e]=!0,!1)}function x2(e,t,n){if(Cq(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function TU(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function va(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function br(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function cN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Aq(e){var t=cN(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tb(e){e._valueTracker||(e._valueTracker=Aq(e))}function dN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=cN(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Ib(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Mq=/[\n"\\]/g;function vr(e){return e.replace(Mq,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function E7(e,t,n,i,s,r,o,a){e.name="",o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.type=o:e.removeAttribute("type"),t!=null?o==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+br(t)):e.value!==""+br(t)&&(e.value=""+br(t)):o!=="submit"&&o!=="reset"||e.removeAttribute("value"),t!=null?v7(e,o,br(t)):n!=null?v7(e,o,br(n)):i!=null&&e.removeAttribute("value"),s==null&&r!=null&&(e.defaultChecked=!!r),s!=null&&(e.checked=s&&typeof s!="function"&&typeof s!="symbol"),a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?e.name=""+br(a):e.removeAttribute("name")}function uN(e,t,n,i,s,r,o,a){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(e.type=r),t!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||t!=null))return;n=n!=null?""+br(n):"",t=t!=null?""+br(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}i=i??s,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=a?e.checked:!!i,e.defaultChecked=!!i,o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.name=o)}function v7(e,t,n){t==="number"&&Ib(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function sh(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+br(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,i&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function fN(e,t,n){if(t!=null&&(t=""+br(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+br(n):""}function hN(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(ne(92));if(z1(i)){if(1<i.length)throw Error(ne(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=br(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i)}function Mh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var kq=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mx(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||kq.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function gN(e,t,n){if(t!=null&&typeof t!="object")throw Error(ne(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var s in t)i=t[s],t.hasOwnProperty(s)&&n[s]!==i&&mx(e,s,i)}else for(var r in t)t.hasOwnProperty(r)&&mx(e,r,t[r])}function k9(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rq=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lq=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function C2(e){return Lq.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var _7=null;function R9(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pf=null,rh=null;function px(e){var t=_g(e);if(t&&(e=t.stateNode)){var n=e[Ds]||null;e:switch(e=t.stateNode,t.type){case"input":if(E7(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vr(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=i[Ds]||null;if(!s)throw Error(ne(90));E7(i,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&dN(i)}break e;case"textarea":fN(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&sh(e,!!n.multiple,t,!1)}}}var GE=!1;function mN(e,t,n){if(GE)return e(t,n);GE=!0;try{var i=e(t);return i}finally{if(GE=!1,(Pf!==null||rh!==null)&&(H5(),Pf&&(t=Pf,e=rh,rh=Pf=null,px(t),e)))for(t=0;t<e.length;t++)px(e[t])}}function t0(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Ds]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ne(231,t,typeof n));return n}var w7=!1;if(al)try{var a1={};Object.defineProperty(a1,"passive",{get:function(){w7=!0}}),window.addEventListener("test",a1,a1),window.removeEventListener("test",a1,a1)}catch{w7=!1}var lc=null,L9=null,A2=null;function pN(){if(A2)return A2;var e,t=L9,n=t.length,i,s="value"in lc?lc.value:lc.textContent,r=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===s[r-i];i++);return A2=s.slice(e,1<i?1-i:void 0)}function M2(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function IU(){return!0}function Ux(){return!1}function Ns(e){function t(n,i,s,r,o){this._reactName=n,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?IU:Ux,this.isPropagationStopped=Ux,this}return on(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=IU)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=IU)},persist:function(){},isPersistent:IU}),t}var Ou={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},R5=Ns(Ou),up=on({},Ou,{view:0,detail:0}),Dq=Ns(up),XE,jE,l1,L5=on({},up,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:D9,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==l1&&(l1&&e.type==="mousemove"?(XE=e.screenX-l1.screenX,jE=e.screenY-l1.screenY):jE=XE=0,l1=e),XE)},movementY:function(e){return"movementY"in e?e.movementY:jE}}),bx=Ns(L5),Pq=on({},L5,{dataTransfer:0}),Nq=Ns(Pq),Oq=on({},up,{relatedTarget:0}),YE=Ns(Oq),Fq=on({},Ou,{animationName:0,elapsedTime:0,pseudoElement:0}),Bq=Ns(Fq),zq=on({},Ou,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hq=Ns(zq),Vq=on({},Ou,{data:0}),yx=Ns(Vq),$q={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jq(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xq[e])?!!t[e]:!1}function D9(){return jq}var Yq=on({},up,{key:function(e){if(e.key){var t=$q[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=M2(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Gq[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:D9,charCode:function(e){return e.type==="keypress"?M2(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?M2(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Wq=Ns(Yq),Kq=on({},L5,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ex=Ns(Kq),Zq=on({},up,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:D9}),qq=Ns(Zq),Qq=on({},Ou,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jq=Ns(Qq),eQ=on({},L5,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),tQ=Ns(eQ),nQ=on({},Ou,{newState:0,oldState:0}),iQ=Ns(nQ),sQ=[9,13,27,32],P9=al&&"CompositionEvent"in window,dm=null;al&&"documentMode"in document&&(dm=document.documentMode);var rQ=al&&"TextEvent"in window&&!dm,UN=al&&(!P9||dm&&8<dm&&11>=dm),vx=" ",_x=!1;function bN(e,t){switch(e){case"keyup":return sQ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yN(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Nf=!1;function oQ(e,t){switch(e){case"compositionend":return yN(t);case"keypress":return t.which!==32?null:(_x=!0,vx);case"textInput":return e=t.data,e===vx&&_x?null:e;default:return null}}function aQ(e,t){if(Nf)return e==="compositionend"||!P9&&bN(e,t)?(e=pN(),A2=L9=lc=null,Nf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return UN&&t.locale!=="ko"?null:t.data;default:return null}}var lQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!lQ[e.type]:t==="textarea"}function EN(e,t,n,i){Pf?rh?rh.push(i):rh=[i]:Pf=i,t=Hb(t,"onChange"),0<t.length&&(n=new R5("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var um=null,n0=null;function cQ(e){oF(e,0)}function D5(e){var t=H1(e);if(dN(t))return e}function Tx(e,t){if(e==="change")return t}var vN=!1;if(al){var WE;if(al){var KE="oninput"in document;if(!KE){var Ix=document.createElement("div");Ix.setAttribute("oninput","return;"),KE=typeof Ix.oninput=="function"}WE=KE}else WE=!1;vN=WE&&(!document.documentMode||9<document.documentMode)}function Sx(){um&&(um.detachEvent("onpropertychange",_N),n0=um=null)}function _N(e){if(e.propertyName==="value"&&D5(n0)){var t=[];EN(t,n0,e,R9(e)),mN(cQ,t)}}function dQ(e,t,n){e==="focusin"?(Sx(),um=t,n0=n,um.attachEvent("onpropertychange",_N)):e==="focusout"&&Sx()}function uQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return D5(n0)}function fQ(e,t){if(e==="click")return D5(t)}function hQ(e,t){if(e==="input"||e==="change")return D5(t)}function gQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var lr=typeof Object.is=="function"?Object.is:gQ;function i0(e,t){if(lr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!b7.call(t,s)||!lr(e[s],t[s]))return!1}return!0}function xx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cx(e,t){var n=xx(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=xx(n)}}function wN(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?wN(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function TN(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ib(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ib(e.document)}return t}function N9(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mQ(e,t){var n=TN(t);t=e.focusedElem;var i=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&wN(t.ownerDocument.documentElement,t)){if(i!==null&&N9(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=Cx(t,r);var o=Cx(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var pQ=al&&"documentMode"in document&&11>=document.documentMode,Of=null,T7=null,fm=null,I7=!1;function Ax(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;I7||Of==null||Of!==Ib(i)||(i=Of,"selectionStart"in i&&N9(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),fm&&i0(fm,i)||(fm=i,i=Hb(T7,"onSelect"),0<i.length&&(t=new R5("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Of)))}function yd(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ff={animationend:yd("Animation","AnimationEnd"),animationiteration:yd("Animation","AnimationIteration"),animationstart:yd("Animation","AnimationStart"),transitionrun:yd("Transition","TransitionRun"),transitionstart:yd("Transition","TransitionStart"),transitioncancel:yd("Transition","TransitionCancel"),transitionend:yd("Transition","TransitionEnd")},ZE={},IN={};al&&(IN=document.createElement("div").style,"AnimationEvent"in window||(delete Ff.animationend.animation,delete Ff.animationiteration.animation,delete Ff.animationstart.animation),"TransitionEvent"in window||delete Ff.transitionend.transition);function Fu(e){if(ZE[e])return ZE[e];if(!Ff[e])return e;var t=Ff[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in IN)return ZE[e]=t[n];return e}var SN=Fu("animationend"),xN=Fu("animationiteration"),CN=Fu("animationstart"),UQ=Fu("transitionrun"),bQ=Fu("transitionstart"),yQ=Fu("transitioncancel"),AN=Fu("transitionend"),MN=new Map,Mx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function To(e,t){MN.set(e,t),Nu(t,[e])}var pr=[],Bf=0,O9=0;function P5(){for(var e=Bf,t=O9=Bf=0;t<e;){var n=pr[t];pr[t++]=null;var i=pr[t];pr[t++]=null;var s=pr[t];pr[t++]=null;var r=pr[t];if(pr[t++]=null,i!==null&&s!==null){var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}r!==0&&kN(n,s,r)}}function N5(e,t,n,i){pr[Bf++]=e,pr[Bf++]=t,pr[Bf++]=n,pr[Bf++]=i,O9|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function F9(e,t,n,i){return N5(e,t,n,i),Sb(e)}function Nc(e,t){return N5(e,null,null,t),Sb(e)}function kN(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var s=!1,r=e.return;r!==null;)r.childLanes|=n,i=r.alternate,i!==null&&(i.childLanes|=n),r.tag===22&&(e=r.stateNode,e===null||e._visibility&1||(s=!0)),e=r,r=r.return;s&&t!==null&&e.tag===3&&(r=e.stateNode,s=31-ir(n),r=r.hiddenUpdates,e=r[s],e===null?r[s]=[t]:e.push(t),t.lane=n|536870912)}function Sb(e){if(50<Tm)throw Tm=0,Y7=null,Error(ne(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var zf={},kx=new WeakMap;function _r(e,t){if(typeof e=="object"&&e!==null){var n=kx.get(e);return n!==void 0?n:(t={value:e,source:t,stack:dx(t)},kx.set(e,t),t)}return{value:e,source:t,stack:dx(t)}}var Hf=[],Vf=0,xb=null,Cb=0,yr=[],Er=0,Wd=null,Xa=1,ja="";function Id(e,t){Hf[Vf++]=Cb,Hf[Vf++]=xb,xb=e,Cb=t}function RN(e,t,n){yr[Er++]=Xa,yr[Er++]=ja,yr[Er++]=Wd,Wd=e;var i=Xa;e=ja;var s=32-ir(i)-1;i&=~(1<<s),n+=1;var r=32-ir(t)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,Xa=1<<32-ir(t)+s|n<<s|i,ja=r+e}else Xa=1<<r|n<<s|i,ja=e}function B9(e){e.return!==null&&(Id(e,1),RN(e,1,0))}function z9(e){for(;e===xb;)xb=Hf[--Vf],Hf[Vf]=null,Cb=Hf[--Vf],Hf[Vf]=null;for(;e===Wd;)Wd=yr[--Er],yr[Er]=null,ja=yr[--Er],yr[Er]=null,Xa=yr[--Er],yr[Er]=null}var fs=null,Li=null,kt=!1,no=null,Bo=!1,S7=Error(ne(519));function au(e){var t=Error(ne(418,""));throw s0(_r(t,e)),S7}function Rx(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[Qi]=e,t[Ds]=i,n){case"dialog":dt("cancel",t),dt("close",t);break;case"iframe":case"object":case"embed":dt("load",t);break;case"video":case"audio":for(n=0;n<a0.length;n++)dt(a0[n],t);break;case"source":dt("error",t);break;case"img":case"image":case"link":dt("error",t),dt("load",t);break;case"details":dt("toggle",t);break;case"input":dt("invalid",t),uN(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),Tb(t);break;case"select":dt("invalid",t);break;case"textarea":dt("invalid",t),hN(t,i.value,i.defaultValue,i.children),Tb(t)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||lF(t.textContent,n)?(i.popover!=null&&(dt("beforetoggle",t),dt("toggle",t)),i.onScroll!=null&&dt("scroll",t),i.onScrollEnd!=null&&dt("scrollend",t),i.onClick!=null&&(t.onclick=$5),t=!0):t=!1,t||au(e)}function Lx(e){for(fs=e.return;fs;)switch(fs.tag){case 3:case 27:Bo=!0;return;case 5:case 13:Bo=!1;return;default:fs=fs.return}}function c1(e){if(e!==fs)return!1;if(!kt)return Lx(e),kt=!0,!1;var t=!1,n;if((n=e.tag!==3&&e.tag!==27)&&((n=e.tag===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||e4(e.type,e.memoizedProps)),n=!n),n&&(t=!0),t&&Li&&au(e),Lx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){Li=lo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}Li=null}}else Li=fs?lo(e.stateNode.nextSibling):null;return!0}function fp(){Li=fs=null,kt=!1}function s0(e){no===null?no=[e]:no.push(e)}var hm=Error(ne(460)),LN=Error(ne(474)),x7={then:function(){}};function Dx(e){return e=e.status,e==="fulfilled"||e==="rejected"}function SU(){}function DN(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(SU,SU),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===hm?Error(ne(483)):e;default:if(typeof t.status=="string")t.then(SU,SU);else{if(e=Qt,e!==null&&100<e.shellSuspendCounter)throw Error(ne(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var s=t;s.status="fulfilled",s.value=i}},function(i){if(t.status==="pending"){var s=t;s.status="rejected",s.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===hm?Error(ne(483)):e}throw gm=t,hm}}var gm=null;function Px(){if(gm===null)throw Error(ne(459));var e=gm;return gm=null,e}var oh=null,r0=0;function xU(e){var t=r0;return r0+=1,oh===null&&(oh=[]),DN(oh,e,t)}function d1(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function CU(e,t){throw t.$$typeof===oq?Error(ne(525)):(e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Nx(e){var t=e._init;return t(e._payload)}function PN(e){function t(b,y){if(e){var v=b.deletions;v===null?(b.deletions=[y],b.flags|=16):v.push(y)}}function n(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function i(b){for(var y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function s(b,y){return b=yc(b,y),b.index=0,b.sibling=null,b}function r(b,y,v){return b.index=v,e?(v=b.alternate,v!==null?(v=v.index,v<y?(b.flags|=33554434,y):v):(b.flags|=33554434,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=33554434),b}function a(b,y,v,_){return y===null||y.tag!==6?(y=l8(v,b.mode,_),y.return=b,y):(y=s(y,v),y.return=b,y)}function l(b,y,v,_){var I=v.type;return I===Lf?d(b,y,v.props.children,_,v.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===jl&&Nx(I)===y.type)?(y=s(y,v.props),d1(y,v),y.return=b,y):(y=P2(v.type,v.key,v.props,null,b.mode,_),d1(y,v),y.return=b,y)}function c(b,y,v,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=c8(v,b.mode,_),y.return=b,y):(y=s(y,v.children||[]),y.return=b,y)}function d(b,y,v,_,I){return y===null||y.tag!==7?(y=Zd(v,b.mode,_,I),y.return=b,y):(y=s(y,v),y.return=b,y)}function u(b,y,v){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return y=l8(""+y,b.mode,v),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case vU:return v=P2(y.type,y.key,y.props,null,b.mode,v),d1(v,y),v.return=b,v;case F1:return y=c8(y,b.mode,v),y.return=b,y;case jl:var _=y._init;return y=_(y._payload),u(b,y,v)}if(z1(y)||o1(y))return y=Zd(y,b.mode,v,null),y.return=b,y;if(typeof y.then=="function")return u(b,xU(y),v);if(y.$$typeof===Ga)return u(b,AU(b,y),v);CU(b,y)}return null}function f(b,y,v,_){var I=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return I!==null?null:a(b,y,""+v,_);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case vU:return v.key===I?l(b,y,v,_):null;case F1:return v.key===I?c(b,y,v,_):null;case jl:return I=v._init,v=I(v._payload),f(b,y,v,_)}if(z1(v)||o1(v))return I!==null?null:d(b,y,v,_,null);if(typeof v.then=="function")return f(b,y,xU(v),_);if(v.$$typeof===Ga)return f(b,y,AU(b,v),_);CU(b,v)}return null}function h(b,y,v,_,I){if(typeof _=="string"&&_!==""||typeof _=="number"||typeof _=="bigint")return b=b.get(v)||null,a(y,b,""+_,I);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case vU:return b=b.get(_.key===null?v:_.key)||null,l(y,b,_,I);case F1:return b=b.get(_.key===null?v:_.key)||null,c(y,b,_,I);case jl:var R=_._init;return _=R(_._payload),h(b,y,v,_,I)}if(z1(_)||o1(_))return b=b.get(v)||null,d(y,b,_,I,null);if(typeof _.then=="function")return h(b,y,v,xU(_),I);if(_.$$typeof===Ga)return h(b,y,v,AU(y,_),I);CU(y,_)}return null}function m(b,y,v,_){for(var I=null,R=null,T=y,w=y=0,S=null;T!==null&&w<v.length;w++){T.index>w?(S=T,T=null):S=T.sibling;var x=f(b,T,v[w],_);if(x===null){T===null&&(T=S);break}e&&T&&x.alternate===null&&t(b,T),y=r(x,y,w),R===null?I=x:R.sibling=x,R=x,T=S}if(w===v.length)return n(b,T),kt&&Id(b,w),I;if(T===null){for(;w<v.length;w++)T=u(b,v[w],_),T!==null&&(y=r(T,y,w),R===null?I=T:R.sibling=T,R=T);return kt&&Id(b,w),I}for(T=i(T);w<v.length;w++)S=h(T,b,w,v[w],_),S!==null&&(e&&S.alternate!==null&&T.delete(S.key===null?w:S.key),y=r(S,y,w),R===null?I=S:R.sibling=S,R=S);return e&&T.forEach(function(k){return t(b,k)}),kt&&Id(b,w),I}function p(b,y,v,_){if(v==null)throw Error(ne(151));for(var I=null,R=null,T=y,w=y=0,S=null,x=v.next();T!==null&&!x.done;w++,x=v.next()){T.index>w?(S=T,T=null):S=T.sibling;var k=f(b,T,x.value,_);if(k===null){T===null&&(T=S);break}e&&T&&k.alternate===null&&t(b,T),y=r(k,y,w),R===null?I=k:R.sibling=k,R=k,T=S}if(x.done)return n(b,T),kt&&Id(b,w),I;if(T===null){for(;!x.done;w++,x=v.next())x=u(b,x.value,_),x!==null&&(y=r(x,y,w),R===null?I=x:R.sibling=x,R=x);return kt&&Id(b,w),I}for(T=i(T);!x.done;w++,x=v.next())x=h(T,b,w,x.value,_),x!==null&&(e&&x.alternate!==null&&T.delete(x.key===null?w:x.key),y=r(x,y,w),R===null?I=x:R.sibling=x,R=x);return e&&T.forEach(function(P){return t(b,P)}),kt&&Id(b,w),I}function U(b,y,v,_){if(typeof v=="object"&&v!==null&&v.type===Lf&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case vU:e:{for(var I=v.key;y!==null;){if(y.key===I){if(I=v.type,I===Lf){if(y.tag===7){n(b,y.sibling),_=s(y,v.props.children),_.return=b,b=_;break e}}else if(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===jl&&Nx(I)===y.type){n(b,y.sibling),_=s(y,v.props),d1(_,v),_.return=b,b=_;break e}n(b,y);break}else t(b,y);y=y.sibling}v.type===Lf?(_=Zd(v.props.children,b.mode,_,v.key),_.return=b,b=_):(_=P2(v.type,v.key,v.props,null,b.mode,_),d1(_,v),_.return=b,b=_)}return o(b);case F1:e:{for(I=v.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){n(b,y.sibling),_=s(y,v.children||[]),_.return=b,b=_;break e}else{n(b,y);break}else t(b,y);y=y.sibling}_=c8(v,b.mode,_),_.return=b,b=_}return o(b);case jl:return I=v._init,v=I(v._payload),U(b,y,v,_)}if(z1(v))return m(b,y,v,_);if(o1(v)){if(I=o1(v),typeof I!="function")throw Error(ne(150));return v=I.call(v),p(b,y,v,_)}if(typeof v.then=="function")return U(b,y,xU(v),_);if(v.$$typeof===Ga)return U(b,y,AU(b,v),_);CU(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint"?(v=""+v,y!==null&&y.tag===6?(n(b,y.sibling),_=s(y,v),_.return=b,b=_):(n(b,y),_=l8(v,b.mode,_),_.return=b,b=_),o(b)):n(b,y)}return function(b,y,v,_){try{r0=0;var I=U(b,y,v,_);return oh=null,I}catch(T){if(T===hm)throw T;var R=Sr(29,T,null,b.mode);return R.lanes=_,R.return=b,R}finally{}}}var lu=PN(!0),NN=PN(!1),kh=ha(null),Ab=ha(0);function Ox(e,t){e=dl,hn(Ab,e),hn(kh,t),dl=e|t.baseLanes}function C7(){hn(Ab,dl),hn(kh,kh.current)}function H9(){dl=Ab.current,_i(kh),_i(Ab)}var Br=ha(null),Zo=null;function Jl(e){var t=e.alternate;hn(ri,ri.current&1),hn(Br,e),Zo===null&&(t===null||kh.current!==null||t.memoizedState!==null)&&(Zo=e)}function ON(e){if(e.tag===22){if(hn(ri,ri.current),hn(Br,e),Zo===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Zo=e)}}else ec()}function ec(){hn(ri,ri.current),hn(Br,Br.current)}function Ya(e){_i(Br),Zo===e&&(Zo=null),_i(ri)}var ri=ha(0);function Mb(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var EQ=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},vQ=ci.unstable_scheduleCallback,_Q=ci.unstable_NormalPriority,si={$$typeof:Ga,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function V9(){return{controller:new EQ,data:new Map,refCount:0}}function hp(e){e.refCount--,e.refCount===0&&vQ(_Q,function(){e.controller.abort()})}var mm=null,A7=0,Rh=0,ah=null;function wQ(e,t){if(mm===null){var n=mm=[];A7=0,Rh=u_(),ah={status:"pending",value:void 0,then:function(i){n.push(i)}}}return A7++,t.then(Fx,Fx),t}function Fx(){if(--A7===0&&mm!==null){ah!==null&&(ah.status="fulfilled");var e=mm;mm=null,Rh=0,ah=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function TQ(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(s){n.push(s)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var s=0;s<n.length;s++)(0,n[s])(t)},function(s){for(i.status="rejected",i.reason=s,s=0;s<n.length;s++)(0,n[s])(void 0)}),i}var Bx=qe.S;qe.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&wQ(e,t),Bx!==null&&Bx(e,t)};var Kd=ha(null);function $9(){var e=Kd.current;return e!==null?e:Qt.pooledCache}function k2(e,t){t===null?hn(Kd,Kd.current):hn(Kd,t.pool)}function FN(){var e=$9();return e===null?null:{parent:si._currentValue,pool:e}}var Oc=0,tt=null,Vt=null,jn=null,kb=!1,lh=!1,cu=!1,Rb=0,o0=0,ch=null,IQ=0;function Rn(){throw Error(ne(321))}function G9(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function X9(e,t,n,i,s,r){return Oc=r,tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qe.H=e===null||e.memoizedState===null?Bu:od,cu=!1,r=n(i,s),cu=!1,lh&&(r=zN(t,n,i,s)),BN(e),r}function BN(e){qe.H=ta;var t=Vt!==null&&Vt.next!==null;if(Oc=0,jn=Vt=tt=null,kb=!1,o0=0,ch=null,t)throw Error(ne(300));e===null||yi||(e=e.dependencies,e!==null&&Pb(e)&&(yi=!0))}function zN(e,t,n,i){tt=e;var s=0;do{if(lh&&(ch=null),o0=0,lh=!1,25<=s)throw Error(ne(301));if(s+=1,jn=Vt=null,e.updateQueue!=null){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}qe.H=zu,r=t(n,i)}while(lh);return r}function SQ(){var e=qe.H,t=e.useState()[0];return t=typeof t.then=="function"?gp(t):t,e=e.useState()[0],(Vt!==null?Vt.memoizedState:null)!==e&&(tt.flags|=1024),t}function j9(){var e=Rb!==0;return Rb=0,e}function Y9(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function W9(e){if(kb){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}kb=!1}Oc=0,jn=Vt=tt=null,lh=!1,o0=Rb=0,ch=null}function Ss(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?tt.memoizedState=jn=e:jn=jn.next=e,jn}function Zn(){if(Vt===null){var e=tt.alternate;e=e!==null?e.memoizedState:null}else e=Vt.next;var t=jn===null?tt.memoizedState:jn.next;if(t!==null)jn=t,Vt=e;else{if(e===null)throw tt.alternate===null?Error(ne(467)):Error(ne(310));Vt=e,e={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},jn===null?tt.memoizedState=jn=e:jn=jn.next=e}return jn}var O5;O5=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function gp(e){var t=o0;return o0+=1,ch===null&&(ch=[]),e=DN(ch,e,t),t=tt,(jn===null?t.memoizedState:jn.next)===null&&(t=t.alternate,qe.H=t===null||t.memoizedState===null?Bu:od),e}function F5(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return gp(e);if(e.$$typeof===Ga)return Ji(e)}throw Error(ne(438,String(e)))}function K9(e){var t=null,n=tt.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=tt.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(s){return s.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=O5(),tt.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=lq;return t.index++,n}function ll(e,t){return typeof t=="function"?t(e):t}function R2(e){var t=Zn();return Z9(t,Vt,e)}function Z9(e,t,n){var i=e.queue;if(i===null)throw Error(ne(311));i.lastRenderedReducer=n;var s=e.baseQueue,r=i.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}t.baseQueue=s=r,i.pending=null}if(r=e.baseState,s===null)e.memoizedState=r;else{t=s.next;var a=o=null,l=null,c=t,d=!1;do{var u=c.lane&-536870913;if(u!==c.lane?(Ut&u)===u:(Oc&u)===u){var f=c.revertLane;if(f===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),u===Rh&&(d=!0);else if((Oc&f)===f){c=c.next,f===Rh&&(d=!0);continue}else u={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=u,o=r):l=l.next=u,tt.lanes|=f,Bc|=f;u=c.action,cu&&n(r,u),r=c.hasEagerState?c.eagerState:n(r,u)}else f={lane:u,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=f,o=r):l=l.next=f,tt.lanes|=u,Bc|=u;c=c.next}while(c!==null&&c!==t);if(l===null?o=r:l.next=a,!lr(r,e.memoizedState)&&(yi=!0,d&&(n=ah,n!==null)))throw n;e.memoizedState=r,e.baseState=o,e.baseQueue=l,i.lastRenderedState=r}return s===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function qE(e){var t=Zn(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,r=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do r=e(r,o.action),o=o.next;while(o!==s);lr(r,t.memoizedState)||(yi=!0),t.memoizedState=r,t.baseQueue===null&&(t.baseState=r),n.lastRenderedState=r}return[r,i]}function HN(e,t,n){var i=tt,s=Zn(),r=kt;if(r){if(n===void 0)throw Error(ne(407));n=n()}else n=t();var o=!lr((Vt||s).memoizedState,n);if(o&&(s.memoizedState=n,yi=!0),s=s.queue,q9(GN.bind(null,i,s,e),[e]),s.getSnapshot!==t||o||jn!==null&&jn.memoizedState.tag&1){if(i.flags|=2048,Lh(9,$N.bind(null,i,s,n,t),{destroy:void 0},null),Qt===null)throw Error(ne(349));r||Oc&60||VN(i,t,n)}return n}function VN(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=tt.updateQueue,t===null?(t=O5(),tt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $N(e,t,n,i){t.value=n,t.getSnapshot=i,XN(t)&&jN(e)}function GN(e,t,n){return n(function(){XN(t)&&jN(e)})}function XN(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!lr(e,n)}catch{return!0}}function jN(e){var t=Nc(e,2);t!==null&&Us(t,e,2)}function M7(e){var t=Ss();if(typeof e=="function"){var n=e;if(e=n(),cu){ac(!0);try{n()}finally{ac(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:e},t}function YN(e,t,n,i){return e.baseState=n,Z9(e,Vt,typeof i=="function"?i:ll)}function xQ(e,t,n,i,s){if(z5(e))throw Error(ne(485));if(e=t.action,e!==null){var r={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(o){r.listeners.push(o)}};qe.T!==null?n(!0):r.isTransition=!1,i(r),n=t.pending,n===null?(r.next=t.pending=r,WN(t,r)):(r.next=n.next,t.pending=n.next=r)}}function WN(e,t){var n=t.action,i=t.payload,s=e.state;if(t.isTransition){var r=qe.T,o={};qe.T=o;try{var a=n(s,i),l=qe.S;l!==null&&l(o,a),zx(e,t,a)}catch(c){k7(e,t,c)}finally{qe.T=r}}else try{r=n(s,i),zx(e,t,r)}catch(c){k7(e,t,c)}}function zx(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Hx(e,t,i)},function(i){return k7(e,t,i)}):Hx(e,t,n)}function Hx(e,t,n){t.status="fulfilled",t.value=n,KN(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,WN(e,n)))}function k7(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,KN(t),t=t.next;while(t!==i)}e.action=null}function KN(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ZN(e,t){return t}function qN(e,t){if(kt){var n=Qt.formState;if(n!==null){e:{var i=tt;if(kt){if(Li){t:{for(var s=Li,r=Bo;s.nodeType!==8;){if(!r){s=null;break t}if(s=lo(s.nextSibling),s===null){s=null;break t}}r=s.data,s=r==="F!"||r==="F"?s:null}if(s){Li=lo(s.nextSibling),i=s.data==="F!";break e}}au(i)}i=!1}i&&(t=n[0])}}return n=Ss(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ZN,lastRenderedState:t},n.queue=i,n=gO.bind(null,tt,i),i.dispatch=n,i=M7(!1),r=t_.bind(null,tt,!1,i.queue),i=Ss(),s={state:t,dispatch:null,action:e,pending:null},i.queue=s,n=xQ.bind(null,tt,s,r,n),s.dispatch=n,i.memoizedState=e,[t,n,!1]}function QN(e){var t=Zn();return JN(t,Vt,e)}function JN(e,t,n){t=Z9(e,t,ZN)[0],e=R2(ll)[0],t=typeof t=="object"&&t!==null&&typeof t.then=="function"?gp(t):t;var i=Zn(),s=i.queue,r=s.dispatch;return n!==i.memoizedState&&(tt.flags|=2048,Lh(9,CQ.bind(null,s,n),{destroy:void 0},null)),[t,r,e]}function CQ(e,t){e.action=t}function eO(e){var t=Zn(),n=Vt;if(n!==null)return JN(t,n,e);Zn(),t=t.memoizedState,n=Zn();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Lh(e,t,n,i){return e={tag:e,create:t,inst:n,deps:i,next:null},t=tt.updateQueue,t===null&&(t=O5(),tt.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function tO(){return Zn().memoizedState}function L2(e,t,n,i){var s=Ss();tt.flags|=e,s.memoizedState=Lh(1|t,n,{destroy:void 0},i===void 0?null:i)}function B5(e,t,n,i){var s=Zn();i=i===void 0?null:i;var r=s.memoizedState.inst;Vt!==null&&i!==null&&G9(i,Vt.memoizedState.deps)?s.memoizedState=Lh(t,n,r,i):(tt.flags|=e,s.memoizedState=Lh(1|t,n,r,i))}function Vx(e,t){L2(8390656,8,e,t)}function q9(e,t){B5(2048,8,e,t)}function nO(e,t){return B5(4,2,e,t)}function iO(e,t){return B5(4,4,e,t)}function sO(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function rO(e,t,n){n=n!=null?n.concat([e]):null,B5(4,4,sO.bind(null,t,e),n)}function Q9(){}function oO(e,t){var n=Zn();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&G9(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function aO(e,t){var n=Zn();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&G9(t,i[1]))return i[0];if(i=e(),cu){ac(!0);try{e()}finally{ac(!1)}}return n.memoizedState=[i,t],i}function J9(e,t,n){return n===void 0||Oc&1073741824?e.memoizedState=t:(e.memoizedState=n,e=KO(),tt.lanes|=e,Bc|=e,n)}function lO(e,t,n,i){return lr(n,t)?n:kh.current!==null?(e=J9(e,n,i),lr(e,t)||(yi=!0),e):Oc&42?(e=KO(),tt.lanes|=e,Bc|=e,t):(yi=!0,e.memoizedState=n)}function cO(e,t,n,i,s){var r=rn.p;rn.p=r!==0&&8>r?r:8;var o=qe.T,a={};qe.T=a,t_(e,!1,t,n);try{var l=s(),c=qe.S;if(c!==null&&c(a,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=TQ(l,i);pm(e,t,d,sr(e))}else pm(e,t,i,sr(e))}catch(u){pm(e,t,{then:function(){},status:"rejected",reason:u},sr())}finally{rn.p=r,qe.T=o}}function AQ(){}function R7(e,t,n,i){if(e.tag!==5)throw Error(ne(476));var s=dO(e).queue;cO(e,s,t,Yd,n===null?AQ:function(){return uO(e),n(i)})}function dO(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Yd,baseState:Yd,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:Yd},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function uO(e){var t=dO(e).next.queue;pm(e,t,{},sr())}function e_(){return Ji(d0)}function fO(){return Zn().memoizedState}function hO(){return Zn().memoizedState}function MQ(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=sr();e=Uc(n);var i=bc(t,e,n);i!==null&&(Us(i,t,n),bm(i,t,n)),t={cache:V9()},e.payload=t;return}t=t.return}}function kQ(e,t,n){var i=sr();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},z5(e)?mO(t,n):(n=F9(e,t,n,i),n!==null&&(Us(n,e,i),pO(n,t,i)))}function gO(e,t,n){var i=sr();pm(e,t,n,i)}function pm(e,t,n,i){var s={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(z5(e))mO(t,s);else{var r=e.alternate;if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var o=t.lastRenderedState,a=r(o,n);if(s.hasEagerState=!0,s.eagerState=a,lr(a,o))return N5(e,t,s,0),Qt===null&&P5(),!1}catch{}finally{}if(n=F9(e,t,s,i),n!==null)return Us(n,e,i),pO(n,t,i),!0}return!1}function t_(e,t,n,i){if(i={lane:2,revertLane:u_(),action:i,hasEagerState:!1,eagerState:null,next:null},z5(e)){if(t)throw Error(ne(479))}else t=F9(e,n,i,2),t!==null&&Us(t,e,2)}function z5(e){var t=e.alternate;return e===tt||t!==null&&t===tt}function mO(e,t){lh=kb=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function pO(e,t,n){if(n&4194176){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,sN(e,n)}}var ta={readContext:Ji,use:F5,useCallback:Rn,useContext:Rn,useEffect:Rn,useImperativeHandle:Rn,useLayoutEffect:Rn,useInsertionEffect:Rn,useMemo:Rn,useReducer:Rn,useRef:Rn,useState:Rn,useDebugValue:Rn,useDeferredValue:Rn,useTransition:Rn,useSyncExternalStore:Rn,useId:Rn};ta.useCacheRefresh=Rn;ta.useMemoCache=Rn;ta.useHostTransitionStatus=Rn;ta.useFormState=Rn;ta.useActionState=Rn;ta.useOptimistic=Rn;var Bu={readContext:Ji,use:F5,useCallback:function(e,t){return Ss().memoizedState=[e,t===void 0?null:t],e},useContext:Ji,useEffect:Vx,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,L2(4194308,4,sO.bind(null,t,e),n)},useLayoutEffect:function(e,t){return L2(4194308,4,e,t)},useInsertionEffect:function(e,t){L2(4,2,e,t)},useMemo:function(e,t){var n=Ss();t=t===void 0?null:t;var i=e();if(cu){ac(!0);try{e()}finally{ac(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Ss();if(n!==void 0){var s=n(t);if(cu){ac(!0);try{n(t)}finally{ac(!1)}}}else s=t;return i.memoizedState=i.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},i.queue=e,e=e.dispatch=kQ.bind(null,tt,e),[i.memoizedState,e]},useRef:function(e){var t=Ss();return e={current:e},t.memoizedState=e},useState:function(e){e=M7(e);var t=e.queue,n=gO.bind(null,tt,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Q9,useDeferredValue:function(e,t){var n=Ss();return J9(n,e,t)},useTransition:function(){var e=M7(!1);return e=cO.bind(null,tt,e.queue,!0,!1),Ss().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=tt,s=Ss();if(kt){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=t(),Qt===null)throw Error(ne(349));Ut&60||VN(i,t,n)}s.memoizedState=n;var r={value:n,getSnapshot:t};return s.queue=r,Vx(GN.bind(null,i,r,e),[e]),i.flags|=2048,Lh(9,$N.bind(null,i,r,n,t),{destroy:void 0},null),n},useId:function(){var e=Ss(),t=Qt.identifierPrefix;if(kt){var n=ja,i=Xa;n=(i&~(1<<32-ir(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=Rb++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=IQ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return Ss().memoizedState=MQ.bind(null,tt)}};Bu.useMemoCache=K9;Bu.useHostTransitionStatus=e_;Bu.useFormState=qN;Bu.useActionState=qN;Bu.useOptimistic=function(e){var t=Ss();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=t_.bind(null,tt,!0,n),n.dispatch=t,[e,t]};var od={readContext:Ji,use:F5,useCallback:oO,useContext:Ji,useEffect:q9,useImperativeHandle:rO,useInsertionEffect:nO,useLayoutEffect:iO,useMemo:aO,useReducer:R2,useRef:tO,useState:function(){return R2(ll)},useDebugValue:Q9,useDeferredValue:function(e,t){var n=Zn();return lO(n,Vt.memoizedState,e,t)},useTransition:function(){var e=R2(ll)[0],t=Zn().memoizedState;return[typeof e=="boolean"?e:gp(e),t]},useSyncExternalStore:HN,useId:fO};od.useCacheRefresh=hO;od.useMemoCache=K9;od.useHostTransitionStatus=e_;od.useFormState=QN;od.useActionState=QN;od.useOptimistic=function(e,t){var n=Zn();return YN(n,Vt,e,t)};var zu={readContext:Ji,use:F5,useCallback:oO,useContext:Ji,useEffect:q9,useImperativeHandle:rO,useInsertionEffect:nO,useLayoutEffect:iO,useMemo:aO,useReducer:qE,useRef:tO,useState:function(){return qE(ll)},useDebugValue:Q9,useDeferredValue:function(e,t){var n=Zn();return Vt===null?J9(n,e,t):lO(n,Vt.memoizedState,e,t)},useTransition:function(){var e=qE(ll)[0],t=Zn().memoizedState;return[typeof e=="boolean"?e:gp(e),t]},useSyncExternalStore:HN,useId:fO};zu.useCacheRefresh=hO;zu.useMemoCache=K9;zu.useHostTransitionStatus=e_;zu.useFormState=eO;zu.useActionState=eO;zu.useOptimistic=function(e,t){var n=Zn();return Vt!==null?YN(n,Vt,e,t):(n.baseState=e,[e,n.queue.dispatch])};function QE(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:on({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var L7={isMounted:function(e){return(e=e._reactInternals)?Eg(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=sr(),s=Uc(i);s.payload=t,n!=null&&(s.callback=n),t=bc(e,s,i),t!==null&&(Us(t,e,i),bm(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=sr(),s=Uc(i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=bc(e,s,i),t!==null&&(Us(t,e,i),bm(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=sr(),i=Uc(n);i.tag=2,t!=null&&(i.callback=t),t=bc(e,i,n),t!==null&&(Us(t,e,n),bm(t,e,n))}};function $x(e,t,n,i,s,r,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,r,o):t.prototype&&t.prototype.isPureReactComponent?!i0(n,i)||!i0(s,r):!0}function Gx(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&L7.enqueueReplaceState(t,t.state,null)}function du(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=on({},n));for(var s in e)n[s]===void 0&&(n[s]=e[s])}return n}var Lb=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function UO(e){Lb(e)}function bO(e){console.error(e)}function yO(e){Lb(e)}function Db(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Xx(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function D7(e,t,n){return n=Uc(n),n.tag=3,n.payload={element:null},n.callback=function(){Db(e,t)},n}function EO(e){return e=Uc(e),e.tag=3,e}function vO(e,t,n,i){var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=i.value;e.payload=function(){return s(r)},e.callback=function(){Xx(t,n,i)}}var o=n.stateNode;o!==null&&typeof o.componentDidCatch=="function"&&(e.callback=function(){Xx(t,n,i),typeof s!="function"&&(Ec===null?Ec=new Set([this]):Ec.add(this));var a=i.stack;this.componentDidCatch(i.value,{componentStack:a!==null?a:""})})}function RQ(e,t,n,i,s){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&mp(t,n,s,!0),n=Br.current,n!==null){switch(n.tag){case 13:return Zo===null?K7():n.alternate===null&&xn===0&&(xn=3),n.flags&=-257,n.flags|=65536,n.lanes=s,i===x7?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),u8(e,i,s)),!1;case 22:return n.flags|=65536,i===x7?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),u8(e,i,s)),!1}throw Error(ne(435,n.tag))}return u8(e,i,s),K7(),!1}if(kt)return t=Br.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=s,i!==S7&&(e=Error(ne(422),{cause:i}),s0(_r(e,n)))):(i!==S7&&(t=Error(ne(423),{cause:i}),s0(_r(t,n))),e=e.current.alternate,e.flags|=65536,s&=-s,e.lanes|=s,i=_r(i,n),s=D7(e.stateNode,i,s),s8(e,s),xn!==4&&(xn=2)),!1;var r=Error(ne(520),{cause:i});if(r=_r(r,n),_m===null?_m=[r]:_m.push(r),xn!==4&&(xn=2),t===null)return!0;i=_r(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=s&-s,n.lanes|=e,e=D7(n.stateNode,i,e),s8(n,e),!1;case 1:if(t=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(Ec===null||!Ec.has(r))))return n.flags|=65536,s&=-s,n.lanes|=s,s=EO(s),vO(s,e,n,i),s8(n,s),!1}n=n.return}while(n!==null);return!1}var _O=Error(ne(461)),yi=!1;function Ai(e,t,n,i){t.child=e===null?NN(t,null,n,i):lu(t,e.child,n,i)}function jx(e,t,n,i,s){n=n.render;var r=t.ref;if("ref"in i){var o={};for(var a in i)a!=="ref"&&(o[a]=i[a])}else o=i;return uu(t),i=X9(e,t,n,o,r,s),a=j9(),e!==null&&!yi?(Y9(e,t,s),cl(e,t,s)):(kt&&a&&B9(t),t.flags|=1,Ai(e,t,i,s),t.child)}function Yx(e,t,n,i,s){if(e===null){var r=n.type;return typeof r=="function"&&!o_(r)&&r.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=r,wO(e,t,r,i,s)):(e=P2(n.type,null,i,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(r=e.child,!n_(e,s)){var o=r.memoizedProps;if(n=n.compare,n=n!==null?n:i0,n(o,i)&&e.ref===t.ref)return cl(e,t,s)}return t.flags|=1,e=yc(r,i),e.ref=t.ref,e.return=t,t.child=e}function wO(e,t,n,i,s){if(e!==null){var r=e.memoizedProps;if(i0(r,i)&&e.ref===t.ref)if(yi=!1,t.pendingProps=i=r,n_(e,s))e.flags&131072&&(yi=!0);else return t.lanes=e.lanes,cl(e,t,s)}return P7(e,t,n,i,s)}function TO(e,t,n){var i=t.pendingProps,s=i.children,r=(t.stateNode._pendingVisibility&2)!==0,o=e!==null?e.memoizedState:null;if(Um(e,t),i.mode==="hidden"||r){if(t.flags&128){if(i=o!==null?o.baseLanes|n:n,e!==null){for(s=t.child=e.child,r=0;s!==null;)r=r|s.lanes|s.childLanes,s=s.sibling;t.childLanes=r&~i}else t.childLanes=0,t.child=null;return Wx(e,t,i,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&k2(t,o!==null?o.cachePool:null),o!==null?Ox(t,o):C7(),ON(t);else return t.lanes=t.childLanes=536870912,Wx(e,t,o!==null?o.baseLanes|n:n,n)}else o!==null?(k2(t,o.cachePool),Ox(t,o),ec(),t.memoizedState=null):(e!==null&&k2(t,null),C7(),ec());return Ai(e,t,s,n),t.child}function Wx(e,t,n,i){var s=$9();return s=s===null?null:{parent:si._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},e!==null&&k2(t,null),C7(),ON(t),e!==null&&mp(e,t,i,!0),null}function Um(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=2097664);else{if(typeof n!="function"&&typeof n!="object")throw Error(ne(284));(e===null||e.ref!==n)&&(t.flags|=2097664)}}function P7(e,t,n,i,s){return uu(t),n=X9(e,t,n,i,void 0,s),i=j9(),e!==null&&!yi?(Y9(e,t,s),cl(e,t,s)):(kt&&i&&B9(t),t.flags|=1,Ai(e,t,n,s),t.child)}function Kx(e,t,n,i,s,r){return uu(t),t.updateQueue=null,n=zN(t,i,n,s),BN(e),i=j9(),e!==null&&!yi?(Y9(e,t,r),cl(e,t,r)):(kt&&i&&B9(t),t.flags|=1,Ai(e,t,n,r),t.child)}function Zx(e,t,n,i,s){if(uu(t),t.stateNode===null){var r=zf,o=n.contextType;typeof o=="object"&&o!==null&&(r=Ji(o)),r=new n(i,r),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=L7,t.stateNode=r,r._reactInternals=t,r=t.stateNode,r.props=i,r.state=t.memoizedState,r.refs={},i_(t),o=n.contextType,r.context=typeof o=="object"&&o!==null?Ji(o):zf,r.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o=="function"&&(QE(t,n,o,i),r.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(o=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),o!==r.state&&L7.enqueueReplaceState(r,r.state,null),Em(t,i,r,s),ym(),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){r=t.stateNode;var a=t.memoizedProps,l=du(n,a);r.props=l;var c=r.context,d=n.contextType;o=zf,typeof d=="object"&&d!==null&&(o=Ji(d));var u=n.getDerivedStateFromProps;d=typeof u=="function"||typeof r.getSnapshotBeforeUpdate=="function",a=t.pendingProps!==a,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a||c!==o)&&Gx(t,r,i,o),Yl=!1;var f=t.memoizedState;r.state=f,Em(t,i,r,s),ym(),c=t.memoizedState,a||f!==c||Yl?(typeof u=="function"&&(QE(t,n,u,i),c=t.memoizedState),(l=Yl||$x(t,n,l,i,f,c,o))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),r.props=i,r.state=c,r.context=o,i=l):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{r=t.stateNode,H7(e,t),o=t.memoizedProps,d=du(n,o),r.props=d,u=t.pendingProps,f=r.context,c=n.contextType,l=zf,typeof c=="object"&&c!==null&&(l=Ji(c)),a=n.getDerivedStateFromProps,(c=typeof a=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o!==u||f!==l)&&Gx(t,r,i,l),Yl=!1,f=t.memoizedState,r.state=f,Em(t,i,r,s),ym();var h=t.memoizedState;o!==u||f!==h||Yl||e!==null&&e.dependencies!==null&&Pb(e.dependencies)?(typeof a=="function"&&(QE(t,n,a,i),h=t.memoizedState),(d=Yl||$x(t,n,d,i,f,h,l)||e!==null&&e.dependencies!==null&&Pb(e.dependencies))?(c||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(i,h,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(i,h,l)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=h),r.props=i,r.state=h,r.context=l,i=d):(typeof r.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return r=i,Um(e,t),i=(t.flags&128)!==0,r||i?(r=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:r.render(),t.flags|=1,e!==null&&i?(t.child=lu(t,e.child,null,s),t.child=lu(t,null,n,s)):Ai(e,t,n,s),t.memoizedState=r.state,e=t.child):e=cl(e,t,s),e}function qx(e,t,n,i){return fp(),t.flags|=256,Ai(e,t,n,i),t.child}var JE={dehydrated:null,treeContext:null,retryLane:0};function e8(e){return{baseLanes:e,cachePool:FN()}}function t8(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=xr),e}function IO(e,t,n){var i=t.pendingProps,s=!1,r=(t.flags&128)!==0,o;if((o=r)||(o=e!==null&&e.memoizedState===null?!1:(ri.current&2)!==0),o&&(s=!0,t.flags&=-129),o=(t.flags&32)!==0,t.flags&=-33,e===null){if(kt){if(s?Jl(t):ec(),kt){var a=Li,l;if(l=a){e:{for(l=a,a=Bo;l.nodeType!==8;){if(!a){a=null;break e}if(l=lo(l.nextSibling),l===null){a=null;break e}}a=l}a!==null?(t.memoizedState={dehydrated:a,treeContext:Wd!==null?{id:Xa,overflow:ja}:null,retryLane:536870912},l=Sr(18,null,null,0),l.stateNode=a,l.return=t,t.child=l,fs=t,Li=null,l=!0):l=!1}l||au(t)}if(a=t.memoizedState,a!==null&&(a=a.dehydrated,a!==null))return a.data==="$!"?t.lanes=16:t.lanes=536870912,null;Ya(t)}return a=i.children,i=i.fallback,s?(ec(),s=t.mode,a=O7({mode:"hidden",children:a},s),i=Zd(i,s,n,null),a.return=t,i.return=t,a.sibling=i,t.child=a,s=t.child,s.memoizedState=e8(n),s.childLanes=t8(e,o,n),t.memoizedState=JE,i):(Jl(t),N7(t,a))}if(l=e.memoizedState,l!==null&&(a=l.dehydrated,a!==null)){if(r)t.flags&256?(Jl(t),t.flags&=-257,t=n8(e,t,n)):t.memoizedState!==null?(ec(),t.child=e.child,t.flags|=128,t=null):(ec(),s=i.fallback,a=t.mode,i=O7({mode:"visible",children:i.children},a),s=Zd(s,a,n,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,lu(t,e.child,null,n),i=t.child,i.memoizedState=e8(n),i.childLanes=t8(e,o,n),t.memoizedState=JE,t=s);else if(Jl(t),a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var c=o.dgst;o=c,i=Error(ne(419)),i.stack="",i.digest=o,s0({value:i,source:null,stack:null}),t=n8(e,t,n)}else if(yi||mp(e,t,n,!1),o=(n&e.childLanes)!==0,yi||o){if(o=Qt,o!==null){if(i=n&-n,i&42)i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(i=i&(o.suspendedLanes|n)?0:i,i!==0&&i!==l.retryLane)throw l.retryLane=i,Nc(e,i),Us(o,e,i),_O}a.data==="$?"||K7(),t=n8(e,t,n)}else a.data==="$?"?(t.flags|=128,t.child=e.child,t=YQ.bind(null,e),a._reactRetry=t,t=null):(e=l.treeContext,Li=lo(a.nextSibling),fs=t,kt=!0,no=null,Bo=!1,e!==null&&(yr[Er++]=Xa,yr[Er++]=ja,yr[Er++]=Wd,Xa=e.id,ja=e.overflow,Wd=t),t=N7(t,i.children),t.flags|=4096);return t}return s?(ec(),s=i.fallback,a=t.mode,l=e.child,c=l.sibling,i=yc(l,{mode:"hidden",children:i.children}),i.subtreeFlags=l.subtreeFlags&31457280,c!==null?s=yc(c,s):(s=Zd(s,a,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a===null?a=e8(n):(l=a.cachePool,l!==null?(c=si._currentValue,l=l.parent!==c?{parent:c,pool:c}:l):l=FN(),a={baseLanes:a.baseLanes|n,cachePool:l}),s.memoizedState=a,s.childLanes=t8(e,o,n),t.memoizedState=JE,i):(Jl(t),n=e.child,e=n.sibling,n=yc(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=n,t.memoizedState=null,n)}function N7(e,t){return t=O7({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function O7(e,t){return YO(e,t,0,null)}function n8(e,t,n){return lu(t,e.child,null,n),e=N7(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Qx(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),B7(e.return,t,n)}function i8(e,t,n,i,s){var r=e.memoizedState;r===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=s)}function SO(e,t,n){var i=t.pendingProps,s=i.revealOrder,r=i.tail;if(Ai(e,t,i.children,n),i=ri.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qx(e,n,t);else if(e.tag===19)Qx(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(hn(ri,i),s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Mb(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),i8(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Mb(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}i8(t,!0,n,null,r);break;case"together":i8(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function cl(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Bc|=t.lanes,!(n&t.childLanes))if(e!==null){if(mp(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,n=yc(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=yc(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function n_(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&Pb(e)))}function LQ(e,t,n){switch(t.tag){case 3:vb(t,t.stateNode.containerInfo),tc(t,si,e.memoizedState.cache),fp();break;case 27:case 5:U7(t);break;case 4:vb(t,t.stateNode.containerInfo);break;case 10:tc(t,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Jl(t),t.flags|=128,null):n&t.child.childLanes?IO(e,t,n):(Jl(t),e=cl(e,t,n),e!==null?e.sibling:null);Jl(t);break;case 19:var s=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(mp(e,t,n,!1),i=(n&t.childLanes)!==0),s){if(i)return SO(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),hn(ri,ri.current),i)break;return null;case 22:case 23:return t.lanes=0,TO(e,t,n);case 24:tc(t,si,e.memoizedState.cache)}return cl(e,t,n)}function xO(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)yi=!0;else{if(!n_(e,n)&&!(t.flags&128))return yi=!1,LQ(e,t,n);yi=!!(e.flags&131072)}else yi=!1,kt&&t.flags&1048576&&RN(t,Cb,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,s=i._init;if(i=s(i._payload),t.type=i,typeof i=="function")o_(i)?(e=du(i,e),t.tag=1,t=Zx(null,t,i,e,n)):(t.tag=0,t=P7(null,t,i,e,n));else{if(i!=null){if(s=i.$$typeof,s===x9){t.tag=11,t=jx(null,t,i,e,n);break e}else if(s===C9){t.tag=14,t=Yx(null,t,i,e,n);break e}}throw t=m7(i)||i,Error(ne(306,t,""))}}return t;case 0:return P7(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,s=du(i,t.pendingProps),Zx(e,t,i,s,n);case 3:e:{if(vb(t,t.stateNode.containerInfo),e===null)throw Error(ne(387));var r=t.pendingProps;s=t.memoizedState,i=s.element,H7(e,t),Em(t,r,null,n);var o=t.memoizedState;if(r=o.cache,tc(t,si,r),r!==s.cache&&z7(t,[si],n,!0),ym(),r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=qx(e,t,r,n);break e}else if(r!==i){i=_r(Error(ne(424)),t),s0(i),t=qx(e,t,r,n);break e}else for(Li=lo(t.stateNode.containerInfo.firstChild),fs=t,kt=!0,no=null,Bo=!0,n=NN(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fp(),r===i){t=cl(e,t,n);break e}Ai(e,t,r,n)}t=t.child}return t;case 26:return Um(e,t),e===null?(n=pC(t.type,null,t.pendingProps,null))?t.memoizedState=n:kt||(n=t.type,e=t.pendingProps,i=Vb(pc.current).createElement(n),i[Qi]=t,i[Ds]=e,Di(i,n,e),Ui(i),t.stateNode=i):t.memoizedState=pC(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return U7(t),e===null&&kt&&(i=t.stateNode=uF(t.type,t.pendingProps,pc.current),fs=t,Bo=!0,Li=lo(i.firstChild)),i=t.pendingProps.children,e!==null||kt?Ai(e,t,i,n):t.child=lu(t,null,i,n),Um(e,t),t.child;case 5:return e===null&&kt&&((s=i=Li)&&(i=cJ(i,t.type,t.pendingProps,Bo),i!==null?(t.stateNode=i,fs=t,Li=lo(i.firstChild),Bo=!1,s=!0):s=!1),s||au(t)),U7(t),s=t.type,r=t.pendingProps,o=e!==null?e.memoizedProps:null,i=r.children,e4(s,r)?i=null:o!==null&&e4(s,o)&&(t.flags|=32),t.memoizedState!==null&&(s=X9(e,t,SQ,null,null,n),d0._currentValue=s),Um(e,t),Ai(e,t,i,n),t.child;case 6:return e===null&&kt&&((e=n=Li)&&(n=dJ(n,t.pendingProps,Bo),n!==null?(t.stateNode=n,fs=t,Li=null,e=!0):e=!1),e||au(t)),null;case 13:return IO(e,t,n);case 4:return vb(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=lu(t,null,i,n):Ai(e,t,i,n),t.child;case 11:return jx(e,t,t.type,t.pendingProps,n);case 7:return Ai(e,t,t.pendingProps,n),t.child;case 8:return Ai(e,t,t.pendingProps.children,n),t.child;case 12:return Ai(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,tc(t,t.type,i.value),Ai(e,t,i.children,n),t.child;case 9:return s=t.type._context,i=t.pendingProps.children,uu(t),s=Ji(s),i=i(s),t.flags|=1,Ai(e,t,i,n),t.child;case 14:return Yx(e,t,t.type,t.pendingProps,n);case 15:return wO(e,t,t.type,t.pendingProps,n);case 19:return SO(e,t,n);case 22:return TO(e,t,n);case 24:return uu(t),i=Ji(si),e===null?(s=$9(),s===null&&(s=Qt,r=V9(),s.pooledCache=r,r.refCount++,r!==null&&(s.pooledCacheLanes|=n),s=r),t.memoizedState={parent:i,cache:s},i_(t),tc(t,si,s)):(e.lanes&n&&(H7(e,t),Em(t,null,null,n),ym()),s=e.memoizedState,r=t.memoizedState,s.parent!==i?(s={parent:i,cache:i},t.memoizedState=s,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=s),tc(t,si,i)):(i=r.cache,tc(t,si,i),i!==s.cache&&z7(t,[si],n,!0))),Ai(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(ne(156,t.tag))}var F7=ha(null),Hu=null,Wa=null;function tc(e,t,n){hn(F7,t._currentValue),t._currentValue=n}function qa(e){e._currentValue=F7.current,_i(F7)}function B7(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function z7(e,t,n,i){var s=e.child;for(s!==null&&(s.return=e);s!==null;){var r=s.dependencies;if(r!==null){var o=s.child;r=r.firstContext;e:for(;r!==null;){var a=r;r=s;for(var l=0;l<t.length;l++)if(a.context===t[l]){r.lanes|=n,a=r.alternate,a!==null&&(a.lanes|=n),B7(r.return,n,e),i||(o=null);break e}r=a.next}}else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,r=o.alternate,r!==null&&(r.lanes|=n),B7(o,n,e),o=null}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}}function mp(e,t,n,i){e=null;for(var s=t,r=!1;s!==null;){if(!r){if(s.flags&524288)r=!0;else if(s.flags&262144)break}if(s.tag===10){var o=s.alternate;if(o===null)throw Error(ne(387));if(o=o.memoizedProps,o!==null){var a=s.type;lr(s.pendingProps.value,o.value)||(e!==null?e.push(a):e=[a])}}else if(s===Eb.current){if(o=s.alternate,o===null)throw Error(ne(387));o.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(e!==null?e.push(d0):e=[d0])}s=s.return}e!==null&&z7(t,e,n,i),t.flags|=262144}function Pb(e){for(e=e.firstContext;e!==null;){if(!lr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function uu(e){Hu=e,Wa=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ji(e){return CO(Hu,e)}function AU(e,t){return Hu===null&&uu(e),CO(e,t)}function CO(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Wa===null){if(e===null)throw Error(ne(308));Wa=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Wa=Wa.next=t;return n}var Yl=!1;function i_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function H7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Uc(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function bc(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,yn&2){var s=i.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),i.pending=t,t=Sb(e),kN(e,null,n),t}return N5(e,i,t,n),Sb(e)}function bm(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194176)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,sN(e,n)}}function s8(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var s=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?s=r=o:r=r.next=o,n=n.next}while(n!==null);r===null?s=r=t:r=r.next=t}else s=r=t;n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var V7=!1;function ym(){if(V7){var e=ah;if(e!==null)throw e}}function Em(e,t,n,i){V7=!1;var s=e.updateQueue;Yl=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?r=c:o.next=c,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(r!==null){var u=s.baseState;o=0,d=c=l=null,a=r;do{var f=a.lane&-536870913,h=f!==a.lane;if(h?(Ut&f)===f:(i&f)===f){f!==0&&f===Rh&&(V7=!0),d!==null&&(d=d.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,p=a;f=t;var U=n;switch(p.tag){case 1:if(m=p.payload,typeof m=="function"){u=m.call(U,u,f);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(U,u,f):m,f==null)break e;u=on({},u,f);break e;case 2:Yl=!0}}f=a.callback,f!==null&&(e.flags|=64,h&&(e.flags|=8192),h=s.callbacks,h===null?s.callbacks=[f]:h.push(f))}else h={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=h,l=u):d=d.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);d===null&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,r===null&&(s.shared.lanes=0),Bc|=o,e.lanes=o,e.memoizedState=u}}function AO(e,t){if(typeof e!="function")throw Error(ne(191,e));e.call(t)}function MO(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)AO(n[e],t)}function pp(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var s=i.next;n=s;do{if((n.tag&e)===e){i=void 0;var r=n.create,o=n.inst;i=r(),o.destroy=i}n=n.next}while(n!==s)}}catch(a){Xt(t,t.return,a)}}function Fc(e,t,n){try{var i=t.updateQueue,s=i!==null?i.lastEffect:null;if(s!==null){var r=s.next;i=r;do{if((i.tag&e)===e){var o=i.inst,a=o.destroy;if(a!==void 0){o.destroy=void 0,s=t;var l=n;try{a()}catch(c){Xt(s,l,c)}}}i=i.next}while(i!==r)}}catch(c){Xt(t,t.return,c)}}function kO(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{MO(t,n)}catch(i){Xt(e,e.return,i)}}}function RO(e,t,n){n.props=du(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){Xt(e,t,i)}}function Od(e,t){try{var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 26:case 27:case 5:var s=i;break;default:s=i}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){Xt(e,t,r)}}function Ks(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(s){Xt(e,t,s)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(s){Xt(e,t,s)}else n.current=null}function LO(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(s){Xt(e,e.return,s)}}function Jx(e,t,n){try{var i=e.stateNode;sJ(i,e.type,n,t),i[Ds]=t}catch(s){Xt(e,e.return,s)}}function DO(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function r8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||DO(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $7(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=$5));else if(i!==4&&i!==27&&(e=e.child,e!==null))for($7(e,t,n),e=e.sibling;e!==null;)$7(e,t,n),e=e.sibling}function Nb(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&i!==27&&(e=e.child,e!==null))for(Nb(e,t,n),e=e.sibling;e!==null;)Nb(e,t,n),e=e.sibling}var Na=!1,In=!1,o8=!1,eC=typeof WeakSet=="function"?WeakSet:Set,pi=null,tC=!1;function DQ(e,t){if(e=e.containerInfo,Q7=jb,e=TN(e),N9(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,u=e,f=null;t:for(;;){for(var h;u!==n||s!==0&&u.nodeType!==3||(a=o+s),u!==r||i!==0&&u.nodeType!==3||(l=o+i),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===e)break t;if(f===n&&++c===s&&(a=o),f===r&&++d===i&&(l=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(J7={focusedElem:e,selectionRange:n},jb=!1,pi=t;pi!==null;)if(t=pi,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pi=e;else for(;pi!==null;){switch(t=pi,r=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&r!==null){e=void 0,n=t,s=r.memoizedProps,r=r.memoizedState,i=n.stateNode;try{var m=du(n.type,s,n.elementType===n.type);e=i.getSnapshotBeforeUpdate(m,r),i.__reactInternalSnapshotBeforeUpdate=e}catch(p){Xt(n,n.return,p)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)t4(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":t4(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(ne(163))}if(e=t.sibling,e!==null){e.return=t.return,pi=e;break}pi=t.return}return m=tC,tC=!1,m}function PO(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:wa(e,n),i&4&&pp(5,n);break;case 1:if(wa(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(a){Xt(n,n.return,a)}else{var s=du(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Xt(n,n.return,a)}}i&64&&kO(n),i&512&&Od(n,n.return);break;case 3:if(wa(e,n),i&64&&(i=n.updateQueue,i!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{MO(i,e)}catch(a){Xt(n,n.return,a)}}break;case 26:wa(e,n),i&512&&Od(n,n.return);break;case 27:case 5:wa(e,n),t===null&&i&4&&LO(n),i&512&&Od(n,n.return);break;case 12:wa(e,n);break;case 13:wa(e,n),i&4&&FO(e,n);break;case 22:if(s=n.memoizedState!==null||Na,!s){t=t!==null&&t.memoizedState!==null||In;var r=Na,o=In;Na=s,(In=t)&&!o?Hl(e,n,(n.subtreeFlags&8772)!==0):wa(e,n),Na=r,In=o}i&512&&(n.memoizedProps.mode==="manual"?Od(n,n.return):Ks(n,n.return));break;default:wa(e,n)}}function NO(e){var t=e.alternate;t!==null&&(e.alternate=null,NO(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&M9(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Gn=null,$s=!1;function _a(e,t,n){for(n=n.child;n!==null;)OO(e,t,n),n=n.sibling}function OO(e,t,n){if(nr&&typeof nr.onCommitFiberUnmount=="function")try{nr.onCommitFiberUnmount(lp,n)}catch{}switch(n.tag){case 26:In||Ks(n,t),_a(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:In||Ks(n,t);var i=Gn,s=$s;for(Gn=n.stateNode,_a(e,t,n),n=n.stateNode,t=n.attributes;t.length;)n.removeAttributeNode(t[0]);M9(n),Gn=i,$s=s;break;case 5:In||Ks(n,t);case 6:s=Gn;var r=$s;if(Gn=null,_a(e,t,n),Gn=s,$s=r,Gn!==null)if($s)try{e=Gn,i=n.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)}catch(o){Xt(n,t,o)}else try{Gn.removeChild(n.stateNode)}catch(o){Xt(n,t,o)}break;case 18:Gn!==null&&($s?(t=Gn,n=n.stateNode,t.nodeType===8?b8(t.parentNode,n):t.nodeType===1&&b8(t,n),h0(t)):b8(Gn,n.stateNode));break;case 4:i=Gn,s=$s,Gn=n.stateNode.containerInfo,$s=!0,_a(e,t,n),Gn=i,$s=s;break;case 0:case 11:case 14:case 15:In||Fc(2,n,t),In||Fc(4,n,t),_a(e,t,n);break;case 1:In||(Ks(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&RO(n,t,i)),_a(e,t,n);break;case 21:_a(e,t,n);break;case 22:In||Ks(n,t),In=(i=In)||n.memoizedState!==null,_a(e,t,n),In=i;break;default:_a(e,t,n)}}function FO(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{h0(e)}catch(n){Xt(t,t.return,n)}}function PQ(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new eC),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new eC),t;default:throw Error(ne(435,e.tag))}}function a8(e,t){var n=PQ(e);t.forEach(function(i){var s=WQ.bind(null,e,i);n.has(i)||(n.add(i),i.then(s,s))})}function ur(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i],r=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 27:case 5:Gn=a.stateNode,$s=!1;break e;case 3:Gn=a.stateNode.containerInfo,$s=!0;break e;case 4:Gn=a.stateNode.containerInfo,$s=!0;break e}a=a.return}if(Gn===null)throw Error(ne(160));OO(r,o,s),Gn=null,$s=!1,r=s.alternate,r!==null&&(r.return=null),s.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)BO(t,e),t=t.sibling}var Qr=null;function BO(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ur(t,e),fr(e),i&4&&(Fc(3,e,e.return),pp(3,e),Fc(5,e,e.return));break;case 1:ur(t,e),fr(e),i&512&&(In||n===null||Ks(n,n.return)),i&64&&Na&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var s=Qr;if(ur(t,e),fr(e),i&512&&(In||n===null||Ks(n,n.return)),i&4){var r=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,s=s.ownerDocument||s;t:switch(i){case"title":r=s.getElementsByTagName("title")[0],(!r||r[e0]||r[Qi]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=s.createElement(i),s.head.insertBefore(r,s.querySelector("head > title"))),Di(r,i,n),r[Qi]=e,Ui(r),i=r;break e;case"link":var o=bC("link","href",s).get(i+(n.href||""));if(o){for(var a=0;a<o.length;a++)if(r=o[a],r.getAttribute("href")===(n.href==null?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){o.splice(a,1);break t}}r=s.createElement(i),Di(r,i,n),s.head.appendChild(r);break;case"meta":if(o=bC("meta","content",s).get(i+(n.content||""))){for(a=0;a<o.length;a++)if(r=o[a],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){o.splice(a,1);break t}}r=s.createElement(i),Di(r,i,n),s.head.appendChild(r);break;default:throw Error(ne(468,i))}r[Qi]=e,Ui(r),i=r}e.stateNode=i}else yC(s,e.type,e.stateNode);else e.stateNode=UC(s,i,e.memoizedProps);else r!==i?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,i===null?yC(s,e.type,e.stateNode):UC(s,i,e.memoizedProps)):i===null&&e.stateNode!==null&&Jx(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(i&4&&e.alternate===null){s=e.stateNode,r=e.memoizedProps;try{for(var l=s.firstChild;l;){var c=l.nextSibling,d=l.nodeName;l[e0]||d==="HEAD"||d==="BODY"||d==="SCRIPT"||d==="STYLE"||d==="LINK"&&l.rel.toLowerCase()==="stylesheet"||s.removeChild(l),l=c}for(var u=e.type,f=s.attributes;f.length;)s.removeAttributeNode(f[0]);Di(s,u,r),s[Qi]=e,s[Ds]=r}catch(m){Xt(e,e.return,m)}}case 5:if(ur(t,e),fr(e),i&512&&(In||n===null||Ks(n,n.return)),e.flags&32){s=e.stateNode;try{Mh(s,"")}catch(m){Xt(e,e.return,m)}}i&4&&e.stateNode!=null&&(s=e.memoizedProps,Jx(e,s,n!==null?n.memoizedProps:s)),i&1024&&(o8=!0);break;case 6:if(ur(t,e),fr(e),i&4){if(e.stateNode===null)throw Error(ne(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){Xt(e,e.return,m)}}break;case 3:if(O2=null,s=Qr,Qr=$b(t.containerInfo),ur(t,e),Qr=s,fr(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{h0(t.containerInfo)}catch(m){Xt(e,e.return,m)}o8&&(o8=!1,zO(e));break;case 4:i=Qr,Qr=$b(e.stateNode.containerInfo),ur(t,e),fr(e),Qr=i;break;case 12:ur(t,e),fr(e);break;case 13:ur(t,e),fr(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(c_=Ko()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,a8(e,i)));break;case 22:if(i&512&&(In||n===null||Ks(n,n.return)),l=e.memoizedState!==null,c=n!==null&&n.memoizedState!==null,d=Na,u=In,Na=d||l,In=u||c,ur(t,e),In=u,Na=d,fr(e),t=e.stateNode,t._current=e,t._visibility&=-3,t._visibility|=t._pendingVisibility&2,i&8192&&(t._visibility=l?t._visibility&-2:t._visibility|1,l&&(t=Na||In,n===null||c||t||Ef(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))e:for(n=null,t=e;;){if(t.tag===5||t.tag===26||t.tag===27){if(n===null){c=n=t;try{if(s=c.stateNode,l)r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none";else{o=c.stateNode,a=c.memoizedProps.style;var h=a!=null&&a.hasOwnProperty("display")?a.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(m){Xt(c,c.return,m)}}}else if(t.tag===6){if(n===null){c=t;try{c.stateNode.nodeValue=l?"":c.memoizedProps}catch(m){Xt(c,c.return,m)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,a8(e,n))));break;case 19:ur(t,e),fr(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,a8(e,i)));break;case 21:break;default:ur(t,e),fr(e)}}function fr(e){var t=e.flags;if(t&2){try{if(e.tag!==27){e:{for(var n=e.return;n!==null;){if(DO(n)){var i=n;break e}n=n.return}throw Error(ne(160))}switch(i.tag){case 27:var s=i.stateNode,r=r8(e);Nb(e,r,s);break;case 5:var o=i.stateNode;i.flags&32&&(Mh(o,""),i.flags&=-33);var a=r8(e);Nb(e,a,o);break;case 3:case 4:var l=i.stateNode.containerInfo,c=r8(e);$7(e,c,l);break;default:throw Error(ne(161))}}}catch(d){Xt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zO(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;zO(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function wa(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)PO(e,t.alternate,t),t=t.sibling}function Ef(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Fc(4,t,t.return),Ef(t);break;case 1:Ks(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&RO(t,t.return,n),Ef(t);break;case 26:case 27:case 5:Ks(t,t.return),Ef(t);break;case 22:Ks(t,t.return),t.memoizedState===null&&Ef(t);break;default:Ef(t)}e=e.sibling}}function Hl(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,s=e,r=t,o=r.flags;switch(r.tag){case 0:case 11:case 15:Hl(s,r,n),pp(4,r);break;case 1:if(Hl(s,r,n),i=r,s=i.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(c){Xt(i,i.return,c)}if(i=r,s=i.updateQueue,s!==null){var a=i.stateNode;try{var l=s.shared.hiddenCallbacks;if(l!==null)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)AO(l[s],a)}catch(c){Xt(i,i.return,c)}}n&&o&64&&kO(r),Od(r,r.return);break;case 26:case 27:case 5:Hl(s,r,n),n&&i===null&&o&4&&LO(r),Od(r,r.return);break;case 12:Hl(s,r,n);break;case 13:Hl(s,r,n),n&&o&4&&FO(s,r);break;case 22:r.memoizedState===null&&Hl(s,r,n),Od(r,r.return);break;default:Hl(s,r,n)}t=t.sibling}}function s_(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&hp(n))}function r_(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&hp(e))}function Ol(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)HO(e,t,n,i),t=t.sibling}function HO(e,t,n,i){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Ol(e,t,n,i),s&2048&&pp(9,t);break;case 3:Ol(e,t,n,i),s&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&hp(e)));break;case 12:if(s&2048){Ol(e,t,n,i),e=t.stateNode;try{var r=t.memoizedProps,o=r.id,a=r.onPostCommit;typeof a=="function"&&a(o,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Xt(t,t.return,l)}}else Ol(e,t,n,i);break;case 23:break;case 22:r=t.stateNode,t.memoizedState!==null?r._visibility&4?Ol(e,t,n,i):vm(e,t):r._visibility&4?Ol(e,t,n,i):(r._visibility|=4,vf(e,t,n,i,(t.subtreeFlags&10256)!==0)),s&2048&&s_(t.alternate,t);break;case 24:Ol(e,t,n,i),s&2048&&r_(t.alternate,t);break;default:Ol(e,t,n,i)}}function vf(e,t,n,i,s){for(s=s&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var r=e,o=t,a=n,l=i,c=o.flags;switch(o.tag){case 0:case 11:case 15:vf(r,o,a,l,s),pp(8,o);break;case 23:break;case 22:var d=o.stateNode;o.memoizedState!==null?d._visibility&4?vf(r,o,a,l,s):vm(r,o):(d._visibility|=4,vf(r,o,a,l,s)),s&&c&2048&&s_(o.alternate,o);break;case 24:vf(r,o,a,l,s),s&&c&2048&&r_(o.alternate,o);break;default:vf(r,o,a,l,s)}t=t.sibling}}function vm(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,s=i.flags;switch(i.tag){case 22:vm(n,i),s&2048&&s_(i.alternate,i);break;case 24:vm(n,i),s&2048&&r_(i.alternate,i);break;default:vm(n,i)}t=t.sibling}}var V1=8192;function af(e){if(e.subtreeFlags&V1)for(e=e.child;e!==null;)VO(e),e=e.sibling}function VO(e){switch(e.tag){case 26:af(e),e.flags&V1&&e.memoizedState!==null&&wJ(Qr,e.memoizedState,e.memoizedProps);break;case 5:af(e);break;case 3:case 4:var t=Qr;Qr=$b(e.stateNode.containerInfo),af(e),Qr=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=V1,V1=16777216,af(e),V1=t):af(e));break;default:af(e)}}function $O(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function u1(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];pi=i,XO(i,e)}$O(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)GO(e),e=e.sibling}function GO(e){switch(e.tag){case 0:case 11:case 15:u1(e),e.flags&2048&&Fc(9,e,e.return);break;case 3:u1(e);break;case 12:u1(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&4&&(e.return===null||e.return.tag!==13)?(t._visibility&=-5,D2(e)):u1(e);break;default:u1(e)}}function D2(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];pi=i,XO(i,e)}$O(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Fc(8,t,t.return),D2(t);break;case 22:n=t.stateNode,n._visibility&4&&(n._visibility&=-5,D2(t));break;default:D2(t)}e=e.sibling}}function XO(e,t){for(;pi!==null;){var n=pi;switch(n.tag){case 0:case 11:case 15:Fc(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:hp(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,pi=i;else e:for(n=e;pi!==null;){i=pi;var s=i.sibling,r=i.return;if(NO(i),i===n){pi=null;break e}if(s!==null){s.return=r,pi=s;break e}pi=r}}}function NQ(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(e,t,n,i){return new NQ(e,t,n,i)}function o_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yc(e,t){var n=e.alternate;return n===null?(n=Sr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&31457280,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function jO(e,t){e.flags&=31457282;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function P2(e,t,n,i,s,r){var o=0;if(i=e,typeof e=="function")o_(e)&&(o=1);else if(typeof e=="string")o=vJ(e,n,Wo.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Lf:return Zd(n.children,s,r,t);case YP:o=8,s|=24;break;case f7:return e=Sr(12,n,t,s|2),e.elementType=f7,e.lanes=r,e;case h7:return e=Sr(13,n,t,s),e.elementType=h7,e.lanes=r,e;case g7:return e=Sr(19,n,t,s),e.elementType=g7,e.lanes=r,e;case KP:return YO(n,s,r,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case aq:case Ga:o=10;break e;case WP:o=9;break e;case x9:o=11;break e;case C9:o=14;break e;case jl:o=16,i=null;break e}o=29,n=Error(ne(130,e===null?"null":typeof e,"")),i=null}return t=Sr(o,n,t,s),t.elementType=e,t.type=i,t.lanes=r,t}function Zd(e,t,n,i){return e=Sr(7,e,i,t),e.lanes=n,e}function YO(e,t,n,i){e=Sr(22,e,i,t),e.elementType=KP,e.lanes=n;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var r=s._current;if(r===null)throw Error(ne(456));if(!(s._pendingVisibility&2)){var o=Nc(r,2);o!==null&&(s._pendingVisibility|=2,Us(o,r,2))}},attach:function(){var r=s._current;if(r===null)throw Error(ne(456));if(s._pendingVisibility&2){var o=Nc(r,2);o!==null&&(s._pendingVisibility&=-3,Us(o,r,2))}}};return e.stateNode=s,e}function l8(e,t,n){return e=Sr(6,e,null,t),e.lanes=n,e}function c8(e,t,n){return t=Sr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ta(e){e.flags|=4}function nC(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!gF(t)){if(t=Br.current,t!==null&&((Ut&4194176)===Ut?Zo!==null:(Ut&62914560)!==Ut&&!(Ut&536870912)||t!==Zo))throw gm=x7,LN;e.flags|=8192}}function MU(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?nN():536870912,e.lanes|=t,Dh|=t)}function f1(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function pn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags&31457280,i|=s.flags&31457280,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function OQ(e,t,n){var i=t.pendingProps;switch(z9(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(t),null;case 1:return pn(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),qa(si),Ch(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(c1(t)?Ta(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,no!==null&&(W7(no),no=null))),pn(t),null;case 26:return n=t.memoizedState,e===null?(Ta(t),n!==null?(pn(t),nC(t,n)):(pn(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Ta(t),pn(t),nC(t,n)):(pn(t),t.flags&=-16777217):(e.memoizedProps!==i&&Ta(t),pn(t),t.flags&=-16777217),null;case 27:_b(t),n=pc.current;var s=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Ta(t);else{if(!i){if(t.stateNode===null)throw Error(ne(166));return pn(t),null}e=Wo.current,c1(t)?Rx(t):(e=uF(s,i,n),t.stateNode=e,Ta(t))}return pn(t),null;case 5:if(_b(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Ta(t);else{if(!i){if(t.stateNode===null)throw Error(ne(166));return pn(t),null}if(e=Wo.current,c1(t))Rx(t);else{switch(s=Vb(pc.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof i.is=="string"?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e=typeof i.is=="string"?s.createElement(n,{is:i.is}):s.createElement(n)}}e[Qi]=t,e[Ds]=i;e:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=e;e:switch(Di(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ta(t)}}return pn(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Ta(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(ne(166));if(e=pc.current,c1(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,s=fs,s!==null)switch(s.tag){case 27:case 5:i=s.memoizedProps}e[Qi]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||lF(e.nodeValue,n)),e||au(t)}else e=Vb(e).createTextNode(i),e[Qi]=t,t.stateNode=e}return pn(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(s=c1(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(ne(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[Qi]=t}else fp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;pn(t),s=!1}else no!==null&&(W7(no),no=null),s=!0;if(!s)return t.flags&256?(Ya(t),t):(Ya(t),null)}if(Ya(t),t.flags&128)return t.lanes=n,t;if(n=i!==null,e=e!==null&&e.memoizedState!==null,n){i=t.child,s=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(s=i.alternate.memoizedState.cachePool.pool);var r=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==s&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),MU(t,t.updateQueue),pn(t),null;case 4:return Ch(),e===null&&f_(t.stateNode.containerInfo),pn(t),null;case 10:return qa(t.type),pn(t),null;case 19:if(_i(ri),s=t.memoizedState,s===null)return pn(t),null;if(i=(t.flags&128)!==0,r=s.rendering,r===null)if(i)f1(s,!1);else{if(xn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(r=Mb(e),r!==null){for(t.flags|=128,f1(s,!1),e=r.updateQueue,t.updateQueue=e,MU(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)jO(n,e),n=n.sibling;return hn(ri,ri.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ko()>Ob&&(t.flags|=128,i=!0,f1(s,!1),t.lanes=4194304)}else{if(!i)if(e=Mb(r),e!==null){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,MU(t,e),f1(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!kt)return pn(t),null}else 2*Ko()-s.renderingStartTime>Ob&&n!==536870912&&(t.flags|=128,i=!0,f1(s,!1),t.lanes=4194304);s.isBackwards?(r.sibling=t.child,t.child=r):(e=s.last,e!==null?e.sibling=r:t.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ko(),t.sibling=null,e=ri.current,hn(ri,i?e&1|2:e&1),t):(pn(t),null);case 22:case 23:return Ya(t),H9(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?n&536870912&&!(t.flags&128)&&(pn(t),t.subtreeFlags&6&&(t.flags|=8192)):pn(t),n=t.updateQueue,n!==null&&MU(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&_i(Kd),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),qa(si),pn(t),null;case 25:return null}throw Error(ne(156,t.tag))}function FQ(e,t){switch(z9(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return qa(si),Ch(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return _b(t),null;case 13:if(Ya(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));fp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return _i(ri),null;case 4:return Ch(),null;case 10:return qa(t.type),null;case 22:case 23:return Ya(t),H9(),e!==null&&_i(Kd),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return qa(si),null;case 25:return null;default:return null}}function WO(e,t){switch(z9(t),t.tag){case 3:qa(si),Ch();break;case 26:case 27:case 5:_b(t);break;case 4:Ch();break;case 13:Ya(t);break;case 19:_i(ri);break;case 10:qa(t.type);break;case 22:case 23:Ya(t),H9(),e!==null&&_i(Kd);break;case 24:qa(si)}}var BQ={getCacheForType:function(e){var t=Ji(si),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},zQ=typeof WeakMap=="function"?WeakMap:Map,yn=0,Qt=null,st=null,Ut=0,Zt=0,Gs=null,Oa=!1,wg=!1,a_=!1,dl=0,xn=0,Bc=0,qd=0,l_=0,xr=0,Dh=0,_m=null,zo=null,G7=!1,c_=0,Ob=1/0,Fb=null,Ec=null,kU=!1,Md=null,wm=0,X7=0,j7=null,Tm=0,Y7=null;function sr(){if(yn&2&&Ut!==0)return Ut&-Ut;if(qe.T!==null){var e=Rh;return e!==0?e:u_()}return oN()}function KO(){xr===0&&(xr=!(Ut&536870912)||kt?tN():536870912);var e=Br.current;return e!==null&&(e.flags|=32),xr}function Us(e,t,n){(e===Qt&&Zt===2||e.cancelPendingCommit!==null)&&(Ph(e,0),Fa(e,Ut,xr,!1)),dp(e,n),(!(yn&2)||e!==Qt)&&(e===Qt&&(!(yn&2)&&(qd|=n),xn===4&&Fa(e,Ut,xr,!1)),ga(e))}function ZO(e,t,n){if(yn&6)throw Error(ne(327));var i=!n&&(t&60)===0&&(t&e.expiredLanes)===0||cp(e,t),s=i?$Q(e,t):d8(e,t,!0),r=i;do{if(s===0){wg&&!i&&Fa(e,t,0,!1);break}else if(s===6)Fa(e,t,0,!Oa);else{if(n=e.current.alternate,r&&!HQ(n)){s=d8(e,t,!1),r=!1;continue}if(s===2){if(r=t,e.errorRecoveryDisabledLanes&r)var o=0;else o=e.pendingLanes&-536870913,o=o!==0?o:o&536870912?536870912:0;if(o!==0){t=o;e:{var a=e;s=_m;var l=a.current.memoizedState.isDehydrated;if(l&&(Ph(a,o).flags|=256),o=d8(a,o,!1),o!==2){if(a_&&!l){a.errorRecoveryDisabledLanes|=r,qd|=r,s=4;break e}r=zo,zo=s,r!==null&&W7(r)}s=o}if(r=!1,s!==2)continue}}if(s===1){Ph(e,0),Fa(e,t,0,!0);break}e:{switch(i=e,s){case 0:case 1:throw Error(ne(345));case 4:if((t&4194176)===t){Fa(i,t,xr,!Oa);break e}break;case 2:zo=null;break;case 3:case 5:break;default:throw Error(ne(329))}if(i.finishedWork=n,i.finishedLanes=t,(t&62914560)===t&&(r=c_+300-Ko(),10<r)){if(Fa(i,t,xr,!Oa),k5(i,0)!==0)break e;i.timeoutHandle=dF(iC.bind(null,i,n,zo,Fb,G7,t,xr,qd,Dh,Oa,2,-0,0),r);break e}iC(i,n,zo,Fb,G7,t,xr,qd,Dh,Oa,0,-0,0)}}break}while(!0);ga(e)}function W7(e){zo===null?zo=e:zo.push.apply(zo,e)}function iC(e,t,n,i,s,r,o,a,l,c,d,u,f){var h=t.subtreeFlags;if((h&8192||(h&16785408)===16785408)&&(c0={stylesheets:null,count:0,unsuspend:_J},VO(t),t=TJ(),t!==null)){e.cancelPendingCommit=t(rC.bind(null,e,n,i,s,o,a,l,1,u,f)),Fa(e,r,o,!c);return}rC(e,n,i,s,o,a,l,d,u,f)}function HQ(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var s=n[i],r=s.getSnapshot;s=s.value;try{if(!lr(r(),s))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fa(e,t,n,i){t&=~l_,t&=~qd,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var s=t;0<s;){var r=31-ir(s),o=1<<r;i[r]=-1,s&=~o}n!==0&&iN(e,n,t)}function H5(){return yn&6?!0:(Up(0),!1)}function d_(){if(st!==null){if(Zt===0)var e=st.return;else e=st,Wa=Hu=null,W9(e),oh=null,r0=0,e=st;for(;e!==null;)WO(e.alternate,e),e=e.return;st=null}}function Ph(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,oJ(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),d_(),Qt=e,st=n=yc(e.current,null),Ut=t,Zt=0,Gs=null,Oa=!1,wg=cp(e,t),a_=!1,Dh=xr=l_=qd=Bc=xn=0,zo=_m=null,G7=!1,t&8&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var s=31-ir(i),r=1<<s;t|=e[s],i&=~r}return dl=t,P5(),n}function qO(e,t){tt=null,qe.H=ta,t===hm?(t=Px(),Zt=3):t===LN?(t=Px(),Zt=4):Zt=t===_O?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Gs=t,st===null&&(xn=1,Db(e,_r(t,e.current)))}function QO(){var e=qe.H;return qe.H=ta,e===null?ta:e}function JO(){var e=qe.A;return qe.A=BQ,e}function K7(){xn=4,Oa||(Ut&4194176)!==Ut&&Br.current!==null||(wg=!0),!(Bc&134217727)&&!(qd&134217727)||Qt===null||Fa(Qt,Ut,xr,!1)}function d8(e,t,n){var i=yn;yn|=2;var s=QO(),r=JO();(Qt!==e||Ut!==t)&&(Fb=null,Ph(e,t)),t=!1;var o=xn;e:do try{if(Zt!==0&&st!==null){var a=st,l=Gs;switch(Zt){case 8:d_(),o=6;break e;case 3:case 2:case 6:Br.current===null&&(t=!0);var c=Zt;if(Zt=0,Gs=null,$f(e,a,l,c),n&&wg){o=0;break e}break;default:c=Zt,Zt=0,Gs=null,$f(e,a,l,c)}}VQ(),o=xn;break}catch(d){qO(e,d)}while(!0);return t&&e.shellSuspendCounter++,Wa=Hu=null,yn=i,qe.H=s,qe.A=r,st===null&&(Qt=null,Ut=0,P5()),o}function VQ(){for(;st!==null;)eF(st)}function $Q(e,t){var n=yn;yn|=2;var i=QO(),s=JO();Qt!==e||Ut!==t?(Fb=null,Ob=Ko()+500,Ph(e,t)):wg=cp(e,t);e:do try{if(Zt!==0&&st!==null){t=st;var r=Gs;t:switch(Zt){case 1:Zt=0,Gs=null,$f(e,t,r,1);break;case 2:if(Dx(r)){Zt=0,Gs=null,sC(t);break}t=function(){Zt===2&&Qt===e&&(Zt=7),ga(e)},r.then(t,t);break e;case 3:Zt=7;break e;case 4:Zt=5;break e;case 7:Dx(r)?(Zt=0,Gs=null,sC(t)):(Zt=0,Gs=null,$f(e,t,r,7));break;case 5:var o=null;switch(st.tag){case 26:o=st.memoizedState;case 5:case 27:var a=st;if(!o||gF(o)){Zt=0,Gs=null;var l=a.sibling;if(l!==null)st=l;else{var c=a.return;c!==null?(st=c,V5(c)):st=null}break t}}Zt=0,Gs=null,$f(e,t,r,5);break;case 6:Zt=0,Gs=null,$f(e,t,r,6);break;case 8:d_(),xn=6;break e;default:throw Error(ne(462))}}GQ();break}catch(d){qO(e,d)}while(!0);return Wa=Hu=null,qe.H=i,qe.A=s,yn=n,st!==null?0:(Qt=null,Ut=0,P5(),xn)}function GQ(){for(;st!==null&&!fq();)eF(st)}function eF(e){var t=xO(e.alternate,e,dl);e.memoizedProps=e.pendingProps,t===null?V5(e):st=t}function sC(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Kx(n,t,t.pendingProps,t.type,void 0,Ut);break;case 11:t=Kx(n,t,t.pendingProps,t.type.render,t.ref,Ut);break;case 5:W9(t);default:WO(n,t),t=st=jO(t,dl),t=xO(n,t,dl)}e.memoizedProps=e.pendingProps,t===null?V5(e):st=t}function $f(e,t,n,i){Wa=Hu=null,W9(t),oh=null,r0=0;var s=t.return;try{if(RQ(e,s,t,n,Ut)){xn=1,Db(e,_r(n,e.current)),st=null;return}}catch(r){if(s!==null)throw st=s,r;xn=1,Db(e,_r(n,e.current)),st=null;return}t.flags&32768?(kt||i===1?e=!0:wg||Ut&536870912?e=!1:(Oa=e=!0,(i===2||i===3||i===6)&&(i=Br.current,i!==null&&i.tag===13&&(i.flags|=16384))),tF(t,e)):V5(t)}function V5(e){var t=e;do{if(t.flags&32768){tF(t,Oa);return}e=t.return;var n=OQ(t.alternate,t,dl);if(n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);xn===0&&(xn=5)}function tF(e,t){do{var n=FQ(e.alternate,e);if(n!==null){n.flags&=32767,st=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){st=e;return}st=e=n}while(e!==null);xn=6,st=null}function rC(e,t,n,i,s,r,o,a,l,c){var d=qe.T,u=rn.p;try{rn.p=2,qe.T=null,XQ(e,t,n,i,u,s,r,o,a,l,c)}finally{qe.T=d,rn.p=u}}function XQ(e,t,n,i,s,r,o,a){do dh();while(Md!==null);if(yn&6)throw Error(ne(327));var l=e.finishedWork;if(i=e.finishedLanes,l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var c=l.lanes|l.childLanes;if(c|=O9,wq(e,i,c,r,o,a),e===Qt&&(st=Qt=null,Ut=0),!(l.subtreeFlags&10256)&&!(l.flags&10256)||kU||(kU=!0,X7=c,j7=n,KQ(wb,function(){return dh(),null})),n=(l.flags&15990)!==0,l.subtreeFlags&15990||n?(n=qe.T,qe.T=null,r=rn.p,rn.p=2,o=yn,yn|=4,DQ(e,l),BO(l,e),mQ(J7,e.containerInfo),jb=!!Q7,J7=Q7=null,e.current=l,PO(e,l.alternate,l),hq(),yn=o,rn.p=r,qe.T=n):e.current=l,kU?(kU=!1,Md=e,wm=i):nF(e,c),c=e.pendingLanes,c===0&&(Ec=null),bq(l.stateNode),ga(e),t!==null)for(s=e.onRecoverableError,l=0;l<t.length;l++)c=t[l],s(c.value,{componentStack:c.stack});return wm&3&&dh(),c=e.pendingLanes,i&4194218&&c&42?e===Y7?Tm++:(Tm=0,Y7=e):Tm=0,Up(0),null}function nF(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,hp(t)))}function dh(){if(Md!==null){var e=Md,t=X7;X7=0;var n=rN(wm),i=qe.T,s=rn.p;try{if(rn.p=32>n?32:n,qe.T=null,Md===null)var r=!1;else{n=j7,j7=null;var o=Md,a=wm;if(Md=null,wm=0,yn&6)throw Error(ne(331));var l=yn;if(yn|=4,GO(o.current),HO(o,o.current,a,n),yn=l,Up(0,!1),nr&&typeof nr.onPostCommitFiberRoot=="function")try{nr.onPostCommitFiberRoot(lp,o)}catch{}r=!0}return r}finally{rn.p=s,qe.T=i,nF(e,t)}}return!1}function oC(e,t,n){t=_r(n,t),t=D7(e.stateNode,t,2),e=bc(e,t,2),e!==null&&(dp(e,2),ga(e))}function Xt(e,t,n){if(e.tag===3)oC(e,e,n);else for(;t!==null;){if(t.tag===3){oC(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ec===null||!Ec.has(i))){e=_r(n,e),n=EO(2),i=bc(t,n,2),i!==null&&(vO(n,i,t,e),dp(i,2),ga(i));break}}t=t.return}}function u8(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new zQ;var s=new Set;i.set(t,s)}else s=i.get(t),s===void 0&&(s=new Set,i.set(t,s));s.has(n)||(a_=!0,s.add(n),e=jQ.bind(null,e,t,n),t.then(e,e))}function jQ(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Qt===e&&(Ut&n)===n&&(xn===4||xn===3&&(Ut&62914560)===Ut&&300>Ko()-c_?!(yn&2)&&Ph(e,0):l_|=n,Dh===Ut&&(Dh=0)),ga(e)}function iF(e,t){t===0&&(t=nN()),e=Nc(e,t),e!==null&&(dp(e,t),ga(e))}function YQ(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),iF(e,n)}function WQ(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(ne(314))}i!==null&&i.delete(t),iF(e,n)}function KQ(e,t){return A9(e,t)}var Bb=null,_f=null,Z7=!1,zb=!1,f8=!1,Qd=0;function ga(e){e!==_f&&e.next===null&&(_f===null?Bb=_f=e:_f=_f.next=e),zb=!0,Z7||(Z7=!0,qQ(ZQ))}function Up(e,t){if(!f8&&zb){f8=!0;do for(var n=!1,i=Bb;i!==null;){if(e!==0){var s=i.pendingLanes;if(s===0)var r=0;else{var o=i.suspendedLanes,a=i.pingedLanes;r=(1<<31-ir(42|e)+1)-1,r&=s&~(o&~a),r=r&201326677?r&201326677|1:r?r|2:0}r!==0&&(n=!0,aC(i,r))}else r=Ut,r=k5(i,i===Qt?r:0),!(r&3)||cp(i,r)||(n=!0,aC(i,r));i=i.next}while(n);f8=!1}}function ZQ(){zb=Z7=!1;var e=0;Qd!==0&&(rJ()&&(e=Qd),Qd=0);for(var t=Ko(),n=null,i=Bb;i!==null;){var s=i.next,r=sF(i,t);r===0?(i.next=null,n===null?Bb=s:n.next=s,s===null&&(_f=n)):(n=i,(e!==0||r&3)&&(zb=!0)),i=s}Up(e)}function sF(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes&-62914561;0<r;){var o=31-ir(r),a=1<<o,l=s[o];l===-1?(!(a&n)||a&i)&&(s[o]=_q(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}if(t=Qt,n=Ut,n=k5(e,e===t?n:0),i=e.callbackNode,n===0||e===t&&Zt===2||e.cancelPendingCommit!==null)return i!==null&&i!==null&&VE(i),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||cp(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&VE(i),rN(n)){case 2:case 8:n=JP;break;case 32:n=wb;break;case 268435456:n=eN;break;default:n=wb}return i=rF.bind(null,e),n=A9(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&VE(i),e.callbackPriority=2,e.callbackNode=null,2}function rF(e,t){var n=e.callbackNode;if(dh()&&e.callbackNode!==n)return null;var i=Ut;return i=k5(e,e===Qt?i:0),i===0?null:(ZO(e,i,t),sF(e,Ko()),e.callbackNode!=null&&e.callbackNode===n?rF.bind(null,e):null)}function aC(e,t){if(dh())return null;ZO(e,t,!0)}function qQ(e){aJ(function(){yn&6?A9(QP,e):e()})}function u_(){return Qd===0&&(Qd=tN()),Qd}function lC(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:C2(""+e)}function cC(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function QQ(e,t,n,i,s){if(t==="submit"&&n&&n.stateNode===s){var r=lC((s[Ds]||null).action),o=i.submitter;o&&(t=(t=o[Ds]||null)?lC(t.formAction):o.getAttribute("formAction"),t!==null&&(r=t,o=null));var a=new R5("action","action",null,i,s);e.push({event:a,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Qd!==0){var l=o?cC(s,o):new FormData(s);R7(n,{pending:!0,data:l,method:s.method,action:r},null,l)}}else typeof r=="function"&&(a.preventDefault(),l=o?cC(s,o):new FormData(s),R7(n,{pending:!0,data:l,method:s.method,action:r},r,l))},currentTarget:s}]})}}for(var h8=0;h8<Mx.length;h8++){var g8=Mx[h8],JQ=g8.toLowerCase(),eJ=g8[0].toUpperCase()+g8.slice(1);To(JQ,"on"+eJ)}To(SN,"onAnimationEnd");To(xN,"onAnimationIteration");To(CN,"onAnimationStart");To("dblclick","onDoubleClick");To("focusin","onFocus");To("focusout","onBlur");To(UQ,"onTransitionRun");To(bQ,"onTransitionStart");To(yQ,"onTransitionCancel");To(AN,"onTransitionEnd");Ah("onMouseEnter",["mouseout","mouseover"]);Ah("onMouseLeave",["mouseout","mouseover"]);Ah("onPointerEnter",["pointerout","pointerover"]);Ah("onPointerLeave",["pointerout","pointerover"]);Nu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var a0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tJ=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(a0));function oF(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;r=a,s.currentTarget=c;try{r(s)}catch(d){Lb(d)}s.currentTarget=null,r=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;r=a,s.currentTarget=c;try{r(s)}catch(d){Lb(d)}s.currentTarget=null,r=l}}}}function dt(e,t){var n=t[y7];n===void 0&&(n=t[y7]=new Set);var i=e+"__bubble";n.has(i)||(aF(t,e,2,!1),n.add(i))}function m8(e,t,n){var i=0;t&&(i|=4),aF(n,e,i,t)}var RU="_reactListening"+Math.random().toString(36).slice(2);function f_(e){if(!e[RU]){e[RU]=!0,aN.forEach(function(n){n!=="selectionchange"&&(tJ.has(n)||m8(n,!1,e),m8(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[RU]||(t[RU]=!0,m8("selectionchange",!1,t))}}function aF(e,t,n,i){switch(yF(t)){case 2:var s=xJ;break;case 8:s=CJ;break;default:s=p_}n=s.bind(null,t,n,e),s=void 0,!w7||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),i?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function p8(e,t,n,i,s){var r=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Nd(a),o===null)return;if(l=o.tag,l===5||l===6||l===26||l===27){i=r=o;continue e}a=a.parentNode}}i=i.return}mN(function(){var c=r,d=R9(n),u=[];e:{var f=MN.get(e);if(f!==void 0){var h=R5,m=e;switch(e){case"keypress":if(M2(n)===0)break e;case"keydown":case"keyup":h=Wq;break;case"focusin":m="focus",h=YE;break;case"focusout":m="blur",h=YE;break;case"beforeblur":case"afterblur":h=YE;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=bx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Nq;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=qq;break;case SN:case xN:case CN:h=Bq;break;case AN:h=Jq;break;case"scroll":case"scrollend":h=Dq;break;case"wheel":h=tQ;break;case"copy":case"cut":case"paste":h=Hq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Ex;break;case"toggle":case"beforetoggle":h=iQ}var p=(t&4)!==0,U=!p&&(e==="scroll"||e==="scrollend"),b=p?f!==null?f+"Capture":null:f;p=[];for(var y=c,v;y!==null;){var _=y;if(v=_.stateNode,_=_.tag,_!==5&&_!==26&&_!==27||v===null||b===null||(_=t0(y,b),_!=null&&p.push(l0(y,_,v))),U)break;y=y.return}0<p.length&&(f=new h(f,m,null,n,d),u.push({event:f,listeners:p}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==_7&&(m=n.relatedTarget||n.fromElement)&&(Nd(m)||m[vg]))break e;if((h||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Nd(m):null,m!==null&&(U=Eg(m),p=m.tag,m!==U||p!==5&&p!==27&&p!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=bx,_="onMouseLeave",b="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=Ex,_="onPointerLeave",b="onPointerEnter",y="pointer"),U=h==null?f:H1(h),v=m==null?f:H1(m),f=new p(_,y+"leave",h,n,d),f.target=U,f.relatedTarget=v,_=null,Nd(d)===c&&(p=new p(b,y+"enter",m,n,d),p.target=v,p.relatedTarget=U,_=p),U=_,h&&m)t:{for(p=h,b=m,y=0,v=p;v;v=lf(v))y++;for(v=0,_=b;_;_=lf(_))v++;for(;0<y-v;)p=lf(p),y--;for(;0<v-y;)b=lf(b),v--;for(;y--;){if(p===b||b!==null&&p===b.alternate)break t;p=lf(p),b=lf(b)}p=null}else p=null;h!==null&&dC(u,f,h,p,!1),m!==null&&U!==null&&dC(u,U,m,p,!0)}}e:{if(f=c?H1(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var I=Tx;else if(wx(f))if(vN)I=hQ;else{I=uQ;var R=dQ}else h=f.nodeName,!h||h.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?c&&k9(c.elementType)&&(I=Tx):I=fQ;if(I&&(I=I(e,c))){EN(u,I,n,d);break e}R&&R(e,f,c),e==="focusout"&&c&&f.type==="number"&&c.memoizedProps.value!=null&&v7(f,"number",f.value)}switch(R=c?H1(c):window,e){case"focusin":(wx(R)||R.contentEditable==="true")&&(Of=R,T7=c,fm=null);break;case"focusout":fm=T7=Of=null;break;case"mousedown":I7=!0;break;case"contextmenu":case"mouseup":case"dragend":I7=!1,Ax(u,n,d);break;case"selectionchange":if(pQ)break;case"keydown":case"keyup":Ax(u,n,d)}var T;if(P9)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Nf?bN(e,n)&&(w="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(UN&&n.locale!=="ko"&&(Nf||w!=="onCompositionStart"?w==="onCompositionEnd"&&Nf&&(T=pN()):(lc=d,L9="value"in lc?lc.value:lc.textContent,Nf=!0)),R=Hb(c,w),0<R.length&&(w=new yx(w,e,null,n,d),u.push({event:w,listeners:R}),T?w.data=T:(T=yN(n),T!==null&&(w.data=T)))),(T=rQ?oQ(e,n):aQ(e,n))&&(w=Hb(c,"onBeforeInput"),0<w.length&&(R=new yx("onBeforeInput","beforeinput",null,n,d),u.push({event:R,listeners:w}),R.data=T)),QQ(u,e,c,n,d)}oF(u,t)})}function l0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hb(e,t){for(var n=t+"Capture",i=[];e!==null;){var s=e,r=s.stateNode;s=s.tag,s!==5&&s!==26&&s!==27||r===null||(s=t0(e,n),s!=null&&i.unshift(l0(e,s,r)),s=t0(e,t),s!=null&&i.push(l0(e,s,r))),e=e.return}return i}function lf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function dC(e,t,n,i,s){for(var r=t._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,l!==null&&l===i)break;a!==5&&a!==26&&a!==27||c===null||(l=c,s?(c=t0(n,r),c!=null&&o.unshift(l0(n,c,l))):s||(c=t0(n,r),c!=null&&o.push(l0(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var nJ=/\r\n?/g,iJ=/\u0000|\uFFFD/g;function uC(e){return(typeof e=="string"?e:""+e).replace(nJ,`
`).replace(iJ,"")}function lF(e,t){return t=uC(t),uC(e)===t}function $5(){}function Ht(e,t,n,i,s,r){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||Mh(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&Mh(e,""+i);break;case"className":TU(e,"class",i);break;case"tabIndex":TU(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":TU(e,n,i);break;case"style":gN(e,i,r);break;case"data":if(t!=="object"){TU(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=C2(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(t!=="input"&&Ht(e,t,"name",s.name,s,null),Ht(e,t,"formEncType",s.formEncType,s,null),Ht(e,t,"formMethod",s.formMethod,s,null),Ht(e,t,"formTarget",s.formTarget,s,null)):(Ht(e,t,"encType",s.encType,s,null),Ht(e,t,"method",s.method,s,null),Ht(e,t,"target",s.target,s,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=C2(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=$5);break;case"onScroll":i!=null&&dt("scroll",e);break;case"onScrollEnd":i!=null&&dt("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(ne(61));if(n=i.__html,n!=null){if(s.children!=null)throw Error(ne(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=C2(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":dt("beforetoggle",e),dt("toggle",e),x2(e,"popover",i);break;case"xlinkActuate":va(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":va(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":va(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":va(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":va(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":va(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":va(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":va(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":va(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":x2(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Rq.get(n)||n,x2(e,n,i))}}function q7(e,t,n,i,s,r){switch(n){case"style":gN(e,i,r);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(ne(61));if(n=i.__html,n!=null){if(s.children!=null)throw Error(ne(60));e.innerHTML=n}}break;case"children":typeof i=="string"?Mh(e,i):(typeof i=="number"||typeof i=="bigint")&&Mh(e,""+i);break;case"onScroll":i!=null&&dt("scroll",e);break;case"onScrollEnd":i!=null&&dt("scrollend",e);break;case"onClick":i!=null&&(e.onclick=$5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!lN.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(s=n.endsWith("Capture"),t=n.slice(2,s?n.length-7:void 0),r=e[Ds]||null,r=r!=null?r[n]:null,typeof r=="function"&&e.removeEventListener(t,r,s),typeof i=="function")){typeof r!="function"&&r!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,s);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):x2(e,n,i)}}}function Di(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dt("error",e),dt("load",e);var i=!1,s=!1,r;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(o!=null)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ne(137,t));default:Ht(e,t,r,o,n,null)}}s&&Ht(e,t,"srcSet",n.srcSet,n,null),i&&Ht(e,t,"src",n.src,n,null);return;case"input":dt("invalid",e);var a=r=o=s=null,l=null,c=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(d!=null)switch(i){case"name":s=d;break;case"type":o=d;break;case"checked":l=d;break;case"defaultChecked":c=d;break;case"value":r=d;break;case"defaultValue":a=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(ne(137,t));break;default:Ht(e,t,i,d,n,null)}}uN(e,r,a,l,c,o,s,!1),Tb(e);return;case"select":dt("invalid",e),i=o=r=null;for(s in n)if(n.hasOwnProperty(s)&&(a=n[s],a!=null))switch(s){case"value":r=a;break;case"defaultValue":o=a;break;case"multiple":i=a;default:Ht(e,t,s,a,n,null)}t=r,n=o,e.multiple=!!i,t!=null?sh(e,!!i,t,!1):n!=null&&sh(e,!!i,n,!0);return;case"textarea":dt("invalid",e),r=s=i=null;for(o in n)if(n.hasOwnProperty(o)&&(a=n[o],a!=null))switch(o){case"value":i=a;break;case"defaultValue":s=a;break;case"children":r=a;break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(ne(91));break;default:Ht(e,t,o,a,n,null)}hN(e,i,s,r),Tb(e);return;case"option":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Ht(e,t,l,i,n,null)}return;case"dialog":dt("cancel",e),dt("close",e);break;case"iframe":case"object":dt("load",e);break;case"video":case"audio":for(i=0;i<a0.length;i++)dt(a0[i],e);break;case"image":dt("error",e),dt("load",e);break;case"details":dt("toggle",e);break;case"embed":case"source":case"link":dt("error",e),dt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(ne(137,t));default:Ht(e,t,c,i,n,null)}return;default:if(k9(t)){for(d in n)n.hasOwnProperty(d)&&(i=n[d],i!==void 0&&q7(e,t,d,i,n,void 0));return}}for(a in n)n.hasOwnProperty(a)&&(i=n[a],i!=null&&Ht(e,t,a,i,n,null))}function sJ(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,r=null,o=null,a=null,l=null,c=null,d=null;for(h in n){var u=n[h];if(n.hasOwnProperty(h)&&u!=null)switch(h){case"checked":break;case"value":break;case"defaultValue":l=u;default:i.hasOwnProperty(h)||Ht(e,t,h,null,i,u)}}for(var f in i){var h=i[f];if(u=n[f],i.hasOwnProperty(f)&&(h!=null||u!=null))switch(f){case"type":r=h;break;case"name":s=h;break;case"checked":c=h;break;case"defaultChecked":d=h;break;case"value":o=h;break;case"defaultValue":a=h;break;case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(ne(137,t));break;default:h!==u&&Ht(e,t,f,h,i,u)}}E7(e,o,a,l,c,d,r,s);return;case"select":h=o=a=f=null;for(r in n)if(l=n[r],n.hasOwnProperty(r)&&l!=null)switch(r){case"value":break;case"multiple":h=l;default:i.hasOwnProperty(r)||Ht(e,t,r,null,i,l)}for(s in i)if(r=i[s],l=n[s],i.hasOwnProperty(s)&&(r!=null||l!=null))switch(s){case"value":f=r;break;case"defaultValue":a=r;break;case"multiple":o=r;default:r!==l&&Ht(e,t,s,r,i,l)}t=a,n=o,i=h,f!=null?sh(e,!!n,f,!1):!!i!=!!n&&(t!=null?sh(e,!!n,t,!0):sh(e,!!n,n?[]:"",!1));return;case"textarea":h=f=null;for(a in n)if(s=n[a],n.hasOwnProperty(a)&&s!=null&&!i.hasOwnProperty(a))switch(a){case"value":break;case"children":break;default:Ht(e,t,a,null,i,s)}for(o in i)if(s=i[o],r=n[o],i.hasOwnProperty(o)&&(s!=null||r!=null))switch(o){case"value":f=s;break;case"defaultValue":h=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(ne(91));break;default:s!==r&&Ht(e,t,o,s,i,r)}fN(e,f,h);return;case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&f!=null&&!i.hasOwnProperty(m))switch(m){case"selected":e.selected=!1;break;default:Ht(e,t,m,null,i,f)}for(l in i)if(f=i[l],h=n[l],i.hasOwnProperty(l)&&f!==h&&(f!=null||h!=null))switch(l){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ht(e,t,l,f,i,h)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in n)f=n[p],n.hasOwnProperty(p)&&f!=null&&!i.hasOwnProperty(p)&&Ht(e,t,p,null,i,f);for(c in i)if(f=i[c],h=n[c],i.hasOwnProperty(c)&&f!==h&&(f!=null||h!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(ne(137,t));break;default:Ht(e,t,c,f,i,h)}return;default:if(k9(t)){for(var U in n)f=n[U],n.hasOwnProperty(U)&&f!==void 0&&!i.hasOwnProperty(U)&&q7(e,t,U,void 0,i,f);for(d in i)f=i[d],h=n[d],!i.hasOwnProperty(d)||f===h||f===void 0&&h===void 0||q7(e,t,d,f,i,h);return}}for(var b in n)f=n[b],n.hasOwnProperty(b)&&f!=null&&!i.hasOwnProperty(b)&&Ht(e,t,b,null,i,f);for(u in i)f=i[u],h=n[u],!i.hasOwnProperty(u)||f===h||f==null&&h==null||Ht(e,t,u,f,i,h)}var Q7=null,J7=null;function Vb(e){return e.nodeType===9?e:e.ownerDocument}function fC(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cF(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function e4(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var U8=null;function rJ(){var e=window.event;return e&&e.type==="popstate"?e===U8?!1:(U8=e,!0):(U8=null,!1)}var dF=typeof setTimeout=="function"?setTimeout:void 0,oJ=typeof clearTimeout=="function"?clearTimeout:void 0,hC=typeof Promise=="function"?Promise:void 0,aJ=typeof queueMicrotask=="function"?queueMicrotask:typeof hC<"u"?function(e){return hC.resolve(null).then(e).catch(lJ)}:dF;function lJ(e){setTimeout(function(){throw e})}function b8(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(i===0){e.removeChild(s),h0(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=s}while(n);h0(t)}function t4(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":t4(n),M9(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function cJ(e,t,n,i){for(;e.nodeType===1;){var s=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[e0])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(r=e.getAttribute("rel"),r==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(r!==s.rel||e.getAttribute("href")!==(s.href==null?null:s.href)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||e.getAttribute("title")!==(s.title==null?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(r=e.getAttribute("src"),(r!==(s.src==null?null:s.src)||e.getAttribute("type")!==(s.type==null?null:s.type)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var r=s.name==null?null:""+s.name;if(s.type==="hidden"&&e.getAttribute("name")===r)return e}else return e;if(e=lo(e.nextSibling),e===null)break}return null}function dJ(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=lo(e.nextSibling),e===null))return null;return e}function lo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}function gC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function uF(e,t,n){switch(t=Vb(n),e){case"html":if(e=t.documentElement,!e)throw Error(ne(452));return e;case"head":if(e=t.head,!e)throw Error(ne(453));return e;case"body":if(e=t.body,!e)throw Error(ne(454));return e;default:throw Error(ne(451))}}var zr=new Map,mC=new Set;function $b(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var xl=rn.d;rn.d={f:uJ,r:fJ,D:hJ,C:gJ,L:mJ,m:pJ,X:bJ,S:UJ,M:yJ};function uJ(){var e=xl.f(),t=H5();return e||t}function fJ(e){var t=_g(e);t!==null&&t.tag===5&&t.type==="form"?uO(t):xl.r(e)}var Tg=typeof document>"u"?null:document;function fF(e,t,n){var i=Tg;if(i&&typeof t=="string"&&t){var s=vr(t);s='link[rel="'+e+'"][href="'+s+'"]',typeof n=="string"&&(s+='[crossorigin="'+n+'"]'),mC.has(s)||(mC.add(s),e={rel:e,crossOrigin:n,href:t},i.querySelector(s)===null&&(t=i.createElement("link"),Di(t,"link",e),Ui(t),i.head.appendChild(t)))}}function hJ(e){xl.D(e),fF("dns-prefetch",e,null)}function gJ(e,t){xl.C(e,t),fF("preconnect",e,t)}function mJ(e,t,n){xl.L(e,t,n);var i=Tg;if(i&&e&&t){var s='link[rel="preload"][as="'+vr(t)+'"]';t==="image"&&n&&n.imageSrcSet?(s+='[imagesrcset="'+vr(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(s+='[imagesizes="'+vr(n.imageSizes)+'"]')):s+='[href="'+vr(e)+'"]';var r=s;switch(t){case"style":r=Nh(e);break;case"script":r=Ig(e)}zr.has(r)||(e=on({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),zr.set(r,e),i.querySelector(s)!==null||t==="style"&&i.querySelector(bp(r))||t==="script"&&i.querySelector(yp(r))||(t=i.createElement("link"),Di(t,"link",e),Ui(t),i.head.appendChild(t)))}}function pJ(e,t){xl.m(e,t);var n=Tg;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",s='link[rel="modulepreload"][as="'+vr(i)+'"][href="'+vr(e)+'"]',r=s;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Ig(e)}if(!zr.has(r)&&(e=on({rel:"modulepreload",href:e},t),zr.set(r,e),n.querySelector(s)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(yp(r)))return}i=n.createElement("link"),Di(i,"link",e),Ui(i),n.head.appendChild(i)}}}function UJ(e,t,n){xl.S(e,t,n);var i=Tg;if(i&&e){var s=ih(i).hoistableStyles,r=Nh(e);t=t||"default";var o=s.get(r);if(!o){var a={loading:0,preload:null};if(o=i.querySelector(bp(r)))a.loading=5;else{e=on({rel:"stylesheet",href:e,"data-precedence":t},n),(n=zr.get(r))&&h_(e,n);var l=o=i.createElement("link");Ui(l),Di(l,"link",e),l._p=new Promise(function(c,d){l.onload=c,l.onerror=d}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,N2(o,t,i)}o={type:"stylesheet",instance:o,count:1,state:a},s.set(r,o)}}}function bJ(e,t){xl.X(e,t);var n=Tg;if(n&&e){var i=ih(n).hoistableScripts,s=Ig(e),r=i.get(s);r||(r=n.querySelector(yp(s)),r||(e=on({src:e,async:!0},t),(t=zr.get(s))&&g_(e,t),r=n.createElement("script"),Ui(r),Di(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function yJ(e,t){xl.M(e,t);var n=Tg;if(n&&e){var i=ih(n).hoistableScripts,s=Ig(e),r=i.get(s);r||(r=n.querySelector(yp(s)),r||(e=on({src:e,async:!0,type:"module"},t),(t=zr.get(s))&&g_(e,t),r=n.createElement("script"),Ui(r),Di(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function pC(e,t,n,i){var s=(s=pc.current)?$b(s):null;if(!s)throw Error(ne(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Nh(n.href),n=ih(s).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Nh(n.href);var r=ih(s).hoistableStyles,o=r.get(e);if(o||(s=s.ownerDocument||s,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(e,o),(r=s.querySelector(bp(e)))&&!r._p&&(o.instance=r,o.state.loading=5),zr.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},zr.set(e,n),r||EJ(s,e,n,o.state))),t&&i===null)throw Error(ne(528,""));return o}if(t&&i!==null)throw Error(ne(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ig(n),n=ih(s).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(ne(444,e))}}function Nh(e){return'href="'+vr(e)+'"'}function bp(e){return'link[rel="stylesheet"]['+e+"]"}function hF(e){return on({},e,{"data-precedence":e.precedence,precedence:null})}function EJ(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Di(t,"link",n),Ui(t),e.head.appendChild(t))}function Ig(e){return'[src="'+vr(e)+'"]'}function yp(e){return"script[async]"+e}function UC(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+vr(n.href)+'"]');if(i)return t.instance=i,Ui(i),i;var s=on({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),Ui(i),Di(i,"style",s),N2(i,n.precedence,e),t.instance=i;case"stylesheet":s=Nh(n.href);var r=e.querySelector(bp(s));if(r)return t.state.loading|=4,t.instance=r,Ui(r),r;i=hF(n),(s=zr.get(s))&&h_(i,s),r=(e.ownerDocument||e).createElement("link"),Ui(r);var o=r;return o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),Di(r,"link",i),t.state.loading|=4,N2(r,n.precedence,e),t.instance=r;case"script":return r=Ig(n.src),(s=e.querySelector(yp(r)))?(t.instance=s,Ui(s),s):(i=n,(s=zr.get(r))&&(i=on({},n),g_(i,s)),e=e.ownerDocument||e,s=e.createElement("script"),Ui(s),Di(s,"link",i),e.head.appendChild(s),t.instance=s);case"void":return null;default:throw Error(ne(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(i=t.instance,t.state.loading|=4,N2(i,n.precedence,e));return t.instance}function N2(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=i.length?i[i.length-1]:null,r=s,o=0;o<i.length;o++){var a=i[o];if(a.dataset.precedence===t)r=a;else if(r!==s)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function h_(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function g_(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var O2=null;function bC(e,t,n){if(O2===null){var i=new Map,s=O2=new Map;s.set(n,i)}else s=O2,i=s.get(n),i||(i=new Map,s.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),s=0;s<n.length;s++){var r=n[s];if(!(r[e0]||r[Qi]||e==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var o=r.getAttribute(t)||"";o=e+o;var a=i.get(o);a?a.push(r):i.set(o,[r])}}return i}function yC(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function vJ(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function gF(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var c0=null;function _J(){}function wJ(e,t,n){if(c0===null)throw Error(ne(475));var i=c0;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var s=Nh(n.href),r=e.querySelector(bp(s));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(i.count++,i=Gb.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=r,Ui(r);return}r=e.ownerDocument||e,n=hF(n),(s=zr.get(s))&&h_(n,s),r=r.createElement("link"),Ui(r);var o=r;o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),Di(r,"link",n),t.instance=r}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(i.count++,t=Gb.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}function TJ(){if(c0===null)throw Error(ne(475));var e=c0;return e.stylesheets&&e.count===0&&n4(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&n4(e,e.stylesheets),e.unsuspend){var i=e.unsuspend;e.unsuspend=null,i()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function Gb(){if(this.count--,this.count===0){if(this.stylesheets)n4(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Xb=null;function n4(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Xb=new Map,t.forEach(IJ,e),Xb=null,Gb.call(e))}function IJ(e,t){if(!(t.state.loading&4)){var n=Xb.get(e);if(n)var i=n.get(null);else{n=new Map,Xb.set(e,n);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var o=s[r];(o.nodeName==="LINK"||o.getAttribute("media")!=="not all")&&(n.set(o.dataset.precedence,o),i=o)}i&&n.set(null,i)}s=t.instance,o=s.getAttribute("data-precedence"),r=n.get(o)||i,r===i&&n.set(null,s),n.set(o,s),this.count++,i=Gb.bind(this),s.addEventListener("load",i),s.addEventListener("error",i),r?r.parentNode.insertBefore(s,r.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(s,e.firstChild)),t.state.loading|=4}}var d0={$$typeof:Ga,Provider:null,Consumer:null,_currentValue:Yd,_currentValue2:Yd,_threadCount:0};function SJ(e,t,n,i,s,r,o,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$E(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$E(0),this.hiddenUpdates=$E(null),this.identifierPrefix=i,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function mF(e,t,n,i,s,r,o,a,l,c,d,u){return e=new SJ(e,t,n,o,a,l,c,u),t=1,r===!0&&(t|=24),r=Sr(3,null,null,t),e.current=r,r.stateNode=e,t=V9(),t.refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:i,isDehydrated:n,cache:t},i_(r),e}function pF(e){return e?(e=zf,e):zf}function UF(e,t,n,i,s,r){s=pF(s),i.context===null?i.context=s:i.pendingContext=s,i=Uc(t),i.payload={element:n},r=r===void 0?null:r,r!==null&&(i.callback=r),n=bc(e,i,t),n!==null&&(Us(n,e,t),bm(n,e,t))}function EC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function m_(e,t){EC(e,t),(e=e.alternate)&&EC(e,t)}function bF(e){if(e.tag===13){var t=Nc(e,67108864);t!==null&&Us(t,e,67108864),m_(e,67108864)}}var jb=!0;function xJ(e,t,n,i){var s=qe.T;qe.T=null;var r=rn.p;try{rn.p=2,p_(e,t,n,i)}finally{rn.p=r,qe.T=s}}function CJ(e,t,n,i){var s=qe.T;qe.T=null;var r=rn.p;try{rn.p=8,p_(e,t,n,i)}finally{rn.p=r,qe.T=s}}function p_(e,t,n,i){if(jb){var s=i4(i);if(s===null)p8(e,t,i,Yb,n),vC(e,i);else if(MJ(s,e,t,n,i))i.stopPropagation();else if(vC(e,i),t&4&&-1<AJ.indexOf(e)){for(;s!==null;){var r=_g(s);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var o=Td(r.pendingLanes);if(o!==0){var a=r;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-ir(o);a.entanglements[1]|=l,o&=~l}ga(r),!(yn&6)&&(Ob=Ko()+500,Up(0))}}break;case 13:a=Nc(r,2),a!==null&&Us(a,r,2),H5(),m_(r,2)}if(r=i4(i),r===null&&p8(e,t,i,Yb,n),r===s)break;s=r}s!==null&&i.stopPropagation()}else p8(e,t,i,null,n)}}function i4(e){return e=R9(e),U_(e)}var Yb=null;function U_(e){if(Yb=null,e=Nd(e),e!==null){var t=Eg(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=ZP(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Yb=e,null}function yF(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gq()){case QP:return 2;case JP:return 8;case wb:case mq:return 32;case eN:return 268435456;default:return 32}default:return 32}}var s4=!1,vc=null,_c=null,wc=null,u0=new Map,f0=new Map,nc=[],AJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vC(e,t){switch(e){case"focusin":case"focusout":vc=null;break;case"dragenter":case"dragleave":_c=null;break;case"mouseover":case"mouseout":wc=null;break;case"pointerover":case"pointerout":u0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":f0.delete(t.pointerId)}}function h1(e,t,n,i,s,r){return e===null||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},t!==null&&(t=_g(t),t!==null&&bF(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function MJ(e,t,n,i,s){switch(t){case"focusin":return vc=h1(vc,e,t,n,i,s),!0;case"dragenter":return _c=h1(_c,e,t,n,i,s),!0;case"mouseover":return wc=h1(wc,e,t,n,i,s),!0;case"pointerover":var r=s.pointerId;return u0.set(r,h1(u0.get(r)||null,e,t,n,i,s)),!0;case"gotpointercapture":return r=s.pointerId,f0.set(r,h1(f0.get(r)||null,e,t,n,i,s)),!0}return!1}function EF(e){var t=Nd(e.target);if(t!==null){var n=Eg(t);if(n!==null){if(t=n.tag,t===13){if(t=ZP(n),t!==null){e.blockedOn=t,Tq(e.priority,function(){if(n.tag===13){var i=sr(),s=Nc(n,i);s!==null&&Us(s,n,i),m_(n,i)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function F2(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=i4(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);_7=i,n.target.dispatchEvent(i),_7=null}else return t=_g(n),t!==null&&bF(t),e.blockedOn=n,!1;t.shift()}return!0}function _C(e,t,n){F2(e)&&n.delete(t)}function kJ(){s4=!1,vc!==null&&F2(vc)&&(vc=null),_c!==null&&F2(_c)&&(_c=null),wc!==null&&F2(wc)&&(wc=null),u0.forEach(_C),f0.forEach(_C)}function LU(e,t){e.blockedOn===t&&(e.blockedOn=null,s4||(s4=!0,ci.unstable_scheduleCallback(ci.unstable_NormalPriority,kJ)))}var DU=null;function wC(e){DU!==e&&(DU=e,ci.unstable_scheduleCallback(ci.unstable_NormalPriority,function(){DU===e&&(DU=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],s=e[t+2];if(typeof i!="function"){if(U_(i||n)===null)continue;break}var r=_g(n);r!==null&&(e.splice(t,3),t-=3,R7(r,{pending:!0,data:s,method:n.method,action:i},i,s))}}))}function h0(e){function t(l){return LU(l,e)}vc!==null&&LU(vc,e),_c!==null&&LU(_c,e),wc!==null&&LU(wc,e),u0.forEach(t),f0.forEach(t);for(var n=0;n<nc.length;n++){var i=nc[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<nc.length&&(n=nc[0],n.blockedOn===null);)EF(n),n.blockedOn===null&&nc.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var s=n[i],r=n[i+1],o=s[Ds]||null;if(typeof r=="function")o||wC(n);else if(o){var a=null;if(r&&r.hasAttribute("formAction")){if(s=r,o=r[Ds]||null)a=o.formAction;else if(U_(s)!==null)continue}else a=o.action;typeof a=="function"?n[i+1]=a:(n.splice(i,3),i-=3),wC(n)}}}function b_(e){this._internalRoot=e}G5.prototype.render=b_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));var n=t.current,i=sr();UF(n,i,e,t,null,null)};G5.prototype.unmount=b_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;e.tag===0&&dh(),UF(e.current,2,null,e,null,null),H5(),t[vg]=null}};function G5(e){this._internalRoot=e}G5.prototype.unstable_scheduleHydration=function(e){if(e){var t=oN();e={blockedOn:null,target:e,priority:t};for(var n=0;n<nc.length&&t!==0&&t<nc[n].priority;n++);nc.splice(n,0,e),n===0&&EF(e)}};var TC=XP.version;if(TC!=="19.0.0")throw Error(ne(527,TC,"19.0.0"));rn.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=uq(t),e=e!==null?qP(e):null,e=e===null?null:e.stateNode,e};var RJ={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:qe,findFiberByHostInstance:Nd,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var PU=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!PU.isDisabled&&PU.supportsFiber)try{lp=PU.inject(RJ),nr=PU}catch{}}A5.createRoot=function(e,t){if(!jP(e))throw Error(ne(299));var n=!1,i="",s=UO,r=bO,o=yO,a=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(s=t.onUncaughtError),t.onCaughtError!==void 0&&(r=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(a=t.unstable_transitionCallbacks)),t=mF(e,1,!1,null,null,n,i,s,r,o,a,null),e[vg]=t.current,f_(e.nodeType===8?e.parentNode:e),new b_(t)};A5.hydrateRoot=function(e,t,n){if(!jP(e))throw Error(ne(299));var i=!1,s="",r=UO,o=bO,a=yO,l=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(o=n.onCaughtError),n.onRecoverableError!==void 0&&(a=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(l=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=mF(e,1,!0,t,n??null,i,s,r,o,a,l,c),t.context=pF(null),n=t.current,i=sr(),s=Uc(i),s.callback=null,bc(n,s,i),t.current.lanes=i,dp(t,i),ga(t),e[vg]=t.current,f_(e),new G5(t)};A5.version="19.0.0";function vF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vF)}catch(e){console.error(e)}}vF(),BP.exports=A5;var LJ=BP.exports;const DJ="modulepreload",PJ=function(e){return"/"+e},IC={},pe=function(t,n,i){let s=Promise.resolve();return n&&n.length>0&&(document.getElementsByTagName("link"),s=Promise.all(n.map(r=>{if(r=PJ(r),r in IC)return;IC[r]=!0;const o=r.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":DJ,o||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),o)return new Promise((c,d)=>{l.addEventListener("load",c),l.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${r}`)))})}))),s.then(()=>t()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})};function NJ(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:s,onRegisteredSW:r,onRegisterError:o}=e;let a,l;const c=async(u=!0)=>{await l};async function d(){if("serviceWorker"in navigator){if(a=await pe(()=>import("./workbox-window.prod.es5-B9K5rw8f.js"),__vite__mapDeps([])).then(({Workbox:u})=>new u("/sw.js",{scope:"/",type:"classic"})).catch(u=>{o==null||o(u)}),!a)return;a.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),a.addEventListener("installed",u=>{u.isUpdate||i==null||i()}),a.register({immediate:t}).then(u=>{r?r("/sw.js",u):s==null||s(u)}).catch(u=>{o==null||o(u)})}}return l=d(),c}class OJ{constructor(t){F(this,"content",[]);this.scoreFunction=t}sinkDown(t){const n=this.content[t],i=this.scoreFunction(n);for(;t>0;){const s=(t+1>>1)-1,r=this.content[s];if(i<this.scoreFunction(r))this.content[t]=r,t=s;else break}this.content[t]=n}bubbleUp(t){const n=this.content.length,i=this.content[t],s=this.scoreFunction(i);for(;;){const r=(t+1<<1)-1,o=r+1;let a=t,l=s;if(r<n){const c=this.scoreFunction(this.content[r]);c<l&&(a=r,l=c)}if(o<n&&this.scoreFunction(this.content[o])<l&&(a=o),a===t)break;this.content[t]=this.content[a],t=a}this.content[t]=i}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){if(this.content.length===0)return null;const t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t}remove(t){if(this.content.length===0)return;const n=this.content.indexOf(t),i=this.content.pop();n<this.content.length&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}}const FJ="#ffffff",BJ="#000000",zJ=["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],HJ=["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],VJ=["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],$J=["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],GJ=["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],XJ=["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],jJ=["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],YJ=["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],WJ=["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],KJ=["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],ZJ=["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],qJ=["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],QJ=["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"],Ei={white:FJ,black:BJ,gray:zJ,red:HJ,pink:VJ,grape:$J,violet:GJ,indigo:XJ,blue:jJ,cyan:YJ,teal:WJ,green:KJ,lime:ZJ,yellow:qJ,orange:QJ},r4=240,JJ=(e,t)=>t.reduce((n,i)=>(i in e&&(n[i]=e[i]),n),{}),eee=5,wf=5,tee=4,$1=4,G1=1,jr=[0,2,4,6,8],Yr=(e,t)=>t.map(n=>Ei[e][n]),Ke={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:Yr("gray",jr),red:Yr("red",jr),pink:Yr("pink",jr),grape:Yr("grape",jr),violet:Yr("violet",jr),blue:Yr("blue",jr),cyan:Yr("cyan",jr),teal:Yr("teal",jr),green:Yr("green",jr),yellow:Yr("yellow",jr),orange:Yr("orange",jr),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},_F=JJ(Ke,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),wF=[Ke.black,Ke.red[$1],Ke.green[$1],Ke.blue[$1],Ke.yellow[$1]],TF=[Ke.transparent,Ke.red[G1],Ke.green[G1],Ke.blue[G1],Ke.yellow[G1]],IF=[Ke.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],nee={transparent:Ke.transparent,white:Ke.white,gray:Ke.gray,black:Ke.black,bronze:Ke.bronze,..._F},iee={transparent:Ke.transparent,white:Ke.white,gray:Ke.gray,black:Ke.black,bronze:Ke.bronze,..._F},see=e=>[Ke.cyan[e],Ke.blue[e],Ke.violet[e],Ke.grape[e],Ke.pink[e],Ke.green[e],Ke.teal[e],Ke.yellow[e],Ke.orange[e],Ke.red[e]],ree=(e,t,n)=>`#${((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}`,SF=typeof window<"u"&&"ResizeObserver"in window,Tc="Excalidraw",oee=36,g0=10,aee=20,B2=8,lee=5,SC=1,cee=30,Ys=Math.PI/12,dee="red",Rt={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},Vl={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1,ERASER:5},Sd={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"};var te=(e=>(e.COPY="copy",e.PASTE="paste",e.CUT="cut",e.KEYDOWN="keydown",e.KEYUP="keyup",e.MOUSE_MOVE="mousemove",e.RESIZE="resize",e.UNLOAD="unload",e.FOCUS="focus",e.BLUR="blur",e.DRAG_OVER="dragover",e.DROP="drop",e.GESTURE_END="gestureend",e.BEFORE_UNLOAD="beforeunload",e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.POINTER_MOVE="pointermove",e.POINTER_DOWN="pointerdown",e.POINTER_UP="pointerup",e.STATE_CHANGE="statechange",e.WHEEL="wheel",e.TOUCH_START="touchstart",e.TOUCH_END="touchend",e.HASHCHANGE="hashchange",e.VISIBILITY_CHANGE="visibilitychange",e.SCROLL="scroll",e.EXCALIDRAW_LINK="excalidraw-link",e.MENU_ITEM_SELECT="menu.itemSelect",e.MESSAGE="message",e.FULLSCREENCHANGE="fullscreenchange",e))(te||{});const NU={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},xF={TEST:"test",DEVELOPMENT:"development"},bs={SIDEBAR:"sidebar",SHAPE_ACTIONS_MENU:"App-menu__left",ZOOM_ACTIONS:"zoom-actions",SEARCH_MENU_INPUT_WRAPPER:"layer-ui__search-inputWrapper",CONVERT_ELEMENT_TYPE_POPUP:"ConvertElementTypePopup",SHAPE_ACTIONS_THEME_SCOPE:"shape-actions-theme-scope",FRAME_NAME:"frame-name"},Gf="Xiaolai",m0="Segoe UI Emoji",rt={Virgil:1,Helvetica:2,Cascadia:3,Excalifont:5,Nunito:6,"Lilita One":7,"Comic Shanns":8,"Liberation Sans":9,Assistant:10},CF="sans-serif",AF="monospace",uee={[CF]:998,[AF]:999},Xf={[Gf]:100,...uee,[m0]:1e3};function fee(e){switch(e){case rt.Cascadia:case rt["Comic Shanns"]:return AF;default:return CF}}const MF=e=>{const t=fee(e);switch(e){case rt.Excalifont:return[Gf,t,m0];default:return[t,m0]}},Se={LIGHT:"light",DARK:"dark"},mt={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},y_=1,Cl=20,ad=rt.Excalifont,Ep="left",Wb="top",kF="{version}",fu=2,Kb=2*fu,hee=1e-5,xC=2*Kb-hee,OU="#ffffff",gee="#1e1e1e",mee="#a2f1a6",Zb=20,RF=5,Oh={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},pee={text:"text/plain",html:"text/html",json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json",excalidrawlibIds:"application/vnd.excalidrawlib.ids+json"},ve={...pee,"excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...Oh},Uee=[ve.text,ve.html,...Object.values(Oh)],y8={png:"png",svg:"svg",clipboard:"clipboard"},kr={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},E_=()=>window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,bee=500,yee=300,Eee=500,vee=3e4,_ee=100,X5=.1,v_=.1,__=30,wee=300,CC=6e4,AC=3e3,w_="invert(93%) hue-rotate(180deg)",o4={addLibrary:"addLibrary"},a4={addLibrary:"addLibrary"},MC={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0}},g1=2,T_=[1,2,3],Sg=10,Tee=1440,kC=4*1024*1024,lt="http://www.w3.org/2000/svg",Iee=`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`,LF=128,j5={excalidraw:2,excalidrawLibrary:2},Wn=5,See=.7,xee=11,qs={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},p0={LEFT:"left",CENTER:"center",RIGHT:"right"},Cee=20,E8=.25,Aee=32,En={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},DF={artist:1,cartoonist:2},v8={thin:1,bold:2,extraBold:4},Un={strokeColor:Ke.black,backgroundColor:Ke.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:DF.artist,opacity:100,locked:!1},qb="library",Jd="search",Rr={name:"default",defaultTab:qb},PF=new Set(["iframe","embeddable","image"]),ii={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",text:"text",image:"image",eraser:"eraser",frame:"frame",magicframe:"magicframe",laser:"laser"},Im={MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"},NF="Untitled",jf={generalStats:1,elementProperties:2},Ur=1,Dn={sharp:"sharp",round:"round",elbow:"elbow"},OF=.3,Qb="element";var Fd=(e=>(e.ACTIVE="active",e.AWAY="away",e.IDLE="idle",e))(Fd||{});const Mee=20,kee=35,Tf=700,vp={background:"var(--mobile-action-button-bg)"},Fh={[rt.Excalifont]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25}},[rt.Nunito]:{metrics:{unitsPerEm:1e3,ascender:1011,descender:-353,lineHeight:1.25}},[rt["Lilita One"]]:{metrics:{unitsPerEm:1e3,ascender:923,descender:-220,lineHeight:1.15}},[rt["Comic Shanns"]]:{metrics:{unitsPerEm:1e3,ascender:750,descender:-250,lineHeight:1.25}},[rt.Virgil]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},deprecated:!0},[rt.Helvetica]:{metrics:{unitsPerEm:2048,ascender:1577,descender:-471,lineHeight:1.15},deprecated:!0,local:!0},[rt.Cascadia]:{metrics:{unitsPerEm:2048,ascender:1900,descender:-480,lineHeight:1.2},deprecated:!0},[rt["Liberation Sans"]]:{metrics:{unitsPerEm:2048,ascender:1854,descender:-434,lineHeight:1.15},private:!0},[rt.Assistant]:{metrics:{unitsPerEm:2048,ascender:1021,descender:-287,lineHeight:1.25},private:!0},[Xf.Xiaolai]:{metrics:{unitsPerEm:1e3,ascender:880,descender:-144,lineHeight:1.25},fallback:!0},[Xf["Segoe UI Emoji"]]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},local:!0,fallback:!0}},kd={LATIN:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD",LATIN_EXT:"U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF",CYRILIC_EXT:"U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F",CYRILIC:"U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116",VIETNAMESE:"U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB"},I_="local:",FF=(e,t,n)=>{var c;const{unitsPerEm:i,ascender:s,descender:r}=((c=Fh[e])==null?void 0:c.metrics)||Fh[rt.Excalifont].metrics,o=t/i,a=(n-o*s+o*r)/2;return o*s+a},zc=e=>{var n;const{lineHeight:t}=((n=Fh[e])==null?void 0:n.metrics)||Fh[rt.Excalifont].metrics;return t};class Ree{constructor(){F(this,"jobs",[]);F(this,"running",!1)}tick(){if(this.running)return;const t=this.jobs.shift();t?(this.running=!0,t.promise.resolve(Hc(t.jobFactory,...t.args).finally(()=>{this.running=!1,this.tick()}))):this.running=!1}push(t,...n){const i=K5();return this.jobs.push({jobFactory:t,promise:i,args:n}),this.tick(),i}}const BF="excalidraw.desktopUIMode",zF=599,Lee=1e3,Dee=500,Pee=zF+1,Nee=1400,Oee=1440,Fee=1229,po=/Mac|iPod|iPhone|iPad/.test(navigator.platform),HF=/^Win/.test(navigator.platform),VF=/\b(android)\b/i.test(navigator.userAgent),U0=typeof window<"u"&&"netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,Bee=navigator.userAgent.indexOf("Chrome")!==-1,zee=!Bee&&navigator.userAgent.indexOf("Safari")!==-1,S_=/iPad|iPhone/i.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,Hee=()=>{var e,t;return((t=(e=navigator.brave)==null?void 0:e.isBrave)==null?void 0:t.name)==="isBrave"},Vee=(e,t)=>e<=zF||t<Dee&&e<Lee,$ee=(e,t)=>{const n=Math.min(e,t),i=Math.max(e,t);return n>=Pee&&i<=Nee},Gee=()=>{const e=navigator.userAgent||"",t=navigator.platform||"",n=navigator.userAgentData;if(n){const s=(n.platform||"").toLowerCase(),r=s==="windows"||s==="macos"||s==="linux"||s==="chrome os";if(n.mobile===!0)return!0;if(n.mobile===!1&&s==="android")return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches);if(r)return!1}if(S_)return!0;if(VF){const s=/Mobile/i.test(e);if(s||!s)return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches)}return/Win|Linux|CrOS|Mac/.test(t)||/Windows NT|X11|CrOS|Macintosh/.test(e),!1},Xee=(e,t)=>Vee(e,t)?"phone":$ee(e,t)?"tablet":"desktop",Sm=e=>e.formFactor==="phone"?"mobile":e.formFactor==="tablet"?"compact":e.desktopUIMode,$F=e=>{const t=e??"";let n="unknown";return S_?n="ios":VF?n="android":t&&(n="other"),{isMobileDevice:Gee(),platform:n}},jee=()=>{if(typeof window>"u")return null;try{const e=window.localStorage.getItem(BF);if(e==="compact"||e==="full")return e}catch{}return null},Yee=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(BF,e)}catch{}},Wee=e=>{if(!(e!=="compact"&&e!=="full"))return Yee(e),e},ot={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",Y:"KeyY",R:"KeyR",S:"KeyS"},$={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:po?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SLASH:"/",A:"a",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},Kee=new Map([[$.Z,ot.Z],[$.Y,ot.Y]]),Zee=e=>/^[a-z]$/.test(e.toLowerCase()),l4=(e,t)=>{if(t===e.key.toLowerCase())return!0;const n=Kee.get(t);return!!(n&&!Zee(e.key)&&e.code===n)},X1=e=>e===$.ARROW_LEFT||e===$.ARROW_RIGHT||e===$.ARROW_DOWN||e===$.ARROW_UP,RC=e=>e.altKey,m1=e=>e.shiftKey,ic=e=>e.shiftKey,_p=1e-4,Ze=(e,t,n)=>Math.min(Math.max(e,t),n),Qa=(e,t,n="round")=>{const i=Math.pow(10,t);return Math[n]((e+Number.EPSILON)*i)/i},qee=(e,t,n="round")=>{const i=1/t;return Math[n](e*i)/i},FU=(e,t)=>(e+t)/2,xm=e=>typeof e=="number"&&Number.isFinite(e),LC=(e,t,n=_p)=>Math.abs(e-t)<n,co=e=>e<0?e%(2*Math.PI)+2*Math.PI:e%(2*Math.PI);function eu(e){return e*Math.PI/180}function Y5(e){return e*180/Math.PI}function Qee(e){return Math.abs(Math.sin(2*e))<_p}function Jee(e,t,n){return e=co(e),t=co(t),n=co(n),t<n?e>=t&&e<=n:e>=t||e<=n}function ete(e,t){e=co(e),t=co(t);let n=e-t;return n<-Math.PI?n=n+2*Math.PI:n>Math.PI&&(n=n-2*Math.PI),Math.abs(n)}function Sn(e,t,n=0,i=0){return[e-n,t-i]}function Ie(e,t=[0,0],n,i=[0,1]){const s=Sn(e[0]-t[0],e[1]-t[1]);return n&&GF(s)<n*n?i:s}function Xn(e,t){return e[0]*t[1]-t[0]*e[1]}function Cm(e,t){return e[0]*t[0]+e[1]*t[1]}function Yf(e,t){return[e[0]+t[0],e[1]+t[1]]}function Jb(e,t){return[e[0]-t[0],e[1]-t[1]]}function vn(e,t){return Sn(e[0]*t,e[1]*t)}function GF(e){return e[0]*e[0]+e[1]*e[1]}function tte(e){return Math.sqrt(GF(e))}const uo=e=>{const t=tte(e);return t===0?Sn(0,0):Sn(e[0]/t,e[1]/t)},nte=e=>Sn(e[1],-e[0]);function C(e,t){return[e,t]}function W5(e){return e.length===2?C(e[0],e[1]):void 0}function Pi(e,t=C(0,0)){return C(t[0]+e[0],t[1]+e[1])}function Wf(e){return Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&!isNaN(e[0])&&typeof e[1]=="number"&&!isNaN(e[1])}function Uo(e,t,n=_p){const i=Math.abs;return i(e[0]-t[0])<n&&i(e[1]-t[1])<n}function Z([e,t],[n,i],s){return C((e-n)*Math.cos(s)-(t-i)*Math.sin(s)+n,(e-n)*Math.sin(s)+(t-i)*Math.cos(s)+i)}function Bh(e,t=[0,0]){return C(e[0]+t[0],e[1]+t[1])}function e6(e,t){return C((e[0]+t[0])/2,(e[1]+t[1])/2)}function Qe(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function p1(e,t){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}const j1=(e,t,n)=>Bh(t,vn(Ie(e,t),n)),b0=(e,t,n)=>t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1]),XF=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],jF=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872];function Cr(e,t,n,i){return[e,t,n,i]}function ite(e,t,n,i,s=.001,r=10){let o=1/0,a=0;for(;o>=s;){if(a>=r)return null;const l=1-n,c=l*l,d=c*l,u=n*n,f=u*n,h=d*e[0][0]+3*c*n*e[1][0]+3*l*u*e[2][0]+f*e[3][0],m=d*e[0][1]+3*c*n*e[1][1]+3*l*u*e[2][1]+f*e[3][1],p=t[0][0]+i*(t[1][0]-t[0][0]),U=t[0][1]+i*(t[1][1]-t[0][1]),b=h-p,y=m-U;if(o=Math.abs(b)+Math.abs(y),o<s)break;const v=-3*c*e[0][0]+3*c*e[1][0]-6*l*n*e[1][0]-3*u*e[2][0]+6*l*n*e[2][0]+3*u*e[3][0],_=-3*c*e[0][1]+3*c*e[1][1]-6*l*n*e[1][1]-3*u*e[2][1]+6*l*n*e[2][1]+3*u*e[3][1],I=-(t[1][0]-t[0][0]),R=-(t[1][1]-t[0][1]),T=v*R-I*_;if(Math.abs(T)<1e-12)return null;const w=1/T,S=w*(R*-b-I*-y),x=w*(-_*-b+v*-y);n+=S,i+=x,a+=1}return[n,i]}const uh=(e,t)=>C((1-t)**3*e[0][0]+3*(1-t)**2*t*e[1][0]+3*(1-t)*t**2*e[2][0]+t**3*e[3][0],(1-t)**3*e[0][1]+3*(1-t)**2*t*e[1][1]+3*(1-t)*t**2*e[2][1]+t**3*e[3][1]),_8=[[.5,0],[.2,0],[.8,0]],w8=([e,t],n,i)=>{const s=ite(i,n,e,t,.01,3);if(!s)return null;const[r,o]=s;return r<0||r>1||o<0||o>1?null:uh(i,r)};function YF(e,t){let n=w8(_8[0],t,e);return n?[n]:(n=w8(_8[1],t,e),n?[n]:(n=w8(_8[2],t,e),n?[n]:[]))}function ste(e,t,n=.001){const i=(c,d,u,f=n)=>{let h=c,m=d,p;for(;m-h>f;)p=(m+h)/2,u(p-f)<u(p+f)?m=p:h=p;return p};let r=0;for(let c=1/0,d=0;d<30;d++){const u=Qe(t,uh(e,d/30));u<c&&(c=u,r=d)}const o=Math.max((r-1)/30,0),a=Math.min((r+1)/30,1),l=i(o,a,c=>Qe(t,uh(e,c)));return l?uh(e,l):null}function x_(e,t){const n=ste(e,t);return n?Qe(t,n):0}function rte(e){return Array.isArray(e)&&e.length===4&&Wf(e[0])&&Wf(e[1])&&Wf(e[2])&&Wf(e[3])}function C_([e,t,n,i],s){return Sn(-3*(1-s)*(1-s)*e[0]+3*(1-s)*(1-s)*t[0]-6*s*(1-s)*t[0]-3*s*s*n[0]+6*s*(1-s)*n[0]+3*s*s*i[0],-3*(1-s)*(1-s)*e[1]+3*(1-s)*(1-s)*t[1]-6*s*(1-s)*t[1]-3*s*s*n[1]+6*s*(1-s)*n[1]+3*s*s*i[1])}function WF(e,t=.5){if(e.length<2)return;const n=[];for(let i=0;i<e.length-1;i++){const s=e[i-1<0?0:i-1],r=e[i],o=e[i+1>=e.length?e.length-1:i+1],a=e[i+2>=e.length?e.length-1:i+2],l=[(o[0]-s[0])*t,(o[1]-s[1])*t],c=[(a[0]-r[0])*t,(a[1]-r[1])*t],d=r[0]+l[0]/3,u=r[1]+l[1]/3,f=o[0]-c[0]/3,h=o[1]-c[1]/3;n.push(Cr(C(r[0],r[1]),C(d,u),C(f,h),C(o[0],o[1])))}return n}function KF([e,t,n,i],s,r=50){const o=[];for(let a=0;a<=r;a++){const l=a/r,c=Cr(e,t,n,i),d=uh(c,l),u=uo(C_(c,l)),f=nte(u);o.push(Pi(vn(f,s),d))}return o}function A_(e){let n=0;for(let i=0;i<24;i++){const s=.5*XF[i]+.5,r=C_(e,s),o=Math.sqrt(r[0]*r[0]+r[1]*r[1]);n+=jF[i]*o}return .5*n}function ote(e,t){if(t<=0)return 0;if(t>=1)return A_(e);const n=t/2,i=t/2;let s=0;for(let r=0;r<24;r++){const o=n*XF[r]+i,a=C_(e,o),l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=jF[r]*l}return n*s}function ate(e,t){const n=A_(e),i=n*t;let s=0,r=1,o=t,a=0;const l=n*1e-4,c=20;for(let d=0;d<c&&(a=ote(e,o),!(Math.abs(a-i)<l));d++)a<i?s=o:r=o,o=(s+r)/2;return uh(e,o)}function ZF(e,t,n){return{center:e,halfWidth:t,halfHeight:n}}const lte=(e,t)=>{const{halfWidth:n,halfHeight:i,center:s}=t,r=n,o=i,a=Yf(Ie(e),vn(Ie(s),-1)),l=Math.abs(a[0]),c=Math.abs(a[1]);let d=.707,u=.707;for(let m=0;m<3;m++){const p=r*d,U=o*u,b=(r*r-o*o)*d**3/r,y=(o*o-r*r)*u**3/o,v=p-b,_=U-y,I=l-b,R=c-y,T=Math.hypot(_,v),w=Math.hypot(R,I);d=Math.min(1,Math.max(0,(I*T/w+b)/r)),u=Math.min(1,Math.max(0,(R*T/w+y)/o));const S=Math.hypot(u,d);d/=S,u/=S}const[f,h]=[r*d*Math.sign(a[0]),o*u*Math.sign(a[1])];return Qe(Pi(a),C(f,h))};function cte(e,t){const n=e.halfWidth,i=e.halfHeight,s=Ie(t[1],t[0]),r=Sn(t[0][0]-e.center[0],t[0][1]-e.center[1]),o=Sn(s[0]/(n*n),s[1]/(i*i)),a=Sn(r[0]/(n*n),r[1]/(i*i)),l=Cm(s,o),c=Cm(s,a),d=Cm(r,a)-1,u=c*c-l*d,f=[];if(u>0){const h=(-c-Math.sqrt(u))/l,m=(-c+Math.sqrt(u))/l;0<=h&&h<=1&&f.push(C(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h)),0<=m&&m<=1&&f.push(C(t[0][0]+(t[1][0]-t[0][0])*m,t[0][1]+(t[1][1]-t[0][1])*m))}else if(u===0){const h=-c/l;0<=h&&h<=1&&f.push(C(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h))}return f}function DC(e,t){return[e,t]}function dte(e,t){const n=e[1][1]-e[0][1],i=e[0][0]-e[1][0],s=t[1][1]-t[0][1],r=t[0][0]-t[1][0],o=n*r-s*i;if(o!==0){const a=n*e[0][0]+i*e[0][1],l=s*t[0][0]+r*t[0][1];return C((a*r-l*i)/o,(n*l-s*a)/o)}return null}function ke(e,t){return[e,t]}const ute=e=>Array.isArray(e)&&e.length===2&&Wf(e[0])&&Wf(e[0]),t6=(e,t,n=_p)=>{const i=cc(e,t);return i===0?!0:i<n},cc=(e,t)=>{const[n,i]=e,[[s,r],[o,a]]=t,l=n-s,c=i-r,d=o-s,u=a-r,f=l*d+c*u,h=d*d+u*u;let m=-1;h!==0&&(m=f/h);let p,U;m<0?(p=s,U=r):m>1?(p=o,U=a):(p=s+m*d,U=r+m*u);const b=n-p,y=i-U;return Math.sqrt(b*b+y*y)};function y0(e,t,n){const i=dte(DC(e[0],e[1]),DC(t[0],t[1]));return!i||!t6(i,t,n)||!t6(i,e,n)?null:i}function PC(e,t){return y0(e,t)?0:Math.min(cc(e[0],t),cc(e[1],t),cc(t[0],e),cc(t[1],e))}function c4(...e){return QF(e)}function n6(e){return QF(e)}const qF=(e,t)=>{const[n,i]=e;let s=0;for(let r=0;r<t.length;r++){const o=(r+1)%t.length,[a,l]=t[r],[c,d]=t[o];l<=i?d>i&&(c-a)*(i-l)-(n-a)*(d-l)>0&&s++:d<=i&&(c-a)*(i-l)-(n-a)*(d-l)<0&&s--}return s!==0};function QF(e){return fte(e)?e:[...e,e[0]]}function fte(e){return Uo(e[0],e[e.length-1])}function Yi(e,t){return ia([e,t])}const i6=([e,t],[n,i])=>e<=n?t>=n:e>=n?i>=e:!1,s6=([e,t],[n,i])=>{const s=Math.max(e,n),r=Math.min(t,i);return s<=r?ia([s,r]):null},BU=(e,[t,n])=>e>=t&&e<=n;function hte(e,t){return[e,t]}function T8([e,t,n],i){const s=(d,u,f)=>(d[0]-f[0])*(u[1]-f[1])-(u[0]-f[0])*(d[1]-f[1]),r=s(i,e,t),o=s(i,t,n),a=s(i,n,e),l=r<0||o<0||a<0,c=r>0||o>0||a>0;return!(l&&c)}const zh=e=>{const t=e.map(i=>i[0]),n=e.map(i=>i[1]);return{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}},r6=(e,t,n,i)=>{const s=n.map(h=>h[e]),r=Math.max(...s),o=Math.min(...s),a=r-o,l=a===0?1:t/a;let c=1/0;const d=n.map(h=>{const m=h[e]*l,p=[...h];return p[e]=m,m<c&&(c=m),p});if(!i||d.length===2)return d;const u=o-c;return d.map(h=>h.map((m,p)=>p===e?m+u:m))},ti=(e,t,n)=>n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t];var JF={exports:{}};(function(e,t){(function(n,i){e.exports=i()})($a,function(){var n=function(){this._listeners={}};n.prototype.addEventListener=function(c,d){this._listeners[c]=this._listeners[c]||[],this._listeners[c].indexOf(d)<0&&this._listeners[c].push(d)},n.prototype.removeEventListener=function(c,d){if(this._listeners[c]){var u=this._listeners[c].indexOf(d);u>=0&&this._listeners[c].splice(u,1)}},n.prototype.dispatchEvent=function(c){if(this._listeners[c.type]&&this._listeners[c.type].length)for(var d=this._listeners[c.type].slice(),u=0,f=d.length;u<f;++u)d[u].call(this,c)};var i=function(c){return typeof c.constructor=="function"&&c.constructor.name==="GeneratorFunction"},s=function(c){return{next:function(){var d=c();return d?{value:d}:{done:!0}}}},r=function(c){var d=!1;return{next:function(){return d?{done:!0}:(d=!0,{value:c})}}},o=function(c,d){var u=typeof c;if(u==="object"){if(typeof c.next=="function")return c;if(typeof c.then=="function")return r(c)}return u==="function"?i(c)?c():s(c):r(d.resolve(c))},a=function(c,d,u){this.target=c,this.type=d,this.data=u},l=function(c,d,u){if(n.call(this),typeof d!="number"||Math.floor(d)!==d||d<1)throw new Error("Invalid concurrency");this._concurrency=d,this._options=u||{},this._options.promise=this._options.promise||Promise,this._iterator=o(c,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return l.prototype=new n,l.prototype.constructor=l,l.prototype.concurrency=function(c){return typeof c<"u"&&(this._concurrency=c,this.active()&&this._proceed()),this._concurrency},l.prototype.size=function(){return this._size},l.prototype.active=function(){return!!this._promise},l.prototype.promise=function(){return this._promise},l.prototype.start=function(){var c=this,d=this._options.promise;return this._promise=new d(function(u,f){c._callbacks={reject:f,resolve:u},c._proceed()}),this._promise},l.prototype._fireEvent=function(c,d){this.dispatchEvent(new a(this,c,d))},l.prototype._settle=function(c){c?this._callbacks.reject(c):this._callbacks.resolve(),this._promise=null,this._callbacks=null},l.prototype._onPooledPromiseFulfilled=function(c,d){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:c,result:d}),this._proceed())},l.prototype._onPooledPromiseRejected=function(c,d){this._size--,this.active()&&(this._fireEvent("rejected",{promise:c,error:d}),this._settle(d||new Error("Unknown error")))},l.prototype._trackPromise=function(c){var d=this;c.then(function(u){d._onPooledPromiseFulfilled(c,u)},function(u){d._onPooledPromiseRejected(c,u)}).catch(function(u){d._settle(new Error("Promise processing failed: "+u))})},l.prototype._proceed=function(){if(!this._done){for(var c={done:!1};this._size<this._concurrency&&!(c=this._iterator.next()).done;)this._size++,this._trackPromise(c.value);this._done=c===null||!!c.done}this._done&&this._size===0&&this._settle()},l.PromisePoolEvent=a,l.PromisePool=l,l})})(JF);var gte=JF.exports;const mte=Sl(gte);class NC{constructor(t,n){F(this,"pool");F(this,"entries",{});this.pool=new mte(t,n)}all(){const t=n=>{if(n.data.result){const[i,s]=n.data.result;this.entries[i]=s}};return this.pool.addEventListener("fulfilled",t),this.pool.start().then(()=>(setTimeout(()=>{this.pool.removeEventListener("fulfilled",t)}),Object.values(this.entries)))}}let eB=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");function pte(){return Math.floor(Math.random()*2**31)}class tB{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const OC=()=>{const e=new Date,t=e.getFullYear(),n=`${e.getMonth()+1}`.padStart(2,"0"),i=`${e.getDate()}`.padStart(2,"0"),s=`${e.getHours()}`.padStart(2,"0"),r=`${e.getMinutes()}`.padStart(2,"0");return`${t}-${n}-${i}-${s}${r}`},Pt=e=>e.charAt(0).toUpperCase()+e.slice(1),Ute=e=>e instanceof HTMLElement&&e.className.includes("ToolIcon"),d4=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement,bte=e=>d4(e)||e instanceof Element&&!!e.closest("label, button"),Ba=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&(e.type==="text"||e.type==="number"||e.type==="password"||e.type==="search"),wp=({fontFamily:e})=>{for(const[t,n]of Object.entries(rt))if(n===e)return`${t}${MF(n).map(i=>`, ${i}`).join("")}`;return m0},bt=({fontSize:e,fontFamily:t})=>`${e}px ${wp({fontFamily:t})}`,yte=async e=>{requestAnimationFrame(()=>requestAnimationFrame(e))},ul=(e,t)=>{let n=0,i=null;const s=(...r)=>{i=r,clearTimeout(n),n=window.setTimeout(()=>{i=null,e(...r)},t)};return s.flush=()=>{if(clearTimeout(n),i){const r=i;i=null,e(...r)}},s.cancel=()=>{i=null,clearTimeout(n)},s},Tp=(e,t)=>{let n=null,i=null,s=null;const r=a=>{n=window.requestAnimationFrame(()=>{n=null,e(...a),i=null,s&&(i=s,s=null,r(i))})},o=(...a)=>{i=a,n===null?r(i):t!=null&&t.trailing&&(s=a)};return o.flush=()=>{n!==null&&(cancelAnimationFrame(n),n=null),i&&(e(...s||i),i=s=null)},o.cancel=()=>{i=s=null,n!==null&&(cancelAnimationFrame(n),n=null)},o},fl=e=>1-Math.pow(1-e,4),FC=(e,t,n)=>(t-e)*fl(n)+e,Ete=({fromValues:e,toValues:t,onStep:n,duration:i=250,interpolateValue:s,onStart:r,onEnd:o,onCancel:a})=>{let l=!1,c=0,d;function u(f){if(l)return;d===void 0&&(d=f,r==null||r());const h=Math.min(f-d,i),m=fl(h/i),p={};if(Object.keys(e).forEach(U=>{const b=U,y=(t[b]-e[b])*m+e[b];p[b]=y}),n(p),h<i){const U=h/i,b={};Object.keys(e).forEach(y=>{const v=y,_=e[v],I=t[v];let R;R=s?s(_,I,U,v):FC(_,I,U),R==null&&(R=FC(_,I,U)),b[v]=R}),n(b),c=window.requestAnimationFrame(u)}else n(t),o==null||o()}return c=window.requestAnimationFrame(u),()=>{a==null||a(),l=!0,window.cancelAnimationFrame(c)}},vte=(e,t)=>{if(!e.length||t<1)return[];let n=0,i=0;const s=Array(Math.ceil(e.length/t));for(;n<e.length;)s[i++]=e.slice(n,n+=t);return s},Ki=(e,t)=>Math.abs(e-t),zU=e=>e==="selection"||e==="lasso",qt=(e,t)=>t.type==="custom"?{...e.activeTool,type:"custom",customType:t.customType,locked:t.locked??e.activeTool.locked}:{...e.activeTool,lastActiveTool:t.lastActiveToolBeforeEraser===void 0?e.activeTool.lastActiveTool:t.lastActiveToolBeforeEraser,type:t.type,customType:null,locked:t.locked??e.activeTool.locked,fromSelection:t.fromSelection??!1},Dt=({clientX:e,clientY:t},{zoom:n,offsetLeft:i,offsetTop:s,scrollX:r,scrollY:o})=>{const a=(e-i)/n.value-r,l=(t-s)/n.value-o;return{x:a,y:l}},Qs=({sceneX:e,sceneY:t},{zoom:n,offsetLeft:i,offsetTop:s,scrollX:r,scrollY:o})=>{const a=(e+r)*n.value+i,l=(t+o)*n.value+s;return{x:a,y:l}},HU=e=>getComputedStyle(document.documentElement).getPropertyValue(`--${e}`),_te="A-Za-z--------",wte="---",Tte=new RegExp(`^[^${_te}]*[${wte}]`),nB=e=>Tte.test(e),I8=e=>{const[t,n]=e;return{x:t,y:n}},iB=e=>{if((e==null?void 0:e.name)==="AbortError"){console.warn(e);return}throw e},sB=(e,t,n=0)=>{n<0&&(n=e.length+n),n=Math.min(e.length,Math.max(n,0));let i=n-1;for(;++i<e.length;)if(t(e[i],i,e))return i;return-1},Rd=(e,t,n=e.length-1)=>{n<0&&(n=e.length+n),n=Math.min(e.length-1,Math.max(n,0));let i=n+1;for(;--i>-1;)if(t(e[i],i,e))return i;return-1},Ite=(e,t)=>{for(let n=0;n<e.length;n++){const i=t(e[n],n);if(i!=null)return i}},ms=e=>{const t=e.length===5&&e.substr(4,1)==="0",n=e.length===9&&e.substr(7,2)==="00";return t||n||e===Ke.transparent},K5=()=>{let e,t;const n=new Promise((i,s)=>{e=i,t=s});return n.resolve=e,n.reject=t,n},BC=(e,t)=>{const n=[{value:1,symbol:"b"},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"}],i=/\.0+$|(\.[0-9]*[1-9])0+$/;let s;for(s=n.length-1;s>0&&!(e>=n[s].value);s--);return(e/n[s].value).toFixed(t).replace(i,"$1")+n[s].symbol},u4=()=>{var e;return((e=document.querySelector('meta[name="version"]'))==null?void 0:e.content)||kF},Ste=e=>{let t=e.parentElement;for(;t;){if(t===document.body)return document;const{overflowY:n}=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return t;t=t.parentElement}return document},xte=e=>{let t=e.parentElement;for(;t;){if(t.tabIndex>-1){t.focus();return}t=t.parentElement}},M_=e=>{e.preventDefault(),e.returnValue=""},rB=e=>Array.from(e).map(t=>`0${t.toString(16)}`.slice(-2)).join(""),xg=()=>Date.now(),be=e=>e instanceof Map?e:e.reduce((t,n)=>(t.set(typeof n=="string"?n:n.id,n),t),new Map),Cte=e=>e.reduce((t,n,i)=>(t.set(n.id,[n,i]),t),new Map),Ia=(e,t)=>e.reduce((n,i,s)=>(n[t?t(i):s]=i,n),{}),Ate=e=>e.reduce((t,n,i)=>{const s={...n,prev:null,next:null};if(i!==0){const r=t[i-1];if(s.prev=r,r.next=s,i===e.length-1){const o=t[0];s.next=o,o.prev=s}}return t.push(s),t},[]),Wl=e=>Array.isArray(e)?e:e.values(),Mte=e=>Array.isArray(e)?e:Array.from(Wl(e)),kte=()=>xF.TEST==="production",k_=()=>xF.DEVELOPMENT==="production",Rte=()=>typeof process<"u"&&!0,oB=(e,t)=>new CustomEvent(e,{detail:{nativeEvent:t},cancelable:!0}),z2=(e,t)=>{let n=!1;for(const i in t){const s=t[i];if(typeof s<"u"){if(e[i]===s&&(typeof s!="object"||s===null))continue;n=!0}}return n?{...e,...t}:e},Ip=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}},Lte=()=>Ip()==="iframe",Sp=e=>!!e&&typeof e=="object"&&"then"in e&&"catch"in e&&"finally"in e,f4=e=>{const t=e==null?void 0:e.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return t?Array.from(t).filter(n=>n.tabIndex>-1&&!n.disabled):[]},zC=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t,vi=(e,t,n,i=!1)=>{const s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return i&&console.warn("%cisShallowEqual: objects don't have same properties ->","color: #8B4000",e,t),!1;if(n&&Array.isArray(n)){for(const o of n)if(!(e[o]===t[o]||zC(e[o],t[o])))return i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),!1;return!0}return s.every(o=>{const a=n==null?void 0:n[o],l=a?a(e[o],t[o]):e[o]===t[o]||zC(e[o],t[o]);return!l&&i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),l})},Z5=(e,t,{checkForDefaultPrevented:n=!0}={})=>function(s){if(e==null||e(s),!n||!(s!=null&&s.defaultPrevented))return t==null?void 0:t(s)},na=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw new Error(t)};function xe(e,t){if(!e)throw new Error(t)}const Dte=e=>{let t,n;const i=function(s){const r=Object.entries(s);if(t){let a=!0;for(const[l,c]of r)if(t.get(l)!==c){a=!1;break}if(a)return n}const o=e(s);return t=new Map(r),n=o,o};return i.clear=()=>{t=void 0,n=void 0},i},aB=(e,t)=>e instanceof Set||e instanceof Map?e.has(t):"includes"in e?e.includes(t):e.hasOwnProperty(t),Ja=e=>JSON.parse(JSON.stringify(e)),U1=(e,t)=>vi(e,t)?e:t;function tn(e,t,n,i){var s;return e?((s=e==null?void 0:e.addEventListener)==null||s.call(e,t,n,i),()=>{var r;(r=e==null?void 0:e.removeEventListener)==null||r.call(e,t,n,i)}):()=>{}}function Pte(e,t=!0){const n=e.length;if(n<4)return"";let i=e[0],s=e[1];const r=e[2];let o=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${s[0].toFixed(2)},${s[1].toFixed(2)} ${FU(s[0],r[0]).toFixed(2)},${FU(s[1],r[1]).toFixed(2)} T`;for(let a=2,l=n-1;a<l;a++)i=e[a],s=e[a+1],o+=`${FU(i[0],s[0]).toFixed(2)},${FU(i[1],s[1]).toFixed(2)} `;return t&&(o+="Z"),o}const lB=e=>e.replace(/\r?\n|\r/g,`
`),ia=e=>e,Hc=async(e,...t)=>new Promise(n=>{n(e(...t))}),Nte=(...e)=>Math.max(...e.map(t=>t?1:0))>0,Ote=e=>{try{return JSON.parse(e)}catch{return null}},H2=e=>e.replace(/"/g,"&quot;"),S8=e=>Array.isArray(e)?e:[e],Fte=e=>Array.isArray(e),cB=e=>Fte(e)?e.length:e instanceof Map||e instanceof Set?e.size:Object.keys(e).length,dB=(e,t)=>{if(cB(e)===0)return null;const n=t||(s=>s);let i=null;for(const s of e){const r=n(s);if((i===null||i===r)&&r!=null)i=r;else return null}return i},Bte="excalidraw-feature-flags",HC={COMPLEX_BINDINGS:!1};let x8=null;const ki=e=>{if(!x8)try{const t=localStorage.getItem(Bte);t&&(x8=JSON.parse(t)??HC)}catch{}return(x8||HC)[e]};let zte=new tB(Date.now());const Hr=()=>Math.floor(zte.next()*2**31),ys=()=>eB();var R_={};Object.defineProperty(R_,"__esModule",{value:!0});var uB=R_.sanitizeUrl=void 0,Hte=/^([^\w]*)(javascript|data|vbscript)/im,Vte=/&#(\w+)(^\w|;)?/g,$te=/&(newline|tab);/gi,Gte=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Xte=/^.+(:|&colon;)/gim,jte=[".","/"];function Yte(e){return jte.indexOf(e[0])>-1}function Wte(e){return e.replace(Vte,function(t,n){return String.fromCharCode(n)})}function Kte(e){var t=Wte(e||"").replace($te,"").replace(Gte,"").trim();if(!t)return"about:blank";if(Yte(t))return t;var n=t.match(Xte);if(!n)return t;var i=n[0];return Hte.test(i)?"about:blank":t}uB=R_.sanitizeUrl=Kte;const rr=e=>(e=e.trim(),e&&uB(H2(e))),fB=e=>!!(e!=null&&e.includes(location.origin)||e!=null&&e.startsWith("/")),L_=e=>{if(e=rr(e),e.startsWith("/"))return`${location.origin}${e}`;try{new URL(e)}catch{return"about:blank"}return e};class Jr{constructor(){F(this,"subscribers",[])}on(...t){const n=t.flat().filter(i=>typeof i=="function");return this.subscribers.push(...n),()=>this.off(n)}once(...t){const n=t.flat().filter(s=>typeof s=="function");n.push(()=>i());const i=this.on(...n);return i}off(...t){const n=t.flat();this.subscribers=this.subscribers.filter(i=>!n.includes(i))}trigger(...t){for(const n of this.subscribers)n(...t);return this}clear(){this.subscribers=[]}}function h4(e,t,n){if(e&&e.length){const[i,s]=t,r=Math.PI/180*n,o=Math.cos(r),a=Math.sin(r);for(const l of e){const[c,d]=l;l[0]=(c-i)*o-(d-s)*a+i,l[1]=(c-i)*a+(d-s)*o+s}}}function Zte(e,t,n){const i=[];e.forEach(s=>i.push(...s)),h4(i,t,n)}function qte(e,t){return e[0]===t[0]&&e[1]===t[1]}function Qte(e,t,n,i=1){const s=n,r=Math.max(t,.1),o=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,a=[0,0];if(s)for(const c of o)h4(c,a,s);const l=Jte(o,r,i);if(s){for(const c of o)h4(c,a,-s);Zte(l,a,-s)}return l}function Jte(e,t,n){const i=[];for(const c of e){const d=[...c];qte(d[0],d[d.length-1])||d.push([d[0][0],d[0][1]]),d.length>2&&i.push(d)}const s=[];t=Math.max(t,.1);const r=[];for(const c of i)for(let d=0;d<c.length-1;d++){const u=c[d],f=c[d+1];if(u[1]!==f[1]){const h=Math.min(u[1],f[1]);r.push({ymin:h,ymax:Math.max(u[1],f[1]),x:h===u[1]?u[0]:f[0],islope:(f[0]-u[0])/(f[1]-u[1])})}}if(r.sort((c,d)=>c.ymin<d.ymin?-1:c.ymin>d.ymin?1:c.x<d.x?-1:c.x>d.x?1:c.ymax===d.ymax?0:(c.ymax-d.ymax)/Math.abs(c.ymax-d.ymax)),!r.length)return s;let o=[],a=r[0].ymin,l=0;for(;o.length||r.length;){if(r.length){let c=-1;for(let u=0;u<r.length&&!(r[u].ymin>a);u++)c=u;r.splice(0,c+1).forEach(u=>{o.push({s:a,edge:u})})}if(o=o.filter(c=>!(c.edge.ymax<=a)),o.sort((c,d)=>c.edge.x===d.edge.x?0:(c.edge.x-d.edge.x)/Math.abs(c.edge.x-d.edge.x)),(n!==1||l%t===0)&&o.length>1)for(let c=0;c<o.length;c=c+2){const d=c+1;if(d>=o.length)break;const u=o[c].edge,f=o[d].edge;s.push([[Math.round(u.x),a],[Math.round(f.x),a]])}a+=n,o.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return s}function xp(e,t){var n;const i=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=t.strokeWidth*4),s=Math.max(s,.1);let r=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(r=s),Qte(e,s,i,r||1)}class D_{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const i=xp(t,n);return{type:"fillSketch",ops:this.renderLines(i,n)}}renderLines(t,n){const i=[];for(const s of t)i.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return i}}function q5(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class ene extends D_{fillPolygons(t,n){let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);const s=Object.assign({},n,{hachureGap:i}),r=xp(t,s),o=Math.PI/180*n.hachureAngle,a=[],l=i*.5*Math.cos(o),c=i*.5*Math.sin(o);for(const[u,f]of r)q5([u,f])&&a.push([[u[0]-l,u[1]+c],[...f]],[[u[0]+l,u[1]-c],[...f]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class tne extends D_{fillPolygons(t,n){const i=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),r=this._fillPolygons(t,s);return i.ops=i.ops.concat(r.ops),i}}class nne{constructor(t){this.helper=t}fillPolygons(t,n){n=Object.assign({},n,{hachureAngle:0});const i=xp(t,n);return this.dotsOnLines(i,n)}dotsOnLines(t,n){const i=[];let s=n.hachureGap;s<0&&(s=n.strokeWidth*4),s=Math.max(s,.1);let r=n.fillWeight;r<0&&(r=n.strokeWidth/2);const o=s/4;for(const a of t){const l=q5(a),c=l/s,d=Math.ceil(c)-1,u=l-d*s,f=(a[0][0]+a[1][0])/2-s/4,h=Math.min(a[0][1],a[1][1]);for(let m=0;m<d;m++){const p=h+u+m*s,U=f-o+Math.random()*2*o,b=p-o+Math.random()*2*o,y=this.helper.ellipse(U,b,r,r,n);i.push(...y.ops)}}return{type:"fillSketch",ops:i}}}class ine{constructor(t){this.helper=t}fillPolygons(t,n){const i=xp(t,n);return{type:"fillSketch",ops:this.dashedLine(i,n)}}dashedLine(t,n){const i=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,r=[];return t.forEach(o=>{const a=q5(o),l=Math.floor(a/(i+s)),c=(a+s-l*(i+s))/2;let d=o[0],u=o[1];d[0]>u[0]&&(d=o[1],u=o[0]);const f=Math.atan((u[1]-d[1])/(u[0]-d[0]));for(let h=0;h<l;h++){const m=h*(i+s),p=m+i,U=[d[0]+m*Math.cos(f)+c*Math.cos(f),d[1]+m*Math.sin(f)+c*Math.sin(f)],b=[d[0]+p*Math.cos(f)+c*Math.cos(f),d[1]+p*Math.sin(f)+c*Math.sin(f)];r.push(...this.helper.doubleLineOps(U[0],U[1],b[0],b[1],n))}}),r}}class sne{constructor(t){this.helper=t}fillPolygons(t,n){const i=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,s=n.zigzagOffset<0?i:n.zigzagOffset;n=Object.assign({},n,{hachureGap:i+s});const r=xp(t,n);return{type:"fillSketch",ops:this.zigzagLines(r,s,n)}}zigzagLines(t,n,i){const s=[];return t.forEach(r=>{const o=q5(r),a=Math.round(o/(2*n));let l=r[0],c=r[1];l[0]>c[0]&&(l=r[1],c=r[0]);const d=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let u=0;u<a;u++){const f=u*2*n,h=(u+1)*2*n,m=Math.sqrt(2*Math.pow(n,2)),p=[l[0]+f*Math.cos(d),l[1]+f*Math.sin(d)],U=[l[0]+h*Math.cos(d),l[1]+h*Math.sin(d)],b=[p[0]+m*Math.cos(d+Math.PI/4),p[1]+m*Math.sin(d+Math.PI/4)];s.push(...this.helper.doubleLineOps(p[0],p[1],b[0],b[1],i),...this.helper.doubleLineOps(b[0],b[1],U[0],U[1],i))}}),s}}const Is={};function rne(e,t){let n=e.fillStyle||"hachure";if(!Is[n])switch(n){case"zigzag":Is[n]||(Is[n]=new ene(t));break;case"cross-hatch":Is[n]||(Is[n]=new tne(t));break;case"dots":Is[n]||(Is[n]=new nne(t));break;case"dashed":Is[n]||(Is[n]=new ine(t));break;case"zigzag-line":Is[n]||(Is[n]=new sne(t));break;case"hachure":default:n="hachure",Is[n]||(Is[n]=new D_(t));break}return Is[n]}const one=0,g4=1,hB=2,VU={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function ane(e){const t=new Array;for(;e!=="";)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:one,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:g4,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length);else return[];return t[t.length]={type:hB,text:""},t}function C8(e,t){return e.type===t}function P_(e){const t=[],n=ane(e);let i="BOD",s=0,r=n[s];for(;!C8(r,hB);){let o=0;const a=[];if(i==="BOD")if(r.text==="M"||r.text==="m")s++,o=VU[r.text],i=r.text;else return P_("M0,0"+e);else C8(r,g4)?o=VU[i]:(s++,o=VU[r.text],i=r.text);if(s+o<n.length){for(let l=s;l<s+o;l++){const c=n[l];if(C8(c,g4))a[a.length]=+c.text;else throw new Error("Param not a number: "+i+","+c.text)}if(typeof VU[i]=="number"){const l={key:i,data:a};t.push(l),s+=o,r=n[s],i==="M"&&(i="L"),i==="m"&&(i="l")}else throw new Error("Bad segment: "+i)}else throw new Error("Path data ended short")}return t}function gB(e){let t=0,n=0,i=0,s=0;const r=[];for(const{key:o,data:a}of e)switch(o){case"M":r.push({key:"M",data:[...a]}),[t,n]=a,[i,s]=a;break;case"m":t+=a[0],n+=a[1],r.push({key:"M",data:[t,n]}),i=t,s=n;break;case"L":r.push({key:"L",data:[...a]}),[t,n]=a;break;case"l":t+=a[0],n+=a[1],r.push({key:"L",data:[t,n]});break;case"C":r.push({key:"C",data:[...a]}),t=a[4],n=a[5];break;case"c":{const l=a.map((c,d)=>d%2?c+n:c+t);r.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":r.push({key:"Q",data:[...a]}),t=a[2],n=a[3];break;case"q":{const l=a.map((c,d)=>d%2?c+n:c+t);r.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":r.push({key:"A",data:[...a]}),t=a[5],n=a[6];break;case"a":t+=a[5],n+=a[6],r.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,n]});break;case"H":r.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],r.push({key:"H",data:[t]});break;case"V":r.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],r.push({key:"V",data:[n]});break;case"S":r.push({key:"S",data:[...a]}),t=a[2],n=a[3];break;case"s":{const l=a.map((c,d)=>d%2?c+n:c+t);r.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":r.push({key:"T",data:[...a]}),t=a[0],n=a[1];break;case"t":t+=a[0],n+=a[1],r.push({key:"T",data:[t,n]});break;case"Z":case"z":r.push({key:"Z",data:[]}),t=i,n=s;break}return r}function mB(e){const t=[];let n="",i=0,s=0,r=0,o=0,a=0,l=0;for(const{key:c,data:d}of e){switch(c){case"M":t.push({key:"M",data:[...d]}),[i,s]=d,[r,o]=d;break;case"C":t.push({key:"C",data:[...d]}),i=d[4],s=d[5],a=d[2],l=d[3];break;case"L":t.push({key:"L",data:[...d]}),[i,s]=d;break;case"H":i=d[0],t.push({key:"L",data:[i,s]});break;case"V":s=d[0],t.push({key:"L",data:[i,s]});break;case"S":{let u=0,f=0;n==="C"||n==="S"?(u=i+(i-a),f=s+(s-l)):(u=i,f=s),t.push({key:"C",data:[u,f,...d]}),a=d[0],l=d[1],i=d[2],s=d[3];break}case"T":{const[u,f]=d;let h=0,m=0;n==="Q"||n==="T"?(h=i+(i-a),m=s+(s-l)):(h=i,m=s);const p=i+2*(h-i)/3,U=s+2*(m-s)/3,b=u+2*(h-u)/3,y=f+2*(m-f)/3;t.push({key:"C",data:[p,U,b,y,u,f]}),a=h,l=m,i=u,s=f;break}case"Q":{const[u,f,h,m]=d,p=i+2*(u-i)/3,U=s+2*(f-s)/3,b=h+2*(u-h)/3,y=m+2*(f-m)/3;t.push({key:"C",data:[p,U,b,y,h,m]}),a=u,l=f,i=h,s=m;break}case"A":{const u=Math.abs(d[0]),f=Math.abs(d[1]),h=d[2],m=d[3],p=d[4],U=d[5],b=d[6];u===0||f===0?(t.push({key:"C",data:[i,s,U,b,U,b]}),i=U,s=b):(i!==U||s!==b)&&(pB(i,s,U,b,u,f,h,m,p).forEach(function(v){t.push({key:"C",data:v})}),i=U,s=b);break}case"Z":t.push({key:"Z",data:[]}),i=r,s=o;break}n=c}return t}function lne(e){return Math.PI*e/180}function b1(e,t,n){const i=e*Math.cos(n)-t*Math.sin(n),s=e*Math.sin(n)+t*Math.cos(n);return[i,s]}function pB(e,t,n,i,s,r,o,a,l,c){const d=lne(o);let u=[],f=0,h=0,m=0,p=0;if(c)[f,h,m,p]=c;else{[e,t]=b1(e,t,-d),[n,i]=b1(n,i,-d);const P=(e-n)/2,D=(t-i)/2;let j=P*P/(s*s)+D*D/(r*r);j>1&&(j=Math.sqrt(j),s=j*s,r=j*r);const G=a===l?-1:1,V=s*s,B=r*r,z=V*B-V*D*D-B*P*P,X=V*D*D+B*P*P,Y=G*Math.sqrt(Math.abs(z/X));m=Y*s*D/r+(e+n)/2,p=Y*-r*P/s+(t+i)/2,f=Math.asin(parseFloat(((t-p)/r).toFixed(9))),h=Math.asin(parseFloat(((i-p)/r).toFixed(9))),e<m&&(f=Math.PI-f),n<m&&(h=Math.PI-h),f<0&&(f=Math.PI*2+f),h<0&&(h=Math.PI*2+h),l&&f>h&&(f=f-Math.PI*2),!l&&h>f&&(h=h-Math.PI*2)}let U=h-f;if(Math.abs(U)>Math.PI*120/180){const P=h,D=n,j=i;l&&h>f?h=f+Math.PI*120/180*1:h=f+Math.PI*120/180*-1,n=m+s*Math.cos(h),i=p+r*Math.sin(h),u=pB(n,i,D,j,s,r,o,0,l,[h,P,m,p])}U=h-f;const b=Math.cos(f),y=Math.sin(f),v=Math.cos(h),_=Math.sin(h),I=Math.tan(U/4),R=4/3*s*I,T=4/3*r*I,w=[e,t],S=[e+R*y,t-T*b],x=[n+R*_,i-T*v],k=[n,i];if(S[0]=2*w[0]-S[0],S[1]=2*w[1]-S[1],c)return[S,x,k].concat(u);{u=[S,x,k].concat(u);const P=[];for(let D=0;D<u.length;D+=3){const j=b1(u[D][0],u[D][1],d),G=b1(u[D+1][0],u[D+1][1],d),V=b1(u[D+2][0],u[D+2][1],d);P.push([j[0],j[1],G[0],G[1],V[0],V[1]])}return P}}const cne={randOffset:gne,randOffsetWithRange:mne,ellipse:fne,doubleLineOps:pne};function UB(e,t,n,i,s){return{type:"path",ops:hl(e,t,n,i,s)}}function V2(e,t,n){const i=(e||[]).length;if(i>2){const s=[];for(let r=0;r<i-1;r++)s.push(...hl(e[r][0],e[r][1],e[r+1][0],e[r+1][1],n));return t&&s.push(...hl(e[i-1][0],e[i-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}else if(i===2)return UB(e[0][0],e[0][1],e[1][0],e[1][1],n);return{type:"path",ops:[]}}function dne(e,t){return V2(e,!0,t)}function une(e,t,n,i,s){const r=[[e,t],[e+n,t],[e+n,t+i],[e,t+i]];return dne(r,s)}function VC(e,t){let n=jC(e,1*(1+t.roughness*.2),t);if(!t.disableMultiStroke){const i=jC(e,1.5*(1+t.roughness*.22),Une(t));n=n.concat(i)}return{type:"path",ops:n}}function fne(e,t,n,i,s){const r=bB(n,i,s);return m4(e,t,s,r).opset}function bB(e,t,n){const i=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*i)),r=Math.PI*2/s;let o=Math.abs(e/2),a=Math.abs(t/2);const l=1-n.curveFitting;return o+=Oe(o*l,n),a+=Oe(a*l,n),{increment:r,rx:o,ry:a}}function m4(e,t,n,i){const[s,r]=YC(i.increment,e,t,i.rx,i.ry,1,i.increment*o6(.1,o6(.4,1,n),n),n);let o=a6(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[a]=YC(i.increment,e,t,i.rx,i.ry,1.5,0,n),l=a6(a,null,n);o=o.concat(l)}return{estimatedPoints:r,opset:{type:"path",ops:o}}}function $C(e,t,n,i,s,r,o,a,l){const c=e,d=t;let u=Math.abs(n/2),f=Math.abs(i/2);u+=Oe(u*.01,l),f+=Oe(f*.01,l);let h=s,m=r;for(;h<0;)h+=Math.PI*2,m+=Math.PI*2;m-h>Math.PI*2&&(h=0,m=Math.PI*2);const p=Math.PI*2/l.curveStepCount,U=Math.min(p/2,(m-h)/2),b=WC(U,c,d,u,f,h,m,1,l);if(!l.disableMultiStroke){const y=WC(U,c,d,u,f,h,m,1.5,l);b.push(...y)}return o&&(a?b.push(...hl(c,d,c+u*Math.cos(h),d+f*Math.sin(h),l),...hl(c,d,c+u*Math.cos(m),d+f*Math.sin(m),l)):b.push({op:"lineTo",data:[c,d]},{op:"lineTo",data:[c+u*Math.cos(h),d+f*Math.sin(h)]})),{type:"path",ops:b}}function GC(e,t){const n=mB(gB(P_(e))),i=[];let s=[0,0],r=[0,0];for(const{key:o,data:a}of n)switch(o){case"M":{r=[a[0],a[1]],s=[a[0],a[1]];break}case"L":i.push(...hl(r[0],r[1],a[0],a[1],t)),r=[a[0],a[1]];break;case"C":{const[l,c,d,u,f,h]=a;i.push(...bne(l,c,d,u,f,h,r,t)),r=[f,h];break}case"Z":i.push(...hl(r[0],r[1],s[0],s[1],t)),r=[s[0],s[1]];break}return{type:"path",ops:i}}function A8(e,t){const n=[];for(const i of e)if(i.length){const s=t.maxRandomnessOffset||0,r=i.length;if(r>2){n.push({op:"move",data:[i[0][0]+Oe(s,t),i[0][1]+Oe(s,t)]});for(let o=1;o<r;o++)n.push({op:"lineTo",data:[i[o][0]+Oe(s,t),i[o][1]+Oe(s,t)]})}}return{type:"fillPath",ops:n}}function If(e,t){return rne(t,cne).fillPolygons(e,t)}function hne(e,t,n,i,s,r,o){const a=e,l=t;let c=Math.abs(n/2),d=Math.abs(i/2);c+=Oe(c*.01,o),d+=Oe(d*.01,o);let u=s,f=r;for(;u<0;)u+=Math.PI*2,f+=Math.PI*2;f-u>Math.PI*2&&(u=0,f=Math.PI*2);const h=(f-u)/o.curveStepCount,m=[];for(let p=u;p<=f;p=p+h)m.push([a+c*Math.cos(p),l+d*Math.sin(p)]);return m.push([a+c*Math.cos(f),l+d*Math.sin(f)]),m.push([a,l]),If([m],o)}function gne(e,t){return Oe(e,t)}function mne(e,t,n){return o6(e,t,n)}function pne(e,t,n,i,s){return hl(e,t,n,i,s,!0)}function Une(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function yB(e){return e.randomizer||(e.randomizer=new tB(e.seed||0)),e.randomizer.next()}function o6(e,t,n,i=1){return n.roughness*i*(yB(n)*(t-e)+e)}function Oe(e,t,n=1){return o6(-e,e,t,n)}function hl(e,t,n,i,s,r=!1){const o=r?s.disableMultiStrokeFill:s.disableMultiStroke,a=XC(e,t,n,i,s,!0,!1);if(o)return a;const l=XC(e,t,n,i,s,!0,!0);return a.concat(l)}function XC(e,t,n,i,s,r,o){const a=Math.pow(e-n,2)+Math.pow(t-i,2),l=Math.sqrt(a);let c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let d=s.maxRandomnessOffset||0;d*d*100>a&&(d=l/10);const u=d/2,f=.2+yB(s)*.2;let h=s.bowing*s.maxRandomnessOffset*(i-t)/200,m=s.bowing*s.maxRandomnessOffset*(e-n)/200;h=Oe(h,s,c),m=Oe(m,s,c);const p=[],U=()=>Oe(u,s,c),b=()=>Oe(d,s,c),y=s.preserveVertices;return o?p.push({op:"move",data:[e+(y?0:U()),t+(y?0:U())]}):p.push({op:"move",data:[e+(y?0:Oe(d,s,c)),t+(y?0:Oe(d,s,c))]}),o?p.push({op:"bcurveTo",data:[h+e+(n-e)*f+U(),m+t+(i-t)*f+U(),h+e+2*(n-e)*f+U(),m+t+2*(i-t)*f+U(),n+(y?0:U()),i+(y?0:U())]}):p.push({op:"bcurveTo",data:[h+e+(n-e)*f+b(),m+t+(i-t)*f+b(),h+e+2*(n-e)*f+b(),m+t+2*(i-t)*f+b(),n+(y?0:b()),i+(y?0:b())]}),p}function jC(e,t,n){const i=[];i.push([e[0][0]+Oe(t,n),e[0][1]+Oe(t,n)]),i.push([e[0][0]+Oe(t,n),e[0][1]+Oe(t,n)]);for(let s=1;s<e.length;s++)i.push([e[s][0]+Oe(t,n),e[s][1]+Oe(t,n)]),s===e.length-1&&i.push([e[s][0]+Oe(t,n),e[s][1]+Oe(t,n)]);return a6(i,null,n)}function a6(e,t,n){const i=e.length,s=[];if(i>3){const r=[],o=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let a=1;a+2<i;a++){const l=e[a];r[0]=[l[0],l[1]],r[1]=[l[0]+(o*e[a+1][0]-o*e[a-1][0])/6,l[1]+(o*e[a+1][1]-o*e[a-1][1])/6],r[2]=[e[a+1][0]+(o*e[a][0]-o*e[a+2][0])/6,e[a+1][1]+(o*e[a][1]-o*e[a+2][1])/6],r[3]=[e[a+1][0],e[a+1][1]],s.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]})}}else i===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):i===2&&s.push(...hl(e[0][0],e[0][1],e[1][0],e[1][1],n));return s}function YC(e,t,n,i,s,r,o,a){const l=a.roughness===0,c=[],d=[];if(l){e=e/4,d.push([t+i*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=Math.PI*2;u=u+e){const f=[t+i*Math.cos(u),n+s*Math.sin(u)];c.push(f),d.push(f)}d.push([t+i*Math.cos(0),n+s*Math.sin(0)]),d.push([t+i*Math.cos(e),n+s*Math.sin(e)])}else{const u=Oe(.5,a)-Math.PI/2;d.push([Oe(r,a)+t+.9*i*Math.cos(u-e),Oe(r,a)+n+.9*s*Math.sin(u-e)]);const f=Math.PI*2+u-.01;for(let h=u;h<f;h=h+e){const m=[Oe(r,a)+t+i*Math.cos(h),Oe(r,a)+n+s*Math.sin(h)];c.push(m),d.push(m)}d.push([Oe(r,a)+t+i*Math.cos(u+Math.PI*2+o*.5),Oe(r,a)+n+s*Math.sin(u+Math.PI*2+o*.5)]),d.push([Oe(r,a)+t+.98*i*Math.cos(u+o),Oe(r,a)+n+.98*s*Math.sin(u+o)]),d.push([Oe(r,a)+t+.9*i*Math.cos(u+o*.5),Oe(r,a)+n+.9*s*Math.sin(u+o*.5)])}return[d,c]}function WC(e,t,n,i,s,r,o,a,l){const c=r+Oe(.1,l),d=[];d.push([Oe(a,l)+t+.9*i*Math.cos(c-e),Oe(a,l)+n+.9*s*Math.sin(c-e)]);for(let u=c;u<=o;u=u+e)d.push([Oe(a,l)+t+i*Math.cos(u),Oe(a,l)+n+s*Math.sin(u)]);return d.push([t+i*Math.cos(o),n+s*Math.sin(o)]),d.push([t+i*Math.cos(o),n+s*Math.sin(o)]),a6(d,null,l)}function bne(e,t,n,i,s,r,o,a){const l=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let d=[0,0];const u=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let h=0;h<u;h++)h===0?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(f?0:Oe(c[0],a)),o[1]+(f?0:Oe(c[0],a))]}),d=f?[s,r]:[s+Oe(c[h],a),r+Oe(c[h],a)],l.push({op:"bcurveTo",data:[e+Oe(c[h],a),t+Oe(c[h],a),n+Oe(c[h],a),i+Oe(c[h],a),d[0],d[1]]});return l}function y1(e){return[...e]}function yne(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const i=[];if(n===3)i.push(y1(e[0]),y1(e[1]),y1(e[2]),y1(e[2]));else{const s=[];s.push(e[0],e[0]);for(let a=1;a<e.length;a++)s.push(e[a]),a===e.length-1&&s.push(e[a]);const r=[],o=1-t;i.push(y1(s[0]));for(let a=1;a+2<s.length;a++){const l=s[a];r[0]=[l[0],l[1]],r[1]=[l[0]+(o*s[a+1][0]-o*s[a-1][0])/6,l[1]+(o*s[a+1][1]-o*s[a-1][1])/6],r[2]=[s[a+1][0]+(o*s[a][0]-o*s[a+2][0])/6,s[a+1][1]+(o*s[a][1]-o*s[a+2][1])/6],r[3]=[s[a+1][0],s[a+1][1]],i.push(r[1],r[2],r[3])}}return i}function Ene(e,t){return Math.sqrt($2(e,t))}function $2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function vne(e,t,n){const i=$2(t,n);if(i===0)return $2(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return s=Math.max(0,Math.min(1,s)),$2(e,xd(t,n,s))}function xd(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function _ne(e,t){const n=e[t+0],i=e[t+1],s=e[t+2],r=e[t+3];let o=3*i[0]-2*n[0]-r[0];o*=o;let a=3*i[1]-2*n[1]-r[1];a*=a;let l=3*s[0]-2*r[0]-n[0];l*=l;let c=3*s[1]-2*r[1]-n[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function p4(e,t,n,i){const s=i||[];if(_ne(e,t)<n){const r=e[t+0];s.length?Ene(s[s.length-1],r)>1&&s.push(r):s.push(r),s.push(e[t+3])}else{const o=e[t+0],a=e[t+1],l=e[t+2],c=e[t+3],d=xd(o,a,.5),u=xd(a,l,.5),f=xd(l,c,.5),h=xd(d,u,.5),m=xd(u,f,.5),p=xd(h,m,.5);p4([o,d,h,p],0,n,s),p4([p,m,f,c],0,n,s)}return s}function N_(e,t){return l6(e,0,e.length,t)}function l6(e,t,n,i,s){const r=s||[],o=e[t],a=e[n-1];let l=0,c=1;for(let d=t+1;d<n-1;++d){const u=vne(e[d],o,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(l6(e,t,c+1,i,r),l6(e,c,n,i,r)):(r.length||r.push(o),r.push(a)),r}function Cp(e,t=.15,n){const i=[],s=(e.length-1)/3;for(let r=0;r<s;r++){const o=r*3;p4(e,o,t,i)}return n&&n>0?l6(i,0,i.length,n):i}function wne(e,t,n){const i=P_(e),s=mB(gB(i)),r=[];let o=[],a=[0,0],l=[];const c=()=>{l.length>=4&&o.push(...Cp(l,t)),l=[]},d=()=>{c(),o.length&&(r.push(o),o=[])};for(const{key:f,data:h}of s)switch(f){case"M":d(),a=[h[0],h[1]],o.push(a);break;case"L":c(),o.push([h[0],h[1]]);break;case"C":if(!l.length){const m=o.length?o[o.length-1]:a;l.push([m[0],m[1]])}l.push([h[0],h[1]]),l.push([h[2],h[3]]),l.push([h[4],h[5]]);break;case"Z":c(),o.push([a[0],a[1]]);break}if(d(),!n)return r;const u=[];for(const f of r){const h=N_(f,n);h.length&&u.push(h)}return u}const Hs="none";class Hh{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return pte()}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,i){return{shape:t,sets:n||[],options:i||this.defaultOptions}}line(t,n,i,s,r){const o=this._o(r);return this._d("line",[UB(t,n,i,s,o)],o)}rectangle(t,n,i,s,r){const o=this._o(r),a=[],l=une(t,n,i,s,o);if(o.fill){const c=[[t,n],[t+i,n],[t+i,n+s],[t,n+s]];o.fillStyle==="solid"?a.push(A8([c],o)):a.push(If([c],o))}return o.stroke!==Hs&&a.push(l),this._d("rectangle",a,o)}ellipse(t,n,i,s,r){const o=this._o(r),a=[],l=bB(i,s,o),c=m4(t,n,o,l);if(o.fill)if(o.fillStyle==="solid"){const d=m4(t,n,o,l).opset;d.type="fillPath",a.push(d)}else a.push(If([c.estimatedPoints],o));return o.stroke!==Hs&&a.push(c.opset),this._d("ellipse",a,o)}circle(t,n,i,s){const r=this.ellipse(t,n,i,i,s);return r.shape="circle",r}linearPath(t,n){const i=this._o(n);return this._d("linearPath",[V2(t,!1,i)],i)}arc(t,n,i,s,r,o,a=!1,l){const c=this._o(l),d=[],u=$C(t,n,i,s,r,o,a,!0,c);if(a&&c.fill)if(c.fillStyle==="solid"){const f=Object.assign({},c);f.disableMultiStroke=!0;const h=$C(t,n,i,s,r,o,!0,!1,f);h.type="fillPath",d.push(h)}else d.push(hne(t,n,i,s,r,o,c));return c.stroke!==Hs&&d.push(u),this._d("arc",d,c)}curve(t,n){const i=this._o(n),s=[],r=VC(t,i);if(i.fill&&i.fill!==Hs&&t.length>=3)if(i.fillStyle==="solid"){const o=VC(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{const o=yne(t),a=Cp(o,10,(1+i.roughness)/2);s.push(If([a],i))}return i.stroke!==Hs&&s.push(r),this._d("curve",s,i)}polygon(t,n){const i=this._o(n),s=[],r=V2(t,!0,i);return i.fill&&(i.fillStyle==="solid"?s.push(A8([t],i)):s.push(If([t],i))),i.stroke!==Hs&&s.push(r),this._d("polygon",s,i)}path(t,n){const i=this._o(n),s=[];if(!t)return this._d("path",s,i);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const r=i.fill&&i.fill!=="transparent"&&i.fill!==Hs,o=i.stroke!==Hs,a=!!(i.simplification&&i.simplification<1),l=a?4-4*(i.simplification||1):(1+i.roughness)/2,c=wne(t,1,l),d=GC(t,i);if(r)if(i.fillStyle==="solid")if(c.length===1){const u=GC(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(A8(c,i));else s.push(If(c,i));return o&&(a?c.forEach(u=>{s.push(V2(u,!1,i))}):s.push(d)),this._d("path",s,i)}opsToPath(t,n){let i="";for(const s of t.ops){const r=typeof n=="number"&&n>=0?s.data.map(o=>+o.toFixed(n)):s.data;switch(s.op){case"move":i+=`M${r[0]} ${r[1]} `;break;case"bcurveTo":i+=`C${r[0]} ${r[1]}, ${r[2]} ${r[3]}, ${r[4]} ${r[5]} `;break;case"lineTo":i+=`L${r[0]} ${r[1]} `;break}}return i.trim()}toPaths(t){const n=t.sets||[],i=t.options||this.defaultOptions,s=[];for(const r of n){let o=null;switch(r.type){case"path":o={d:this.opsToPath(r),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:Hs};break;case"fillPath":o={d:this.opsToPath(r),stroke:Hs,strokeWidth:0,fill:i.fill||Hs};break;case"fillSketch":o=this.fillSketch(r,i);break}o&&s.push(o)}return s}fillSketch(t,n){let i=n.fillWeight;return i<0&&(i=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Hs,strokeWidth:i,fill:Hs}}_mergedShape(t){return t.filter((n,i)=>i===0?!0:n.op!=="move")}}class Tne{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Hh(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.ctx,r=t.options.fixedDecimalPlaceDigits;for(const o of n)switch(o.type){case"path":s.save(),s.strokeStyle=i.stroke==="none"?"transparent":i.stroke,s.lineWidth=i.strokeWidth,i.strokeLineDash&&s.setLineDash(i.strokeLineDash),i.strokeLineDashOffset&&(s.lineDashOffset=i.strokeLineDashOffset),this._drawToContext(s,o,r),s.restore();break;case"fillPath":{s.save(),s.fillStyle=i.fill||"";const a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,o,r,a),s.restore();break}case"fillSketch":this.fillSketch(s,o,i);break}}fillSketch(t,n,i){let s=i.fillWeight;s<0&&(s=i.strokeWidth/2),t.save(),i.fillLineDash&&t.setLineDash(i.fillLineDash),i.fillLineDashOffset&&(t.lineDashOffset=i.fillLineDashOffset),t.strokeStyle=i.fill||"",t.lineWidth=s,this._drawToContext(t,n,i.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,i,s="nonzero"){t.beginPath();for(const r of n.ops){const o=typeof i=="number"&&i>=0?r.data.map(a=>+a.toFixed(i)):r.data;switch(r.op){case"move":t.moveTo(o[0],o[1]);break;case"bcurveTo":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":t.lineTo(o[0],o[1]);break}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,i,s,r){const o=this.gen.line(t,n,i,s,r);return this.draw(o),o}rectangle(t,n,i,s,r){const o=this.gen.rectangle(t,n,i,s,r);return this.draw(o),o}ellipse(t,n,i,s,r){const o=this.gen.ellipse(t,n,i,s,r);return this.draw(o),o}circle(t,n,i,s){const r=this.gen.circle(t,n,i,s);return this.draw(r),r}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i),i}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i),i}arc(t,n,i,s,r,o,a=!1,l){const c=this.gen.arc(t,n,i,s,r,o,a,l);return this.draw(c),c}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i),i}path(t,n){const i=this.gen.path(t,n);return this.draw(i),i}}const $U="http://www.w3.org/2000/svg";class Ine{constructor(t,n){this.svg=t,this.gen=new Hh(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS($U,"g"),o=t.options.fixedDecimalPlaceDigits;for(const a of n){let l=null;switch(a.type){case"path":{l=s.createElementNS($U,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke",i.stroke),l.setAttribute("stroke-width",i.strokeWidth+""),l.setAttribute("fill","none"),i.strokeLineDash&&l.setAttribute("stroke-dasharray",i.strokeLineDash.join(" ").trim()),i.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${i.strokeLineDashOffset}`);break}case"fillPath":{l=s.createElementNS($U,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",i.fill||""),(t.shape==="curve"||t.shape==="polygon")&&l.setAttribute("fill-rule","evenodd");break}case"fillSketch":{l=this.fillSketch(s,a,i);break}}l&&r.appendChild(l)}return r}fillSketch(t,n,i){let s=i.fillWeight;s<0&&(s=i.strokeWidth/2);const r=t.createElementNS($U,"path");return r.setAttribute("d",this.opsToPath(n,i.fixedDecimalPlaceDigits)),r.setAttribute("stroke",i.fill||""),r.setAttribute("stroke-width",s+""),r.setAttribute("fill","none"),i.fillLineDash&&r.setAttribute("stroke-dasharray",i.fillLineDash.join(" ").trim()),i.fillLineDashOffset&&r.setAttribute("stroke-dashoffset",`${i.fillLineDashOffset}`),r}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,i,s,r){const o=this.gen.line(t,n,i,s,r);return this.draw(o)}rectangle(t,n,i,s,r){const o=this.gen.rectangle(t,n,i,s,r);return this.draw(o)}ellipse(t,n,i,s,r){const o=this.gen.ellipse(t,n,i,s,r);return this.draw(o)}circle(t,n,i,s){const r=this.gen.circle(t,n,i,s);return this.draw(r)}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i)}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i)}arc(t,n,i,s,r,o,a=!1,l){const c=this.gen.arc(t,n,i,s,r,o,a,l);return this.draw(c)}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i)}path(t,n){const i=this.gen.path(t,n);return this.draw(i)}}const ld={canvas(e,t){return new Tne(e,t)},svg(e,t){return new Ine(e,t)},generator(e){return new Hh(e)},newSeed(){return Hh.newSeed()}},Sne=e=>{const{angle:t,width:n,height:i,x:s,y:r}=e,o=s+n/2,a=r+i/2,l=C(o,a);let c;return e.type==="diamond"?c=c4(Z(C(o,r),l,t),Z(C(s+n,a),l,t),Z(C(o,r+i),l,t),Z(C(s,a),l,t)):c=c4(Z(C(s,r),l,t),Z(C(s+n,r),l,t),Z(C(s+n,r+i),l,t),Z(C(s,r+i),l,t)),{type:"polygon",data:c}},xne=e=>{const{width:t,height:n,angle:i,x:s,y:r}=e;return{type:"ellipse",data:{center:C(s+t/2,r+n/2),angle:i,halfWidth:t/2,halfHeight:n/2}}},Vu=e=>{if(!e)return[];for(const t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops},Cne=(e,t=C(0,0),n,i)=>{const s=l=>Z(C(l[0]+t[0],l[1]+t[1]),i,n),r=Vu(e),o=[];let a=C(0,0);for(const l of r){if(l.op==="move"){const c=W5(l.data);xe(c!=null,"Ops data is not a point"),a=s(c)}if(l.op==="bcurveTo"){const c=s(C(l.data[0],l.data[1])),d=s(C(l.data[2],l.data[3])),u=s(C(l.data[4],l.data[5]));o.push(Cr(a,c,d,u)),a=u}}return{type:"polycurve",data:o}},Ane=e=>{let t=e[0];const n=[];for(let i=1;i<e.length;i++){const s=e[i];n.push(ke(t,s)),t=s}return n},Mne=(e,t,n=!1)=>{const i=r=>Z(Pi(Yf(Ie(r),Sn(e.x,e.y))),t,e.angle),s=Ane(e.points.map(r=>i(r)));return n?{type:"polygon",data:n6(s.flat())}:{type:"polyline",data:s}},kne=(e,t,n=C(0,0),i,s)=>{const r=d=>Z(C(d[0]+n[0],d[1]+n[1]),s,i);if(e.roundness===null)return{type:"polygon",data:n6(e.points.map(d=>r(d)))};const o=Vu(t),a=[];let l=!1;for(const d of o)d.op==="move"?(l=!l,l&&a.push(C(d.data[0],d.data[1]))):d.op==="bcurveTo"?l&&(a.push(C(d.data[0],d.data[1])),a.push(C(d.data[2],d.data[3])),a.push(C(d.data[4],d.data[5]))):d.op==="lineTo"&&l&&a.push(C(d.data[0],d.data[1]));const c=Cp(a,10,5).map(d=>r(d));return{type:"polygon",data:n6(c)}};function KC(e,t,n,i=s=>s){return e*i(.5-t*(.5-n))}function Rne(e){return[-e[0],-e[1]]}function qr(e,t){return[e[0]+t[0],e[1]+t[1]]}function mr(e,t){return[e[0]-t[0],e[1]-t[1]]}function Wr(e,t){return[e[0]*t,e[1]*t]}function Lne(e,t){return[e[0]/t,e[1]/t]}function E1(e){return[e[1],-e[0]]}function ZC(e,t){return e[0]*t[0]+e[1]*t[1]}function Dne(e,t){return e[0]===t[0]&&e[1]===t[1]}function Pne(e){return Math.hypot(e[0],e[1])}function Nne(e){return e[0]*e[0]+e[1]*e[1]}function qC(e,t){return Nne(mr(e,t))}function EB(e){return Lne(e,Pne(e))}function One(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function v1(e,t,n){let i=Math.sin(n),s=Math.cos(n),r=e[0]-t[0],o=e[1]-t[1],a=r*s-o*i,l=r*i+o*s;return[a+t[0],l+t[1]]}function U4(e,t,n){return qr(e,Wr(mr(t,e),n))}function QC(e,t,n){return qr(e,Wr(t,n))}var{min:cf,PI:Fne}=Math,JC=.275,_1=Fne+1e-4;function Bne(e,t={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=B=>B,start:a={},end:l={},last:c=!1}=t,{cap:d=!0,easing:u=B=>B*(2-B)}=a,{cap:f=!0,easing:h=B=>--B*B*B+1}=l;if(e.length===0||n<=0)return[];let m=e[e.length-1].runningLength,p=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,U=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,b=Math.pow(n*i,2),y=[],v=[],_=e.slice(0,10).reduce((B,z)=>{let X=z.pressure;if(r){let Y=cf(1,z.distance/n),ee=cf(1,1-Y);X=cf(1,B+(ee-B)*(Y*JC))}return(B+X)/2},e[0].pressure),I=KC(n,s,e[e.length-1].pressure,o),R,T=e[0].vector,w=e[0].point,S=w,x=w,k=S,P=!1;for(let B=0;B<e.length;B++){let{pressure:z}=e[B],{point:X,vector:Y,distance:ee,runningLength:se}=e[B];if(B<e.length-1&&m-se<3)continue;if(s){if(r){let Xe=cf(1,ee/n),je=cf(1,1-Xe);z=cf(1,_+(je-_)*(Xe*JC))}I=KC(n,s,z,o)}else I=n/2;R===void 0&&(R=I);let oe=se<p?u(se/p):1,Fe=m-se<U?h((m-se)/U):1;I=Math.max(.01,I*Math.min(oe,Fe));let Ge=(B<e.length-1?e[B+1]:e[B]).vector,Me=B<e.length-1?ZC(Y,Ge):1,Ne=ZC(Y,T)<0&&!P,et=Me!==null&&Me<0;if(Ne||et){let Xe=Wr(E1(T),I);for(let je=1/13,Jt=0;Jt<=1;Jt+=je)x=v1(mr(X,Xe),X,_1*Jt),y.push(x),k=v1(qr(X,Xe),X,_1*-Jt),v.push(k);w=x,S=k,et&&(P=!0);continue}if(P=!1,B===e.length-1){let Xe=Wr(E1(Y),I);y.push(mr(X,Xe)),v.push(qr(X,Xe));continue}let Ot=Wr(E1(U4(Ge,Y,Me)),I);x=mr(X,Ot),(B<=1||qC(w,x)>b)&&(y.push(x),w=x),k=qr(X,Ot),(B<=1||qC(S,k)>b)&&(v.push(k),S=k),_=z,T=Y}let D=e[0].point.slice(0,2),j=e.length>1?e[e.length-1].point.slice(0,2):qr(e[0].point,[1,1]),G=[],V=[];if(e.length===1){if(!(p||U)||c){let B=QC(D,EB(E1(mr(D,j))),-(R||I)),z=[];for(let X=1/13,Y=X;Y<=1;Y+=X)z.push(v1(B,D,_1*2*Y));return z}}else{if(!(p||U&&e.length===1))if(d)for(let z=1/13,X=z;X<=1;X+=z){let Y=v1(v[0],D,_1*X);G.push(Y)}else{let z=mr(y[0],v[0]),X=Wr(z,.5),Y=Wr(z,.51);G.push(mr(D,X),mr(D,Y),qr(D,Y),qr(D,X))}let B=E1(Rne(e[e.length-1].vector));if(U||p&&e.length===1)V.push(j);else if(f){let z=QC(j,B,I);for(let X=1/29,Y=X;Y<1;Y+=X)V.push(v1(z,j,_1*3*Y))}else V.push(qr(j,Wr(B,I)),qr(j,Wr(B,I*.99)),mr(j,Wr(B,I*.99)),mr(j,Wr(B,I)))}return y.concat(V,v.reverse(),G)}function zne(e,t={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=t;if(e.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(e[0])?e:e.map(({x:h,y:m,pressure:p=.5})=>[h,m,p]);if(a.length===2){let h=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(U4(a[0],h,m/4))}a.length===1&&(a=[...a,[...qr(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,u=l[0],f=a.length-1;for(let h=1;h<a.length;h++){let m=r&&h===f?a[h].slice(0,2):U4(u.point,a[h],o);if(Dne(u.point,m))continue;let p=One(m,u.point);if(d+=p,h<f&&!c){if(d<s)continue;c=!0}u={point:m,pressure:a[h][2]>=0?a[h][2]:.5,vector:EB(mr(u.point,m)),distance:p,runningLength:d},l.push(u)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function Hne(e,t={}){return Bne(zne(e,t),t)}const fi=10,Vne=(e,t,n,i,s,r,o,a)=>{var k,P;const{width:l,height:c}=gl(e),d=i/l,u=s/c,f=(((k=e.crop)==null?void 0:k.x)??0)/d,h=(((P=e.crop)==null?void 0:P.y)??0)/u,m=Z(C(r,o),Ti(e,t),-e.angle);r=m[0],o=m[1];let p=e.width,U=e.height,b=e.crop??{x:0,y:0,width:i,height:s,naturalWidth:i,naturalHeight:s};const y=b.height,v=b.width,_=e.scale[0]===-1,I=e.scale[1]===-1;let R=o-e.y,T=r-e.x;n.includes("n")&&(U=Ze(e.height-R,fi,I?c-h:e.height+h)),n.includes("s")&&(R=o-e.y-e.height,U=Ze(e.height+R,fi,I?e.height+h:c-h)),n.includes("e")&&(T=r-e.x-e.width,p=Ze(e.width+T,fi,_?e.width+f:l-f)),n.includes("w")&&(p=Ze(e.width-T,fi,_?l-f:e.width+f));const w=D=>{D.height=U*u,D.width=p*d};w(b);const S=(D,j)=>{w(j),D.includes("n")&&(I||(j.y+=y-j.height)),D.includes("s")&&I&&(j.y+=y-j.height),D.includes("e")&&_&&(j.x+=v-j.width),D.includes("w")&&(_||(j.x+=v-j.width))};switch(n){case"n":{if(a){const D=f+e.width/2,j=l-f-e.width/2,G=Math.min(D,j)*2;p=Ze(U*a,fi,G),U=p/a}S(n,b),a&&(b.x+=(v-b.width)/2);break}case"s":{if(a){const D=f+e.width/2,j=l-f-e.width/2,G=Math.min(D,j)*2;p=Ze(U*a,fi,G),U=p/a}S(n,b),a&&(b.x+=(v-b.width)/2);break}case"w":{if(a){const D=h+e.height/2,j=c-h-e.height/2,G=Math.min(D,j)*2;U=Ze(p/a,fi,G),p=U*a}S(n,b),a&&(b.y+=(y-b.height)/2);break}case"e":{if(a){const D=h+e.height/2,j=c-h-e.height/2,G=Math.min(D,j)*2;U=Ze(p/a,fi,G),p=U*a}S(n,b),a&&(b.y+=(y-b.height)/2);break}case"ne":{if(a)if(T>-R){const D=I?c-h:h+e.height;U=Ze(p/a,fi,D),p=U*a}else{const D=_?f+e.width:l-f;p=Ze(U*a,fi,D),U=p/a}S(n,b);break}case"nw":{if(a)if(T<R){const D=I?c-h:h+e.height;U=Ze(p/a,fi,D),p=U*a}else{const D=_?l-f:f+e.width;p=Ze(U*a,fi,D),U=p/a}S(n,b);break}case"se":{if(a)if(T>R){const D=I?h+e.height:c-h;U=Ze(p/a,fi,D),p=U*a}else{const D=_?f+e.width:l-f;p=Ze(U*a,fi,D),U=p/a}S(n,b);break}case"sw":{if(a)if(-T>R){const D=I?h+e.height:c-h;U=Ze(p/a,fi,D),p=U*a}else{const D=_?l-f:f+e.width;p=Ze(U*a,fi,D),U=p/a}S(n,b);break}}const x=$ne(e,n,p,U,!!a);return LC(b.width,b.naturalWidth)&&LC(b.height,b.naturalHeight)&&(b=null),{x:x[0],y:x[1],width:p,height:U,crop:b}},$ne=(e,t,n,i,s)=>{const[r,o,a,l]=I0(e,e.width,e.height,!0),c=C(r,o),d=C(a,l),u=e6(c,d),[f,h,m,p]=I0(e,n,i,!0),U=m-f,b=p-h;let y=[...c];if(["n","w","nw"].includes(t)&&(y=[d[0]-Math.abs(U),d[1]-Math.abs(b)]),t==="ne"){const w=[c[0],d[1]];y=[w[0],w[1]-Math.abs(b)]}if(t==="sw"){const w=[d[0],c[1]];y=[w[0]-Math.abs(U),w[1]]}s&&(["s","n"].includes(t)&&(y[0]=u[0]-U/2),["e","w"].includes(t)&&(y[1]=u[1]-b/2));const v=e.angle,_=Z(y,u,v),I=[y[0]+Math.abs(U)/2,y[1]+Math.abs(b)/2],R=Z(I,u,v);y=Z(_,R,-v);const T=[...y];return T[0]+=e.x-f,T[1]+=e.y-h,T},Gne=(e,t)=>{if(e.crop){const{width:n,height:i}=gl(e),[s,r,o,a,l,c]=$e(e,t),d=Ie(Z(C(s,r),C(l,c),e.angle)),u=Ie(Z(C(o,r),C(l,c),e.angle)),f=uo(Jb(u,d)),h=Ie(Z(C(s,a),C(l,c),e.angle)),m=Jb(h,d),p=uo(m),{cropX:U,cropY:b}=Xne(e.crop,e.scale),y=Yf(Yf(d,vn(f,-U*n/e.crop.naturalWidth)),vn(p,-b*i/e.crop.naturalHeight)),v=Pi(Yf(Yf(y,vn(f,n/2)),vn(p,i/2))),_=Z(Pi(y),v,-e.angle);return{...e,x:_[0],y:_[1],width:n,height:i,crop:null}}return e},gl=e=>{if(e.crop){const t=e.width/(e.crop.width/e.crop.naturalWidth),n=e.height/(e.crop.height/e.crop.naturalHeight);return{width:t,height:n}}return{width:e.width,height:e.height}},Xne=(e,t)=>{let n=e.x,i=e.y;const s=t[0]===-1,r=t[1]===-1;return s&&(n=e.naturalWidth-Math.abs(n)-e.width),r&&(i=e.naturalHeight-Math.abs(i)-e.height),{cropX:n,cropY:i}},jne=(e,t=!1)=>{const n=e.crop;if(!n)return null;const i=e.scale[0]===-1,s=e.scale[1]===-1;let r=n.x,o=n.y;if(i&&(r=n.naturalWidth-n.width-n.x),s&&(o=n.naturalHeight-n.height-n.y),t)return{x:r,y:o};const{width:a,height:l}=gl(e);return{x:r/(n.naturalWidth/a),y:o/(n.naturalHeight/l)}},On=e=>!!e&&e.type==="image"&&!!e.fileId,wt=e=>!!e&&e.type==="image",ds=e=>!!e&&e.type==="embeddable",Kl=e=>!!e&&e.type==="iframe",wr=e=>!!e&&(e.type==="iframe"||e.type==="embeddable"),fe=e=>e!=null&&e.type==="text",vB=e=>e!=null&&e.type==="frame",G2=e=>e!=null&&e.type==="magicframe",Ue=e=>e!=null&&(e.type==="frame"||e.type==="magicframe"),ts=e=>e!=null&&Yne(e.type),Yne=e=>e==="freedraw",Ce=e=>e!=null&&_B(e.type),nn=e=>e!=null&&e.type==="line",_e=e=>e!=null&&e.type==="arrow",ye=e=>_e(e)&&e.elbowed,M8=e=>_e(e)&&!e.elbowed,Wne=e=>_e(e)&&!e.elbowed&&!e.roundness,Kne=e=>_e(e)&&!e.elbowed&&e.roundness!==null,_B=e=>e==="arrow"||e==="line",dn=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&wB(e.type),wB=e=>e==="arrow",Lr=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),TB=e=>e!=null&&(e.type==="rectangle"||e.type==="diamond"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),eA=e=>e!=null&&(e.type==="rectangle"||e.type==="image"||e.type==="text"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="freedraw"),tu=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||_e(e)),IB=e=>{const t=e==null?void 0:e.type;if(!t)return!1;switch(t){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return na(t,null),!1}},Q5=e=>e.type==="rectangle"||e.type==="ellipse"||e.type==="diamond",Fi=e=>{var t;return tu(e)&&!!((t=e.boundElements)!=null&&t.some(({type:n})=>n==="text"))},Nt=e=>e!==null&&"containerId"in e&&e.containerId!==null&&fe(e),SB=e=>!!e.startBinding||!!e.endBinding,$u=e=>e==="rectangle"||e==="embeddable"||e==="iframe"||e==="image",xB=e=>e==="line"||e==="arrow"||e==="diamond",Zne=(e,t)=>!!((e===En.ADAPTIVE_RADIUS||e===En.LEGACY)&&$u(t.type)||e===En.PROPORTIONAL_RADIUS&&xB(t.type)),qne=e=>xB(e.type)?{type:En.PROPORTIONAL_RADIUS}:$u(e.type)?{type:En.ADAPTIVE_RADIUS}:null,fh=e=>Wne(e)?"sharpArrow":Kne(e)?"curvedArrow":ye(e)?"elbowArrow":"line",b4=e=>e.length>3&&Uo(e[0],e[e.length-1]),CB=e=>e.length>3||e.length===3&&!Uo(e[0],e[e.length-1]),Am=new WeakMap,O_=(e,t)=>{const n=Am.get(e);if(!n)return;const{version:i,shapes:s}=n;if(i!==e.version){Am.delete(e);return}return s.get(t)},F_=(e,t,n)=>{const i=Am.get(e);if(!i){Am.set(e,{version:e.version,shapes:new Map([[n,t]])});return}const{version:s,shapes:r}=i;if(s!==e.version){Am.set(e,{version:e.version,shapes:new Map([[n,t]])});return}r.set(n,t)};function c6(e){const t=O_(e,0);if(t)return t;const n=Lse(e),i=[],s=[];for(let o=0;o<n.length;o+=1){const a=n[o],l=n[o-1]&&W5(n[o-1].data.slice(-2));switch(a.op){case"move":continue;case"lineTo":if(!l)throw new Error("prevPoint is undefined");i.push(ke(C(e.x+l[0],e.y+l[1]),C(e.x+a.data[0],e.y+a.data[1])));continue;case"bcurveTo":if(!l)throw new Error("prevPoint is undefined");s.push(Cr(C(e.x+l[0],e.y+l[1]),C(e.x+a.data[0],e.y+a.data[1]),C(e.x+a.data[2],e.y+a.data[3]),C(e.x+a.data[4],e.y+a.data[5])));continue;default:console.error("Unknown op type",a.op)}}const r=[i,s];return F_(e,r,0),r}function Ap(e,t=0){const n=O_(e,t);if(n)return n;let i=qo(Math.min(e.width,e.height),e);i===0&&(i=.01);const s=hte(C(e.x,e.y),C(e.x+e.width,e.y+e.height)),r=ke(C(s[0][0]+i,s[0][1]),C(s[1][0]-i,s[0][1])),o=ke(C(s[1][0],s[0][1]+i),C(s[1][0],s[1][1]-i)),a=ke(C(s[0][0]+i,s[1][1]),C(s[1][0]-i,s[1][1])),l=ke(C(s[0][0],s[1][1]-i),C(s[0][0],s[0][1]+i)),c=[Cr(l[1],C(l[1][0]+2/3*(s[0][0]-l[1][0]),l[1][1]+2/3*(s[0][1]-l[1][1])),C(r[0][0]+2/3*(s[0][0]-r[0][0]),r[0][1]+2/3*(s[0][1]-r[0][1])),r[0]),Cr(r[1],C(r[1][0]+2/3*(s[1][0]-r[1][0]),r[1][1]+2/3*(s[0][1]-r[1][1])),C(o[0][0]+2/3*(s[1][0]-o[0][0]),o[0][1]+2/3*(s[0][1]-o[0][1])),o[0]),Cr(o[1],C(o[1][0]+2/3*(s[1][0]-o[1][0]),o[1][1]+2/3*(s[1][1]-o[1][1])),C(a[1][0]+2/3*(s[1][0]-a[1][0]),a[1][1]+2/3*(s[1][1]-a[1][1])),a[1]),Cr(a[0],C(a[0][0]+2/3*(s[0][0]-a[0][0]),a[0][1]+2/3*(s[1][1]-a[0][1])),C(l[0][0]+2/3*(s[0][0]-l[0][0]),l[0][1]+2/3*(s[1][1]-l[0][1])),l[0])],d=t>0?c.map(h=>WF(KF(h,t))):[[c[0]],[c[1]],[c[2]],[c[3]]],f=[[ke(d[0][d[0].length-1][3],d[1][0][0]),ke(d[1][d[1].length-1][3],d[2][0][0]),ke(d[2][d[2].length-1][3],d[3][0][0]),ke(d[3][d[3].length-1][3],d[0][0][0])],d.flat()];return F_(e,f,t),f}function Mp(e,t=0){const n=O_(e,t);if(n)return n;const[i,s,r,o,a,l,c,d]=lw(e),u=e.roundness?qo(Math.abs(i-c),e):(i-c)*.01,f=e.roundness?qo(Math.abs(o-s),e):(o-s)*.01,[h,m,p,U]=[C(e.x+i,e.y+s),C(e.x+r,e.y+o),C(e.x+a,e.y+l),C(e.x+c,e.y+d)],y=[Cr(C(m[0]-u,m[1]-f),m,m,C(m[0]-u,m[1]+f)),Cr(C(p[0]+u,p[1]-f),p,p,C(p[0]-u,p[1]-f)),Cr(C(U[0]+u,U[1]+f),U,U,C(U[0]+u,U[1]-f)),Cr(C(h[0]-u,h[1]+f),h,h,C(h[0]+u,h[1]+f))].map(I=>WF(KF(I,t))),_=[[ke(y[0][y[0].length-1][3],y[1][0][0]),ke(y[1][y[1].length-1][3],y[2][0][0]),ke(y[2][y[2].length-1][3],y[3][0][0]),ke(y[3][y[3].length-1][3],y[0][0][0])],y.flat()];return F_(e,_,t),_}const sa=(e,t=1)=>{if(e.length>=3){const[n,i]=[e[0],e[e.length-1]];return Qe(n,i)<=B2/t}return!1},qo=(e,t)=>{var n,i,s,r;if(((n=t.roundness)==null?void 0:n.type)===En.PROPORTIONAL_RADIUS||((i=t.roundness)==null?void 0:i.type)===En.LEGACY)return e*E8;if(((s=t.roundness)==null?void 0:s.type)===En.ADAPTIVE_RADIUS){const o=((r=t.roundness)==null?void 0:r.value)??Aee,a=o/E8;return e<=a?e*E8:o}return 0},Qne=(e,t)=>{const n=e.type==="rectangle"?15:0,i=a=>{const l=uo(Ie(a[1],a[0])),c=vn(l,n);return ke(Bh(a[0],c),Bh(a[1],vn(c,-1)))},s=Ti(e,t),r=i(eA(e)?ke(Z(C(e.x,e.y),s,e.angle),Z(C(e.x+e.width,e.y+e.height),s,e.angle)):ke(Z(C(e.x+e.width/2,e.y),s,e.angle),Z(C(e.x+e.width/2,e.y+e.height),s,e.angle))),o=i(eA(e)?ke(Z(C(e.x+e.width,e.y),s,e.angle),Z(C(e.x,e.y+e.height),s,e.angle)):ke(Z(C(e.x,e.y+e.height/2),s,e.angle),Z(C(e.x+e.width,e.y+e.height/2),s,e.angle)));return[r,o]},E0=(e,t,n,i,s)=>{if(xe(e.points.length>=2,"Arrow must have at least two points"),e.width<3&&e.height<3)return null;const[r,o]=Qne(n,s),a=re.getPointAtIndexGlobalCoordinates(e,i==="start"?1:e.points.length-2,s),l=Pi(vn(Ie(t,a),2*Qe(a,t)+Math.max(Qe(r[0],r[1]),Qe(o[0],o[1]))),a),c=ke(t,l),d=y0(r,c),u=y0(o,c),f=d&&Qe(a,d),h=u&&Qe(a,u);let m=null;return f!=null&&h!=null?m=f<h?d:u:m=d||u||null,m&&ml(m,n,s)?m:null},Vh={},d6=(e,t)=>{const n=Vh[e]||(Vh[e]={height:t});return n.height=t,n},AB=e=>{Vh[e]&&delete Vh[e]},Jne=e=>{var t;return((t=Vh[e])==null?void 0:t.height)??null},qn=(e,t,n)=>{const i=e.split(`
`).map(a=>a||" ").join(`
`),s=parseFloat(t),r=iie(i,s,n);return{width:H_(i,t),height:r}},MB="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),kB=(e,t)=>{const n=sie(e);return n===0?qn(MB.split("").join(`
`),e,t).width+Wn*2:n+Wn*2},B_=(e,t)=>qn("",e,t).width+Wn*2,eie=()=>H_(MB,bt({fontSize:Cl,fontFamily:ad}))>0,$h=e=>lB(e).replace(/\t/g,"        "),z_=e=>$h(e).split(`
`),tie=e=>{const t=z_(e.text).length;return e.height/t/e.fontSize},kp=(e,t)=>e*t,RB=(e,t)=>kp(e,t)+Wn*2;let k8;class nie{constructor(){F(this,"canvas");this.canvas=document.createElement("canvas")}getLineWidth(t,n){const i=this.canvas.getContext("2d");return i.font=n,i.measureText(t).width}}const hu=(e,t)=>(k8||(k8=new nie),k8.getLineWidth(e,t)),H_=(e,t)=>{const n=z_(e);let i=0;return n.forEach(s=>{i=Math.max(i,hu(s,t))}),i},iie=(e,t,n)=>{const i=z_(e).length;return kp(t,n)*i},Rp=(()=>{const e={};return{calculate:(s,r)=>{const o=s.charCodeAt(0);if(e[r]||(e[r]=[]),!e[r][o]){const a=hu(s,r);e[r][o]=a}return e[r][o]},getCache:s=>e[s],clearCache:s=>{e[s]=[]}}})(),sie=e=>{const t=Rp.getCache(e);if(!t)return 0;const n=t.filter(i=>i!==void 0);return Math.max(...n)};let R8,GU,L8;const rie=e=>(R8||(R8=At.class(...Object.values(Ca))),R8.test(e)),oie=()=>{if(!GU)try{GU=lie()}catch{GU=aie()}return GU},V_=()=>(L8||(L8=cie()),L8),hr={WHITESPACE:/\s/u,HYPHEN:/-/u,OPENING:/<\(\[\{/u,CLOSING:/>\)\]\}.,:;!\?\//u},Ca={CHAR:new RegExp("\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}","u"),OPENING://u,CLOSING://u,CURRENCY://u},Ed={FLAG:new RegExp("\\p{RI}\\p{RI}","u"),JOINER:new RegExp("(?:\\p{Emoji_Modifier}|\\uFE0F\\u20E3?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?","u"),ZWJ:/\u200D/u,ANY:/[\p{Emoji}]/u,MOST:/[\p{Extended_Pictographic}\p{Emoji_Presentation}]/u},aie=()=>At.or(V_(),Tn.On(hr.HYPHEN,hr.WHITESPACE,Ca.CHAR)),lie=()=>At.or(V_(),Tn.Before(hr.WHITESPACE).Build(),Tn.After(hr.WHITESPACE,hr.HYPHEN).Build(),Tn.Before(Ca.CHAR,Ca.CURRENCY).NotPrecededBy(hr.OPENING,Ca.OPENING).Build(),Tn.After(Ca.CHAR).NotFollowedBy(hr.HYPHEN,hr.CLOSING,Ca.CLOSING).Build(),Tn.BeforeMany(Ca.OPENING).NotPrecededBy(hr.OPENING).Build(),Tn.AfterMany(Ca.CLOSING).NotFollowedBy(hr.CLOSING).Build(),Tn.AfterMany(hr.CLOSING).FollowedBy(hr.OPENING).Build()),cie=()=>At.group(At.or(Ed.FLAG,At.and(Ed.MOST,Ed.JOINER,At.build(`(?:${Ed.ZWJ.source}(?:${Ed.FLAG.source}|${Ed.ANY.source}${Ed.JOINER.source}))*`)))),At={build:e=>new RegExp(e,"u"),join:(...e)=>e.map(t=>t.source).join(""),and:(...e)=>At.build(At.join(...e)),or:(...e)=>At.build(e.map(t=>t.source).join("|")),group:(...e)=>At.build(`(${At.join(...e)})`),class:(...e)=>At.build(`[${At.join(...e)}]`)},Tn={On:(...e)=>{const t=At.join(...e);return At.build(`([${t}])`)},Before:(...e)=>{const t=At.join(...e),n=()=>At.build(`(?=[${t}])`);return Tn.Chain(n)},After:(...e)=>{const t=At.join(...e),n=()=>At.build(`(?<=[${t}])`);return Tn.Chain(n)},BeforeMany:(...e)=>{const t=At.join(...e),n=()=>At.build(`(?<![${t}])(?=[${t}])`);return Tn.Chain(n)},AfterMany:(...e)=>{const t=At.join(...e),n=()=>At.build(`(?<=[${t}])(?![${t}])`);return Tn.Chain(n)},NotBefore:(...e)=>{const t=At.join(...e),n=()=>At.build(`(?![${t}])`);return Tn.Chain(n)},NotAfter:(...e)=>{const t=At.join(...e),n=()=>At.build(`(?<![${t}])`);return Tn.Chain(n)},Chain:e=>({Build:e,PreceededBy:(...t)=>{const n=e(),i=Tn.After(...t).Build(),s=()=>At.and(i,n);return Tn.Chain(s)},FollowedBy:(...t)=>{const n=e(),i=Tn.Before(...t).Build(),s=()=>At.and(n,i);return Tn.Chain(s)},NotPrecededBy:(...t)=>{const n=e(),i=Tn.NotAfter(...t).Build(),s=()=>At.and(i,n);return Tn.Chain(s)},NotFollowedBy:(...t)=>{const n=e(),i=Tn.NotBefore(...t).Build(),s=()=>At.and(n,i);return Tn.Chain(s)}})},die=e=>{const t=oie();return e.normalize("NFC").split(t).filter(Boolean)},cd=(e,t,n)=>{if(!Number.isFinite(n)||n<0)return e;const i=[],s=e.split(`
`);for(const r of s){if(hu(r,t)<=n){i.push(r);continue}const a=uie(r,t,n);i.push(...a)}return i.join(`
`)},uie=(e,t,n)=>{const i=[],r=die(e)[Symbol.iterator]();let o="",a=0,l=r.next();for(;!l.done;){const c=l.value,d=o+c,u=gie(c)?a+Rp.calculate(c,t):hu(d,t);if(/\s/.test(c)||u<=n){o=d,a=u,l=r.next();continue}if(o)i.push(o.trimEnd()),o="",a=0;else{const f=fie(c,t,n),h=f[f.length-1]??"",m=f.slice(0,-1);i.push(...m),o=h,a=hu(h,t),l=r.next()}}if(o){const c=hie(o,t,n);i.push(c)}return i},fie=(e,t,n)=>{if(V_().test(e))return[e];const i=[],s=Array.from(e);let r="",o=0;for(const a of s){const l=Rp.calculate(a,t),c=o+l;if(c<=n){r=r+a,o=c;continue}r&&i.push(r),r=a,o=l}return r&&i.push(r),i},hie=(e,t,n)=>{if(!(hu(e,t)>n))return e;let[,s,r]=e.match(/^(.+?)(\s+)$/)??[e,e.trimEnd(),""],o=hu(s,t);for(const a of Array.from(r)){const l=Rp.calculate(a,t),c=o+l;if(c>n)break;s=s+a,o=c}return s},gie=e=>e.codePointAt(0)!==void 0&&e.codePointAt(1)===void 0,ns=(e,t,n)=>{const i=n.getNonDeletedElementsMap();let s;const r={x:e.x,y:e.y,text:e.text,width:e.width,height:e.height,angle:t?_e(t)?0:t.angle:e.angle};r.text=e.text,(t||!e.autoResize)&&(s=t?oa(t,e):e.width,r.text=cd(e.originalText,bt(e),s));const o=qn(r.text,bt(e),e.lineHeight);if(e.autoResize&&(r.width=o.width),r.height=o.height,t){const a=Dp(t,e),l=oa(t,e);if(!_e(t)&&o.height>a){const f=gu(o.height,t.type);n.mutateElement(t,{height:f}),d6(t.id,f)}if(o.width>l){const f=gu(o.width,t.type);n.mutateElement(t,{width:f})}const c={...e,...r},{x:d,y:u}=dd(t,c,i);r.x=d,r.y=u}n.mutateElement(e,r)},Lp=(e,t,n,i=!1)=>{const s=t.getNonDeletedElementsMap();if(!ra(e))return;AB(e.id);const o=Re(e,s);if(o&&o.text){if(!e)return;let a=o.text,l=o.height,c=o.width;const d=oa(e,o),u=Dp(e,o);let f=e.height;if(i||n!=="n"&&n!=="s"){a&&(a=cd(o.originalText,bt(o),d));const h=qn(a,bt(o),o.lineHeight);l=h.height,c=h.width}if(l>u){f=gu(l,e.type);const h=f-e.height,m=!_e(e)&&(n==="ne"||n==="nw"||n==="n")?e.y-h:e.y;t.mutateElement(e,{height:f,y:m})}t.mutateElement(o,{text:a,width:c,height:l}),_e(e)||t.mutateElement(o,dd(e,o,s))}},dd=(e,t,n)=>{if(_e(e))return re.getBoundTextElementPosition(e,t,n);const i=mie(e),s=Dp(e,t),r=oa(e,t);let o,a;t.verticalAlign===qs.TOP?a=i.y:t.verticalAlign===qs.BOTTOM?a=i.y+(s-t.height):a=i.y+(s/2-t.height/2),t.textAlign===p0.LEFT?o=i.x:t.textAlign===p0.RIGHT?o=i.x+(r-t.width):o=i.x+(r/2-t.width/2);const l=e.angle??0;if(l!==0){const c=C(i.x+r/2,i.y+s/2),d=C(o+t.width/2,a+t.height/2),[u,f]=Z(d,c,l);return{x:u-t.width/2,y:f-t.height/2}}return{x:o,y:a}},ra=e=>{var t,n,i;return(t=e==null?void 0:e.boundElements)!=null&&t.length&&((i=(n=e==null?void 0:e.boundElements)==null?void 0:n.find(s=>s.type==="text"))==null?void 0:i.id)||null},Re=(e,t)=>{if(!e)return null;const n=ra(e);return n&&t.get(n)||null},Bn=(e,t)=>e&&e.containerId&&t.get(e.containerId)||null,D8=(e,t,n)=>{if(!_e(e))return{x:e.x+e.width/2,y:e.y+e.height/2};if(re.getPointsGlobalCoordinates(e,n).length%2===1){const o=Math.floor(e.points.length/2),a=re.getPointGlobalCoordinates(e,e.points[o],n);return{x:a[0],y:a[1]}}const s=e.points.length/2-1;let r=re.getEditorMidPoints(e,n,t)[s];return r||(r=re.getSegmentMidPoint(e,s+1)),{x:r[0],y:r[1]}},mie=e=>{let t=Wn,n=Wn;return e.type==="ellipse"&&(t+=e.width/2*(1-Math.sqrt(2)/2),n+=e.height/2*(1-Math.sqrt(2)/2)),e.type==="diamond"&&(t+=e.width/4,n+=e.height/4),{x:e.x+t,y:e.y+n}},pie=(e,t)=>_e(t)?0:t?t.angle:e.angle,LB=(e,t)=>e.some(n=>{if(Nt(n)){const i=Bn(n,t);return!_e(i)}return!1}),DB=(e,t)=>e.some(n=>{if(Nt(n)){const i=Bn(n,t);return!_e(i)}return fe(n)}),Uie=new Set(["rectangle","ellipse","diamond","arrow"]),bie=e=>Uie.has(e.type),gu=(e,t)=>{e=Math.ceil(e);const n=Wn*2;return t==="ellipse"?Math.round((e+n)/Math.sqrt(2)*2):t==="arrow"?e+n*8:t==="diamond"?2*(e+n):e+n},oa=(e,t)=>{const{width:n}=e;if(_e(e)){const i=((t==null?void 0:t.fontSize)??Cl)*xee;return Math.max(See*n,i)}return e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-Wn*2:e.type==="diamond"?Math.round(n/2)-Wn*2:n-Wn*2},Dp=(e,t)=>{const{height:n}=e;return _e(e)?n-Wn*8*2<=0?t.height:n:e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-Wn*2:e.type==="diamond"?Math.round(n/2)-Wn*2:n-Wn*2},PB=(e,t=`

`)=>e.reduce((i,s)=>(fe(s)&&i.push(s.text),i),[]).join(t),J5=(e,t,n)=>{switch(e.type){case"selection":case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return yie(e,t,n);case"diamond":return Eie(e,t,n);case"ellipse":return vie(e,t,n);case"line":case"arrow":case"freedraw":return _ie(e,n)}},yie=(e,t,n)=>{const i=Ti(e,t),s=Z(n,i,-e.angle),[r,o]=Ap(e);return Math.min(...r.map(a=>cc(s,a)),...o.map(a=>x_(a,s)).filter(a=>a!==null))},Eie=(e,t,n)=>{const i=Ti(e,t),s=Z(n,i,-e.angle),[r,o]=Mp(e);return Math.min(...r.map(a=>cc(s,a)),...o.map(a=>x_(a,s)).filter(a=>a!==null))},vie=(e,t,n)=>{const i=Ti(e,t);return lte(Z(n,i,-e.angle),ZF(i,e.width/2,e.height/2))},_ie=(e,t)=>{const[n,i]=c6(e);return Math.min(...n.map(s=>cc(t,s)),...i.map(s=>x_(s,t)))},u6=e=>{if(e.type==="arrow")return!1;const t=!ms(e.backgroundColor)||Fi(e)||wr(e)||fe(e);return e.type==="line"||e.type==="freedraw"?t&&sa(e.points):t||wt(e)},Sf=({point:e,element:t,threshold:n,elementsMap:i,frameNameBound:s=null,overrideShouldTestInside:r=!1})=>{const o=s?b0(C(s.x-n,s.y-n),e,C(s.x+s.width+n,s.y+s.height+n)):!1,a=Mn(t,i,!0);return!b0(C(a[0]-n,a[1]-n),Z(e,Mg(a),-t.angle),C(a[2]+n,a[3]+n))&&!o?!1:(r||u6(t))&&ml(e,t,i)||tA(e,t,i,n)||o},ey=(e,t,n,i=0)=>{let[s,r,o,a]=Mn(t,n);return s-=i,r-=i,o+=i,a+=i,b0(C(s,r),e,C(o,a))},wie=(e,t)=>!Sf(e)&&!NB(e.point,e.element,t)&&ey(e.point,e.element,t),NB=(e,t,n)=>{const i=Re(t,n);if(!i)return!1;const s=Ce(t)?{...i,...re.getBoundTextElementPosition(t,i,n)}:i;return ml(e,s,n)},Tie=(e,[t,n],i,s=0)=>{const r=C(t,n),o=!Ue(e),a=Math.max(1,s),l=[t-a,n-a,t+a,n+a],c=Mn(e,i);if(!ud(l,c))return!1;if(e.frameId){const f=i.get(e.frameId);if(f&&Ue(f)){const h=Mn(f,i);if(!Kh(r,h))return!1}}const d=fo(e,i,ke(Ti(e,i),r)),u=J5(e,i,r);return o?d.length===0||u<=s:d.length>0&&u<=a},$_=(e,t,n,i)=>{const s=[];for(let r=t.length-1;r>=0;--r){const o=t[r];if(xe(!o.isDeleted,"Elements in the function parameter for getAllElementsAtPositionForBinding() should not contain deleted elements"),Lr(o,!1)&&Tie(o,e,n,i==null?void 0:i(o))&&(s.push(o),!ms(o.backgroundColor)))break}return s},Ci=(e,t,n,i)=>{const s=$_(e,t,n,i);return!s||s.length===0?null:s.length===1?s[0]:s.sort((r,o)=>o.width**2+o.height**2-(r.width**2+r.height**2)).pop()},fo=(e,t,n,i=0,s=!1)=>{const r=[Math.min(n[0][0]-i,n[1][0]-i),Math.min(n[0][1]-i,n[1][1]-i),Math.max(n[0][0]+i,n[1][0]+i),Math.max(n[0][1]+i,n[1][1]+i)],o=Mn(e,t);if(!ud(r,o))return[];switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"selection":case"magicframe":return Sie(e,t,n,i,s);case"diamond":return xie(e,t,n,i,s);case"ellipse":return Cie(e,t,n,i);case"line":case"freedraw":case"arrow":return Iie(e,n,s)}},OB=(e,t,n,i,s,r=!1)=>{for(const o of e){const a=cw(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!ud(a,l))continue;const c=YF(o,t);if(c.length>0){for(const d of c)n.push(Z(d,i,s));if(r)return n}}return n},FB=(e,t,n,i,s,r=!1)=>{for(const o of e){const a=y0(o,t);if(a&&(n.push(Z(a,i,s)),r))return n}return n},Iie=(e,t,n=!1)=>{const[i,s]=c6(e),r=[];for(const o of i){const a=y0(o,t);if(a&&(r.push(a),n))return r}for(const o of s){const a=cw(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!ud(a,l))continue;const c=YF(o,t);if(c.length>0&&(r.push(...c),n))return r}return r},Sie=(e,t,n,i=0,s=!1)=>{const r=Ti(e,t),o=Z(n[0],r,-e.angle),a=Z(n[1],r,-e.angle),l=ke(o,a),[c,d]=Ap(e,i),u=[];return FB(c,l,u,r,e.angle,s),s&&u.length>0||OB(d,l,u,r,e.angle,s),u},xie=(e,t,n,i=0,s=!1)=>{const r=Ti(e,t),o=Z(n[0],r,-e.angle),a=Z(n[1],r,-e.angle),l=ke(o,a),[c,d]=Mp(e,i),u=[];return FB(c,l,u,r,e.angle,s),s&&u.length>0||OB(d,l,u,r,e.angle,s),u},Cie=(e,t,n,i=0)=>{const s=Ti(e,t),r=Z(n[0],s,-e.angle),o=Z(n[1],s,-e.angle);return cte(ZF(s,e.width/2+i,e.height/2+i),ke(r,o)).map(a=>Z(a,s,e.angle))},tA=(e,t,n,i=1)=>J5(t,n,e)<=i,ml=(e,t,n)=>{if((Ce(t)||ts(t))&&!sa(t.points))return!1;const[i,s,r,o]=Mn(t,n);if(!b0(C(i,s),e,C(r,o)))return!1;const a=C((i+r)/2,(s+o)/2),l=Pi(vn(uo(Ie(e,a,.1)),Math.max(t.width,t.height)*2),a),c=ke(e,l);return fo(t,n,c).filter((u,f,h)=>h.findIndex(m=>Uo(m,u))===f).length%2===1},BB=(e,t,n)=>{const i=(o,a)=>{const{x:l,y:c,width:d,height:u,angle:f}=o,h=Ti(o,n);if(o.type==="diamond"){const[p,U,b,y,v,_,I,R]=lw(o);return[C(l+p,c+U-a),C(l+b+a,c+y),C(l+v,c+_+a),C(l+I-a,c+R)].map(w=>Z(w,h,f))}if(o.type==="ellipse"){const p=l+d/2,U=c+u/2,b=d/2,y=u/2;return[C(p,U-y-a),C(p+b+a,U),C(p,U+y+a),C(p-b-a,U)].map(_=>Z(_,h,f))}return[C(l-a,c-a),C(l+d+a,c-a),C(l+d+a,c+u+a),C(l-a,c+u+a)].map(p=>Z(p,h,f))},s=-1*Math.max(e.width,e.height)/20;return i(e,s).every(o=>ml(o,t,n))},Yn=[1,0],hs=[0,1],Tr=[-1,0],ro=[0,-1],Gh=e=>{const[t,n]=e,i=Math.abs(t),s=Math.abs(n);return t>s?Yn:t<=-s?Tr:n>i?hs:ro},Xs=(e,t)=>Gh(Ie(e,t)),za=(e,t)=>Go(Xs(e,t)),Kn=(e,t)=>e[0]===t[0]&&e[1]===t[1],Go=e=>Kn(e,Yn)||Kn(e,Tr),Aie=(e,t,n)=>{const i=Mg(t),s=.95,r=Pi(vn(Ie(Z(C(e.x+e.width/2,e.y),i,e.angle),i),s),i),o=Pi(vn(Ie(Z(C(e.x+e.width,e.y+e.height/2),i,e.angle),i),s),i),a=Pi(vn(Ie(Z(C(e.x+e.width/2,e.y+e.height),i,e.angle),i),s),i),l=Pi(vn(Ie(Z(C(e.x,e.y+e.height/2),i,e.angle),i),s),i);if(Xn(Ie(n,r),Ie(r,o))<=0&&Xn(Ie(n,r),Ie(r,l))>0)return Xs(r,i);if(Xn(Ie(n,o),Ie(o,a))<=0&&Xn(Ie(n,o),Ie(o,r))>0)return Xs(o,i);if(Xn(Ie(n,a),Ie(a,l))<=0&&Xn(Ie(n,a),Ie(a,o))>0)return Xs(a,i);if(Xn(Ie(n,l),Ie(l,r))<=0&&Xn(Ie(n,l),Ie(l,a))>0)return Xs(l,i);if(Xn(Ie(n,i),Ie(r,i))<=0&&Xn(Ie(n,i),Ie(o,i))>0){const d=e.width>e.height?r:o;return Xs(d,i)}else if(Xn(Ie(n,i),Ie(o,i))<=0&&Xn(Ie(n,i),Ie(a,i))>0){const d=e.width>e.height?a:o;return Xs(d,i)}else if(Xn(Ie(n,i),Ie(a,i))<=0&&Xn(Ie(n,i),Ie(l,i))>0){const d=e.width>e.height?a:l;return Xs(d,i)}const c=e.width>e.height?r:l;return Xs(c,i)},G_=(e,t,n)=>{const s=Mg(t);if(e.type==="diamond")return Aie(e,t,n);const r=j1(C(t[0],t[1]),s,2),o=j1(C(t[2],t[1]),s,2),a=j1(C(t[0],t[3]),s,2),l=j1(C(t[2],t[3]),s,2);return T8([r,o,s],n)?ro:T8([o,l,s],n)?Yn:T8([l,a,s],n)?hs:Tr},zB=e=>[e[0]===0?0:e[0]>0?-1:1,e[1]===0?0:e[1]>0?-1:1],X_=1,Pn=40,Mie=(e,t)=>{const n=e.fixedSegments?e.fixedSegments.slice():null;if(n){const i=[];e.points.map(o=>C(e.x+o[0],e.y+o[1])).forEach((o,a,l)=>{if(a<2)return i.push(o);const c=Xs(o,l[a-1]),d=Xs(l[a-1],l[a-2]);if(Kn(c,d)){const u=(n==null?void 0:n.findIndex(h=>h.index===a-1))??-1,f=(n==null?void 0:n.findIndex(h=>h.index===a))??-1;f!==-1&&(n[f].start=C(l[a-2][0]-e.x,l[a-2][1]-e.y)),u!==-1&&n.splice(u,1),i.splice(-1,1),n.forEach(h=>{h.index>a-1&&(h.index-=1)})}return i.push(o)});const s=[];i.forEach((o,a,l)=>{if(a<3)return s.push(o);if(Qe(l[a-2],l[a-1])<X_){const c=(n==null?void 0:n.findIndex(f=>f.index===a-2))??-1,d=(n==null?void 0:n.findIndex(f=>f.index===a-1))??-1;d!==-1&&n.splice(d,1),c!==-1&&n.splice(c,1),s.splice(-2,2),n.forEach(f=>{f.index>a-2&&(f.index-=2)});const u=za(o,l[a-1]);return s.push(C(u?o[0]:l[a-2][0],u?l[a-2][1]:o[1]))}s.push(o)});const r=n.filter(o=>o.index!==1&&o.index!==s.length-1);return r.length===0?el(W_(K_(Y_(e,j_(e,t,s.map(o=>C(o[0]-e.x,o[1]-e.y))))??[])),r,null,null):el(s,r,e.startIsSpecial,e.endIsSpecial)}return{x:e.x,y:e.y,points:e.points,fixedSegments:e.fixedSegments,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}},kie=(e,t,n)=>{var S,x;const i=t.map(k=>k.index),r=(((S=e.fixedSegments)==null?void 0:S.map(k=>k.index))??[]).findIndex(k=>!i.includes(k));if(r===-1||!((x=e.fixedSegments)!=null&&x[r]))return{points:e.points};const o=e.fixedSegments[r].index,a=e.fixedSegments[r-1],l=e.fixedSegments[r+1],c=e.x+(a?a.end[0]:0),d=e.y+(a?a.end[1]:0),u=a?null:e.startBinding,f=l?null:e.endBinding,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredStartElement:b,hoveredEndElement:y,...v}=j_({x:c,y:d,startBinding:u,endBinding:f,startArrowhead:null,endArrowhead:null,points:e.points},n,[C(0,0),C(e.x+((l==null?void 0:l.start[0])??e.points[e.points.length-1][0])-c,e.y+((l==null?void 0:l.start[1])??e.points[e.points.length-1][1])-d)],{isDragging:!1}),{points:_}=el(W_(K_(Y_(e,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredEndElement:y,...v})??[])),t,null,null);if(!_||_.length<2)throw new Error("Property 'points' is required in the update returned by normalizeArrowElementUpdate()");const I=[];if(a)for(let k=0;k<a.index;k++)I.push(C(e.x+e.points[k][0],e.y+e.points[k][1]));if(_.forEach(k=>{I.push(C(e.x+(a?a.end[0]:0)+k[0],e.y+(a?a.end[1]:0)+k[1]))}),l)for(let k=l.index;k<e.points.length;k++)I.push(C(e.x+e.points[k][0],e.y+e.points[k][1]));const R=((l==null?void 0:l.index)??e.points.length)-((a==null?void 0:a.index)??0)-1,T=t.map(k=>k.index>o?{...k,index:k.index-R+(_.length-1)}:k),w=I.flatMap((k,P)=>{const D=I[P-1],j=I[P+1];if(D&&j){const G=Xs(k,D),V=Xs(j,k);if(Kn(G,V))return T.forEach(B=>{B.index>P&&(B.index-=1)}),[];if(Kn(G,zB(V)))return T.forEach(B=>{B.index>P&&(B.index+=1)}),[k,k]}return[k]});return el(w,T,!1,!1)},Rie=(e,t,n,i,s,r)=>{var I,R;const o=t.map((T,w)=>e.fixedSegments==null||e.fixedSegments[w]===void 0||e.fixedSegments[w].index!==T.index||(T.start[0]!==e.fixedSegments[w].start[0]&&T.end[0]!==e.fixedSegments[w].end[0])!=(T.start[1]!==e.fixedSegments[w].start[1]&&T.end[1]!==e.fixedSegments[w].end[1])?w:null).filter(T=>T!==null).shift();if(o==null)return{points:e.points};const a=((I=e.fixedSegments)==null?void 0:I.findIndex(T=>T.index===1))??-1,l=((R=e.fixedSegments)==null?void 0:R.findIndex(T=>T.index===e.points.length-1))??-1,c=Qe(t[o].start,t[o].end),d=c<Pn+5;if(a===-1&&t[o].index===1&&s){const T=Go(n),S=(T?Kn(n,Yn):Kn(n,hs))?d?c/2:Pn:d?-c/2:-40;t[o].start=C(t[o].start[0]+(T?S:0),t[o].start[1]+(T?0:S))}if(l===-1&&t[o].index===e.points.length-1&&r){const T=Go(i),S=(T?Kn(i,Yn):Kn(i,hs))?d?c/2:Pn:d?-c/2:-40;t[o].end=C(t[o].end[0]+(T?S:0),t[o].end[1]+(T?0:S))}const u=t.map(T=>({...T,start:C(e.x+T.start[0],e.y+T.start[1]),end:C(e.x+T.end[0],e.y+T.end[1])})),f=e.points.map((T,w)=>C(e.x+T[0],e.y+T[1])),h=u[o].index-1,m=u[o].index,p=u[o].start,U=u[o].end,b=f[h-1]&&!Uo(f[h],f[h-1])?za(f[h-1],f[h]):void 0,y=f[m+1]&&!Uo(f[m],f[m+1])?za(f[m+1],f[m]):void 0;if(b!==void 0){const T=b?1:0;f[h-1][T]=p[T]}if(f[h]=p,f[m]=U,y!==void 0){const T=y?1:0;f[m+1][T]=U[T]}const v=u.findIndex(T=>T.index===h);if(v!==-1){const T=za(u[v].end,u[v].start)?1:0;u[v].start[T]=p[T],u[v].end=p}const _=u.findIndex(T=>T.index===m+1);if(_!==-1){const T=za(u[_].end,u[_].start)?1:0;u[_].end[T]=U[T],u[_].start=U}if(a===-1&&h===0){const T=s?Go(n):za(f[1],f[0]);f.unshift(C(T?p[0]:e.x+e.points[0][0],T?e.y+e.points[0][1]:p[1])),s&&f.unshift(C(e.x+e.points[0][0],e.y+e.points[0][1]));for(const w of u)w.index+=s?2:1}if(l===-1&&m===e.points.length-1){const T=Go(i);f.push(C(T?U[0]:e.x+e.points[e.points.length-1][0],T?e.y+e.points[e.points.length-1][1]:U[1])),r&&f.push(C(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]))}return el(f,u.map(T=>({...T,start:C(T.start[0]-e.x,T.start[1]-e.y),end:C(T.end[0]-e.x,T.end[1]-e.y)})),!1,!1)},Lie=(e,t,n,i,s,r,o,a,l)=>{let c=e.startIsSpecial??null,d=e.endIsSpecial??null;const u=t.map((U,b)=>b===0||b===t.length-1?C(e.x+U[0],e.y+U[1]):C(e.x+e.points[b][0],e.y+e.points[b][1])),f=n.map(U=>({...U,start:C(e.x+(U.start[0]-t[0][0]),e.y+(U.start[1]-t[0][1])),end:C(e.x+(U.end[0]-t[0][0]),e.y+(U.end[1]-t[0][1]))})),h=[],m=2+(c?1:0),p=2+(d?1:0);for(;h.length+m<u.length-p;)h.push(u[h.length+m]);{const U=u.at(c?2:1),b=u.at(c?3:2);if(!U||!b)throw new Error(`Second and third points must exist when handling endpoint drag (${c})`);const y=Go(i),v=Go(Gh(Ie(U,b)));if(a&&y===v){const _=y?Kn(i,Yn):Kn(i,hs);if(h.unshift(C(v?r[0]+(_?Pn:-40):b[0],v?b[1]:r[1]+(_?Pn:-40))),h.unshift(C(y?r[0]+(_?Pn:-40):r[0],y?r[1]:r[1]+(_?Pn:-40))),!c){c=!0;for(const I of f)I.index>1&&(I.index+=1)}}else if(h.unshift(C(v?r[0]:U[0],v?U[1]:r[1])),c){c=!1;for(const _ of f)_.index>1&&(_.index-=1)}h.unshift(r)}{const U=u.at(u.length-(d?3:2)),b=u.at(u.length-(d?4:3));if(!U||!b)throw new Error(`Second and third to last points must exist when handling endpoint drag (${d})`);const y=Go(s),v=za(b,U);if(l&&y===v){const _=y?Kn(s,Yn):Kn(s,hs);h.push(C(v?o[0]+(_?Pn:-40):b[0],v?b[1]:o[1]+(_?Pn:-40))),h.push(C(y?o[0]+(_?Pn:-40):o[0],y?o[1]:o[1]+(_?Pn:-40))),d||(d=!0)}else h.push(C(v?o[0]:U[0],v?U[1]:o[1])),d&&(d=!1)}return h.push(o),el(h,f.map(({index:U})=>({index:U,start:h[U-1],end:h[U]})).map(U=>({...U,start:C(U.start[0]-r[0],U.start[1]-r[1]),end:C(U.end[0]-r[0],U.end[1]-r[1])})),c,d)},XU=1e6,Cg=(e,t,n,i)=>{var I;if(e.points.length<2)return{points:n.points??e.points};const s=n.fixedSegments??e.fixedSegments??[],r=n.points?n.points&&n.points.length===2?e.points.map((R,T)=>T===0?n.points[0]:T===e.points.length-1?n.points[1]:R):n.points.slice():e.points.slice(),{startBinding:o,endBinding:a,...l}=n,c=typeof o<"u"?o:e.startBinding,d=typeof a<"u"?a:e.endBinding,u=c&&f6(c.elementId,t),f=d&&f6(d.elementId,t),h=VB(r);if(c&&!u&&h||d&&!f&&h||t.size===0&&h||Object.keys(l).length===0&&((u==null?void 0:u.id)!==(c==null?void 0:c.elementId)||(f==null?void 0:f.id)!==(d==null?void 0:d.elementId)))return el(r.map(R=>C(e.x+R[0],e.y+R[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial);const{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredStartElement:y,hoveredEndElement:v,..._}=j_({x:e.x,y:e.y,startBinding:c,endBinding:d,startArrowhead:e.startArrowhead,endArrowhead:e.endArrowhead,points:e.points},t,r,i);return t.size===0&&h?el(r.map(R=>C(e.x+R[0],e.y+R[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial):!n.points&&!n.fixedSegments&&!n.startBinding&&!n.endBinding?Mie(e,t):n.startBinding===e.startBinding&&n.endBinding===e.endBinding&&(n.points??[]).every((R,T)=>Uo(R,e.points[T]??C(1/0,1/0)))&&h?{}:s.length===0?el(W_(K_(Y_(e,{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredEndElement:v,..._})??[])),s,null,null):(((I=e.fixedSegments)==null?void 0:I.length)??0)>s.length?kie(e,s,t):n.points?n.points&&n.fixedSegments?n:Lie(e,r,s,m,p,U,b,y,v):Rie(e,s,m,p,y,v)},j_=(e,t,n,i)=>{var I,R;const s=Bh(n[0],Sn(e.x,e.y)),r=Bh(n[n.length-1],Sn(e.x,e.y));let o=null,a=null;if(i!=null&&i.isDragging){const T=Array.from(t.values());o=rA(s,t,T,i==null?void 0:i.zoom)||null,a=rA(r,t,T,i==null?void 0:i.zoom)||null}else o=e.startBinding&&f6(e.startBinding.elementId,t)||null,a=e.endBinding&&f6(e.endBinding.elementId,t)||null;const l=iA({...e,angle:0,type:"arrow",elbowed:!0,points:n},"start",(I=e.startBinding)==null?void 0:I.fixedPoint,s,o,t,i==null?void 0:i.isDragging),c=iA({...e,angle:0,type:"arrow",elbowed:!0,points:n},"end",(R=e.endBinding)==null?void 0:R.fixedPoint,r,a,t,i==null?void 0:i.isDragging),d=sA(l,c,o,s,t,i==null?void 0:i.zoom),u=sA(c,l,a,r,t,i==null?void 0:i.zoom),f=[l[0]-2,l[1]-2,l[0]+2,l[1]+2],h=[c[0]-2,c[1]-2,c[0]+2,c[1]+2],m=o?ka(o,t,Fl(d,e.startArrowhead?dc(o,{elbowed:!0})*6:dc(o,{elbowed:!0})*2,1)):f,p=a?ka(a,t,Fl(u,e.endArrowhead?dc(a,{elbowed:!0})*6:dc(a,{elbowed:!0})*2,1)):h,U=Kh(l,a?ka(a,t,Fl(u,Pn,Pn)):h)||Kh(c,o?ka(o,t,Fl(d,Pn,Pn)):f),b=HB(U?[f,h]:[m,p]),y=Nie(U?f:m,U?h:p,b,U?Fl(d,!o&&!a?0:Pn,0):Fl(d,!o&&!a?0:Pn-(e.startArrowhead?Kf*6:Kf*2),Pn),U?Fl(u,!o&&!a?0:Pn,0):Fl(u,!o&&!a?0:Pn-(e.endArrowhead?Kf*6:Kf*2),Pn),U,o&&ka(o,t),a&&ka(a,t)),v=nA(y[0],d,l),_=nA(y[1],u,c);return{dynamicAABBs:y,startDonglePosition:v,startGlobalPoint:l,startHeading:d,endDonglePosition:_,endGlobalPoint:c,endHeading:u,commonBounds:b,hoveredStartElement:o,hoveredEndElement:a,boundsOverlap:U,startElementBounds:m,endElementBounds:p}},Y_=(e,t)=>{const{dynamicAABBs:n,startDonglePosition:i,startGlobalPoint:s,startHeading:r,endDonglePosition:o,endGlobalPoint:a,endHeading:l,commonBounds:c,hoveredEndElement:d}=t,u=Oie(n,i||s,r,o||a,l,c),f=i&&jU(i,u),h=o&&jU(o,u),m=jU(a,u);m&&d&&(m.closed=!0);const p=jU(s,u);p&&e.startBinding&&(p.closed=!0);const U=f&&h&&(Kh(f.pos,n[1])||Kh(h.pos,n[0])),b=Die(f||p,h||m,u,r||Yn,l||Yn,U?[]:n);if(b){const y=b.map(v=>[v.pos[0],v.pos[1]]);return f&&y.unshift(s),h&&y.push(a),y}return null},Fl=(e,t,n)=>{switch(e){case ro:return[t,n,n,n];case Yn:return[n,t,n,n];case hs:return[n,n,t,n]}return[n,n,n,t]},Die=(e,t,n,i,s,r)=>{const o=P8(e.pos,t.pos),a=new OJ(l=>l.f);for(a.push(e);a.size()>0;){const l=a.pop();if(!l||l.closed)continue;if(l===t)return Pie(e,l);l.closed=!0;const c=Bie(l.addr,n);for(let d=0;d<4;d++){const u=c[d];if(!u||u.closed)continue;const f=j1(u.pos,l.pos,.5);if(Nte(...r.map(_=>Kh(f,_))))continue;const h=zie(d),m=l.parent?Gh(Ie(l.pos,l.parent.pos)):i,p=zB(m);if(Kn(p,h)||oA(e.addr,u.addr)&&Kn(h,i)||oA(t.addr,u.addr)&&Kn(h,s))continue;const b=m!==h,y=l.g+P8(u.pos,l.pos)+(b?Math.pow(o,3):0),v=u.visited;if(!v||y<u.g){const _=Fie(u,t,h,s);u.visited=!0,u.parent=l,u.h=P8(t.pos,u.pos)+_*Math.pow(o,2),u.g=y,u.f=u.g+u.h,v?a.rescoreElement(u):a.push(u)}}}return null},Pie=(e,t)=>{let n=t;const i=[];for(;n.parent;)i.unshift(n),n=n.parent;return i.unshift(e),i},P8=(e,t)=>Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1]),Nie=(e,t,n,i,s,r,o,a)=>{const l=o??e,c=a??t,[d,u,f,h]=i??[0,0,0,0],[m,p,U,b]=s??[0,0,0,0],y=[e[0]>t[2]?e[1]>t[3]||e[3]<t[1]?Math.min((l[0]+c[2])/2,e[0]-h):(l[0]+c[2])/2:e[0]>t[0]?e[0]-h:n[0]-h,e[1]>t[3]?e[0]>t[2]||e[2]<t[0]?Math.min((l[1]+c[3])/2,e[1]-d):(l[1]+c[3])/2:e[1]>t[1]?e[1]-d:n[1]-d,e[2]<t[0]?e[1]>t[3]||e[3]<t[1]?Math.max((l[2]+c[0])/2,e[2]+u):(l[2]+c[0])/2:e[2]<t[2]?e[2]+u:n[2]+u,e[3]<t[1]?e[0]>t[2]||e[2]<t[0]?Math.max((l[3]+c[1])/2,e[3]+f):(l[3]+c[1])/2:e[3]<t[3]?e[3]+f:n[3]+f],v=[t[0]>e[2]?t[1]>e[3]||t[3]<e[1]?Math.min((c[0]+l[2])/2,t[0]-b):(c[0]+l[2])/2:t[0]>e[0]?t[0]-b:n[0]-b,t[1]>e[3]?t[0]>e[2]||t[2]<e[0]?Math.min((c[1]+l[3])/2,t[1]-m):(c[1]+l[3])/2:t[1]>e[1]?t[1]-m:n[1]-m,t[2]<e[0]?t[1]>e[3]||t[3]<e[1]?Math.max((c[2]+l[0])/2,t[2]+p):(c[2]+l[0])/2:t[2]<e[2]?t[2]+p:n[2]+p,t[3]<e[1]?t[0]>e[2]||t[2]<e[0]?Math.max((c[3]+l[1])/2,t[3]+U):(c[3]+l[1])/2:t[3]<e[3]?t[3]+U:n[3]+U],_=HB([y,v]);if(!r&&y[2]-y[0]+v[2]-v[0]>_[2]-_[0]+1e-11&&y[3]-y[1]+v[3]-v[1]>_[3]-_[1]+1e-11){const[I,R]=[(v[0]+v[2])/2,(v[1]+v[3])/2];if(t[0]>e[2]&&e[1]>t[3]){const T=y[2]+(v[0]-y[2])/2,w=v[3]+(y[1]-v[3])/2;return Xn(Sn(e[2]-I,e[1]-R),Sn(e[0]-I,e[3]-R))>0?[[y[0],y[1],T,y[3]],[T,v[1],v[2],v[3]]]:[[y[0],w,y[2],y[3]],[v[0],v[1],v[2],w]]}else if(e[2]<t[0]&&e[3]<t[1]){const T=y[2]+(v[0]-y[2])/2,w=y[3]+(v[1]-y[3])/2;return Xn(Sn(e[0]-I,e[1]-R),Sn(e[2]-I,e[3]-R))>0?[[y[0],y[1],y[2],w],[v[0],w,v[2],v[3]]]:[[y[0],y[1],T,y[3]],[T,v[1],v[2],v[3]]]}else if(e[0]>t[2]&&e[3]<t[1]){const T=v[2]+(y[0]-v[2])/2,w=y[3]+(v[1]-y[3])/2;return Xn(Sn(e[2]-I,e[1]-R),Sn(e[0]-I,e[3]-R))>0?[[T,y[1],y[2],y[3]],[v[0],v[1],T,v[3]]]:[[y[0],y[1],y[2],w],[v[0],w,v[2],v[3]]]}else if(e[0]>t[2]&&e[1]>t[3]){const T=v[2]+(y[0]-v[2])/2,w=v[3]+(y[1]-v[3])/2;return Xn(Sn(e[0]-I,e[1]-R),Sn(e[2]-I,e[3]-R))>0?[[T,y[1],y[2],y[3]],[v[0],v[1],T,v[3]]]:[[y[0],w,y[2],y[3]],[v[0],v[1],v[2],w]]}}return[y,v]},Oie=(e,t,n,i,s,r)=>{const o=new Set,a=new Set;n===Tr||n===Yn?a.add(t[1]):o.add(t[0]),s===Tr||s===Yn?a.add(i[1]):o.add(i[0]),e.forEach(d=>{o.add(d[0]),o.add(d[2]),a.add(d[1]),a.add(d[3])}),o.add(r[0]),o.add(r[2]),a.add(r[1]),a.add(r[3]);const l=Array.from(a).sort((d,u)=>d-u),c=Array.from(o).sort((d,u)=>d-u);return{row:l.length,col:c.length,data:l.flatMap((d,u)=>c.map((f,h)=>({f:0,g:0,h:0,closed:!1,visited:!1,parent:null,addr:[h,u],pos:[f,d]})))}},nA=(e,t,n)=>{switch(t){case ro:return C(n[0],e[1]);case Yn:return C(e[2],n[1]);case hs:return C(n[0],e[3])}return C(e[0],n[1])},Fie=(e,t,n,i)=>{if(i===Yn)switch(n){case Yn:return e.pos[0]>=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2;case ro:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case hs:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case Tr:return e.pos[1]===t.pos[1]?4:2}else if(i===Tr)switch(n){case Yn:return e.pos[1]===t.pos[1]?4:2;case ro:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case hs:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case Tr:return e.pos[0]<=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2}else if(i===ro)switch(n){case Yn:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case ro:return e.pos[1]>=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case hs:return e.pos[0]===t.pos[0]?4:2;case Tr:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3}else if(i===hs)switch(n){case Yn:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case ro:return e.pos[0]===t.pos[0]?4:2;case hs:return e.pos[1]<=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case Tr:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3}return 0},Bie=([e,t],n)=>[Y1([e,t-1],n),Y1([e+1,t],n),Y1([e,t+1],n),Y1([e-1,t],n)],Y1=([e,t],n)=>e<0||e>=n.col||t<0||t>=n.row?null:n.data[t*n.col+e]??null,jU=(e,t)=>{for(let n=0;n<t.col;n++)for(let i=0;i<t.row;i++){const s=Y1([n,i],t);if(s&&e[0]===s.pos[0]&&e[1]===s.pos[1])return s}return null},HB=e=>[Math.min(...e.map(t=>t[0])),Math.min(...e.map(t=>t[1])),Math.max(...e.map(t=>t[2])),Math.max(...e.map(t=>t[3]))],f6=(e,t)=>{const n=t.get(e);return n&&Lr(n)?n:null},el=(e,t,n,i)=>{const s=e[0][0],r=e[0][1];let o=e.map(a=>Bh(a,vn(Ie(e[0]),-1)));return(s<-1e6||s>XU||r<-1e6||r>XU||s+o[o.length-1][0]<-1e6||r+o[o.length-1][0]>XU||s+o[o.length-1][1]<-1e6||r+o[o.length-1][1]>XU)&&console.error("Elbow arrow normalization is outside reasonable bounds (> 1e6)",{x:s,y:r,points:o,...zh(o)}),o=o.map(([a,l])=>C(Ze(a,-1e6,1e6),Ze(l,-1e6,1e6))),{points:o,x:Ze(s,-1e6,1e6),y:Ze(r,-1e6,1e6),fixedSegments:((t==null?void 0:t.length)??0)>0?t:null,...zh(o),startIsSpecial:n,endIsSpecial:i}},W_=e=>{if(e.length>1){let t=Math.abs(e[0][1]-e[1][1])<Math.abs(e[0][0]-e[1][0]);return e.filter((n,i)=>{if(i===0||i===e.length-1)return!0;const s=e[i+1],r=Math.abs(n[1]-s[1])<Math.abs(n[0]-s[0]);return t===r?(t=r,!1):(t=r,!0)})}return e},K_=e=>e.length>=4?e.filter((t,n)=>{if(n===0||n===e.length-1)return!0;const i=e[n-1];return Qe(i,t)>X_}):e,zie=e=>{switch(e){case 0:return ro;case 1:return Yn;case 2:return hs}return Tr},iA=(e,t,n,i,s,r,o)=>o?s&&r?Z_(e,s,t,r):i:s?tl(n||[0,0],s,r??be([s])):i,sA=(e,t,n,i,s,r)=>Yie(e,t,n,n&&ka(n,s,Array(4).fill(J5(n,s,e))),i,s,r),rA=(e,t,n,i)=>Ci(e,n,t,s=>nu(i)),oA=(e,t)=>e[0]===t[0]&&e[1]===t[1],VB=(e,t=X_)=>e.slice(1).map((n,i)=>Math.abs(n[0]-e[i][0])<t||Math.abs(n[1]-e[i][1])<t).every(Boolean),Cn=(e,t,n,i)=>{let s=!1;const{points:r,fixedSegments:o,fileId:a}=n;ye(e)&&(Object.keys(n).length===0||typeof r<"u"||typeof o<"u")?n={...n,angle:0,...Cg({...e,x:n.x||e.x,y:n.y||e.y},t,n,i)}:typeof r<"u"&&(n={...zh(r),...n});for(const l in n){const c=n[l];if(typeof c<"u"){if(e[l]===c&&(typeof c!="object"||c===null||l==="groupIds"||l==="scale"))continue;if(l==="scale"){const d=e[l],u=c;if(d[0]===u[0]&&d[1]===u[1])continue}else if(l==="points"){const d=e[l],u=c;if(d.length===u.length){let f=!1,h=d.length;for(;--h;){const m=d[h],p=u[h];if(m[0]!==p[0]||m[1]!==p[1]){f=!0;break}}if(!f)continue}}e[l]=c,s=!0}}return s&&((typeof n.height<"u"||typeof n.width<"u"||typeof a<"u"||typeof r<"u")&&sn.delete(e),e.version=n.version??e.version+1,e.versionNonce=n.versionNonce??Hr(),e.updated=xg()),e},Te=(e,t,n=!1)=>{let i=!1;for(const s in t){const r=t[s];if(typeof r<"u"){if(e[s]===r&&(typeof r!="object"||r===null))continue;i=!0}}return!i&&!n?e:{...e,...t,version:t.version??e.version+1,versionNonce:t.versionNonce??Hr(),updated:xg()}},Ha=(e,t)=>(e.version=(t??e.version)+1,e.versionNonce=Hr(),e.updated=xg(),e),$B=10,Kf=5,dc=(e,t)=>(t.elbowed?Kf:$B)+e.strokeWidth/2,nu=e=>{const t=Math.max($B,15),n=e!=null&&e.value&&e.value<1?e.value:1;return Ze(t/(n*1.5),t,t*2)},Hie=e=>!e[$.CTRL_OR_CMD],Va=e=>e.isBindingEnabled,ty=(e,t,n,i,s)=>{const{start:r,end:o}=XB(e,t,n.getNonDeletedElementsMap(),n.getNonDeletedElements(),i,{...s,finalize:!0});if(aA(e,r,"start",n),aA(e,o,"end",n),r.focusPoint||o.focusPoint){const a=new Map;r.focusPoint&&a.set(0,{point:_0(e,"startBinding",e.startBinding,r.element,n.getNonDeletedElementsMap())||e.points[0]}),o.focusPoint&&a.set(e.points.length-1,{point:_0(e,"endBinding",e.endBinding,o.element,n.getNonDeletedElementsMap())||e.points[e.points.length-1]}),re.movePoints(e,n,a)}return{start:r,end:o}},aA=(e,{mode:t,element:n,focusPoint:i},s,r)=>{t===null?Vr(e,s,r):t!==void 0&&mu(e,n,t,s,r,i)},GB=(e,t,n,i,s)=>{xe(t.size===1,"Bound elbow arrows cannot be moved");const r=t.entries().next().value;xe(r,"There should be a position update for dragging an elbow arrow endpoint");const[o,{point:a}]=r,l=re.getPointGlobalCoordinates(e,a,n),c=Ci(l,i,n,f=>nu(s)),d=c?{element:c,mode:"orbit",focusPoint:re.getPointAtIndexGlobalCoordinates(e,o,n)}:{mode:null},u={mode:void 0};return o===0?{start:d,end:u}:{start:u,end:d}},Vie=(e,t,n,i,s,r,o,a,l,c,d)=>{var U,b,y;let u={mode:void 0},f={mode:void 0};const h=e.points.length>2,m=re.getPointGlobalCoordinates(e,t.get(s?o:a).point,n),p=Ci(m,i,n);if(s)return p?u={element:p,mode:"inside",focusPoint:m}:u={mode:null},{start:u,end:f};if(r){const v=(U=l==null?void 0:l.selectedLinearElement)==null?void 0:U.initialState.origin;if(p&&((b=e.startBinding)==null?void 0:b.elementId)===p.id){const _=C(p.x+p.width/2,p.y+p.height/2);return{start:h?{mode:void 0}:{mode:"inside",element:p,focusPoint:v??_},end:h?{mode:"orbit",element:p,focusPoint:m}:{mode:"inside",element:p,focusPoint:m}}}if(p&&e.startBinding){const _=e.startBinding;if($_(m,i,n).find(R=>R.id===_.elementId)){const R=n.get(e.startBinding.elementId);return xe(R,"Other element must be in the elements map"),{start:h?{mode:void 0}:{mode:R.id!==p.id?"orbit":"inside",element:R,focusPoint:v??C(e.x,e.y)},end:{mode:"orbit",element:p,focusPoint:m}}}}if(e.startBinding&&e.startBinding.elementId!==(p==null?void 0:p.id)){const _=n.get(e.startBinding.elementId);xe(_,"Other element must be in the elements map");const R={mode:!!((y=l.selectedLinearElement)!=null&&y.initialState.arrowStartIsInside)?"inside":"orbit",element:_,focusPoint:d?Ti(_,n):v??C(e.x,e.y)},T=p&&BB(_,p,n);let w;if(p){const S=c==="inside"||c==="skip";w={mode:S&&!T?"inside":"orbit",element:p,focusPoint:m}}else w={mode:null};return{start:h?{mode:void 0}:R,end:w}}if(!e.startBinding)return p?f={mode:c==="inside"||c==="skip"?"inside":"orbit",element:p,focusPoint:m}:f={mode:null},{start:u,end:f}}xe(!1,"New arrow creation should not reach here")},lA=(e,t,n,i,s,r,o,a)=>{let l={mode:void 0},c={mode:void 0};const d=o.points.length>2,u=Ci(e,s,i),f=n?$_(e,s,i).some(U=>U.id===n.elementId):!1,h=n?i.get(n.elementId):null,m=f&&h?ms(h.backgroundColor):!1,p=u&&h&&BB(h,u,i);return r==="inside"||r==="skip"?(l=u?{element:!f||!h||m?u:h,focusPoint:e,mode:"inside"}:{mode:null},c=a&&u&&u.id===(n==null?void 0:n.elementId)?{mode:null}:c,{current:l,other:c}):u?u.id===(t==null?void 0:t.elementId)&&t.mode==="inside"?{current:{mode:"inside",focusPoint:e,element:u},other:c}:n?n.elementId===u.id?n.mode==="orbit"?(l={element:u,mode:"orbit",focusPoint:e},c={mode:a?null:void 0},{current:l,other:d?{mode:void 0}:c}):(l={element:u,mode:"inside",focusPoint:e},{current:l,other:d?{mode:void 0}:c}):(f&&h&&!m?l={element:h,mode:"inside",focusPoint:e}:l={element:u,mode:"orbit",focusPoint:e},{current:l,other:d?{mode:void 0}:c}):(l={element:u,mode:"orbit",focusPoint:e},{current:l,other:d?{mode:void 0}:c}):{current:{mode:null},other:c}},XB=(e,t,n,i,s,r)=>ki("COMPLEX_BINDINGS")?Gie(e,t,n,i,s,r):$ie(e,t,n,i,s,r),$ie=(e,t,n,i,s,r)=>{var T,w,S;const a=e.points.length-1,l=t.has(0),c=t.has(a);let d={mode:void 0},u={mode:void 0};if(xe(e.points.length>1,"Do not attempt to bind linear elements with a single point"),!l&&!c)return{start:d,end:u};if(l&&c)return{start:{mode:null},end:{mode:null}};if(!Va(s))return d=l?{mode:null}:d,u=c?{mode:null}:u,{start:d,end:u};if(ye(e))return GB(e,t,n,i,r==null?void 0:r.zoom);const f=l?e.endBinding:e.startBinding,h=(T=t.get(l?0:a))==null?void 0:T.point;xe(h,`Local point must be defined for ${l?"start":"end"} dragging`);const m=re.getPointGlobalCoordinates(e,h,n),p=Ci(m,i,n,x=>nu(s.zoom)),U=p&&ml(m,p,n),b=f?n.get(f.elementId):void 0,y=f&&b&&tl(f.fixedPoint,b,n),v=b&&y&&ml(y,b,n);if(f&&f.elementId===(p==null?void 0:p.id))return xe(!(r!=null&&r.newArrow)||((w=s.selectedLinearElement)==null?void 0:w.initialState.origin),"appState.selectedLinearElement.initialState.origin must be defined for new arrows"),{start:{mode:"inside",element:p,focusPoint:l?m:r!=null&&r.newArrow?s.selectedLinearElement.initialState.origin:re.getPointAtIndexGlobalCoordinates(e,0,n)},end:{mode:"inside",element:p,focusPoint:c?m:re.getPointAtIndexGlobalCoordinates(e,-1,n)}};if(r!=null&&r.altKey)return{start:l?p?{mode:"inside",element:p,focusPoint:m}:{mode:null}:d,end:c?p?{mode:"inside",element:p,focusPoint:m}:{mode:null}:u};const _=p?U?{mode:"inside",element:p,focusPoint:m}:{mode:"orbit",element:p,focusPoint:E0(e,m,p,l?"start":"end",n)||m}:{mode:null},I=re.getPointAtIndexGlobalCoordinates(e,l?-1:0,n),R=b&&!v&&((S=s.selectedLinearElement)!=null&&S.initialState.altFocusPoint)?{mode:"orbit",element:b,focusPoint:s.selectedLinearElement.initialState.altFocusPoint}:r!=null&&r.angleLocked&&b?{mode:"orbit",element:b,focusPoint:E0(e,I,b,l?"end":"start",n)||I}:{mode:void 0};return{start:l?_:R,end:c?_:R}},Gie=(e,t,n,i,s,r)=>{var h,m;const o=s.bindMode||"orbit",a=0,l=e.points.length-1,c=t.has(a),d=t.has(l);let u={mode:void 0},f={mode:void 0};if(xe(e.points.length>1,"Do not attempt to bind linear elements with a single point"),!c&&!d)return{start:u,end:f};if(c&&d)return{start:{mode:null},end:{mode:null}};if(!Va(s))return u=c?{mode:null}:u,f=d?{mode:null}:f,{start:u,end:f};if(ye(e))return GB(e,t,n,i);if(r!=null&&r.newArrow){const{start:p,end:U}=Vie(e,t,n,i,c,d,a,l,s,o,r==null?void 0:r.shiftKey);return{start:p,end:U}}if(c){const p=(h=t.get(a))==null?void 0:h.point;xe(p,"Local point must be defined for start dragging");const U=re.getPointGlobalCoordinates(e,p,n),{current:b,other:y}=lA(U,e.startBinding,e.endBinding,n,i,o,e,r==null?void 0:r.finalize);return{start:b,end:y}}if(d){const p=(m=t.get(l))==null?void 0:m.point;xe(p,"Local point must be defined for end dragging");const U=re.getPointGlobalCoordinates(e,p,n),{current:b,other:y}=lA(U,e.endBinding,e.startBinding,n,i,o,e,r==null?void 0:r.finalize);return{start:y,end:b}}return{start:u,end:f}},y4=(e,t,n)=>{e.forEach(i=>{ty(i,new Map,t,n)})},mu=(e,t,n,i,s,r)=>{const o=s.getNonDeletedElementsMap();let a;ye(e)?a={elementId:t.id,mode:"orbit",...E4(e,t,i,o)}:a={elementId:t.id,mode:n,...Xh(e,t,i,o,r)},s.mutateElement(e,{[i==="start"?"startBinding":"endBinding"]:a}),be(t.boundElements||[]).has(e.id)||s.mutateElement(t,{boundElements:(t.boundElements||[]).concat({id:e.id,type:"arrow"})})},Vr=(e,t,n)=>{var o;const i=t==="start"?"startBinding":"endBinding",s=e[i];if(s==null)return null;const r=e[t==="start"?"endBinding":"startBinding"];if(!r||r.elementId!==s.elementId){const a=n.getNonDeletedElementsMap().get(s.elementId);n.mutateElement(a,{boundElements:(o=a.boundElements)==null?void 0:o.filter(l=>l.id!==e.id)})}return n.mutateElement(e,{[i]:null}),s.elementId},ps=(e,t,n)=>{if(!Lr(e))return;const{simultaneouslyUpdated:i}=n??{},s=jie(i);let r=t.getNonDeletedElementsMap();n!=null&&n.changedElements&&(r=new Map(r),n.changedElements.forEach(o=>{r.set(o.id,o)})),h6(r,e,o=>{if(!_e(o)||o.isDeleted||!Xie(o,e))return;const a=o.startBinding?r.get(o.startBinding.elementId):null,l=o.endBinding?(a==null?void 0:a.id)===o.endBinding.elementId?a:r.get(o.endBinding.elementId):null;if(s.has(o.id))return;const c=g6(r,o,(u,f)=>{var h,m;if(u&&Lr(u)&&(f==="startBinding"||f==="endBinding")&&(e.id===((h=o[f])==null?void 0:h.elementId)||e.id===((m=o[f==="startBinding"?"endBinding":"startBinding"])==null?void 0:m.elementId))){const p=_0(o,f,o[f],u,r);if(p)return[f==="startBinding"?0:o.points.length-1,{point:p}]}return null}).filter(u=>u!==null);re.movePoints(o,t,new Map(c),{moveMidPointsWithElement:!!a&&(a==null?void 0:a.id)===(l==null?void 0:l.id)});const d=Re(o,r);d&&!d.isDeleted&&Lp(o,t,!1)})},v0=(e,t,n,i)=>{_e(e)?ty(e,new Map,t,n):ps(e,t,{...i,changedElements:new Map([[e.id,e]])})},Xie=(e,t)=>{var n,i;return((n=e.startBinding)==null?void 0:n.elementId)===t.id||((i=e.endBinding)==null?void 0:i.elementId)===t.id},jie=e=>new Set((e||[]).map(t=>t.id)),Yie=(e,t,n,i,s,r,o)=>{const a=Gh(Ie(t,e));return!n||!i?a:Wie(s,n,r,o)?G_(n,i,e):Gh(Ie(e,Ti(n,r)))},Wie=(e,t,n,i)=>{const s=J5(t,n,e),r=nu(i);return s>r?null:s},Z_=(e,t,n,i,s)=>{const r=ye(e),o=re.getPointAtIndexGlobalCoordinates(e,n==="start"?0:-1,i);if(e.points.length<2)return o;const a=TB(t)&&r?jB(e,t,i,o):o,l=s&&!r?s[1]:re.getPointAtIndexGlobalCoordinates(e,n==="start"?1:-2,i),c=dc(t,e),d=ka(t,i),u=Mg(d);let f=null;if(r){const h=Go(G_(t,d,o)),m=Kie(e,t,i,a),p=C(h?u[0]:m[0],h?m[1]:u[1]),U=s??ke(p,Pi(vn(uo(Ie(m,p)),Math.max(t.width,t.height)*2),p));if(f=fo(t,i,U,c).sort(p1)[0],!f){const b=C(h?m[0]:u[0],h?u[1]:m[1]),y=ke(b,Pi(vn(uo(Ie(m,b)),Math.max(t.width,t.height)*2),b));f=fo(t,i,y,Kf).sort(p1)[0]}}else{let h=s;if(!h){const m=vn(uo(Ie(a,l)),Qe(a,l)+Math.max(t.width,t.height)+c*2);h=s??ke(Pi(m,l),Pi(vn(m,-1),l))}f=Qe(a,l)<1?a:fo(t,i,h,c).sort((m,p)=>p1(m,l)-p1(p,l))[0]}return!f||p1(a,f)<_p?a:f},jB=(e,t,n,i)=>{const s=Ti(t,n),r=Z(i,s,-t.angle),o=dc(t,e);return r[0]<t.x&&r[1]<t.y?r[1]-t.y>-o?Z(C(t.x-o,t.y),s,t.angle):Z(C(t.x,t.y-o),s,t.angle):r[0]<t.x&&r[1]>t.y+t.height?r[0]-t.x>-o?Z(C(t.x,t.y+t.height+o),s,t.angle):Z(C(t.x-o,t.y+t.height),s,t.angle):r[0]>t.x+t.width&&r[1]>t.y+t.height?r[0]-t.x<t.width+o?Z(C(t.x+t.width,t.y+t.height+o),s,t.angle):Z(C(t.x+t.width+o,t.y+t.height),s,t.angle):r[0]>t.x+t.width&&r[1]<t.y?r[0]-t.x<t.width+o?Z(C(t.x+t.width,t.y-o),s,t.angle):Z(C(t.x+t.width+o,t.y),s,t.angle):i},Kie=(e,t,n,i,s=.05)=>{const{x:r,y:o,width:a,height:l,angle:c}=t,d=Ti(t,n,-.1,-.1),u=Z(i,d,-c),f=dc(t,e),h=Ze(s*l,5,80),m=Ze(s*a,5,80);if(Qe(d,u)<f)return i;if(u[0]<=r+a/2&&u[1]>d[1]-h&&u[1]<d[1]+h)return Z(C(r-f,d[1]),d,c);if(u[1]<=o+l/2&&u[0]>d[0]-m&&u[0]<d[0]+m)return Z(C(d[0],o-f),d,c);if(u[0]>=r+a/2&&u[1]>d[1]-h&&u[1]<d[1]+h)return Z(C(r+a+f,d[1]),d,c);if(u[1]>=o+l/2&&u[0]>d[0]-m&&u[0]<d[0]+m)return Z(C(d[0],o+l+f),d,c);if(t.type==="diamond"){const p=f,U=C(r+a/4-p,o+l/4-p),b=C(r+3*a/4+p,o+l/4-p),y=C(r+a/4-p,o+3*l/4+p),v=C(r+3*a/4+p,o+3*l/4+p);if(Qe(U,u)<Math.max(m,h))return Z(U,d,c);if(Qe(b,u)<Math.max(m,h))return Z(b,d,c);if(Qe(y,u)<Math.max(m,h))return Z(y,d,c);if(Qe(v,u)<Math.max(m,h))return Z(v,d,c)}return i},Zie=(e,t)=>t.width**2+t.height**2-(e.width**2+e.height**2),_0=(e,t,n,i,s,r)=>{if(n==null||n.elementId!==i.id&&e.points.length>2)return null;const o=tl(jh(n.fixedPoint),i,s),a=t==="startBinding"?0:e.points.length-1,l=ye(e),c=t==="startBinding"?e.endBinding:e.startBinding,d=c&&s.get(c.elementId),u=Mn(i,s),f=d&&Mn(d,s),h=d&&Zie(i,d)<(t==="endBinding"?1:0),m=f&&ud(u,f);let p=!1;if(!m&&!l&&e.startBinding&&e.endBinding&&d&&e.points.length===2){const v=tl(e.startBinding.fixedPoint,t==="startBinding"?i:d,s),_=tl(e.endBinding.fixedPoint,t==="endBinding"?i:d,s),I=ke(v,_),R=fo(t==="endBinding"?i:d,s,I,0,!0),T=fo(t==="startBinding"?i:d,s,I,0,!0);R.length>0&&T.length>0&&(p=Qe(R[0],T[0])<40)}const U=(p||m)&&h;let b=r;if(!l&&!b){const[v,_,I,R]=re.getElementAbsoluteCoords(e,s),T=C((v+I)/2,(_+R)/2),w=TB(i)?jB(e,i,s,o):o,S=Z(C(e.x+e.points[a===0?1:e.points.length-2][0],e.y+e.points[a===0?1:e.points.length-2][1]),T,e.angle),x=dc(i,e),k=vn(uo(Ie(w,S)),Qe(w,S)+Math.max(i.width,i.height)+x*2);b=ke(Pi(k,S),Pi(vn(k,-1),S))}const y=n.mode==="orbit"&&i?U?o:Z_({...e,points:[a===0?re.createPointAt(e,s,o[0],o[1],null):e.points[0],...e.points.slice(1,-1),a===e.points.length-1?re.createPointAt(e,s,o[0],o[1],null):e.points[e.points.length-1]]},i,a===0?"start":"end",s,b):o;return re.createPointAt(e,s,y[0],y[1],null)},E4=(e,t,n,i)=>{const s=[t.x,t.y,t.x+t.width,t.y+t.height],r=Z_(e,t,n,i),o=C(s[0]+(s[2]-s[0])/2,s[1]+(s[3]-s[1])/2),a=Z(r,o,-t.angle);return{fixedPoint:jh([(a[0]-t.x)/t.width,(a[1]-t.y)/t.height])}},Xh=(e,t,n,i,s)=>{const r=s||re.getPointAtIndexGlobalCoordinates(e,n==="start"?0:-1,i),o=C(t.x+t.width/2,t.y+t.height/2),a=Z(r,o,-t.angle),l=(a[0]-t.x)/t.width,c=(a[1]-t.y)/t.height;return{fixedPoint:jh([l,c])}},qie=(e,t,n)=>{for(const i of e){if("boundElements"in i&&i.boundElements&&Object.assign(i,{boundElements:i.boundElements.reduce((s,r)=>{const o=t.get(r.id);return o&&s.push({...r,id:o}),s},[])}),"containerId"in i&&i.containerId&&Object.assign(i,{containerId:t.get(i.containerId)??null}),"endBinding"in i&&i.endBinding){const s=t.get(i.endBinding.elementId);Object.assign(i,{endBinding:s?{...i.endBinding,elementId:s}:null})}if("startBinding"in i&&i.startBinding){const s=t.get(i.startBinding.elementId);Object.assign(i,{startBinding:s?{...i.startBinding,elementId:s}:null})}ye(i)&&Object.assign(i,Cg(i,n,{points:[i.points[0],i.points[i.points.length-1]]}))}},YB=(e,t)=>{const n=be(e);for(const i of t)Zf.unbindAffected(n,i,(s,r)=>Cn(s,n,r)),qf.unbindAffected(n,i,(s,r)=>Cn(s,n,r))},Mm=(e,t,n=[])=>{if(!e)return null;const i=e.filter(s=>!t.has(s.id));return i.push(...n.map(s=>({id:s.id,type:s.type}))),i},Qie=new Set(["boundElements","frameId","containerId","startBinding","endBinding"]),h6=(e,t,n)=>{var i;Lr(t)&&(((i=t.boundElements)==null?void 0:i.slice())??[]).forEach(({id:r})=>{n(e.get(r),"boundElements",r)})},g6=(e,t,n)=>{const i=[];if(t.frameId){const s=t.frameId;i.push(n(e.get(s),"frameId",s))}if(Nt(t)){const s=t.containerId;i.push(n(e.get(s),"containerId",s))}if(_e(t)){if(t.startBinding){const s=t.startBinding.elementId;i.push(n(e.get(s),"startBinding",s))}if(t.endBinding){const s=t.endBinding.elementId;i.push(n(e.get(s),"endBinding",s))}}return i};class Zf{static unbindAffected(t,n,i){n&&g6(t,n,s=>{!s||s.isDeleted||h6(t,s,(r,o,a)=>{a===n.id&&i(s,{boundElements:Mm(s.boundElements,new Set([a]))})})})}}F(Zf,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||g6(t,n,(s,r)=>{var o,a;if(!s||s.isDeleted){i(n,{[r]:null});return}r!=="frameId"&&((o=s.boundElements)!=null&&o.find(l=>l.id===n.id)||(_e(n)&&i(s,{boundElements:Mm(s.boundElements,new Set,new Array(n))}),fe(n)&&((a=s.boundElements)!=null&&a.find(l=>l.type==="text")?i(n,{[r]:null}):i(s,{boundElements:Mm(s.boundElements,new Set,new Array(n))}))))})});class qf{static unbindAffected(t,n,i){n&&h6(t,n,s=>{!s||s.isDeleted||g6(t,s,(r,o,a)=>{a===n.id&&i(s,{[o]:null})})})}}F(qf,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||h6(t,n,(s,r,o)=>{var a,l;if(!s||s.isDeleted){i(n,{boundElements:Mm(n.boundElements,new Set([o]))});return}fe(s)&&(((l=(((a=n.boundElements)==null?void 0:a.slice())??[]).reverse().find(d=>d.type==="text"))==null?void 0:l.id)===s.id?s.containerId!==n.id&&i(s,{containerId:n.id}):(s.containerId!==null&&i(s,{containerId:null}),i(n,{boundElements:Mm(n.boundElements,new Set([s.id]))})))})});const tl=(e,t,n)=>{const[i,s]=jh(e);return Z(C(t.x+t.width*i,t.y+t.height*s),Ti(t,n),t.angle)},Jie=(e,t)=>{const n=e.startBinding&&t.get(e.startBinding.elementId),i=e.endBinding&&t.get(e.endBinding.elementId),s=n&&e.startBinding?tl(e.startBinding.fixedPoint,n,t):C(e.x+e.points[0][0],e.y+e.points[0][1]),r=i&&e.endBinding?tl(e.endBinding.fixedPoint,i,t):C(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]);return[s,r]},ese=(e,t)=>{const[n,i]=Jie(e,t);return[re.pointFromAbsoluteCoords(e,n,t),re.pointFromAbsoluteCoords(e,i,t)]},jh=e=>e&&(Math.abs(e[0]-.5)<1e-4||Math.abs(e[1]-.5)<1e-4)?e.map(t=>Math.abs(t-.5)<1e-4?.5001:t):e,N8=({points:e})=>{const t=e[0][0],n=e[0][1];return{points:e.map(i=>C(i[0]-t,i[1]-n)),offsetX:t,offsetY:n}},we=class we{constructor(t,n,i=!1){F(this,"elementId");F(this,"selectedPointsIndices");F(this,"initialState");F(this,"isDragging");F(this,"lastUncommittedPoint");F(this,"lastCommittedPoint");F(this,"pointerOffset");F(this,"hoverPointIndex");F(this,"segmentMidPointHoveredCoords");F(this,"elbowed");F(this,"customLineAngle");F(this,"isEditing");F(this,"pointerDownState");this.elementId=t.id,Uo(t.points[0],C(0,0))||(console.error("Linear element is not normalized",Error().stack),Cn(t,n,we.getNormalizeElementPointsAndCoords(t))),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.lastCommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.initialState={prevSelectedPointsIndices:null,lastClickedPoint:-1,origin:null,segmentMidpoint:{value:null,index:null,added:!1},arrowStartIsInside:!1,altFocusPoint:null},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null,this.elbowed=ye(t)&&t.elbowed,this.customLineAngle=null,this.isEditing=i}static getElement(t,n){const i=n.get(t);return i||null}static handleBoxSelection(t,n,i,s){var p;if(!((p=n.selectedLinearElement)!=null&&p.isEditing)||!n.selectionElement)return!1;const{selectedLinearElement:r}=n,{selectedPointsIndices:o,elementId:a}=r,l=we.getElement(a,s);if(!l)return!1;const[c,d,u,f]=$e(n.selectionElement,s),m=we.getPointsGlobalCoordinates(l,s).reduce((U,b,y)=>((b[0]>=c&&b[0]<=u&&b[1]>=d&&b[1]<=f||t.shiftKey&&(o!=null&&o.includes(y)))&&U.push(y),U),[]).filter(U=>!(ye(l)&&U!==0&&U!==l.points.length-1));i({selectedLinearElement:{...r,selectedPointsIndices:m.length?m:null}})}static handlePointerMove(t,n,i,s,r){var I,R;const o=n.scene.getNonDeletedElementsMap(),a=n.scene.getNonDeletedElements(),{elementId:l}=r,c=we.getElement(l,o);xe(c,"Element being dragged must exist in the scene"),xe(c.points.length>1,"Element must have at least 2 points");const d=c.points.length-1,u=c.points[d],f=c.points[d-1],h=r.customLineAngle??dA(f,c.points[d]);let m=0,p=0;if(ic(t)){const[T,w]=we._getShiftLockedDelta(c,o,f,C(i,s),t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize(),h),S=C(T+f[0],w+f[1]);m=S[0]-u[0],p=S[1]-u[1]}else{const T=we.createPointAt(c,o,i-r.pointerOffset.x,s-r.pointerOffset.y,t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize());m=T[0]-u[0],p=T[1]-u[1]}let U=null;const{positions:b,updates:y}=cA([d],m,p,o,c,a,n,ic(t),t.altKey);if(we.movePoints(c,n.scene,b,{startBinding:y==null?void 0:y.startBinding,endBinding:y==null?void 0:y.endBinding,moveMidPointsWithElement:y==null?void 0:y.moveMidPointsWithElement}),dn(c,!1)&&Va(n.state)&&(U=(y==null?void 0:y.suggestedBinding)??null),dn(c)&&ZA(we.getPointGlobalCoordinates(c,c.points[c.points.length-1],o),c,a,o,n.scene),((I=n.state.selectedLinearElement)==null?void 0:I.customLineAngle)===h&&r.initialState.altFocusPoint&&(!U||vi(n.state.suggestedBinding??[],U)))return null;const v=dn(c)&&c.startBinding&&o.get(c.startBinding.elementId);return{selectedLinearElement:{...r,customLineAngle:h,initialState:{...r.initialState,altFocusPoint:!r.initialState.altFocusPoint&&v&&((R=y==null?void 0:y.suggestedBinding)==null?void 0:R.id)!==v.id?E0(c,C(c.x,c.y),v,"start",o):r.initialState.altFocusPoint}},suggestedBinding:U}}static handlePointDragging(t,n,i,s,r){var z,X;const o=n.scene.getNonDeletedElementsMap(),a=n.scene.getNonDeletedElements(),{elbowed:l,elementId:c,initialState:d}=r,u=Array.from(r.selectedPointsIndices??[]);let{lastClickedPoint:f}=d;const h=we.getElement(c,o);xe(h,"Element being dragged must exist in the scene"),xe(h.points.length>1,"Element must have at least 2 points"),xe(u,"There must be selected points in order to drag them"),l&&u.some((Y,ee)=>Y>0&&Y!==h.points.length-1?(u[ee]=h.points.length-1,f=h.points.length-1,!0):!1),xe(f>-1&&u.includes(f)&&h.points[f],`There must be a valid lastClickedPoint in order to drag it. selectedPointsIndices(${JSON.stringify(u)}) points(0..${h.points.length-1}) lastClickedPoint(${f})`);const m=h.points[f],p=h.points[f===0?1:f-1],U=u.length===1,b=r.customLineAngle??dA(p,h.points[f]),y=u.includes(0),v=u.includes(h.points.length-1);let _=0,I=0;if(ic(t)&&U){const[Y,ee]=we._getShiftLockedDelta(h,o,p,C(i,s),t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize(),b),se=C(Y+p[0],ee+p[1]);_=se[0]-m[0],I=se[1]-m[1]}else{const Y=we.createPointAt(h,o,i-r.pointerOffset.x,s-r.pointerOffset.y,t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize());_=Y[0]-m[0],I=Y[1]-m[1]}let R=null;const{positions:T,updates:w}=cA(u,_,I,o,h,a,n,ic(t)&&U,t.altKey);we.movePoints(h,n.scene,T,{startBinding:w==null?void 0:w.startBinding,endBinding:w==null?void 0:w.endBinding,moveMidPointsWithElement:w==null?void 0:w.moveMidPointsWithElement}),dn(h,!1)&&Va(n.state)&&(y||v)&&(R=(w==null?void 0:w.suggestedBinding)??null),dn(h)&&y!==v&&ZA(we.getPointGlobalCoordinates(h,y?h.points[0]:h.points[h.points.length-1],o),h,a,o,n.scene),Re(h,o)&&Lp(h,n.scene,!1);const x=l?v?[h.points.length-1]:[0]:u,k=l?x[0]:f,P=!y&&!v?we.getPointGlobalCoordinates(h,m,o):null,D=k,j=dn(h)&&h.startBinding&&o.get(h.startBinding.elementId),G=dn(h)&&h.endBinding&&o.get(h.endBinding.elementId),V=v&&j&&((z=w==null?void 0:w.suggestedBinding)==null?void 0:z.id)!==j.id?j:y&&G&&((X=w==null?void 0:w.suggestedBinding)==null?void 0:X.id)!==G.id?G:null;return{selectedLinearElement:{...r,selectedPointsIndices:x,initialState:{...r.initialState,lastClickedPoint:k,altFocusPoint:!r.initialState.altFocusPoint&&dn(h)&&V?E0(h,C(h.x,h.y),V,"start",o):r.initialState.altFocusPoint},segmentMidPointHoveredCoords:P,hoverPointIndex:D,isDragging:!0,customLineAngle:b},suggestedBinding:R}}static handlePointerUp(t,n,i,s){var u;const r=s.getNonDeletedElementsMap(),{elementId:o,selectedPointsIndices:a,isDragging:l,initialState:c}=n,d=we.getElement(o,r);if(!d)return n;if(l&&a)for(const f of a)(f===0||f===d.points.length-1)&&sa(d.points,i.zoom.value)&&(nn(d)&&s.mutateElement(d,{...aw(d,!0)},{informMutation:!1,isDragging:!1}),we.movePoints(d,s,new Map([[f,{point:f===0?d.points[d.points.length-1]:d.points[0]}]])));return{...n,segmentMidPointHoveredCoords:null,hoverPointIndex:-1,selectedPointsIndices:l||t.shiftKey?!l&&t.shiftKey&&((u=c.prevSelectedPointsIndices)!=null&&u.includes(c.lastClickedPoint))?a&&a.filter(f=>f!==c.lastClickedPoint):a:a!=null&&a.includes(c.lastClickedPoint)?[c.lastClickedPoint]:a,isDragging:!1,pointerOffset:{x:0,y:0},customLineAngle:null,initialState:{...n.initialState,origin:null,arrowStartIsInside:!1}}}static isSegmentTooShort(t,n,i,s,r){if(ye(t))return s>=0&&s<t.points.length?Qe(n,i)*r.value<we.POINT_HANDLE_SIZE/2:!1;let o=Qe(n,i);if(t.points.length>2&&t.roundness){const[a,l]=c6(t);xe(a.length===0&&l.length>0,"Only linears built out of curves are supported"),xe(a.length+l.length>=s,"Invalid segment index while calculating mid point"),o=A_(l[s])}return o*r.value<we.POINT_HANDLE_SIZE*4}static getSegmentMidPoint(t,n){if(ye(t)){xe(t.points.length>=n,"Invalid segment index while calculating elbow arrow mid point");const r=e6(t.points[n-1],t.points[n]);return C(t.x+r[0],t.y+r[1])}const[i,s]=c6(t);if(xe(i.length===0&&s.length>0||i.length>0&&s.length===0,"Only linears built out of either segments or curves are supported"),xe(i.length+s.length>=n,"Invalid segment index while calculating mid point"),i.length){const r=i[n-1];return e6(r[0],r[1])}if(s.length){const r=s[n-1];return ate(r,.5)}xe(!1,"Invalid segment type while calculating mid point")}static getSegmentMidPointIndex(t,n,i,s){const r=we.getElement(t.elementId,s);if(!r)return-1;const o=we.getEditorMidPoints(r,s,n);let a=0;for(;a<o.length;){if(we.arePointsEqual(i,o[a]))return a+1;a++}return-1}static handlePointerDown(t,n,i,s,r,o){var w,S;const a=n.state,l=o.getNonDeletedElementsMap(),c={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!r)return c;const{elementId:d}=r,u=we.getElement(d,l);if(!u)return c;const f=we.getSegmentMidpointHitCoords(r,s,a,l),h=C(s.x,s.y);let m=null;if(f)m=we.getSegmentMidPointIndex(r,a,f,l);else if(t.altKey&&((w=a.selectedLinearElement)!=null&&w.isEditing))return r.lastUncommittedPoint==null&&(o.mutateElement(u,{points:[...u.points,we.createPointAt(u,l,s.x,s.y,t[$.CTRL_OR_CMD]?null:n.getEffectiveGridSize())]}),c.didAddPoint=!0),i.scheduleCapture(),c.linearElementEditor={...r,initialState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:-1,origin:h,segmentMidpoint:{value:f,index:m,added:!1},arrowStartIsInside:!!n.state.newElement&&(n.state.bindMode==="inside"||n.state.bindMode==="skip"),altFocusPoint:null},selectedPointsIndices:[u.points.length-1],lastUncommittedPoint:null},c.didAddPoint=!0,c;const p=we.getPointIndexUnderCursor(u,l,a.zoom,s.x,s.y);(p>=0||f)&&(c.hitElement=u);const[U,b,y,v]=$e(u,l),_=(U+y)/2,I=(b+v)/2,R=p>-1&&Z(C(u.x+u.points[p][0],u.y+u.points[p][1]),C(_,I),u.angle),T=p>-1||t.shiftKey?t.shiftKey||(S=r.selectedPointsIndices)!=null&&S.includes(p)?tse([...r.selectedPointsIndices||[],p]):[p]:null;return c.linearElementEditor={...r,initialState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:p,origin:h,segmentMidpoint:{value:f,index:m,added:!1},arrowStartIsInside:!!n.state.newElement&&(n.state.bindMode==="inside"||n.state.bindMode==="skip"),altFocusPoint:null},selectedPointsIndices:T,pointerOffset:R?{x:s.x-R[0],y:s.y-R[1]}:{x:0,y:0}},c}static arePointsEqual(t,n){return!t&&!n?!0:!t||!n?!1:Uo(t,n)}static handlePointerMoveInEditMode(t,n,i,s){var h,m;const r=s.state;if(!((h=r.selectedLinearElement)!=null&&h.isEditing))return null;const{elementId:o,lastUncommittedPoint:a}=r.selectedLinearElement,l=s.scene.getNonDeletedElementsMap(),c=we.getElement(o,l);if(!c)return r.selectedLinearElement;const{points:d}=c,u=d[d.length-1];if(!t.altKey)return u===a&&we.deletePoints(c,s,[d.length-1]),(m=r.selectedLinearElement)!=null&&m.lastUncommittedPoint?{...r.selectedLinearElement,lastUncommittedPoint:null}:r.selectedLinearElement;let f;if(ic(t)&&d.length>=2){const p=d[d.length-2],[U,b]=we._getShiftLockedDelta(c,l,p,C(n,i),t[$.CTRL_OR_CMD]?null:s.getEffectiveGridSize());f=C(U+p[0],b+p[1])}else f=we.createPointAt(c,l,n-r.selectedLinearElement.pointerOffset.x,i-r.selectedLinearElement.pointerOffset.y,t[$.CTRL_OR_CMD]||ye(c)?null:s.getEffectiveGridSize());return u===a?we.movePoints(c,s.scene,new Map([[c.points.length-1,{point:f}]])):we.addPoints(c,s.scene,[f]),{...r.selectedLinearElement,lastUncommittedPoint:c.points[c.points.length-1]}}static getPointGlobalCoordinates(t,n,i){const[s,r,o,a]=$e(t,i),l=(s+o)/2,c=(r+a)/2,{x:d,y:u}=t;return Z(C(d+n[0],u+n[1]),C(l,c),t.angle)}static getPointsGlobalCoordinates(t,n){const[i,s,r,o]=$e(t,n),a=(i+r)/2,l=(s+o)/2;return t.points.map(c=>{const{x:d,y:u}=t;return Z(C(d+c[0],u+c[1]),C(a,l),t.angle)})}static getPointAtIndexGlobalCoordinates(t,n,i){const s=n<0?t.points.length+n:n,[,,,,r,o]=$e(t,i),a=C(r,o),l=t.points[s],{x:c,y:d}=t;return Z(l?C(c+l[0],d+l[1]):C(c,d),a,t.angle)}static pointFromAbsoluteCoords(t,n,i){if(ye(t))return C(n[0]-t.x,n[1]-t.y);const[s,r,o,a]=$e(t,i),l=(s+o)/2,c=(r+a)/2,[d,u]=Z(C(n[0],n[1]),C(l,c),-t.angle);return C(d-t.x,u-t.y)}static getPointIndexUnderCursor(t,n,i,s,r){const o=we.getPointsGlobalCoordinates(t,n);let a=o.length;for(;--a>-1;){const l=o[a];if(Qe(C(s,r),C(l[0],l[1]))*i.value<we.POINT_HANDLE_SIZE+1)return a}return-1}static createPointAt(t,n,i,s,r){const o=ti(i,s,r),[a,l,c,d]=$e(t,n),u=(a+c)/2,f=(l+d)/2,[h,m]=Z(C(o[0],o[1]),C(u,f),-t.angle);return C(h-t.x,m-t.y)}static getNormalizeElementPointsAndCoords(t){const{points:n,offsetX:i,offsetY:s}=N8(t);return{points:n,x:t.x+i,y:t.y+s}}static duplicateSelectedPoints(t,n){var f;xe((f=t.selectedLinearElement)==null?void 0:f.isEditing,"Not currently editing a linear element");const i=n.getNonDeletedElementsMap(),{selectedPointsIndices:s,elementId:r}=t.selectedLinearElement,o=we.getElement(r,i);xe(o,"The linear element does not exist in the provided Scene"),xe(s!=null,"There are no selected points to duplicate");const{points:a}=o,l=[];let c=!1,d=-1;const u=a.reduce((h,m,p)=>{if(++d,h.push(m),s.includes(p)){const b=a[p+1];b||(c=!0),h.push(b?C((m[0]+b[0])/2,(m[1]+b[1])/2):C(m[0],m[1])),l.push(d+1),++d}return h},[]);if(n.mutateElement(o,{points:u}),c){const h=o.points[o.points.length-1];we.movePoints(o,n,new Map([[o.points.length-1,{point:C(h[0]+30,h[1]+30)}]]))}return{...t,selectedLinearElement:{...t.selectedLinearElement,selectedPointsIndices:l}}}static deletePoints(t,n,i){var d,u;const s=((d=n.state.selectedLinearElement)==null?void 0:d.isEditing)&&((u=n.state.selectedLinearElement)==null?void 0:u.lastUncommittedPoint)===t.points[t.points.length-1],r=t.points.filter((f,h)=>!i.includes(h));nn(t)&&t.polygon&&(s||i.includes(0)||i.includes(t.points.length-1))&&(r[0]=C(r[r.length-1][0],r[r.length-1][1]));const{points:a,offsetX:l,offsetY:c}=N8({points:r});we._updatePoints(t,n.scene,a,l,c)}static addPoints(t,n,i){const s=[...t.points,...i];nn(t)&&t.polygon&&(s[0]=C(s[s.length-1][0],s[s.length-1][1]));const{points:r,offsetX:o,offsetY:a}=N8({points:s});we._updatePoints(t,n,r,o,a)}static movePoints(t,n,i,s){var d,u,f;const{points:r}=t;if(nn(t)&&t.polygon){const h=i.get(0),m=i.get(r.length-1);h?i.set(r.length-1,{point:C(h.point[0],h.point[1]),isDragging:h.isDragging}):m&&i.set(0,{point:C(m.point[0],m.point[1]),isDragging:m.isDragging})}const o=((d=i.get(0))==null?void 0:d.point)??C(0,0),[a,l]=o,c=ye(t)?[((u=i.get(0))==null?void 0:u.point)??r[0],((f=i.get(r.length-1))==null?void 0:f.point)??r[r.length-1]]:r.map((h,m)=>{var U;const p=((U=i.get(m))==null?void 0:U.point)??h;return s!=null&&s.moveMidPointsWithElement&&m!==0&&m!==r.length-1&&!i.has(m)?p:C(p[0]-a,p[1]-l)});we._updatePoints(t,n,c,a,l,s,{isDragging:Array.from(i.values()).some(h=>h.isDragging)})}static shouldAddMidpoint(t,n,i,s){var c;const r=we.getElement(t.elementId,s);if(r&&ye(r)||!r)return!1;const{segmentMidpoint:o}=t.initialState;if(o.added||o.value===null||o.index===null||t.initialState.origin===null)return!1;const a=t.initialState.origin,l=Qe(a,C(n.x,n.y));return!(!((c=i.selectedLinearElement)!=null&&c.isEditing)&&l<g0/i.zoom.value)}static addMidpoint(t,n,i,s,r){const o=r.getNonDeletedElementsMap(),a=we.getElement(t.elementId,o);if(!a)return;const{segmentMidpoint:l}=t.initialState,c={pointerDownState:t.initialState,selectedPointsIndices:t.selectedPointsIndices},d=we.createPointAt(a,o,n.x,n.y,s&&!ye(a)?i.getEffectiveGridSize():null),u=[...a.points.slice(0,l.index),d,...a.points.slice(l.index)];return r.mutateElement(a,{points:u}),c.pointerDownState={...t.initialState,segmentMidpoint:{...t.initialState.segmentMidpoint,added:!0},lastClickedPoint:l.index},c.selectedPointsIndices=[l.index],c}static _updatePoints(t,n,i,s,r,o,a){if(ye(t)){const l={};(o==null?void 0:o.startBinding)!==void 0&&(l.startBinding=o.startBinding),(o==null?void 0:o.endBinding)!==void 0&&(l.endBinding=o.endBinding),l.points=Array.from(i),n.mutateElement(t,l,{informMutation:!0,isDragging:(a==null?void 0:a.isDragging)??!1})}else{const l=IA(t,i),c=IA(t,t.points),d=(l[0]+l[2])/2,u=(l[1]+l[3])/2,f=(c[0]+c[2])/2,h=(c[1]+c[3])/2,m=f-d,p=h-u,U=Z(C(s,r),C(m,p),t.angle);n.mutateElement(t,{...o,points:i,x:t.x+U[0],y:t.y+U[1]})}}static _getShiftLockedDelta(t,n,i,s,r,o){const a=we.getPointGlobalCoordinates(t,i,n);if(ye(t))return[s[0]-a[0],s[1]-a[1]];const[l,c]=ti(s[0],s[1],r),{width:d,height:u}=Xse(a[0],a[1],l,c,o);return Z(C(d,u),C(0,0),-t.angle)}static moveFixedSegment(t,n,i,s,r){const o=r.getNonDeletedElementsMap(),a=we.getElement(t.elementId,o);if(!a||!ye(a))return t;if(n&&n>0&&n<a.points.length){const l=Go(Gh(Ie(a.points[n],a.points[n-1]))),c=(a.fixedSegments??[]).reduce((h,m)=>(h[m.index]=m,h),{});c[n]={index:n,start:C(l?a.points[n-1][0]:i-a.x,l?s-a.y:a.points[n-1][1]),end:C(l?a.points[n][0]:i-a.x,l?s-a.y:a.points[n][1])};const d=Object.values(c).sort((h,m)=>h.index-m.index),u=d.map(h=>h.index).reduce((h,m)=>m<n?h+1:h,0);r.mutateElement(a,{fixedSegments:d});const f=C(a.x+(a.fixedSegments[u].start[0]+a.fixedSegments[u].end[0])/2,a.y+(a.fixedSegments[u].start[1]+a.fixedSegments[u].end[1])/2);return{...t,segmentMidPointHoveredCoords:f,initialState:{...t.initialState,segmentMidpoint:{added:!1,index:a.fixedSegments[u].index,value:f}}}}return t}static deleteFixedSegment(t,n,i){var s;n.mutateElement(t,{fixedSegments:(s=t.fixedSegments)==null?void 0:s.filter(r=>r.index!==i)})}};F(we,"POINT_HANDLE_SIZE",10),F(we,"getEditorMidPoints",(t,n,i)=>{var l;const s=Re(t,n);if(!ye(t)&&!((l=i.selectedLinearElement)!=null&&l.isEditing)&&t.points.length>2&&!s)return[];const r=we.getPointsGlobalCoordinates(t,n);let o=0;const a=[];for(;o<r.length-1;){if(we.isSegmentTooShort(t,t.points[o],t.points[o+1],o,i.zoom)){a.push(null),o++;continue}const c=we.getSegmentMidPoint(t,o+1);a.push(c),o++}return a}),F(we,"getSegmentMidpointHitCoords",(t,n,i,s)=>{var h;const{elementId:r}=t,o=we.getElement(r,s);if(!o)return null;const a=we.getPointIndexUnderCursor(o,s,i.zoom,n.x,n.y);if(!ye(o)&&a>=0||we.getPointsGlobalCoordinates(o,s).length>=3&&!((h=i.selectedLinearElement)!=null&&h.isEditing)&&!ye(o))return null;const c=(we.POINT_HANDLE_SIZE+1)/i.zoom.value,d=t.segmentMidPointHoveredCoords;if(d&&Qe(C(d[0],d[1]),C(n.x,n.y))<=c)return d;let u=0;const f=we.getEditorMidPoints(o,s,i);for(;u<f.length;){if(f[u]!==null&&Qe(f[u],C(n.x,n.y))<=c)return f[u];u++}return null}),F(we,"getBoundTextElementPosition",(t,n,i)=>{we.getPointsGlobalCoordinates(t,i).length<2&&Cn(n,i,{isDeleted:!0});let r=0,o=0;if(t.points.length%2===1){const a=Math.floor(t.points.length/2),l=we.getPointGlobalCoordinates(t,t.points[a],i);r=l[0]-n.width/2,o=l[1]-n.height/2}else{const a=t.points.length/2-1,l=we.getSegmentMidPoint(t,a+1);r=l[0]-n.width/2,o=l[1]-n.height/2}return{x:r,y:o}}),F(we,"getMinMaxXYWithBoundText",(t,n,i,s)=>{let[r,o,a,l]=i;const c=(r+a)/2,d=(o+l)/2,{x:u,y:f}=we.getBoundTextElementPosition(t,s,n),h=u+s.width,m=f+s.height,p=C(c,d),U=Z(C(r,o),p,t.angle),b=Z(C(a,o),p,t.angle),y=Z(C(u,f),p,-t.angle),v=Z(C(h,f),p,-t.angle),_=Z(C(u,m),p,-t.angle),I=Z(C(h,m),p,-t.angle);return U[0]<b[0]&&U[1]>=b[1]?(r=Math.min(r,_[0]),a=Math.max(a,Math.max(v[0],I[0])),o=Math.min(o,y[1]),l=Math.max(l,I[1])):U[0]>=b[0]&&U[1]>b[1]?(r=Math.min(r,I[0]),a=Math.max(a,Math.max(y[0],v[0])),o=Math.min(o,_[1]),l=Math.max(l,v[1])):U[0]>=b[0]?(r=Math.min(r,v[0]),a=Math.max(a,_[0]),o=Math.min(o,I[1]),l=Math.max(l,y[1])):U[1]<=b[1]&&(r=Math.min(r,Math.min(v[0],y[0])),a=Math.max(a,I[0]),o=Math.min(o,v[1]),l=Math.max(l,_[1])),[r,o,a,l,c,d]}),F(we,"getElementAbsoluteCoords",(t,n,i=!1)=>{const s=sn.generateElementShape(t,null),r=Vu(s[0]),[o,a,l,c]=ay(r),d=o+t.x,u=a+t.y,f=l+t.x,h=c+t.y,m=(d+f)/2,p=(u+h)/2,U=i&&Re(t,n);return U?we.getMinMaxXYWithBoundText(t,n,[d,u,f,h],U):[d,u,f,h,m,p]});let re=we;const tse=e=>{let t=[...new Set(e.filter(n=>n!==null&&n!==-1))];return t=t.sort((n,i)=>n-i),t.length?t:null},cA=(e,t,n,i,s,r,o,a,l)=>{const c=new Map(e.map(D=>[D,{point:C(s.points[D][0]+t,s.points[D][1]+n),isDragging:!0}]));if(!_e(s))return{positions:c};const d=e.includes(0),u=e.includes(s.points.length-1),{start:f,end:h}=XB(s,c,i,r,o.state,{newArrow:!!o.state.newElement,angleLocked:a,altKey:l});if(ye(s))return{positions:c,updates:{suggestedBinding:d?f.element:u?h.element:null}};if(d===u)return{positions:c};const m={suggestedBinding:null};f.mode===null?m.startBinding=null:f.mode?(m.startBinding={elementId:f.element.id,mode:f.mode,...Xh(s,f.element,"start",i,f.focusPoint)},d&&(m.startBinding.mode==="orbit"||!ki("COMPLEX_BINDINGS"))&&(m.suggestedBinding=f.element)):d&&(m.suggestedBinding=o.state.suggestedBinding),h.mode===null?m.endBinding=null:h.mode?(m.endBinding={elementId:h.element.id,mode:h.mode,...Xh(s,h.element,"end",i,h.focusPoint)},u&&(m.endBinding.mode==="orbit"||!ki("COMPLEX_BINDINGS"))&&(m.suggestedBinding=h.element)):u&&(m.suggestedBinding=o.state.suggestedBinding);const p=d?C(s.points[0][0]+t,s.points[0][1]+n):s.points[0],U=u?C(s.points[s.points.length-1][0]+t,s.points[s.points.length-1][1]+n):s.points[s.points.length-1],b={...s,points:[p,...s.points.slice(1,-1),U],startBinding:m.startBinding===void 0?s.startBinding:m.startBinding===null?null:m.startBinding,endBinding:m.endBinding===void 0?s.endBinding:m.endBinding===null?null:m.endBinding},y=f.focusPoint&&h.focusPoint?ke(f.focusPoint,h.focusPoint):void 0,v=s.endBinding&&b.startBinding&&d&&b.startBinding.elementId===s.endBinding.elementId,_=s.startBinding&&b.endBinding&&u&&s.startBinding.elementId===b.endBinding.elementId,I=b.endBinding?h.element??i.get(b.endBinding.elementId):null,R=v?b.points[b.points.length-1]:_&&o.state.bindMode!=="inside"&&ki("COMPLEX_BINDINGS")?b.points[0]:I&&_0(s,"endBinding",b.endBinding,I,i,y)||b.points[b.points.length-1];b.points[b.points.length-1]=R;const T=b.startBinding?f.element??i.get(b.startBinding.elementId):null,w=_&&ki("COMPLEX_BINDINGS")?b.points[0]:v&&o.state.bindMode!=="inside"&&ki("COMPLEX_BINDINGS")?b.points[b.points.length-1]:T&&_0(s,"startBinding",b.startBinding,T,i,y)||b.points[0],S=Qe(R,b.points[b.points.length-1])!==0,x=Qe(w,b.points[0])!==0,k=new Set(e);T&&x&&k.add(0),I&&S&&k.add(s.points.length-1);const P=Array.from(k);return{updates:m.startBinding||m.suggestedBinding?{startBinding:m.startBinding,suggestedBinding:m.suggestedBinding}:void 0,positions:new Map(P.map(D=>[D,D===0?{point:w,isDragging:!0}:D===s.points.length-1?{point:R,isDragging:!0}:c.get(D)]))}},dA=(e,t)=>Math.atan2(t[1]-e[1],t[0]-e[0]);function uA(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function nse(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}const ise=1e-6;function fA(e,t){const n=Ie(e[1],e[0]),i=Ie(t,e[0]),s=Xn(n,i);return Math.abs(s)<ise}function O8(e,t){const n=Ie(e[1],e[0]),i=Ie(t,e[0]);return Xn(n,i)<0}function hA(e,t){return fA(e,t[0])||fA(e,t[1])||(O8(e,t[0])?!O8(e,t[1]):O8(e,t[1]))}function sse(e,t){return nse(uA(e),uA(t))&&hA(e,t)&&hA(t,e)}const rse=e=>e.type==="diamond"?[C(e.width/2,0),C(e.width,e.height/2),C(e.width/2,e.height),C(0,e.height/2)]:[C(0,0),C(0+e.width,0),C(0+e.width,e.height),C(0,e.height)],ose=e=>Ce(e)||ts(e)?e.points:rse(e),gA=e=>{const t=e.reduce((n,[i,s])=>(n.minY=Math.min(n.minY,s),n.minX=Math.min(n.minX,i),n.maxX=Math.max(n.maxX,i),n.maxY=Math.max(n.maxY,s),n),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return t.cx=(t.maxX+t.minX)/2,t.cy=(t.maxY+t.minY)/2,t},ase=e=>{const t=ose(e),{cx:n,cy:i}=gA(t),s=C(n,i),r=t.map(d=>Z(d,s,e.angle)),{minX:o,minY:a,maxX:l,maxY:c}=gA(r);return[o+e.x,a+e.y,l+e.x,c+e.y]},lse=(e,t)=>{const n=ase(e);return(BU(n[0],Yi(t[0],t[2]))||BU(t[0],Yi(n[0],n[2])))&&(BU(n[1],Yi(t[1],t[3]))||BU(t[1],Yi(n[1],n[3])))},cse=({elements:e,bounds:t,type:n,errorMargin:i=0})=>{var o;IB(t)&&(t=Mn(t,be(e)));const s=[t[0]-i,t[1]-i,t[2]+i,t[3]+i],r=new Set;for(const a of e){if(r.has(a.id))continue;if(lse(a,s)){if(r.add(a.id),a.boundElements)for(const c of a.boundElements)r.add(c.id);fe(a)&&a.containerId&&r.add(a.containerId),_e(a)&&(a.startBinding&&r.add(a.startBinding.elementId),a.endBinding&&r.add((o=a.endBinding)==null?void 0:o.elementId))}}return e.filter(a=>r.has(a.id))},WB=(e,t,n)=>{const i=n.reduce((s,r)=>(r.groupIds.includes(e)&&(s[r.id]=!0),s),{});return Object.keys(i).length<2?t.selectedGroupIds[e]||t.editingGroupId===e?{selectedElementIds:t.selectedElementIds,selectedGroupIds:{...t.selectedGroupIds,[e]:!1},editingGroupId:null}:t:{editingGroupId:t.editingGroupId,selectedGroupIds:{...t.selectedGroupIds,[e]:!0},selectedElementIds:{...t.selectedElementIds,...i}}},xi=function(){let e=null,t=null,n=null;const i=(r,o,a,l)=>{if(n!==void 0&&o===t&&r===e&&a.editingGroupId===(n==null?void 0:n.editingGroupId))return n;const c={};for(const f of r){let h=f.groupIds;if(a.editingGroupId){const m=h.indexOf(a.editingGroupId);m>-1&&(h=h.slice(0,m))}if(h.length>0){const m=h[h.length-1];c[m]=!0}}const d={},u=o.reduce((f,h)=>{if(h.isDeleted)return f;const m=h.groupIds.find(p=>c[p]);return m&&(f[h.id]=!0,Array.isArray(d[m])?d[m].push(h.id):d[m]=[h.id]),f},{});for(const f of Object.keys(d))d[f].length<2&&c[f]&&(c[f]=!1);return t=o,e=r,n={editingGroupId:a.editingGroupId,selectedGroupIds:c,selectedElementIds:vt({...a.selectedElementIds,...u},l)},n},s=(r,o,a,l)=>{const c=l?l.scene.getSelectedElements({selectedElementIds:r.selectedElementIds,elements:o}):Ye(o,r);return c.length?i(c,o,r,a):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:vt(r.selectedElementIds,a)}};return s.clearCache=()=>{t=null,e=null,n=null},s}(),q_=(e,t)=>KB(e,t)!=null,KB=(e,t)=>t.groupIds.filter(n=>n!==e.editingGroupId).find(n=>e.selectedGroupIds[n]),Ic=e=>Object.entries(e.selectedGroupIds).filter(([t,n])=>n).map(([t,n])=>t),Pp=(e,t)=>{let n={...t,selectedGroupIds:{}};for(const i of e){let s=i.groupIds;if(t.editingGroupId){const r=s.indexOf(t.editingGroupId);r>-1&&(s=s.slice(0,r))}if(s.length>0){const r=s[s.length-1];n={...n,...WB(r,n,e)}}}return n.selectedGroupIds},dse=(e,t)=>({...e,editingGroupId:t.groupIds.length?t.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[t.id]:!0}}),w0=(e,t)=>e.groupIds.includes(t),Lt=(e,t)=>{const n=[];for(const i of e.values())w0(i,t)&&n.push(i);return n},ZB=(e,t)=>e.groupIds.find(n=>t[n]),use=(e,t,n)=>{const i=[...e],s=n?i.indexOf(n):-1,r=s>-1?s:i.length;return i.splice(r,0,t),i},fse=(e,t)=>e.filter(n=>!t[n]),qB=(e,t)=>{const n=new Map;return e.forEach(i=>{const s=i.groupIds.length===0?i.id:i.groupIds[i.groupIds.length-1],r=n.get(s)||[],o=Re(i,t);o&&r.push(o),n.set(s,[...r,i])}),Array.from(n.values())},hse=e=>{const t=new Set;for(const[,n]of e)if(!n.isDeleted)for(const i of n.groupIds??[])t.add(i);return t},Q_=e=>{const t=e.flatMap(s=>s.groupIds),n=new Map;let i=0;for(const s of t)n.set(s,(n.get(s)??0)+1),n.get(s)>i&&(i=n.get(s));return i===e.length},Yh=e=>e.groupIds.length>0,gse=(e,t,n)=>{const i=[...e],s=t?e.indexOf(t):-1,r=s>-1?s:e.length;for(let o=0;o<r;o++)i[o]=n(i[o]);return i},ny=(e,t,n)=>{const i=Ic(n),s=e.filter(u=>!Nt(u)),r=new Map,o=new Map,a=u=>{const f=o.get(u.id)||[],h=Re(u,t);h&&f.push(h),o.set(u.id,[...f,u])},l=(u,f)=>{const h=r.get(f)||[],m=Re(u,t);m&&h.push(m),r.set(f,[...h,u])},c=(u,f)=>{const h=u.groupIds.indexOf(f,0);return u.groupIds.slice(0,h).length>0?l(u,u.groupIds[h-1]):a(u)},d=e.every(u=>q_(n,u));return s.forEach(u=>{const f=ZB(u,n.selectedGroupIds);f?i.length===1&&d?c(u,f):l(u,f):a(u)}),Array.from(r.values()).concat(Array.from(o.values()))},J_=e=>{const t=new Set;return e.forEach(n=>{Ue(n)&&t.add(n.id)}),e.filter(n=>!(n.frameId&&t.has(n.frameId)))},ew=(e,t,n,i=!0)=>{const[s,r,o,a]=$e(t,n);let l=e.filter(c=>{let[d,u,f,h]=Mn(c,n);const m=Ls(c,n);if(m){const[p,U,b,y]=Mn(m,n);d=Math.max(p,d),u=Math.max(U,u),f=Math.min(b,f),h=Math.min(y,h)}return c.locked===!1&&c.type!=="selection"&&!Nt(c)&&s<=d&&r<=u&&o>=f&&a>=h});return l=i?J_(l):l,l=l.filter(c=>{const d=Ls(c,n);return d?Vc(c,d,n):!0}),l},QB=(e,t,n,i)=>{const s=new Set(t.map(r=>r.id));return e.filter(r=>{const o=_6(r,n.width,n.height,n,i);return!s.has(r.id)&&o})},Qn=function(){let e=null,t=null,n=null;const i=(s,r)=>(n!=null&&s===e&&r.selectedElementIds===t||(n=s.some(o=>r.selectedElementIds[o.id]),e=s,t=r.selectedElementIds),n);return i.clearCache=()=>{e=null,t=null,n=null},i}(),Ye=(e,t,n)=>{const i=new Set,s=[];for(const r of e.values()){if(t.selectedElementIds[r.id]){s.push(r),i.add(r.id);continue}if(n!=null&&n.includeBoundTextElement&&Nt(r)&&t.selectedElementIds[r==null?void 0:r.containerId]){s.push(r),i.add(r.id);continue}}if(n!=null&&n.includeElementsInFrames){const r=[];return s.forEach(o=>{Ue(o)&&or(e,o.id).forEach(a=>!i.has(a.id)&&r.push(a)),r.push(o)}),r}return s},iy=(e,t)=>t.editingTextElement?[t.editingTextElement]:t.newElement?[t.newElement]:Ye(e,t,{includeBoundTextElement:!0}),vt=(e,t)=>vi(t.selectedElementIds,e)?t.selectedElementIds:e,mse=(e,t)=>{var i;const n=e.filter(Ce);if(n.length===1){const s=n[0],r=((i=s.boundElements)==null?void 0:i.map(a=>a.id))??[];if(e.every(a=>a.id===s.id||r.includes(a.id)))return new re(s,be(t))}return null},JB=(e,t,n)=>({selectedLinearElement:mse(e,t),...xi({editingGroupId:n.editingGroupId,selectedElementIds:J_(e).reduce((i,s)=>(Nt(s)||(i[s.id]=!0),i),{})},t,n,null)}),pse=(e,t,n)=>{const i=be(e);for(const s of t)if(s.frameId){const r=n.get(s.id),o=n.get(s.frameId),a=r&&i.get(r);a&&Cn(a,i,{frameId:o??null})}};function tw(e,t,n){const i=v6(t,n),s=v6(e,n);return i.some(o=>s.some(a=>sse(o,a)))}const ez=(e,t,n)=>ry(ew(e,t,n,!1)).filter(i=>!Ue(i)&&!i.frameId||i.frameId===t.id),nw=(e,t,n)=>ew([t],e,n).some(i=>i.id===t.id),Np=(e,t,n)=>{const[i,s,r,o]=$e(t,n),[a,l,c,d]=pt(e);return i<=a&&s<=l&&r>=c&&o>=d},Vc=(e,t,n)=>Np([e],t,n)||tw(e,t,n)||nw(e,t,n),mA=(e,t,n)=>{const[i,s,r,o]=$e(t,n);return b0(C(i,s),C(e.x,e.y),C(r,o))},Use=e=>{const t=new Map;for(const n of e){const i=Ue(n)?n.id:n.frameId;i&&!t.has(i)&&t.set(i,or(e,i))}return t},or=(e,t)=>{const n=[];for(const i of e.values())i.frameId===t&&n.push(i);return n},iw=e=>e.filter(t=>Ue(t)),sw=e=>{const t=be(iw(e));return e.filter(n=>t.has(n.id)||!n.frameId||!t.has(n.frameId))},Qo=(e,t,n,i)=>{const s=or(e,t.id),r=new Set(s),o=new Set([...ez(e,t,i),...s.filter(f=>nw(f,t,i))]),a=s.filter(f=>!o.has(f)),l=new Set(Array.from(o).flatMap(f=>f.groupIds));for(const f of a)if(!tw(f,t,i))f.groupIds.length===0&&r.delete(f);else if(f.groupIds.length>0)for(const h of f.groupIds)l.add(h);for(const f of a)if(f.groupIds.length>0){let h=!0;for(const m of f.groupIds)l.has(m)&&(h=!1);h&&r.delete(f)}const c=Array.from(o).filter(f=>f.groupIds.length===0);for(const f of c)r.add(f);const d=Array.from(o).filter(f=>f.groupIds.length>0),u=Pp(d,n);for(const[f,h]of Object.entries(u))if(h){const m=Lt(e,f);if(Np(m,t,i))for(const p of m)r.add(p)}return[...r].filter(f=>!(fe(f)&&f.containerId))},bse=(e,t,n)=>yse(ry(e,ez(e,t,n)),t,n),yse=(e,t,n)=>{const i=[],s=new Map;for(const r of e){let o=!1;if(r.groupIds.length>0){if(r.groupIds.some(a=>s.get(a)))o=!0;else{const a=new Set(r.groupIds.flatMap(l=>Lt(n,l)));o=!Np(Array.from(a),t,n)}r.groupIds.forEach(a=>{s.set(a,o)})}o||i.push(r)}return i},Ls=(e,t)=>e.frameId&&t.get(e.frameId)||null,Ese=(e,t)=>{const n=new Set,i=be(e);e=ry(e);for(const o of e)Ue(o)&&o.id!==t.id&&n.add(o.id);const s=new Set,r=[];for(const o of e)if(!(Ue(o)||o.frameId&&n.has(o.frameId)))if(o.groupIds.length){const a=o.groupIds.at(-1);if(!s.has(a)){s.add(a);const l=Lt(e,a);if(l.some(c=>Vc(c,t,i)))for(const c of l)r.push(c)}}else Vc(o,t,i)&&r.push(o);return r},km=(e,t,n,i)=>{const s=be(e),r=new Map;for(const c of e.values())c.frameId===n.id&&r.set(c.id,!0);const o=new Set(t.map(c=>c.id)),a=[],l=new Set;for(const c of t)Ue(c)&&c.id!==n.id&&l.add(c.id);for(const c of ry(e,t)){if(Ue(c)||c.frameId&&l.has(c.frameId)||c.frameId&&i.selectedElementIds[c.id]&&i.selectedElementIds[c.frameId])continue;r.has(c.id)||a.push(c);const d=Re(c,s);d&&!o.has(d.id)&&!r.has(d.id)&&a.push(d)}for(const c of a)Cn(c,s,{frameId:n.id});return e},sy=(e,t)=>{const n=new Map,i=new Map;for(const s of e)if(s.frameId){n.set(s.id,s);const r=i.get(s.frameId)||[];r.push(s);const o=Re(s,t);o&&(n.set(o.id,o),r.push(o)),i.set(s.frameId,r)}for(const[,s]of n)Cn(s,t,{frameId:null})},tz=(e,t)=>{const n=or(e,t.id);return sy(n,be(e)),e},Ag=(e,t,n,i)=>km(tz(e,n),t,n,i.state).slice(),Wh=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,elements:e}),s=new Set(i);if(t.editingGroupId)for(const a of i)a.groupIds.length===0?s.add(a):a.groupIds.flatMap(l=>Lt(e,l)).forEach(l=>s.add(l));const r=new Set,o=be(e);return s.forEach(a=>{a.frameId&&!Ue(a)&&!p6(a,o,t)&&r.add(a)}),r.size>0&&sy(r,o),e},ry=(e,t)=>{const n=new Set,i=t||e;for(const o of i.values()){const a=o.groupIds[o.groupIds.length-1];a&&n.add(a)}const s=new Set;for(const o of n)Lt(e,o).some(a=>Ue(a))&&s.add(o);const r=[];for(const o of i.values())s.has(o.groupIds[o.groupIds.length-1])||r.push(o);return r},m6=(e,t,n)=>{const i=fe(e)&&Bn(e,t)||e;return i.frameId&&n.selectedElementIds[i.id]&&n.selectedElementIds[i.frameId]?Ls(i,t):n.selectedElementIds[i.id]&&n.selectedElementsAreBeingDragged?n.frameToHighlight:Ls(i,t)},p6=(e,t,n,i)=>{var l;const s=(i==null?void 0:i.targetFrame)??m6(e,t,n);if(!s)return!1;const r=fe(e)&&Bn(e,t)||e,o=c=>{i!=null&&i.checkedGroups&&r.groupIds.forEach(d=>{var u;(u=i.checkedGroups)==null||u.set(d,c)})};if(!n.selectedElementIds[r.id]||!n.selectedElementsAreBeingDragged||n.selectedElementIds[r.id]&&n.selectedElementIds[s.id])return!0;if(r.groupIds.length===0)return Vc(r,s,t);for(const c of r.groupIds)if((l=i==null?void 0:i.checkedGroups)!=null&&l.has(c))return i.checkedGroups.get(c);const a=new Set(r.groupIds.filter(c=>i!=null&&i.checkedGroups?!i.checkedGroups.has(c):!0).flatMap(c=>Lt(t,c)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){const c=new Set(Ye(t,n));if(n.frameToHighlight!==null)return!0;c.forEach(u=>{a.delete(u)})}for(const c of a)if(Ue(c))return o(!1),!1;for(const c of a)if(Vc(c,s,t))return o(!0),!0;return!1},v4=(e,t,n,i,s)=>{if(!n.frameRendering||!n.frameRendering.clip)return!1;const r=tw(e,t,i)||nw(e,t,i);if(r){for(const o of e.groupIds)s==null||s.set(o,!0);return!0}if(!r&&e.groupIds.length>0&&!Np([e],t,i)){let o=!1;if(n.selectedElementsAreBeingDragged)o=p6(e,i,n,{targetFrame:t,checkedGroups:s});else{o=e.frameId===t.id;for(const a of e.groupIds)s==null||s.set(a,o)}for(const a of e.groupIds)s==null||s.set(a,o);return o}return!1},vse="Frame",_se="AI Frame",rw=e=>vB(e)?vse:_se,nz=e=>e.name===null?rw(e):e.name,ow=(e,t)=>cse({elements:e,bounds:t,type:"overlap"}).filter(n=>!n.frameId||n.frameId===t.id),iz=e=>{const t=be(e);return e.length>1&&e.some(n=>n.frameId&&t.has(n.frameId))},sz="invert(100%) hue-rotate(180deg) saturate(1.25)",rz=(e,t)=>On(e)&&!t.imageCache.has(e.fileId),oz=(e,t,n)=>{var i;return n.theme===Se.DARK&&On(e)&&!rz(e,t)&&((i=t.imageCache.get(e.fileId))==null?void 0:i.mimeType)!==ve.svg},oy=e=>{switch(e.type){case"freedraw":return e.strokeWidth*12;case"text":return e.fontSize/2;case"arrow":return e.endArrowhead||e.endArrowhead?40:20;default:return 20}},az=(e,t,n,i,s=1)=>{let r=((t==null?void 0:t.opacity)??100)*e.opacity/1e4*s;return(n.has(e.id)||i&&i.some(o=>o.id===e.id)||t&&n.has(t.id))&&(r*=Cee/100),r},wse=(e,t,n)=>{const r=oy(e),[o,a,l,c]=$e(e,t),d=Ce(e)||ts(e)?Ki(o,l):e.width,u=Ce(e)||ts(e)?Ki(a,c):e.height;let f=d*window.devicePixelRatio+r*2,h=u*window.devicePixelRatio+r*2,m=n.value;return(f*m>32767||h*m>32767)&&(m=Math.min(32767/f,32767/h)),f*h*m*m>16777216&&(m=Math.sqrt(16777216/(f*h))),f=Math.floor(f*m),h=Math.floor(h*m),{width:f,height:h,scale:m}},lz=(e,t,n,i,s)=>{var b,y;const r=document.createElement("canvas"),o=r.getContext("2d"),a=oy(e),{width:l,height:c,scale:d}=wse(e,t,n);if(!l||!c)return null;r.width=l,r.height=c;let u=-100,f=0;if(Ce(e)||ts(e)){const[v,_]=$e(e,t);u=e.x>v?Ki(e.x,v)*window.devicePixelRatio*d:0,f=e.y>_?Ki(e.y,_)*window.devicePixelRatio*d:0,o.translate(u,f)}o.save(),o.translate(a*d,a*d),o.scale(window.devicePixelRatio*d,window.devicePixelRatio*d);const h=ld.canvas(r);oz(e,i,s)&&(o.filter=sz),X2(e,h,o,i),o.restore();const m=Re(e,t),p=document.createElement("canvas"),U=p.getContext("2d");if(_e(e)&&m){const[v,_,I,R]=$e(e,t),T=Math.max(Ki(v,I),Ki(_,R));p.width=T*window.devicePixelRatio*d+a*d*10,p.height=T*window.devicePixelRatio*d+a*d*10,U.translate(p.width/2,p.height/2),U.rotate(e.angle),U.drawImage(r,-r.width/2,-r.height/2,r.width,r.height);const[,,,,w,S]=$e(m,t);U.rotate(-e.angle);const x=(p.width-r.width)/2,k=(p.height-r.height)/2,P=p.width/2-(w-v)*window.devicePixelRatio*d-x-a*d,D=p.height/2-(S-_)*window.devicePixelRatio*d-k-a*d;U.translate(-P,-D),U.clearRect(-(m.width/2+Wn)*window.devicePixelRatio*d,-(m.height/2+Wn)*window.devicePixelRatio*d,(m.width+Wn*2)*window.devicePixelRatio*d,(m.height+Wn*2)*window.devicePixelRatio*d)}return{element:e,canvas:r,theme:s.theme,scale:d,zoomValue:n.value,canvasOffsetX:u,canvasOffsetY:f,boundTextElementVersion:((b=Re(e,t))==null?void 0:b.version)||null,containingFrameOpacity:((y=Ls(e,t))==null?void 0:y.opacity)||100,boundTextCanvas:p,angle:e.angle,imageCrop:wt(e)?e.crop:null}},cz=typeof document<"u"?document.createElement("img"):{src:""};cz.src=`data:${ve.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;const dz=typeof document<"u"?document.createElement("img"):{src:""};dz.src=`data:${ve.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;const Tse=(e,t)=>{t.fillStyle="#E7E7E7",t.fillRect(0,0,e.width,e.height);const n=Math.min(e.width,e.height),i=Math.min(n,Math.min(n*.4,100));t.drawImage(e.status==="error"?dz:cz,e.width/2-i/2,e.height/2-i/2,i,i)},X2=(e,t,n,i)=>{var s;switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":{n.lineJoin="round",n.lineCap="round",t.draw(sn.get(e));break}case"arrow":case"line":{n.lineJoin="round",n.lineCap="round",sn.get(e).forEach(r=>{t.draw(r)});break}case"freedraw":{n.save(),n.fillStyle=e.strokeColor;const r=xse(e),o=sn.get(e);o&&t.draw(o),n.fillStyle=e.strokeColor,n.fill(r),n.restore();break}case"image":{const r=On(e)?(s=i.imageCache.get(e.fileId))==null?void 0:s.image:void 0;if(r!=null&&!(r instanceof Promise)){e.roundness&&n.roundRect&&(n.beginPath(),n.roundRect(0,0,e.width,e.height,qo(Math.min(e.width,e.height),e)),n.clip());const{x:o,y:a,width:l,height:c}=e.crop?e.crop:{x:0,y:0,width:r.naturalWidth,height:r.naturalHeight};n.drawImage(r,o,a,l,c,0,0,e.width,e.height)}else Tse(e,n);break}default:if(fe(e)){const r=nB(e.text),o=r&&!n.canvas.isConnected;o&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",r?"rtl":"ltr"),n.save(),n.font=bt(e),n.fillStyle=e.strokeColor,n.textAlign=e.textAlign;const a=e.text.replace(/\r\n?/g,`
`).split(`
`),l=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,c=kp(e.fontSize,e.lineHeight),d=FF(e.fontFamily,e.fontSize,c);for(let u=0;u<a.length;u++)n.fillText(a[u],l,u*c+d);n.restore(),o&&n.canvas.remove()}else throw new Error(`Unimplemented type ${e.type}`)}},_4=new WeakMap,pA=(e,t,n,i)=>{var u;const s=n?i.zoom:{value:1},r=_4.get(e),o=r&&r.zoomValue!==s.value&&!(i!=null&&i.shouldCacheIgnoreZoom),a=Re(e,t),l=(a==null?void 0:a.version)||null,c=wt(e)?e.crop:null,d=((u=Ls(e,t))==null?void 0:u.opacity)||100;if(!r||o||r.theme!==i.theme||r.boundTextElementVersion!==l||r.imageCrop!==c||r.containingFrameOpacity!==d||_e(e)&&a&&e.angle!==r.angle){const f=lz(e,t,s,n,i);return f?(_4.set(e,f),f):null}return r},F8=(e,t,n,i,s)=>{const r=e.element,o=oy(r),a=e.scale,[l,c,d,u]=$e(r,s),f=((l+d)/2+i.scrollX)*window.devicePixelRatio,h=((c+u)/2+i.scrollY)*window.devicePixelRatio;t.save(),t.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);const m=Re(r,s);if(_e(r)&&m){const p=(e.boundTextCanvas.width-e.canvas.width)/2,U=(e.boundTextCanvas.height-e.canvas.height)/2;t.translate(f,h),t.drawImage(e.boundTextCanvas,-(d-l)/2*window.devicePixelRatio-p/a-o,-(u-c)/2*window.devicePixelRatio-U/a-o,e.boundTextCanvas.width/a,e.boundTextCanvas.height/a)}else t.translate(f,h),t.rotate(r.angle),"scale"in e.element&&!rz(r,n)&&t.scale(e.element.scale[0],e.element.scale[1]),t.translate(-f,-h),t.drawImage(e.canvas,(l+i.scrollX)*window.devicePixelRatio-o*e.scale/e.scale,(c+i.scrollY)*window.devicePixelRatio-o*e.scale/e.scale,e.canvas.width/e.scale,e.canvas.height/e.scale);t.restore()},Ise=(e,t,n,i)=>{t.save(),t.translate(e.x+n.scrollX,e.y+n.scrollY),t.fillStyle="rgba(0, 0, 200, 0.04)";const s=.5/n.zoom.value;t.fillRect(s,s,e.width,e.height),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(s,s,e.width,e.height),t.restore()},Cd=(e,t,n,i,s,r,o)=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="elementLinkSelector"&&!o.selectedElementIds[e.id]&&!o.hoveredElementIds[e.id];switch(s.globalAlpha=az(e,Ls(e,t),r.elementsPendingErasure,r.pendingFlowchartNodes,a?OF:1),e.type){case"magicframe":case"frame":{o.frameRendering.enabled&&o.frameRendering.outline&&(s.save(),s.translate(e.x+o.scrollX,e.y+o.scrollY),s.fillStyle="rgba(0, 0, 200, 0.04)",s.lineWidth=mt.strokeWidth/o.zoom.value,s.strokeStyle=mt.strokeColor,G2(e)&&(s.strokeStyle=o.theme===Se.LIGHT?"#7affd7":"#1d8264"),s.roundRect?(s.beginPath(),s.roundRect(0,0,e.width,e.height,mt.radius/o.zoom.value),s.stroke(),s.closePath()):s.strokeRect(0,0,e.width,e.height),s.restore());break}case"freedraw":{if(sn.generateElementShape(e,null),r.isExporting){const[c,d,u,f]=$e(e,t),h=(c+u)/2+o.scrollX,m=(d+f)/2+o.scrollY,p=(u-c)/2-(e.x-c),U=(f-d)/2-(e.y-d);s.save(),s.translate(h,m),s.rotate(e.angle),s.translate(-p,-U),X2(e,i,s,r),s.restore()}else{const c=pA(e,n,r,o);if(!c)return;F8(c,s,r,o,n)}break}case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":{if(sn.generateElementShape(e,r),r.isExporting){const[c,d,u,f]=$e(e,t),h=(c+u)/2+o.scrollX,m=(d+f)/2+o.scrollY;let p=(u-c)/2-(e.x-c),U=(f-d)/2-(e.y-d);if(fe(e)){const y=Bn(e,t);if(_e(y)){const v=re.getBoundTextElementPosition(y,e,t);p=(u-c)/2-(v.x-c),U=(f-d)/2-(v.y-d)}}s.save(),s.translate(h,m),oz(e,r,o)&&(s.filter="none");const b=Re(e,t);if(_e(e)&&b){const y=document.createElement("canvas"),v=y.getContext("2d"),_=Math.max(Ki(c,u),Ki(d,f)),I=oy(e);y.width=_*o.exportScale+I*10*o.exportScale,y.height=_*o.exportScale+I*10*o.exportScale,v.translate(y.width/2,y.height/2),v.scale(o.exportScale,o.exportScale),p=e.width/2-(e.x-c),U=e.height/2-(e.y-d),v.rotate(e.angle);const R=ld.canvas(y);v.translate(-p,-U),X2(e,R,v,r),v.translate(p,U),v.rotate(-e.angle);const[,,,,T,w]=$e(b,t),S=(c+u)/2-T,x=(d+f)/2-w;v.translate(-S,-x),v.clearRect(-b.width/2,-b.height/2,b.width,b.height),s.scale(1/o.exportScale,1/o.exportScale),s.drawImage(y,-y.width/2,-y.height/2,y.width,y.height)}else s.rotate(e.angle),e.type==="image"&&s.scale(e.scale[0],e.scale[1]),s.translate(-p,-U),X2(e,i,s,r);s.restore()}else{const c=pA(e,n,r,o);if(!c)return;const d=s.imageSmoothingEnabled;if(!(o!=null&&o.shouldCacheIgnoreZoom)&&(!e.angle||Qee(e.angle))&&(s.imageSmoothingEnabled=!1),e.id===o.croppingElementId&&wt(c.element)&&c.element.crop!==null){s.save(),s.globalAlpha=.1;const u=lz(Gne(c.element,t),n,o.zoom,r,o);u&&F8(u,s,r,o,n),s.restore()}F8(c,s,r,o,n),s.imageSmoothingEnabled=d}break}default:throw new Error(`Unimplemented type ${e.type}`)}s.globalAlpha=1},uz=new WeakMap([]);function Sse(e){const t=fz(e),n=new Path2D(t);return uz.set(e,n),n}function xse(e){return uz.get(e)}function fz(e){return Mse(hz(e))}function Cse(e,t,n){const i=Mn({...e,angle:0},n),s=C((i[0]+i[2])/2,(i[1]+i[3])/2);return xe(t.length>=2,"Freepath outline must have at least 2 points"),t.slice(2).reduce((r,o)=>(r.push(ke(r[r.length-1][1],Z(C(o[0]+e.x,o[1]+e.y),s,e.angle))),r),[ke(Z(C(t[0][0]+e.x,t[0][1]+e.y),s,e.angle),Z(C(t[1][0]+e.x,t[1][1]+e.y),s,e.angle))])}function hz(e){const t=e.simulatePressure?e.points:e.points.length?e.points.map(([i,s],r)=>[i,s,e.pressures[r]]):[[0,0,.5]],n={simulatePressure:e.simulatePressure,size:e.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:i=>Math.sin(i*Math.PI/2),last:!0};return Hne(t,n)}function UA(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}const Ase=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function Mse(e){if(!e.length)return"";const t=e.length-1;return e.reduce((n,i,s,r)=>(s===t?n.push(i,UA(i,r[0]),"L",r[0],"Z"):n.push(i,UA(i,r[s+1])),n),["M",e[0],"Q"]).join(" ").replace(Ase,"$1")}const $c=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="line"||e==="freedraw",w4=e=>e==="rectangle"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line"||e==="text",U6=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line",b6=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="arrow"||e==="line",T0=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="line"||e==="diamond"||e==="image",y6=e=>e==="arrow",E6=e=>e==="arrow",ji=class ji{};F(ji,"rg",new Hh),F(ji,"cache",new WeakMap),F(ji,"get",t=>ji.cache.get(t)),F(ji,"set",(t,n)=>ji.cache.set(t,n)),F(ji,"delete",t=>ji.cache.delete(t)),F(ji,"destroy",()=>{ji.cache=new WeakMap}),F(ji,"generateElementShape",(t,n)=>{const i=n!=null&&n.isExporting?void 0:ji.get(t);if(i!==void 0)return i;_4.delete(t);const s=Dse(t,ji.rg,n||{isExporting:!1,canvasBackgroundColor:Ke.white,embedsValidationStatus:null});return ji.cache.set(t,s),s});let sn=ji;const kse=e=>[8,8+e],gz=e=>[1.5,6+e];function Rse(e){const t=e.roughness,n=Math.max(e.width,e.height),i=Math.min(e.width,e.height);return i>=20&&n>=50||i>=15&&e.roundness&&T0(e.type)||Ce(e)&&n>=50?t:Math.min(t/(n<10?3:2),2.5)}const js=(e,t=!1)=>{const n={seed:e.seed,strokeLineDash:e.strokeStyle==="dashed"?kse(e.strokeWidth):e.strokeStyle==="dotted"?gz(e.strokeWidth):void 0,disableMultiStroke:e.strokeStyle!=="solid",strokeWidth:e.strokeStyle!=="solid"?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:e.strokeWidth*4,roughness:Rse(e),stroke:e.strokeColor,preserveVertices:t||e.roughness<DF.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return n.fillStyle=e.fillStyle,n.fill=ms(e.backgroundColor)?void 0:e.backgroundColor,e.type==="ellipse"&&(n.curveFitting=1),n;case"line":case"freedraw":return sa(e.points)&&(n.fillStyle=e.fillStyle,n.fill=e.backgroundColor==="transparent"?void 0:e.backgroundColor),n;case"arrow":return n;default:throw new Error(`Unimplemented type ${e.type}`)}},bA=(e,t,n)=>wr(e)&&(t||ds(e)&&(n==null?void 0:n.get(e.id))!==!0)&&ms(e.backgroundColor)&&ms(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:Kl(e)?{...e,strokeColor:ms(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:ms(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,yA=(e,t,n,i,s,r,o)=>{const a=TA(e,t,n,i);if(a===null)return[];const l=(c,d)=>{if(c===null)return[];const[,,u,f,h,m]=c;return[s.line(u,f,h,m,d)]};switch(i){case"dot":case"circle":case"circle_outline":{const[c,d,u]=a;return delete r.strokeLineDash,[s.circle(c,d,u,{...r,fill:i==="circle_outline"?o:e.strokeColor,fillStyle:"solid",stroke:e.strokeColor,roughness:Math.min(.5,r.roughness||0)})]}case"triangle":case"triangle_outline":{const[c,d,u,f,h,m]=a;return delete r.strokeLineDash,[s.polygon([[c,d],[u,f],[h,m],[c,d]],{...r,fill:i==="triangle_outline"?o:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"diamond":case"diamond_outline":{const[c,d,u,f,h,m,p,U]=a;return delete r.strokeLineDash,[s.polygon([[c,d],[u,f],[h,m],[p,U],[c,d]],{...r,fill:i==="diamond_outline"?o:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"crowfoot_one":return l(a,r);case"bar":case"arrow":case"crowfoot_many":case"crowfoot_one_or_many":default:{const[c,d,u,f,h,m]=a;if(e.strokeStyle==="dotted"){const p=gz(e.strokeWidth-1);r.strokeLineDash=[p[0],p[1]-1]}else delete r.strokeLineDash;return r.roughness=Math.min(1,r.roughness||0),[s.line(u,f,c,d,r),s.line(h,m,c,d,r),...i==="crowfoot_one_or_many"?l(TA(e,t,n,"crowfoot_one"),r):[]]}}},Lse=e=>{const t=new Hh,n={seed:e.seed,disableMultiStroke:!0,disableMultiStrokeFill:!0,roughness:0,preserveVertices:!0},i=Mg(e.points.reduce((s,r)=>[Math.min(e.x+r[0],s[0]),Math.min(e.y+r[1],s[1]),Math.max(e.x+r[0],s[2]),Math.max(e.y+r[1],s[3])],[1/0,1/0,-1/0,-1/0]));switch(e.type){case"line":case"arrow":{const s=e.points.length?e.points:[C(0,0)];return ye(e)?t.path(mz(s,16),n).sets[0].ops:e.roundness?t.curve(s,n).sets[0].ops.slice(0,e.points.length).map((r,o)=>{if(o===0){const a=Z(C(e.x+r.data[0],e.y+r.data[1]),i,e.angle);return{op:"move",data:C(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[Z(C(e.x+r.data[0],e.y+r.data[1]),i,e.angle),Z(C(e.x+r.data[2],e.y+r.data[3]),i,e.angle),Z(C(e.x+r.data[4],e.y+r.data[5]),i,e.angle)].map(a=>C(a[0]-e.x,a[1]-e.y)).flat()}}):s.map((r,o)=>{const a=Z(C(e.x+r[0],e.y+r[1]),i,e.angle);return{op:o===0?"move":"lineTo",data:C(a[0]-e.x,a[1]-e.y)}})}case"freedraw":{if(e.points.length<2)return[];const s=N_(e.points,.75);return t.curve(s,n).sets[0].ops.slice(0,e.points.length).map((r,o)=>{if(o===0){const a=Z(C(e.x+r.data[0],e.y+r.data[1]),i,e.angle);return{op:"move",data:C(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[Z(C(e.x+r.data[0],e.y+r.data[1]),i,e.angle),Z(C(e.x+r.data[2],e.y+r.data[3]),i,e.angle),Z(C(e.x+r.data[4],e.y+r.data[5]),i,e.angle)].map(a=>C(a[0]-e.x,a[1]-e.y)).flat()}})}}},Dse=(e,t,{isExporting:n,canvasBackgroundColor:i,embedsValidationStatus:s})=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":{let r;if(e.roundness){const o=e.width,a=e.height,l=qo(Math.min(o,a),e);r=t.path(`M ${l} 0 L ${o-l} 0 Q ${o} 0, ${o} ${l} L ${o} ${a-l} Q ${o} ${a}, ${o-l} ${a} L ${l} ${a} Q 0 ${a}, 0 ${a-l} L 0 ${l} Q 0 0, ${l} 0`,js(bA(e,n,s),!0))}else r=t.rectangle(0,0,e.width,e.height,js(bA(e,n,s),!1));return r}case"diamond":{let r;const[o,a,l,c,d,u,f,h]=lw(e);if(e.roundness){const m=qo(Math.abs(o-f),e),p=qo(Math.abs(c-a),e);r=t.path(`M ${o+m} ${a+p} L ${l-m} ${c-p}
            C ${l} ${c}, ${l} ${c}, ${l-m} ${c+p}
            L ${d+m} ${u-p}
            C ${d} ${u}, ${d} ${u}, ${d-m} ${u-p}
            L ${f+m} ${h+p}
            C ${f} ${h}, ${f} ${h}, ${f+m} ${h-p}
            L ${o-m} ${a+p}
            C ${o} ${a}, ${o} ${a}, ${o+m} ${a+p}`,js(e,!0))}else r=t.polygon([[o,a],[l,c],[d,u],[f,h]],js(e));return r}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,js(e));case"line":case"arrow":{let r;const o=js(e),a=e.points.length?e.points:[C(0,0)];if(ye(e)?a.every(l=>Math.abs(l[0])<=1e6&&Math.abs(l[1])<=1e6)?r=[t.path(mz(a,16),js(e,!0))]:(console.error("Elbow arrow with extreme point positions detected. Arrow not rendered.",e.id,JSON.stringify(a)),r=[]):e.roundness?r=[t.curve(a,o)]:o.fill?r=[t.polygon(a,o)]:r=[t.linearPath(a,o)],e.type==="arrow"){const{startArrowhead:l=null,endArrowhead:c="arrow"}=e;if(l!==null){const d=yA(e,r,"start",l,t,o,i);r.push(...d)}if(c!==null){const d=yA(e,r,"end",c,t,o,i);r.push(...d)}}return r}case"freedraw":{let r;if(Sse(e),sa(e.points)){const o=N_(e.points,.75);r=t.curve(o,{...js(e),stroke:"none"})}else r=null;return r}case"frame":case"magicframe":case"text":case"image":return null;default:return na(e,`generateElementShape(): Unimplemented type ${e==null?void 0:e.type}`),null}},mz=(e,t)=>{const n=[];for(let s=1;s<e.length-1;s+=1){const r=e[s-1],o=e[s+1],a=e[s],l=za(a,r),c=za(o,a),d=Math.min(t,Qe(e[s],o)/2,Qe(e[s],r)/2);l?r[0]<a[0]?n.push([e[s][0]-d,e[s][1]]):n.push([e[s][0]+d,e[s][1]]):r[1]<a[1]?n.push([e[s][0],e[s][1]-d]):n.push([e[s][0],e[s][1]+d]),n.push(e[s]),c?o[0]<a[0]?n.push([e[s][0]-d,e[s][1]]):n.push([e[s][0]+d,e[s][1]]):o[1]<a[1]?n.push([e[s][0],e[s][1]-d]):n.push([e[s][0],e[s][1]+d])}const i=[`M ${e[0][0]} ${e[0][1]}`];for(let s=0;s<n.length;s+=3)i.push(`L ${n[s][0]} ${n[s][1]}`),i.push(`Q ${n[s+1][0]} ${n[s+1][1]}, ${n[s+2][0]} ${n[s+2][1]}`);return i.push(`L ${e[e.length-1][0]} ${e[e.length-1][1]}`),i.join(" ")},Pse=(e,t)=>{var n;switch(e.type){case"rectangle":case"diamond":case"frame":case"magicframe":case"embeddable":case"image":case"iframe":case"text":case"selection":return Sne(e);case"arrow":case"line":{const i=((n=sn.get(e))==null?void 0:n[0])??sn.generateElementShape(e,null)[0],[,,,,s,r]=$e(e,t);return u6(e)?kne(e,i,C(e.x,e.y),e.angle,C(s,r)):Cne(i,C(e.x,e.y),e.angle,C(s,r))}case"ellipse":return xne(e);case"freedraw":{const[,,,,i,s]=$e(e,t);return Mne(e,C(i,s),u6(e))}}},aw=(e,t)=>{const n=[...e.points];if(t){if(!CB(e.points))return null;const s=n[0],r=n[n.length-1];Math.hypot(s[0]-r[0],s[1]-r[1])>Mee||n.length<4?n.push(C(s[0],s[1])):n[n.length-1]=C(s[0],s[1])}return{polygon:t,points:n}},No=class No{static getBounds(t,n,i=!1){const s=i&&t.angle!==0?No.nonRotatedBoundsCache.get(t):No.boundsCache.get(t);if(s!=null&&s.version&&s.version===t.version&&!Nt(t))return s.bounds;if(i&&t.angle!==0){const o=No.calculateBounds({...t,angle:0},n);return No.nonRotatedBoundsCache.set(t,{version:t.version,bounds:o}),o}const r=No.calculateBounds(t,n);return No.boundsCache.set(t,{version:t.version,bounds:r}),r}static calculateBounds(t,n){let i;const[s,r,o,a,l,c]=$e(t,n);if(ts(t)){const[d,u,f,h]=dw(t.points.map(([m,p])=>Z(C(m,p),C(l-t.x,c-t.y),t.angle)));return[d+t.x,u+t.y,f+t.x,h+t.y]}else if(Ce(t))i=Vse(t,l,c,n);else if(t.type==="diamond"){const[d,u]=Z(C(l,r),C(l,c),t.angle),[f,h]=Z(C(l,a),C(l,c),t.angle),[m,p]=Z(C(s,c),C(l,c),t.angle),[U,b]=Z(C(o,c),C(l,c),t.angle),y=Math.min(d,f,m,U),v=Math.min(u,h,p,b),_=Math.max(d,f,m,U),I=Math.max(u,h,p,b);i=[y,v,_,I]}else if(t.type==="ellipse"){const d=(o-s)/2,u=(a-r)/2,f=Math.cos(t.angle),h=Math.sin(t.angle),m=Math.hypot(d*f,u*h),p=Math.hypot(u*f,d*h);i=[l-m,c-p,l+m,c+p]}else{const[d,u]=Z(C(s,r),C(l,c),t.angle),[f,h]=Z(C(s,a),C(l,c),t.angle),[m,p]=Z(C(o,a),C(l,c),t.angle),[U,b]=Z(C(o,r),C(l,c),t.angle),y=Math.min(d,f,m,U),v=Math.min(u,h,p,b),_=Math.max(d,f,m,U),I=Math.max(u,h,p,b);i=[y,v,_,I]}return i}};F(No,"boundsCache",new WeakMap),F(No,"nonRotatedBoundsCache",new WeakMap);let T4=No;const $e=(e,t,n=!1)=>{if(ts(e))return Fse(e);if(Ce(e))return re.getElementAbsoluteCoords(e,t,n);if(fe(e)){const i=t?Bn(e,t):null;if(_e(i)){const{x:s,y:r}=re.getBoundTextElementPosition(i,e,t);return[s,r,s+e.width,r+e.height,s+e.width/2,r+e.height/2]}}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},v6=(e,t)=>{const n=Pse(e,t),[i,s,r,o,a,l]=$e(e,t),c=C(a,l);if(n.type==="polycurve"){const b=n.data.map(v=>Cp(v,10)),y=[];if(nn(e)&&!e.polygon||_e(e))for(const v of b){let _=0;for(;_<v.length-1;)y.push(ke(C(v[_][0],v[_][1]),C(v[_+1][0],v[_+1][1]))),_++}else{const v=b.flat();let _=0;for(;_<v.length-1;)y.push(ke(C(v[_][0],v[_][1]),C(v[_+1][0],v[_+1][1]))),_++}return y}else{if(n.type==="polyline")return n.data;if(Nse(e)){const[U,b]=Ap(e),y=b.map(_=>vA(_,c,e.angle)).flat();return[...EA(U,c,e.angle),...y]}else if(e.type==="diamond"){const[U,b]=Mp(e),y=b.map(_=>vA(_,c,e.angle)).flat();return[...EA(U,c,e.angle),...y]}else if(n.type==="polygon"){if(fe(e)){const y=Bn(e,t);if(y&&Ce(y))return[ke(C(i,s),C(r,s)),ke(C(r,s),C(r,o)),ke(C(r,o),C(i,o)),ke(C(i,o),C(i,s))]}const U=n.data,b=[];for(let y=0;y<U.length-1;y++)b.push(ke(U[y],U[y+1]));return b}else if(n.type==="ellipse")return Ose(e)}const[d,u,f,h,,,m,p]=[[i,s],[r,s],[i,o],[r,o],[a,s],[a,o],[i,l],[r,l]].map(U=>Z(U,c,e.angle));return[ke(d,u),ke(f,h),ke(d,f),ke(u,h),ke(d,p),ke(f,p),ke(u,m),ke(h,m)]},Nse=e=>e!=null&&(e.type==="rectangle"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),EA=(e,t,n)=>e.map(i=>ke(Z(i[0],t,n),Z(i[1],t,n))),vA=(e,t,n)=>{const i=Cp(e,10);let s=0;const r=[];for(;s<i.length-1;)r.push(ke(Z(C(i[s][0],i[s][1]),t,n),Z(C(i[s+1][0],i[s+1][1]),t,n))),s++;return r},Ose=e=>{const t=C(e.x+e.width/2,e.y+e.height/2),n=e.width/2,i=e.height/2,s=[],r=[],o=90,a=Math.PI*2/o;for(let l=0;l<o;l++){const c=l*a,d=t[0]+n*Math.cos(c),u=t[1]+i*Math.sin(c);r.push(Z(C(d,u),t,e.angle))}for(let l=0;l<r.length-1;l++)s.push(ke(r[l],r[l+1]));return s.push(ke(r[r.length-1],r[0])),s},lw=e=>{const t=Math.floor(e.width/2)+1,n=0,i=e.width,s=Math.floor(e.height/2)+1,r=t,o=e.height;return[t,n,i,s,r,o,0,s]},_A=(e,t,n,i,s)=>{const r=1-e;return Math.pow(r,3)*t+3*Math.pow(r,2)*e*n+3*r*Math.pow(e,2)*i+Math.pow(e,3)*s},wA=(e,t,n,i)=>{const s=t-e,r=n-t,o=i-n,a=3*s-6*r+3*o,l=6*r-6*s,c=3*s,d=l*l-4*a*c;if(!(d>=0))return!1;let f=null,h=null,m=1/0,p=1/0;return a===0?m=p=-c/l:(m=(-l+Math.sqrt(d))/(2*a),p=(-l-Math.sqrt(d))/(2*a)),m>=0&&m<=1&&(f=_A(m,e,t,n,i)),p>=0&&p<=1&&(h=_A(p,e,t,n,i)),[f,h]},cw=(e,t,n,i)=>{const s=wA(e[0],t[0],n[0],i[0]),r=wA(e[1],t[1],n[1],i[1]);let o=Math.min(e[0],i[0]),a=Math.max(e[0],i[0]);if(s){const d=s.filter(u=>u!==null);o=Math.min(o,...d),a=Math.max(a,...d)}let l=Math.min(e[1],i[1]),c=Math.max(e[1],i[1]);if(r){const d=r.filter(u=>u!==null);l=Math.min(l,...d),c=Math.max(c,...d)}return[o,l,a,c]},ay=(e,t)=>{let n=C(0,0);const{minX:i,minY:s,maxX:r,maxY:o}=e.reduce((a,{op:l,data:c})=>{if(l==="move"){const d=W5(c);xe(d!=null,"Op data is not a point"),n=d}else if(l==="bcurveTo"){const d=C(c[0],c[1]),u=C(c[2],c[3]),f=C(c[4],c[5]),h=t?t(d):d,m=t?t(u):u,p=t?t(f):f,U=t?t(n):n;n=f;const[b,y,v,_]=cw(U,h,m,p);a.minX=Math.min(a.minX,b),a.minY=Math.min(a.minY,y),a.maxX=Math.max(a.maxX,v),a.maxY=Math.max(a.maxY,_)}return a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[i,s,r,o]},dw=e=>{let t=1/0,n=1/0,i=-1/0,s=-1/0;for(const[r,o]of e)t=Math.min(t,r),n=Math.min(n,o),i=Math.max(i,r),s=Math.max(s,o);return[t,n,i,s]},Fse=e=>{const[t,n,i,s]=dw(e.points),r=t+e.x,o=n+e.y,a=i+e.x,l=s+e.y;return[r,o,a,l,(r+a)/2,(o+l)/2]},Bse=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;case"crowfoot_many":case"crowfoot_one":case"crowfoot_one_or_many":return 20;default:return 15}},zse=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},TA=(e,t,n,i)=>{if(t.length<1)return null;const s=Vu(t[0]);if(s.length<1)return null;const r=n==="start"?1:s.length-1,o=s[r].data;xe(o.length===6,"Op data length is not 6");const a=C(o[4],o[5]),l=C(o[2],o[3]),c=C(o[0],o[1]),d=s[r-1];let u=C(0,0);if(d.op==="move"){const G=W5(d.data);xe(G!=null,"Op data is not a point"),u=G}else d.op==="bcurveTo"&&(u=C(d.data[4],d.data[5]));const f=(G,V)=>Math.pow(1-G,3)*a[V]+3*G*Math.pow(1-G,2)*l[V]+3*Math.pow(G,2)*(1-G)*c[V]+u[V]*Math.pow(G,3),[h,m]=n==="start"?u:a,[p,U]=[f(.3,0),f(.3,1)],b=Math.hypot(h-p,m-U),y=(h-p)/b,v=(m-U)/b,_=Bse(i);let I=0;{const[G,V]=n==="end"?e.points[e.points.length-1]:e.points[0],[B,z]=e.points.length>1?n==="end"?e.points[e.points.length-2]:e.points[1]:[0,0];I=Math.hypot(G-B,V-z)}const T=Math.min(_,I*(i==="diamond"||i==="diamond_outline"?.25:.5)),w=h-y*T,S=m-v*T;if(i==="dot"||i==="circle"||i==="circle_outline"){const G=Math.hypot(S-m,w-h)+e.strokeWidth-2;return[h,m,G]}const x=zse(i);if(i==="crowfoot_many"||i==="crowfoot_one_or_many"){const[G,V]=Z(C(h,m),C(w,S),eu(-x)),[B,z]=Z(C(h,m),C(w,S),eu(x));return[w,S,G,V,B,z]}const[k,P]=Z(C(w,S),C(h,m),-x*Math.PI/180),[D,j]=Z(C(w,S),C(h,m),eu(x));if(i==="diamond"||i==="diamond_outline"){let G,V;if(n==="start"){const[B,z]=e.points.length>1?e.points[1]:[0,0];[G,V]=Z(C(h+T*2,m),C(h,m),Math.atan2(z-m,B-h))}else{const[B,z]=e.points.length>1?e.points[e.points.length-2]:[0,0];[G,V]=Z(C(h-T*2,m),C(h,m),Math.atan2(m-z,h-B))}return[h,m,k,P,G,V,D,j]}return[h,m,k,P,D,j]},Hse=e=>{const t=ld.generator(),n=js(e),i=e.roundness?"curve":n.fill?"polygon":"linearPath";return t[i](e.points,n)},Vse=(e,t,n,i)=>{var u;const s=Re(e,i);if(e.points.length<2){const[f,h]=e.points[0],[m,p]=Z(C(e.x+f,e.y+h),C(t,n),e.angle);let U=[m,p,m,p];if(s){const b=re.getMinMaxXYWithBoundText(e,i,[m,p,m,p],s);U=[b[0],b[1],b[2],b[3]]}return U}const o=((u=sn.get(e))==null?void 0:u[0])??Hse(e),a=Vu(o),c=ay(a,([f,h])=>Z(C(e.x+f,e.y+h),C(t,n),e.angle));let d=[c[0],c[1],c[2],c[3]];if(s){const f=re.getMinMaxXYWithBoundText(e,i,d,s);d=[f[0],f[1],f[2],f[3]]}return d},Mn=(e,t,n=!1)=>T4.getBounds(e,t,n),pt=(e,t)=>{if(!cB(e))return[0,0,0,0];let n=1/0,i=-1/0,s=1/0,r=-1/0;const o=t||be(e);return e.forEach(a=>{const[l,c,d,u]=Mn(a,o);n=Math.min(n,l),s=Math.min(s,c),i=Math.max(i,d),r=Math.max(r,u)}),[n,s,i,r]},uw=(e,t)=>{const[n,i,s,r]=pt(e);return[n+t.x,i+t.y,s+t.x,r+t.y]},I0=(e,t,n,i)=>{if(!(Ce(e)||ts(e)))return[e.x,e.y,e.x+t,e.y+n];const s=r6(0,t,r6(1,n,e.points,i),i);let r;if(ts(e))r=dw(s);else{const d=ld.generator(),u=e.roundness?d.curve(s,js(e)):d.linearPath(s,js(e)),f=Vu(u);r=ay(f)}const[o,a,l,c]=r;return[o+e.x,a+e.y,l+e.x,c+e.y]},IA=(e,t)=>{const n=ld.generator(),i=e.roundness==null?n.linearPath(t,js(e)):n.curve(t,js(e)),s=Vu(i),[r,o,a,l]=ay(s);return[r+e.x,o+e.y,a+e.x,l+e.y]},$se=(e,t)=>{if(!e.length)return[0,0,0,0];let n=1/0,i=e[0];const s=be(e);return e.forEach(r=>{const[o,a,l,c]=Mn(r,s),d=Qe(C((o+l)/2,(a+c)/2),C(t.x,t.y));d<n&&(n=d,i=r)}),Mn(i,s)},Dr=e=>{const[t,n,i,s]=pt(e);return{minX:t,minY:n,maxX:i,maxY:s,width:i-t,height:s-n,midX:(t+i)/2,midY:(n+s)/2}},pz=({scrollX:e,scrollY:t,width:n,height:i,zoom:s})=>[-e,-t,-e+n/s.value,-t+i/s.value],Mg=e=>C(e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2),ka=(e,t,n)=>{const i={minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height,midX:e.x+e.width/2,midY:e.y+e.height/2},s=Ti(e,t),[r,o]=Z(C(i.minX,i.minY),s,e.angle),[a,l]=Z(C(i.maxX,i.minY),s,e.angle),[c,d]=Z(C(i.maxX,i.maxY),s,e.angle),[u,f]=Z(C(i.minX,i.maxY),s,e.angle),h=[Math.min(r,a,c,u),Math.min(o,l,d,f),Math.max(r,a,c,u),Math.max(o,l,d,f)];if(n){const[m,p,U,b]=n;return[h[0]-b,h[1]-m,h[2]+p,h[3]+U]}return h},Kh=(e,t)=>e[0]>t[0]&&e[0]<t[2]&&e[1]>t[1]&&e[1]<t[3],ud=(e,t)=>{if(e==null||t==null)return!1;const[n,i,s,r]=e,[o,a,l,c]=t;return n<l&&s>o&&i<c&&r>a},Ti=(e,t,n=0,i=0)=>{if(Ce(e)){const[o,a,l,c]=$e(e,t),[d,u]=C((o+l)/2,(a+c)/2);return C(d+n,u+i)}const[s,r]=Mg(Mn(e,t));return C(s+n,r+i)},Gse=.1,nl=e=>Ce(e)||ts(e)?e.points.length<2||e.points.length===2&&_e(e)&&Uo(e.points[0],e.points[e.points.length-1],Gse):e.width===0&&e.height===0,_6=(e,t,n,i,s)=>{const[r,o,a,l]=Mn(e,s),c=Dt({clientX:i.offsetLeft,clientY:i.offsetTop},i),d=Dt({clientX:i.offsetLeft+t,clientY:i.offsetTop+n},i);return c.x<=a&&c.y<=l&&d.x>=r&&d.y>=o},j2=(e,t,n,i,s,r)=>{const[o,a,l,c]=pt(e,s),d=Dt({clientX:i.offsetLeft+((r==null?void 0:r.left)||0),clientY:i.offsetTop+((r==null?void 0:r.top)||0)},i),u=Dt({clientX:i.offsetLeft+t-((r==null?void 0:r.right)||0),clientY:i.offsetTop+n-((r==null?void 0:r.bottom)||0)},i);return o>=d.x&&a>=d.y&&l<=u.x&&c<=u.y},SA=(e,t,n)=>{const i=Math.abs(t),s=Math.abs(n);if(e==="line"||e==="arrow"||e==="freedraw"){const r=Math.round(Math.atan(s/i)/Ys)*Ys;r===0?n=0:r===Math.PI/2?t=0:n=i*Math.tan(r)*Math.sign(n)||n}else e!=="selection"&&(n=i*Math.sign(n));return{width:t,height:n}},Xse=(e,t,n,i,s)=>{let r=n-e,o=i-t;const a=Math.atan2(o,r);let l=Math.round(a/Ys)*Ys;if(s){const c=Math.floor(s/Ys)*Ys;Jee(a,c,c+Ys)&&(ete(a,s)<Ys/6?l=s:co(a)>co(s)?l=c+Ys:l=c)}if(l===0)o=0;else if(l===Math.PI/2)r=0;else{const c=Math.tan(l),d=-1,u=t-c*e,f=-1/c,h=-1,m=i-f*n,p=(d*m-h*u)/(c*h-f*d),U=(u*f-m*c)/(c*h-f*d);r=p-e,o=U-t}return{width:r,height:o}},Uz=e=>{const t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){const n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){const n=Math.abs(e.height);t.height=n,t.y=e.y-n}return t},jse=(e,t,n,i)=>{const s=ny(e,n.getNonDeletedElementsMap(),i),r=Dr(e);return s.flatMap(o=>{const a=Yse(o,r,t);return o.map(l=>{const c=n.mutateElement(l,{x:l.x+a.x,y:l.y+a.y});return ps(l,n,{simultaneouslyUpdated:o}),c})})},Yse=(e,t,{axis:n,position:i})=>{const s=Dr(e),[r,o]=n==="x"?["minX","maxX"]:["minY","maxY"],a={x:0,y:0};return i==="start"?{...a,[n]:t[r]-s[r]}:i==="end"?{...a,[n]:t[o]-s[o]}:{...a,[n]:(t[r]+t[o])/2-(s[r]+s[o])/2}},Wse=e=>{const t=e.slice(),n=new Set,i=r=>{var c,d,u;const o=(d=(c=r[0])==null?void 0:c.groupIds)==null?void 0:d.join(""),a=[r[0]],l=[];for(const f of r.slice(1))((u=f.groupIds)==null?void 0:u.join(""))===o?a.push(f):l.push(f);return l.length?[...a,...i(l)]:a},s=new Map;return t.forEach((r,o)=>{var a;if(!s.has(r.id))if((a=r.groupIds)!=null&&a.length){const l=r.groupIds[r.groupIds.length-1],c=t.slice(o).filter(d=>{var f;const u=(f=d==null?void 0:d.groupIds)==null?void 0:f.some(h=>h===l);return u&&s.set(d.id,!0),u});for(const d of i(c))n.add(d)}else n.add(r)}),n.size!==e.length?(console.error("normalizeGroupElementOrder: lost some elements... bailing!"),e):[...n]},Kse=e=>{const t=Cte(e),n=e.slice(),i=new Set;return n.forEach((s,r)=>{var o,a;if(s)if((o=s.boundElements)!=null&&o.length)i.add(s),n[r]=null,s.boundElements.forEach(l=>{const c=t.get(l.id);c&&l.type==="text"&&(i.add(c[0]),n[c[1]]=null)});else if(s.type==="text"&&s.containerId){const l=t.get(s.containerId);(a=l==null?void 0:l[0].boundElements)!=null&&a.find(c=>c.id===s.id)||(i.add(s),n[r]=null)}else i.add(s),n[r]=null}),i.size!==e.length?(console.error("normalizeBoundElementsOrder: lost some elements... bailing!"),e):[...i]},Zse=e=>Kse(Wse(e)),qse=(e,t,n,i)=>{const s=Gc(n);return s.id=ys(),s.updated=xg(),i&&(s.seed=Hr(),Ha(s)),s.groupIds=gse(s.groupIds,e,r=>(t.has(r)||t.set(r,ys()),t.get(r))),s},Rm=e=>{let{elements:t}=e;const n="appState"in e?e.appState:{editingGroupId:null,selectedGroupIds:{}},i=new Map,s=new Map,r=[],o=[],a=new Map,l=new Map,c=new Map,d=be(t),u=e.type==="in-place"?e.idsOfElementsToDuplicate:new Map(t.map(U=>[U.id,U]));if(e.type==="in-place")for(const U of Object.keys(e.appState.selectedGroupIds))t.filter(b=>{var y;return(y=b.groupIds)==null?void 0:y.includes(U)}).forEach(b=>u.set(b.id,b));t=Zse(t);const f=t.slice(),h=U=>{const y=S8(U).reduce((v,_)=>{if(i.has(_.id))return v;i.set(_.id,!0);const I=qse(n.editingGroupId,s,_,e.randomizeSeed);return i.set(I.id,!0),c.set(I.id,I),a.set(_.id,I.id),l.set(I.id,_),o.push(_),r.push(I),v.push(I),v},[]);return Array.isArray(U)?y:y[0]||null},m=(U,b)=>{if(b){if(U>f.length-1){f.push(...S8(b));return}f.splice(U+1,0,...S8(b))}},p=new Set(t.filter(U=>u.has(U.id)&&Ue(U)).map(U=>U.id));for(const U of t){if(i.has(U.id)||!u.has(U.id))continue;const b=KB(n,U);if(b){const y=Lt(t,b).flatMap(_=>Ue(_)?[...or(t,_.id),_]:[_]),v=Rd(f,_=>{var I;return(I=_.groupIds)==null?void 0:I.includes(b)});m(v,h(y));continue}if(!(U.frameId&&p.has(U.frameId))){if(Ue(U)){const y=U.id,v=or(t,y),_=Rd(f,I=>I.frameId===y||I.id===y);m(_,h([...v,U]));continue}if(Fi(U)){const y=Re(U,d),v=Rd(f,_=>_.id===U.id||"containerId"in _&&_.containerId===U.id);y?m(v,h([U,y])):m(v,h(U));continue}if(Nt(U)){const y=Bn(U,d),v=Rd(f,_=>_.id===U.id||_.id===(y==null?void 0:y.id));y?m(v,h([y,U])):m(v,h(U));continue}m(Rd(f,y=>y.id===U.id),h(U))}}if(qie(r,a,c),pse(f,o,a),e.overrides)for(const U of r){const b=l.get(U.id);b&&Object.assign(U,e.overrides({duplicateElement:U,origElement:b,origIdToDuplicateId:a}))}return{duplicatedElements:r,duplicateElementsMap:c,elementsWithDuplicates:f,origIdToDuplicateId:a}},I4=(e,t=0)=>{if(e==null||typeof e!="object")return e;if(Object.prototype.toString.call(e)==="[object Object]"){const i=typeof e.constructor=="function"?Object.create(Object.getPrototypeOf(e)):{};for(const s in e)if(e.hasOwnProperty(s)){if(t===0&&(s==="shape"||s==="canvas"))continue;i[s]=I4(e[s],t+1)}return i}if(Array.isArray(e)){let i=e.length;const s=new Array(i);for(;i--;)s[i]=I4(e[i],t+1);return s}return e},Gc=e=>I4(e),q={IMMEDIATELY:"IMMEDIATELY",NEVER:"NEVER",EVENTUALLY:"EVENTUALLY"};class Qse{constructor(t){F(this,"onDurableIncrementEmitter",new Jr);F(this,"onStoreIncrementEmitter",new Jr);F(this,"scheduledMacroActions",new Set);F(this,"scheduledMicroActions",[]);F(this,"_snapshot",Xo.empty());this.app=t}get snapshot(){return this._snapshot}set snapshot(t){this._snapshot=t}scheduleAction(t){this.scheduledMacroActions.add(t),this.satisfiesScheduledActionsInvariant()}scheduleCapture(){this.scheduleAction(q.IMMEDIATELY)}scheduleMicroAction(t){const{action:n}=t;let i;if("change"in t)i=t.change;else{const r=Xo.create(this.app.scene.getElementsMapIncludingDeleted(),this.app.state),o=r.maybeClone(n,t.elements?sre(t.elements):void 0,t.appState);i=hh.create(r,o)}const s="delta"in t?t.delta:void 0;this.scheduledMicroActions.push(()=>this.processAction({action:n,change:i,delta:s}))}commit(t,n){this.flushMicroActions();try{const i=this.getScheduledMacroAction();this.processAction({action:i,elements:t,appState:n})}finally{this.satisfiesScheduledActionsInvariant(),this.scheduledMacroActions=new Set}}clear(){this.snapshot=Xo.empty(),this.scheduledMacroActions=new Set}emitDurableIncrement(t,n=void 0,i=void 0){const s=this.snapshot;let r,o;if(n?r=n:r=hh.create(s,t),i?o=i:o=pu.calculate(s,t),!o.isEmpty()){const a=new Jse(r,o);this.onDurableIncrementEmitter.trigger(a),this.onStoreIncrementEmitter.trigger(a)}}emitEphemeralIncrement(t,n=void 0){let i;if(n)i=n;else{const r=this.snapshot;i=hh.create(r,t)}const s=new ere(i);this.onStoreIncrementEmitter.trigger(s)}applyChangeToSnapshot(t){const n=this.snapshot,i=this.snapshot.applyChange(t);return n===i?null:i}maybeCloneSnapshot(t,n,i){if(!n&&!i)return null;const s=this.snapshot,r=this.snapshot.maybeClone(t,n,i);return s===r?null:r}flushMicroActions(){for(const t of this.scheduledMicroActions)try{t()}catch(n){console.error("Failed to execute scheduled micro action",n)}this.scheduledMicroActions=[]}processAction(t){const{action:n}=t;if(n===q.EVENTUALLY&&!this.onStoreIncrementEmitter.subscribers.length)return;let i;if("change"in t?i=this.applyChangeToSnapshot(t.change):i=this.maybeCloneSnapshot(n,t.elements,t.appState),!i)return;const s="change"in t?t.change:void 0,r="delta"in t?t.delta:void 0;try{switch(n){case q.IMMEDIATELY:this.emitDurableIncrement(i,s,r);break;case q.NEVER:case q.EVENTUALLY:this.emitEphemeralIncrement(i,s);break;default:na(n,"Unknown store action")}}finally{switch(n){case q.IMMEDIATELY:case q.NEVER:this.snapshot=i;break}}}getScheduledMacroAction(){let t;return this.scheduledMacroActions.has(q.IMMEDIATELY)?t=q.IMMEDIATELY:this.scheduledMacroActions.has(q.NEVER)?t=q.NEVER:t=q.EVENTUALLY,t}satisfiesScheduledActionsInvariant(){if(!(this.scheduledMacroActions.size>=0&&this.scheduledMacroActions.size<=Object.keys(q).length)){const t=`There can be at most three store actions scheduled at the same time, but there are "${this.scheduledMacroActions.size}".`;console.error(t,this.scheduledMacroActions.values())}}}class hh{constructor(t,n){this.elements=t,this.appState=n}static create(t,n){const i=n.getChangedElements(t),s=n.getChangedAppState(t);return new hh(i,s)}}class bz{constructor(t,n){this.type=t,this.change=n}static isDurable(t){return t.type==="durable"}static isEphemeral(t){return t.type==="ephemeral"}}class Jse extends bz{constructor(t,n){super("durable",t),this.change=t,this.delta=n}}class ere extends bz{constructor(t){super("ephemeral",t),this.change=t}}class pu{constructor(t,n,i){this.id=t,this.elements=n,this.appState=i}static create(t,n,i={id:ys()}){return new this(i.id,t,n)}static calculate(t,n){const i=n.metadata.didElementsChange?Ld.calculate(t.elements,n.elements):Ld.empty(),s=n.metadata.didAppStateChange?Ln.calculate(t.appState,n.appState):Ln.empty();return this.create(i,s)}static restore(t){const{id:n,elements:i,appState:s}=t;return new this(n,Ld.restore(i),Ln.restore(s))}static load({id:t,elements:{added:n,removed:i,updated:s},appState:{delta:r}}){const o=Ld.create(n,i,s),a=Ln.create(r);return new this(t,o,a)}static squash(...t){const n=pu.empty();for(const i of t)n.elements.squash(i.elements),n.appState.squash(i.appState);return n}static inverse(t){return this.create(t.elements.inverse(),t.appState.inverse())}static applyTo(t,n,i,s){const[r,o]=t.elements.applyTo(n,Xo.empty().elements,s),[a,l]=t.appState.applyTo(i,r);return[r,a,o||l]}static applyLatestChanges(t,n,i,s){return this.create(t.elements.applyLatestChanges(n,i,s),t.appState,{id:t.id})}static empty(){return pu.create(Ld.empty(),Ln.empty())}isEmpty(){return this.elements.isEmpty()&&this.appState.isEmpty()}}class Xo{constructor(t,n,i={didElementsChange:!1,didAppStateChange:!1,isEmpty:!1}){F(this,"_lastChangedElementsHash",0);F(this,"_lastChangedAppStateHash",0);this.elements=t,this.appState=n,this.metadata=i}static create(t,n,i={didElementsChange:!1,didAppStateChange:!1}){return new Xo(t,xA(n)?n:gh(n),i)}static empty(){return new Xo(new Map,tre(),{didElementsChange:!1,didAppStateChange:!1,isEmpty:!0})}getChangedElements(t){const n={};for(const i of Wl(t.elements))this.elements.get(i.id)||(n[i.id]=Te(i,{isDeleted:!0}));for(const i of Wl(this.elements))t.elements.get(i.id)!==i&&(n[i.id]=i);return n}getChangedAppState(t){return Le.getRightDifferences(t.appState,this.appState).reduce((n,i)=>Object.assign(n,{[i]:this.appState[i]}),{})}isEmpty(){return this.metadata.isEmpty}applyChange(t){const n=new Map(this.elements);for(const[s,r]of Object.entries(t.elements))n.set(s,r);const i=gh({...this.appState,...t.appState});return Xo.create(n,i,{didElementsChange:Object.keys(t.elements).length>0,didAppStateChange:Object.keys(t.appState).length>0})}maybeClone(t,n,i){const s={shouldCompareHashes:!1};t===q.EVENTUALLY&&(s.shouldCompareHashes=!0);const r=this.maybeCreateElementsSnapshot(n,s),o=this.maybeCreateAppStateSnapshot(i,s);let a=!1,l=!1;return this.elements!==r&&(a=!0),this.appState!==o&&(l=!0),!a&&!l?this:new Xo(r,o,{didElementsChange:a,didAppStateChange:l})}maybeCreateAppStateSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.appState;const i=xA(t)?t:gh(t);return this.detectChangedAppState(i,n)?i:this.appState}maybeCreateElementsSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.elements;const i=this.detectChangedElements(t,n);return i!=null&&i.size?this.createElementsSnapshot(i):this.elements}detectChangedAppState(t,n={shouldCompareHashes:!1}){if(this.appState===t)return;const i=Le.isRightDifferent(this.appState,t);if(!i)return;const s=Ew(JSON.stringify(t));if(!(n.shouldCompareHashes&&this._lastChangedAppStateHash===s))return this._lastChangedAppStateHash=s,i}detectChangedElements(t,n={shouldCompareHashes:!1}){if(this.elements===t)return;const i=new Map;for(const r of Wl(this.elements))t.get(r.id)||i.set(r.id,Te(r,{isDeleted:!0}));for(const r of Wl(t)){const o=this.elements.get(r.id);if(!o||o.version<r.version){if(wt(r)&&!On(r))continue;i.set(r.id,r)}}if(!i.size)return;const s=Xz(i);if(!(n.shouldCompareHashes&&this._lastChangedElementsHash===s))return this._lastChangedElementsHash=s,i}createElementsSnapshot(t){const n=new Map;for(const i of Wl(this.elements))n.set(i.id,i);for(const i of Wl(t))n.set(i.id,Gc(i));return n}}const yz="__observedAppState",tre=()=>({name:null,editingGroupId:null,viewBackgroundColor:Ke.white,selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null,croppingElementId:null,activeLockedId:null,lockedMultiSelections:{}}),gh=e=>{const t={name:e.name,editingGroupId:e.editingGroupId,viewBackgroundColor:e.viewBackgroundColor,selectedElementIds:e.selectedElementIds,selectedGroupIds:e.selectedGroupIds,croppingElementId:e.croppingElementId,activeLockedId:e.activeLockedId,lockedMultiSelections:e.lockedMultiSelections,selectedLinearElement:e.selectedLinearElement?{elementId:e.selectedLinearElement.elementId,isEditing:!!e.selectedLinearElement.isEditing}:null};return Reflect.defineProperty(t,yz,{value:!0,enumerable:!1}),t},xA=e=>!!Reflect.get(e,yz),Ez="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Qf(e,t,n){const i=n[0];if(t!=null&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===i||t&&t.slice(-1)===i)throw new Error("trailing zero");if(t){let o=0;for(;(e[o]||i)===t[o];)o++;if(o>0)return t.slice(0,o)+Qf(e.slice(o),t.slice(o),n)}const s=e?n.indexOf(e[0]):0,r=t!=null?n.indexOf(t[0]):n.length;if(r-s>1){const o=Math.round(.5*(s+r));return n[o]}else return t&&t.length>1?t.slice(0,1):n[s]+Qf(e.slice(1),null,n)}function vz(e){if(e.length!==_z(e[0]))throw new Error("invalid integer part of order key: "+e)}function _z(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw new Error("invalid order key head: "+e)}function W1(e){const t=_z(e[0]);if(t>e.length)throw new Error("invalid order key: "+e);return e.slice(0,t)}function CA(e,t){if(e==="A"+t[0].repeat(26))throw new Error("invalid order key: "+e);const n=W1(e);if(e.slice(n.length).slice(-1)===t[0])throw new Error("invalid order key: "+e)}function AA(e,t){vz(e);const[n,...i]=e.split("");let s=!0;for(let r=i.length-1;s&&r>=0;r--){const o=t.indexOf(i[r])+1;o===t.length?i[r]=t[0]:(i[r]=t[o],s=!1)}if(s){if(n==="Z")return"a"+t[0];if(n==="z")return null;const r=String.fromCharCode(n.charCodeAt(0)+1);return r>"a"?i.push(t[0]):i.pop(),r+i.join("")}else return n+i.join("")}function nre(e,t){vz(e);const[n,...i]=e.split("");let s=!0;for(let r=i.length-1;s&&r>=0;r--){const o=t.indexOf(i[r])-1;o===-1?i[r]=t.slice(-1):(i[r]=t[o],s=!1)}if(s){if(n==="a")return"Z"+t.slice(-1);if(n==="A")return null;const r=String.fromCharCode(n.charCodeAt(0)-1);return r<"Z"?i.push(t.slice(-1)):i.pop(),r+i.join("")}else return n+i.join("")}function df(e,t,n=Ez){if(e!=null&&CA(e,n),t!=null&&CA(t,n),e!=null&&t!=null&&e>=t)throw new Error(e+" >= "+t);if(e==null){if(t==null)return"a"+n[0];const l=W1(t),c=t.slice(l.length);if(l==="A"+n[0].repeat(26))return l+Qf("",c,n);if(l<t)return l;const d=nre(l,n);if(d==null)throw new Error("cannot decrement any more");return d}if(t==null){const l=W1(e),c=e.slice(l.length),d=AA(l,n);return d??l+Qf(c,null,n)}const i=W1(e),s=e.slice(i.length),r=W1(t),o=t.slice(r.length);if(i===r)return i+Qf(s,o,n);const a=AA(i,n);if(a==null)throw new Error("cannot increment any more");return a<t?a:i+Qf(s,null,n)}function S4(e,t,n,i=Ez){if(n===0)return[];if(n===1)return[df(e,t,i)];if(t==null){let o=df(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=df(o,t,i),a.push(o);return a}if(e==null){let o=df(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=df(e,o,i),a.push(o);return a.reverse(),a}const s=Math.floor(n/2),r=df(e,t,i);return[...S4(e,r,s,i),r,...S4(r,t,n-s-1,i)]}class ire extends Error{constructor(){super(...arguments);F(this,"code","ELEMENT_HAS_INVALID_INDEX")}}const fw=(e,{shouldThrow:t=!1,includeBoundTextValidation:n=!1,ignoreLogs:i,reconciliationContext:s})=>{const r=[],o=l=>`${l==null?void 0:l.index}:${l==null?void 0:l.id}:${l==null?void 0:l.type}:${l==null?void 0:l.isDeleted}:${l==null?void 0:l.version}:${l==null?void 0:l.versionNonce}`,a=e.map(l=>l.index);for(const[l,c]of a.entries()){const d=a[l-1],u=a[l+1];if(x4(c,d,u)||r.push(`Fractional indices invariant has been compromised: "${o(e[l-1])}", "${o(e[l])}", "${o(e[l+1])}"`),n&&Fi(e[l])){const f=e[l],h=Re(f,be(e));h&&h.index<=f.index&&r.push(`Fractional indices invariant for bound elements has been compromised: "${o(h)}", "${o(f)}"`)}}if(r.length){const l=new ire,c=[];if(s&&(c.push("Additional reconciliation context:"),c.push(s.localElements.map(d=>o(d))),c.push(s.remoteElements.map(d=>o(d)))),i||console.error(r.join(`

`),l.stack,e.map(d=>o(d)),...c),t)throw l}},hw=e=>e.sort((t,n)=>MA(t)&&MA(n)?t.index<n.index?-1:t.index>n.index?1:t.id<n.id?-1:1:1),bo=(e,t)=>{try{const n=be(e),i=rre(e,t),s=gw(e,i),r=e.map(o=>{const a=s.get(o);return a?{...o,index:a.index}:o});fw(r,{includeBoundTextValidation:!1,shouldThrow:!0,ignoreLogs:!0});for(const[o,{index:a}]of s)Cn(o,n,{index:a})}catch{fd(e)}return e},fd=e=>{const t=be(e),n=wz(e),i=gw(e,n);for(const[s,{index:r}]of i)Cn(s,t,{index:r});return e},sre=e=>{const t=be(e),n=wz(e),i=gw(e,n);for(const[s,{index:r}]of i)t.set(s.id,Te(s,{index:r}));return t},rre=(e,t)=>{const n=[];let i=0;for(;i<e.length;)if(t.has(e[i].id)){const s=[i-1,i];for(;++i<e.length&&t.has(e[i].id);)s.push(i);s.push(i),n.push(s)}else i++;return n},wz=e=>{const t=[];let n,i,s=-1,r=0;const o=c=>{var f;const d=e[s]?e[s].index:void 0,u=(f=e[c-1])==null?void 0:f.index;return!d&&u||d&&u&&u>d?[u,c-1]:[d,s]},a=c=>{var f;const d=e[r]?e[r].index:void 0;if(d&&c<r)return[d,r];let u=r;for(;++u<e.length;){const h=(f=e[u])==null?void 0:f.index;if(!d&&h||d&&h&&h>d)return[h,u]}return[void 0,u]};let l=0;for(;l<e.length;){const c=e[l].index;if([n,s]=o(l),[i,r]=a(l),x4(c,n,i))l++;else{const d=[s,l];for(;++l<e.length;){const u=e[l].index,[f,h]=o(l),[m,p]=a(l);if(x4(u,f,m))break;[n,s]=[f,h],[i,r]=[m,p],d.push(l)}d.push(r),t.push(d)}}return t},x4=(e,t,n)=>e?t&&n?t<e&&e<n:!t&&n?e<n:t&&!n?t<e:!!e:!1,gw=(e,t)=>{var i,s;const n=new Map;for(const r of t){const o=r.shift(),a=r.pop(),l=S4((i=e[o])==null?void 0:i.index,(s=e[a])==null?void 0:s.index,r.length);for(let c=0;c<r.length;c++){const d=e[r[c]];n.set(d,{index:l[c]})}}return n},MA=e=>!!e.index;var Tz="Expected a function",kA=NaN,ore="[object Symbol]",are=/^\s+|\s+$/g,lre=/^[-+]0x[0-9a-f]+$/i,cre=/^0b[01]+$/i,dre=/^0o[0-7]+$/i,ure=parseInt,fre=typeof $a=="object"&&$a&&$a.Object===Object&&$a,hre=typeof self=="object"&&self&&self.Object===Object&&self,gre=fre||hre||Function("return this")(),mre=Object.prototype,pre=mre.toString,Ure=Math.max,bre=Math.min,B8=function(){return gre.Date.now()};function yre(e,t,n){var i,s,r,o,a,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(Tz);t=RA(t)||0,w6(n)&&(d=!!n.leading,u="maxWait"in n,r=u?Ure(RA(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f);function h(R){var T=i,w=s;return i=s=void 0,c=R,o=e.apply(w,T),o}function m(R){return c=R,a=setTimeout(b,t),d?h(R):o}function p(R){var T=R-l,w=R-c,S=t-T;return u?bre(S,r-w):S}function U(R){var T=R-l,w=R-c;return l===void 0||T>=t||T<0||u&&w>=r}function b(){var R=B8();if(U(R))return y(R);a=setTimeout(b,p(R))}function y(R){return a=void 0,f&&i?h(R):(i=s=void 0,o)}function v(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function _(){return a===void 0?o:y(B8())}function I(){var R=B8(),T=U(R);if(i=arguments,s=this,l=R,T){if(a===void 0)return m(l);if(u)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=v,I.flush=_,I}function Ere(e,t,n){var i=!0,s=!0;if(typeof e!="function")throw new TypeError(Tz);return w6(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),yre(e,t,{leading:i,maxWait:t,trailing:s})}function w6(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function vre(e){return!!e&&typeof e=="object"}function _re(e){return typeof e=="symbol"||vre(e)&&pre.call(e)==ore}function RA(e){if(typeof e=="number")return e;if(_re(e))return kA;if(w6(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=w6(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(are,"");var n=cre.test(e);return n||dre.test(e)?ure(e.slice(2),n?2:8):lre.test(e)?kA:+e}var wre=Ere;const jo=Sl(wre),LA=e=>{const t=new Map,n=[];for(const i of e)i.isDeleted||(n.push(i),t.set(i.id,i));return{elementsMap:t,elements:n}},Tre=jo(e=>{window!=null&&window.DEBUG_FRACTIONAL_INDICES&&fw(e,{shouldThrow:kte(),includeBoundTextValidation:!0})},1e3*60,{leading:!0,trailing:!1}),Ire=e=>{const t=["includeBoundTextElement","includeElementsInFrames"];let n="";for(const i of t)n+=`${i}:${e[i]?"1":"0"}`;return n};class T6{constructor(t=null,n){F(this,"callbacks",new Set);F(this,"nonDeletedElements",[]);F(this,"nonDeletedElementsMap",ia(new Map));F(this,"elements",[]);F(this,"nonDeletedFramesLikes",[]);F(this,"frames",[]);F(this,"elementsMap",ia(new Map));F(this,"selectedElementsCache",{selectedElementIds:null,elements:null,cache:new Map});F(this,"sceneNonce");F(this,"insertElement",t=>{const n=t.frameId?this.getElementIndex(t.frameId):this.elements.length;this.insertElementAtIndex(t,n)});F(this,"insertElements",t=>{var i;if(!t.length)return;const n=(i=t[0])!=null&&i.frameId?this.getElementIndex(t[0].frameId):this.elements.length;this.insertElementsAtIndex(t,n)});F(this,"getContainerElement",t=>t&&t.containerId&&this.getElement(t.containerId)||null);F(this,"getElementsFromId",t=>{const n=this.getNonDeletedElementsMap(),i=n.get(t);return i?[i]:Lt(n,t)});t&&this.replaceAllElements(t,n)}getSceneNonce(){return this.sceneNonce}getNonDeletedElementsMap(){return this.nonDeletedElementsMap}getElementsIncludingDeleted(){return this.elements}getElementsMapIncludingDeleted(){return this.elementsMap}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(t){const n=Ire(t),i=(t==null?void 0:t.elements)||this.nonDeletedElements;if(this.selectedElementsCache.elements===i&&this.selectedElementsCache.selectedElementIds===t.selectedElementIds){const r=this.selectedElementsCache.cache.get(n);if(r)return r}else(t==null?void 0:t.elements)==null&&this.selectedElementsCache.cache.clear();const s=Ye(i,{selectedElementIds:t.selectedElementIds},t);return(t==null?void 0:t.elements)==null&&(this.selectedElementsCache.selectedElementIds=t.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(n,s)),s}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(t){return this.elementsMap.get(t)||null}getNonDeletedElement(t){const n=this.getElement(t);return n&&N4(n)?n:null}mapElements(t){let n=!1;const i=this.elements.map(s=>{const r=t(s);return r!==s&&(n=!0),r});return n&&this.replaceAllElements(i),n}replaceAllElements(t,n){const i=Mte(t),s=[];n!=null&&n.skipValidation||Tre(i),this.elements=fd(i),this.elementsMap.clear(),this.elements.forEach(o=>{Ue(o)&&s.push(o),this.elementsMap.set(o.id,o)});const r=LA(this.elements);this.nonDeletedElements=r.elements,this.nonDeletedElementsMap=r.elementsMap,this.frames=s,this.nonDeletedFramesLikes=LA(this.frames).elements,this.triggerUpdate()}triggerUpdate(){this.sceneNonce=Hr();for(const t of Array.from(this.callbacks))t()}onUpdate(t){if(this.callbacks.has(t))throw new Error;return this.callbacks.add(t),()=>{if(!this.callbacks.has(t))throw new Error;this.callbacks.delete(t)}}destroy(){this.elements=[],this.nonDeletedElements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),this.callbacks.clear()}insertElementAtIndex(t,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),t,...this.elements.slice(n)];bo(i,be([t])),this.replaceAllElements(i)}insertElementsAtIndex(t,n){if(!t.length)return;if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),...t,...this.elements.slice(n)];bo(i,be(t)),this.replaceAllElements(i)}getElementIndex(t){return this.elements.findIndex(n=>n.id===t)}mutateElement(t,n,i={informMutation:!0,isDragging:!1}){const s=this.getNonDeletedElementsMap(),{version:r}=t,{version:o}=Cn(t,s,n,i);return this.elementsMap.has(t.id)&&r!==o&&i.informMutation&&this.triggerUpdate(),t}}class Le{constructor(t,n){this.deleted=t,this.inserted=n}static create(t,n,i,s){const r=i&&s!=="inserted"?i(t,"deleted"):t,o=i&&s!=="deleted"?i(n,"inserted"):n;return new Le(r,o)}static calculate(t,n,i,s){if(t===n)return Le.empty();const r={},o={};for(const c of this.getDifferences(t,n))r[c]=t[c],o[c]=n[c];const[a,l]=s?s(r,o):[r,o];return Le.create(a,l,i)}static empty(){return new Le({},{})}static isEmpty(t){return!Object.keys(t.deleted).length&&!Object.keys(t.inserted).length}static merge(t,n,i=Le.empty()){return Le.create({...t.deleted,...n.deleted,...i.deleted},{...t.inserted,...n.inserted,...i.inserted})}static mergeObjects(t,n,i={}){const s={...t};for(const r of Object.keys(i))delete s[r];return{...s,...n}}static mergeArrays(t,n,i,s){return Object.values(Le.mergeObjects(Ia(t??[],s),Ia(n??[],s),Ia(i??[],s)))}static diffObjects(t,n,i,s){if(!t[i]&&!n[i])return;const r=t[i]!==null&&typeof t[i]=="object",o=n[i]!==null&&typeof n[i]=="object";if(r||o){const a=t[i]??{},l=n[i]??{},c=Le.getLeftDifferences(a,l).reduce((u,f)=>(u[f]=s(a[f]),u),{}),d=Le.getRightDifferences(a,l).reduce((u,f)=>(u[f]=s(l[f]),u),{});Object.keys(c).length||Object.keys(d).length?(Reflect.set(t,i,c),Reflect.set(n,i,d)):(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}else t[i]===n[i]&&(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}static diffArrays(t,n,i,s){if(!(!t[i]&&!n[i])&&(Array.isArray(t[i])||Array.isArray(n[i]))){const r=Array.isArray(t[i])?t[i]:[],o=Array.isArray(n[i])?n[i]:[],a=Ia(Le.getLeftDifferences(Ia(r,s),Ia(o,s)),c=>c),l=Ia(Le.getRightDifferences(Ia(r,s),Ia(o,s)),c=>c);if(Object.keys(a).length||Object.keys(l).length){const c=r.filter(u=>a[s?s(u):String(u)]),d=o.filter(u=>l[s?s(u):String(u)]);Reflect.set(t,i,c),Reflect.set(n,i,d)}else Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i)}}static isLeftDifferent(t,n,i=!1){return!!this.distinctKeysIterator("left",t,n,i).next().value}static isRightDifferent(t,n,i=!1){return!!this.distinctKeysIterator("right",t,n,i).next().value}static isInnerDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("inner",t,n,i).next().value}static isDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("full",t,n,i).next().value}static getLeftDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("left",t,n,i)).sort()}static getRightDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("right",t,n,i)).sort()}static getInnerDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("inner",t,n,i)).sort()}static getDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("full",t,n,i)).sort()}static*distinctKeysIterator(t,n,i,s=!1){if(n===i)return;let r=[];t==="left"?r=Object.keys(n):t==="right"?r=Object.keys(i):t==="inner"?r=Object.keys(n).filter(o=>o in i):t==="full"?r=Array.from(new Set([...Object.keys(n),...Object.keys(i)])):na(t,`Unknown distinctKeysIterator's join param "${t}"`,!0);for(const o of r){const a=n[o],l=i[o];if(a!==l){if(!s&&typeof a=="object"&&typeof l=="object"&&a!==null&&l!==null&&vi(a,l))continue;yield o}}}}class Ln{constructor(t){this.delta=t}static create(t){return new Ln(t)}static calculate(t,n){const i=Le.calculate(t,n,Ln.orderAppStateKeys,Ln.postProcess);return new Ln(i)}static restore(t){const{delta:n}=t;return new Ln(n)}static empty(){return new Ln(Le.create({},{}))}inverse(){const t=Le.create(this.delta.inserted,this.delta.deleted);return new Ln(t)}squash(t){if(t.isEmpty())return this;const n=Le.mergeObjects(this.delta.deleted.selectedElementIds??{},t.delta.deleted.selectedElementIds??{}),i=Le.mergeObjects(this.delta.inserted.selectedElementIds??{},t.delta.inserted.selectedElementIds??{}),s=Le.mergeObjects(this.delta.deleted.selectedGroupIds??{},t.delta.deleted.selectedGroupIds??{}),r=Le.mergeObjects(this.delta.inserted.selectedGroupIds??{},t.delta.inserted.selectedGroupIds??{}),o=Le.mergeObjects(this.delta.deleted.lockedMultiSelections??{},t.delta.deleted.lockedMultiSelections??{}),a=Le.mergeObjects(this.delta.inserted.lockedMultiSelections??{},t.delta.inserted.lockedMultiSelections??{}),l={},c={};return(Object.keys(n).length||Object.keys(i).length)&&(c.selectedElementIds=n,l.selectedElementIds=i),(Object.keys(s).length||Object.keys(r).length)&&(c.selectedGroupIds=s,l.selectedGroupIds=r),(Object.keys(o).length||Object.keys(a).length)&&(c.lockedMultiSelections=o,l.lockedMultiSelections=a),this.delta=Le.merge(this.delta,t.delta,Le.create(c,l)),this}applyTo(t,n){try{const{selectedElementIds:i={},selectedGroupIds:s={},lockedMultiSelections:r={}}=this.delta.deleted,{selectedElementIds:o={},selectedGroupIds:a={},lockedMultiSelections:l={},selectedLinearElement:c,...d}=this.delta.inserted,u=Le.mergeObjects(t.selectedElementIds,o,i),f=Le.mergeObjects(t.selectedGroupIds,a,s),h=Le.mergeObjects(t.lockedMultiSelections,l,r),m=c&&n.has(c.elementId)?new re(n.get(c.elementId),n,c.isEditing):null,p={...t,...d,selectedElementIds:u,selectedGroupIds:f,lockedMultiSelections:h,selectedLinearElement:typeof c<"u"?m:t.selectedLinearElement},U=this.filterInvisibleChanges(t,p,n);return[p,U]}catch(i){return console.error("Couldn't apply appstate change",i),[t,!1]}}isEmpty(){return Le.isEmpty(this.delta)}filterInvisibleChanges(t,n,i){const s=gh(t),r=gh(n),o=Le.isRightDifferent(Ln.stripElementsProps(s),Ln.stripElementsProps(r)),a=Le.isRightDifferent(Ln.stripStandaloneProps(s),Ln.stripStandaloneProps(r));if(!o&&!a)return!1;const l={value:o};if(a){const c=Le.getRightDifferences(Ln.stripStandaloneProps(s),Ln.stripStandaloneProps(r));let d=new Set;(c.includes("editingGroupId")||c.includes("selectedGroupIds"))&&(d=hse(i));for(const u of c)switch(u){case"selectedElementIds":n[u]=Ln.filterSelectedElements(n[u],i,l);break;case"selectedGroupIds":n[u]=Ln.filterSelectedGroups(n[u],d,l);break;case"croppingElementId":{const y=n[u];if(!y)l.value=!0;else{const v=i.get(y);v&&!v.isDeleted?l.value=!0:n[u]=null}break}case"editingGroupId":const f=n[u];f?d.has(f)?l.value=!0:n[u]=null:l.value=!0;break;case"selectedLinearElement":const h=n[u];if(!h)l.value=!0;else{const y=i.get(h.elementId);y&&!y.isDeleted?l.value=!0:n[u]=null}break;case"lockedMultiSelections":const m=t[u]||{},p=n[u]||{};vi(m,p)||(l.value=!0);break;case"activeLockedId":const U=t[u]||null,b=n[u]||null;U!==b&&(l.value=!0);break;default:na(u,`Unknown ObservedElementsAppState's key "${u}"`,!0)}}return l.value}static filterSelectedElements(t,n,i){const s=Object.keys(t);if(!s.length)return i.value=!0,t;const r={...t};for(const o of s){const a=n.get(o);a&&!a.isDeleted?i.value=!0:delete r[o]}return r}static filterSelectedGroups(t,n,i){if(!Object.keys(t).length)return i.value=!0,t;const r={...t};for(const o of Object.keys(r))n.has(o)?i.value=!0:delete r[o];return r}static stripElementsProps(t){const{editingGroupId:n,selectedGroupIds:i,selectedElementIds:s,selectedLinearElement:r,croppingElementId:o,lockedMultiSelections:a,activeLockedId:l,...c}=t;return c}static stripStandaloneProps(t){const{name:n,viewBackgroundColor:i,...s}=t;return s}static postProcess(t,n){try{Le.diffObjects(t,n,"selectedElementIds",i=>!0),Le.diffObjects(t,n,"selectedGroupIds",i=>i??!1),Le.diffObjects(t,n,"lockedMultiSelections",i=>i??{})}catch{console.error("Couldn't postprocess appstate change deltas.")}finally{return[t,n]}}static orderAppStateKeys(t){const n={};for(const i of Object.keys(t).sort())n[i]=t[i];return n}}const _t=class _t{constructor(t,n,i){this.added=t,this.removed=n,this.updated=i}static create(t,n,i,s={shouldRedistribute:!1}){let r;if(s.shouldRedistribute){const o={},a={},l={},c=[...Object.entries(t),...Object.entries(n),...Object.entries(i)];for(const[d,u]of c)this.satisfiesAddition(u)?o[d]=u:this.satisfiesRemoval(u)?a[d]=u:l[d]=u;r=new _t(o,a,l)}else r=new _t(t,n,i);return r}static restore(t){const{added:n,removed:i,updated:s}=t;return _t.create(n,i,s)}static validate(t,n,i){for(const[s,r]of Object.entries(t[n]))if(!this.satisfiesCommmonInvariants(r)||!this.satisfiesUniqueInvariants(t,s)||!i(r))throw console.error(`Broken invariant for "${n}" delta, element "${s}", delta:`,r),new Error(`ElementsDelta invariant broken for element "${s}".`)}static calculate(t,n){if(t===n)return _t.empty();const i={},s={},r={};for(const o of t.values())if(!n.get(o.id)){const l={...o},c={isDeleted:!0,version:o.version+1,versionNonce:Hr()},d=Le.create(l,c,_t.stripIrrelevantProps);o.isDeleted?r[o.id]=d:s[o.id]=d}for(const o of n.values()){const a=t.get(o.id);if(!a){const l={isDeleted:!0,version:o.version-1,versionNonce:Hr()},c={...o},d=Le.create(l,c,_t.stripIrrelevantProps);o.isDeleted?r[o.id]=d:i[o.id]=d;continue}if(a.versionNonce!==o.versionNonce){const l=Le.calculate(a,o,_t.stripIrrelevantProps,_t.postProcess);if(typeof a.isDeleted=="boolean"&&typeof o.isDeleted=="boolean"&&a.isDeleted!==o.isDeleted){a.isDeleted&&!o.isDeleted?i[o.id]=l:s[o.id]=l;continue}r[o.id]=l}}return _t.create(i,s,r)}static empty(){return _t.create({},{},{})}inverse(){const t=r=>{const o={};for(const[a,{inserted:l,deleted:c}]of Object.entries(r))o[a]=Le.create({...l},{...c});return o},n=t(this.added),i=t(this.removed),s=t(this.updated);return _t.create(i,n,s)}isEmpty(){return Object.keys(this.added).length===0&&Object.keys(this.removed).length===0&&Object.keys(this.updated).length===0}applyLatestChanges(t,n,i){const s=(c,d)=>(u,f)=>{let h;switch(f){case"deleted":h=c;break;case"inserted":h=d;break}if(!h)return console.error("Element not found when trying to apply latest changes"),u;const m={};for(const p of Object.keys(u))switch(p){case"boundElements":m[p]=u[p];break;default:m[p]=h[p]}return m},r=c=>{const d={};for(const[u,f]of Object.entries(c)){const h=t.get(u),m=n.get(u);let p=null;h||m?p=Le.create(f.deleted,f.inserted,s(h,m),i):p=f,Le.isInnerDifferent(p.deleted,p.inserted)&&(d[u]=p)}return d},o=r(this.added),a=r(this.removed),l=r(this.updated);return _t.create(o,a,l,{shouldRedistribute:!0})}applyTo(t,n=Xo.empty().elements,i){let s=new Map(t),r;const o={containsVisibleDifference:!1,containsZindexDifference:!1,applyDirection:void 0};try{const a=_t.createApplier(t,s,n,o,i),l=a(this.added),c=a(this.removed),d=a(this.updated),u=this.resolveConflicts(t,s,o.applyDirection);r=new Map([...l,...c,...d,...u])}catch(a){return console.error("Couldn't apply elements delta",a),[t,!0]}try{s=_t.reorderElements(s,r,o),_t.redrawElements(s,r)}catch(a){console.error("Couldn't mutate elements after applying elements change",a)}finally{return[s,o.containsVisibleDifference]}}squash(t){if(t.isEmpty())return this;const{added:n,removed:i,updated:s}=t,r=(o,a)=>{const l=Le.mergeArrays(o.deleted.boundElements??[],a.deleted.boundElements??[],void 0,d=>d.id)??[],c=Le.mergeArrays(o.inserted.boundElements??[],a.inserted.boundElements??[],void 0,d=>d.id)??[];if(!(!l.length&&!c.length))return Le.create({boundElements:l},{boundElements:c})};for(const[o,a]of Object.entries(n)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.added[o]=a;else{const c=r(l,a);delete this.removed[o],delete this.updated[o],this.added[o]=Le.merge(l,a,c)}}for(const[o,a]of Object.entries(i)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.removed[o]=a;else{const c=r(l,a);delete this.added[o],delete this.updated[o],this.removed[o]=Le.merge(l,a,c)}}for(const[o,a]of Object.entries(s)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.updated[o]=a;else{const c=r(l,a),d=Le.merge(l,a,c);l===this.added[o]?this.added[o]=d:l===this.removed[o]?this.removed[o]=d:this.updated[o]=d}}return this}static applyDelta(t,n,i,s){var o,a,l;const r={};for(const c of Object.keys(n.inserted)){if(c==="boundElements"||(o=s==null?void 0:s.excludedProperties)!=null&&o.has(c))continue;const d=n.inserted[c];Reflect.set(r,c,d)}if((a=n.deleted.boundElements)!=null&&a.length||(l=n.inserted.boundElements)!=null&&l.length){const c=Le.mergeArrays(t.boundElements,n.inserted.boundElements,n.deleted.boundElements,d=>d.id);Object.assign(r,{boundElements:c})}if(!i.containsVisibleDifference){const{index:c,...d}=r,u=_t.checkForVisibleDifference(t,d);i.containsVisibleDifference=u}return i.containsZindexDifference||(i.containsZindexDifference=n.deleted.index!==n.inserted.index),Te(t,r,!0)}static checkForVisibleDifference(t,n){return t.isDeleted&&n.isDeleted!==!1?!1:t.isDeleted&&n.isDeleted===!1||t.isDeleted===!1&&n.isDeleted?!0:Le.isRightDifferent(t,n)}resolveConflicts(t,n,i="forward"){const s=new Map,r=(a,l)=>{const c=n.get(a.id);if(!c)return;const d=t.get(a.id),u=i==="forward"?c.version+1:c.version-1,f=l;let h;d===c?h=Te(c,{...f,version:u},!0):h=Cn(c,n,{...f,version:(d==null?void 0:d.version)!==c.version?c.version:u}),s.set(h.id,h),n.set(h.id,h)};for(const a of Object.keys(this.removed))_t.unbindAffected(t,n,a,r);for(const a of Object.keys(this.added))_t.rebindAffected(t,n,a,r);for(const[a]of Array.from(Object.entries(this.updated)).filter(([l,c])=>Object.keys({...c.deleted,...c.inserted}).find(d=>Qie.has(d)))){const l=n.get(a);!l||l.isDeleted||_t.rebindAffected(t,n,a,r)}const o=new Map(Array.from(t).filter(([a])=>s.has(a)));return this.squash(_t.calculate(o,s)),s}static unbindAffected(t,n,i,s){const r=()=>t.get(i),o=()=>n.get(i);Zf.unbindAffected(n,r(),s),Zf.unbindAffected(n,o(),s),qf.unbindAffected(n,r(),s),qf.unbindAffected(n,o(),s)}static rebindAffected(t,n,i,s){const r=()=>t.get(i),o=()=>n.get(i);Zf.unbindAffected(n,r(),s),Zf.rebindAffected(n,o(),s),qf.unbindAffected(n,r(),(a,l)=>{fe(a)&&s(a,l)}),qf.rebindAffected(n,o(),s)}static redrawElements(t,n){try{const i=new T6(t,{skipValidation:!0});_t.redrawTextBoundingBoxes(i,n),_t.redrawBoundArrows(i,n)}catch(i){console.error("Couldn't redraw elements",i)}finally{return t}}static redrawTextBoundingBoxes(t,n){const i=t.getNonDeletedElementsMap(),s=new Map;for(const r of n.values()){if(Nt(r)){const{containerId:o}=r,a=o?i.get(o):void 0;a&&s.set(a.id,{container:a,boundText:r})}if(Fi(r)){const o=ra(r),a=o?i.get(o):void 0;a&&s.set(r.id,{container:r,boundText:a})}}for(const{container:r,boundText:o}of s.values())r.isDeleted||o.isDeleted||ns(o,r,t)}static redrawBoundArrows(t,n){for(const i of n.values())!i.isDeleted&&Lr(i)&&ps(i,t,{changedElements:n})}static reorderElements(t,n,i){if(!i.containsZindexDifference)return t;const s=Array.from(t.values()),r=hw([...s]),o=Le.getRightDifferences(s,r,!0).reduce((a,l)=>{const c=s[Number(l)];return c&&n.has(c.id)&&a.set(c.id,c),a},new Map);return!i.containsVisibleDifference&&o.size&&(i.containsVisibleDifference=!0),be(bo(r,o))}static postProcess(t,n){try{Le.diffArrays(t,n,"boundElements",r=>r.id);const i=t.points??[],s=n.points??[];Le.isDifferent(i,s)||(Reflect.deleteProperty(t,"points"),Reflect.deleteProperty(n,"points"))}catch{console.error("Couldn't postprocess elements delta.")}finally{return[t,n]}}static stripIrrelevantProps(t){const{id:n,updated:i,...s}=t;return s}};F(_t,"satisfiesAddition",({deleted:t,inserted:n})=>t.isDeleted===!0&&!n.isDeleted),F(_t,"satisfiesRemoval",({deleted:t,inserted:n})=>!t.isDeleted&&n.isDeleted===!0),F(_t,"satisfiesUpdate",({deleted:t,inserted:n})=>!!t.isDeleted==!!n.isDeleted),F(_t,"satisfiesCommmonInvariants",({deleted:t,inserted:n})=>!!(Number.isInteger(t.version)&&Number.isInteger(n.version)&&t.version>=0&&n.version>=0&&t.version!==n.version)),F(_t,"satisfiesUniqueInvariants",(t,n)=>{const{added:i,removed:s,updated:r}=t;return[i[n],s[n],r[n]].filter(Boolean).length===1}),F(_t,"createApplier",(t,n,i,s,r)=>o=>{const a=_t.createGetter(n,i,s);return Object.entries(o).reduce((l,[c,d])=>{const u=a(c,d.inserted);if(u){const f=_t.applyDelta(u,d,s,r);if(n.set(f.id,f),l.set(f.id,f),!s.applyDirection){const h=t.get(c);h&&(s.applyDirection=h.version>f.version?"backward":"forward")}}return l},new Map)}),F(_t,"createGetter",(t,n,i)=>(s,r)=>{let o=t.get(s);return o||(o=n.get(s),o?(i.containsZindexDifference=!0,(!r.isDeleted||r.isDeleted&&!o.isDeleted)&&(i.containsVisibleDifference=!0)):o=Te({id:s,version:1},{...r})),o});let Ld=_t;const Sre=(e,t,n,i)=>{const[s,r,o,a]=n.axis==="x"?["minX","midX","maxX","width"]:["minY","midY","maxY","height"],l=Dr(e),c=ny(e,t,i).map(h=>[h,Dr(h)]).sort((h,m)=>h[1][r]-m[1][r]);let d=0;for(const h of c)d+=h[1][a];const u=(l[a]-d)/(c.length-1);if(u<0){const h=c.findIndex(b=>b[1][s]===l[s]),m=c.findIndex(b=>b[1][o]===l[o]),p=(c[m][1][r]-c[h][1][r])/(c.length-1);let U=c[h][1][r];return c.flatMap(([b,y],v)=>{const _={x:0,y:0};return v!==h&&v!==m&&(U+=p,_[n.axis]=U-y[r]),b.map(I=>Te(I,{x:I.x+_.x,y:I.y+_.y}))})}let f=l[s];return c.flatMap(([h,m])=>{const p={x:0,y:0};return p[n.axis]=f-m[s],f+=u,f+=m[a],h.map(U=>Te(U,{x:U.x+p.x,y:U.y+p.y}))})},xre=(e,t,n,i,s,r)=>{if(t.length===1&&ye(t[0])&&(t[0].startBinding||t[0].endBinding))return;const o=t.filter(f=>{if(ye(f)&&f.startBinding&&f.endBinding){const h=t.find(p=>{var U;return p.id===((U=f.startBinding)==null?void 0:U.elementId)}),m=t.find(p=>{var U;return p.id===((U=f.endBinding)==null?void 0:U.elementId)});return h&&m}return!0}),a=new Set(o),l=o.filter(f=>Ue(f)).map(f=>f.id);if(l.length>0)for(const f of i.getNonDeletedElements())f.frameId!==null&&l.includes(f.frameId)&&a.add(f);const c=[];for(const f of a){const h=e.originalElements.get(f.id);if(!h)return;c.push(h)}const d=Cre(pt(c),n,s,r),u=new Set(Array.from(a,f=>f.id));a.forEach(f=>{const h=!_e(f),m=h||(f.startBinding?u.has(f.startBinding.elementId):!1),p=h||(f.endBinding?u.has(f.endBinding.elementId):!1);if(_e(f)){if(a.size>1||Math.max(Math.abs(d.x),Math.abs(d.y))>g0||!f.startBinding&&!f.endBinding){z8(e,f,i,d);const U=f.startBinding&&!m,b=f.endBinding&&!p;(U||b)&&(U&&Vr(f,"start",i),b&&Vr(f,"end",i))}}else{z8(e,f,i,d);const U=Re(f,i.getNonDeletedElementsMap());U&&z8(e,U,i,d),ps(f,i,{simultaneouslyUpdated:Array.from(a)})}})},Cre=(e,t,n,i)=>{const[s,r]=e;let o=s+t.x+n.x,a=r+t.y+n.y;if(n.x===0||n.y===0){const[l,c]=ti(s+t.x,r+t.y,i);n.x===0&&(o=l),n.y===0&&(a=c)}return{x:o-s,y:a-r}},z8=(e,t,n,i)=>{const s=e.originalElements.get(t.id)??t,r=s.x+i.x,o=s.y+i.y;n.mutateElement(t,{x:r,y:o})},Are=(e,t,n)=>{const[i,s]=pt(e);return[t-i,n-s]},DA=({newElement:e,elementType:t,originX:n,originY:i,x:s,y:r,width:o,height:a,shouldMaintainAspectRatio:l,shouldResizeFromCenter:c,zoom:d,scene:u,widthAspectRatio:f=null,originOffset:h=null,informMutation:m=!0})=>{l&&e.type!=="selection"&&(f?a=o/f:(Math.abs(r-i)>Math.abs(s-n)?{width:o,height:a}=SA(t,a,s<n?-o:o):{width:o,height:a}=SA(t,o,r<i?-a:a),a<0&&(a=-a)));let p=s<n?n-o:n,U=r<i?i-a:i;c&&(o+=o,a+=a,p=n-o/2,U=i-a/2);let b=null;if(fe(e)){a=e.height;const y=B_(bt({fontSize:e.fontSize,fontFamily:e.fontFamily}),e.lineHeight);o=Math.max(o,y),Math.abs(s-n)>oee/d&&(b={autoResize:!1}),U=i,c&&(p=n-o/2)}if(o!==0&&a!==0){let y=null;wt(e)&&(y={initialWidth:o,initialHeight:a}),u.mutateElement(e,{x:p+((h==null?void 0:h.x)??0),y:U+((h==null?void 0:h.y)??0),width:o,height:a,...b,...y},{informMutation:m,isDragging:!1})}},Iz=(e,t)=>{const n=window.location.href;try{const i=new URL(n);return i.searchParams.set(Qb,e),rr(i.toString())}catch(i){console.error(i)}return rr(n)},Sz=(e,t)=>{if(e.length>0&&I6(e)){if(e.length===1)return{id:e[0].id,type:"element"};if(e.length>1){const n=Object.keys(t.selectedGroupIds)[0];return n?{id:n,type:"group"}:{id:e[0].groupIds[0],type:"group"}}}return null},I6=e=>!!(e.length===1||e.length>1&&Q_(e)),mh=e=>{try{const t=new URL(e);return t.searchParams.has(Qb)&&t.host===window.location.host}catch{return!1}},Mre=e=>{try{const{searchParams:t}=new URL(e);if(t.has(Qb))return t.get(Qb)}catch{}return null},yo=(e,{x:t,y:n,strokeColor:i=Un.strokeColor,backgroundColor:s=Un.backgroundColor,fillStyle:r=Un.fillStyle,strokeWidth:o=Un.strokeWidth,strokeStyle:a=Un.strokeStyle,roughness:l=Un.roughness,opacity:c=Un.opacity,width:d=0,height:u=0,angle:f=0,groupIds:h=[],frameId:m=null,index:p=null,roundness:U=null,boundElements:b=null,link:y=null,locked:v=Un.locked,..._})=>((t<-1e6||t>1e6||n<-1e6||n>1e6||d<-1e6||d>1e6||u<-1e6||u>1e6)&&console.error("New element size or position is too large",{x:t,y:n,width:d,height:u,points:_.points}),{id:_.id||ys(),type:e,x:t,y:n,width:d,height:u,angle:f,strokeColor:i,backgroundColor:s,fillStyle:r,strokeWidth:o,strokeStyle:a,roughness:l,opacity:c,groupIds:h,frameId:m,index:p,roundness:U,seed:_.seed??Hr(),version:_.version||1,versionNonce:_.versionNonce??0,isDeleted:!1,boundElements:b,updated:xg(),link:y,locked:v,customData:_.customData}),aa=e=>yo(e.type,e),PA=e=>yo("embeddable",e),kre=e=>({...yo("iframe",e)}),mw=e=>Te({...yo("frame",e),type:"frame",name:(e==null?void 0:e.name)||null},{}),C4=e=>Te({...yo("magicframe",e),type:"magicframe",name:(e==null?void 0:e.name)||null},{}),xz=(e,t)=>({x:e.textAlign==="center"?t.width/2:e.textAlign==="right"?t.width:0,y:e.verticalAlign==="middle"?t.height/2:0}),cr=e=>{const t=e.fontFamily||ad,n=e.fontSize||Cl,i=e.lineHeight||zc(t),s=$h(e.text),r=qn(s,bt({fontFamily:t,fontSize:n}),i),o=e.textAlign||Ep,a=e.verticalAlign||Wb,l=xz({textAlign:o,verticalAlign:a},r),c={...yo("text",e),text:s,fontSize:n,fontFamily:t,textAlign:o,verticalAlign:a,x:e.x-l.x,y:e.y-l.y,width:r.width,height:r.height,containerId:e.containerId||null,originalText:e.originalText??s,autoResize:e.autoResize??!0,lineHeight:i};return Te(c,{})},Rre=(e,t,n)=>{let{width:i,height:s}=qn(n,bt(e),e.lineHeight);e.autoResize||(i=e.width);const{textAlign:r,verticalAlign:o}=e;let a,l;if(r==="center"&&o===qs.MIDDLE&&!e.containerId&&e.autoResize){const c=qn(e.text,bt(e),e.lineHeight),d=xz(e,{width:i-c.width,height:s-c.height});a=e.x-d.x,l=e.y-d.y}else{const[c,d,u,f]=$e(e,t),[h,m,p,U]=I0(e,i,s,!1),b=(c-h)/2,y=(d-m)/2,v=(u-p)/2,_=(f-U)/2;[a,l]=Lre({s:!0,e:r==="center"||r==="left",w:r==="center"||r==="right"},e.x,e.y,e.angle,b,y,v,_)}return{width:i,height:s,x:Number.isFinite(a)?a:e.x,y:Number.isFinite(l)?l:e.y}},Lre=(e,t,n,i,s,r,o,a)=>{const l=Math.cos(i),c=Math.sin(i);return e.e&&e.w?t+=s+o:e.e?(t+=s*(1+l),n+=s*c,t+=o*(1-l),n+=o*-c):e.w&&(t+=s*(1-l),n+=s*-c,t+=o*(1+l),n+=o*c),e.n&&e.s?n+=r+a:e.n?(t+=r*c,n+=r*(1-l),t+=a*-c,n+=a*(1+l)):(t+=r*-c,n+=r*(1+l),t+=a*c,n+=a*(1-l)),[t,n]},Cz=(e,t,n,i=e.text)=>{if(e.isDeleted)return;(t||!e.autoResize)&&(i=cd(i,bt(e),t?oa(t,e):e.width));const s=Rre(e,n,i);return{text:i,...s}},Dre=e=>({...yo(e.type,e),points:e.points||[],pressures:e.pressures||[],simulatePressure:e.simulatePressure}),Sc=e=>{const t={...yo(e.type,e),points:e.points||[],startBinding:null,endBinding:null,startArrowhead:null,endArrowhead:null};return nn(t)?{...t,polygon:e.polygon??!1}:t},ph=e=>e.elbowed?{...yo(e.type,e),points:e.points||[],startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!0,fixedSegments:e.fixedSegments||[],startIsSpecial:!1,endIsSpecial:!1}:{...yo(e.type,e),points:e.points||[],startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!1},Az=e=>({...yo("image",e),strokeColor:"transparent",status:e.status??"pending",fileId:e.fileId??null,scale:e.scale??[1,1],crop:e.crop??null}),Co=new Map,Pre=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)/,Nre=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}\.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,Ore=/^https:\/\/(?:www\.)?figma\.com/,NA=/^https:\/\/gist\.github\.com\/([\w_-]+)\/([\w_-]+)/,Fre=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist\.github\.com\/.*?)\.js["']/i,Bre=/^(?:https?:\/\/)?forms\.microsoft\.com\//,OA=/(?:https?:\/\/)?(?:(?:w){3}\.)?(?:twitter|x)\.com\/[^/]+\/status\/(\d+)/,zre=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:twitter|x)\.com\/[^"']*)/i,Hre=/^https:\/\/(?:www\.)?val\.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,Vre=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,FA=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,BA=/^(?:http(?:s)?:\/\/)?(?:www\.)?reddit\.com\/r\/([a-zA-Z0-9_]+)\/comments\/([a-zA-Z0-9_]+)\/([a-zA-Z0-9_]+)\/?(?:\?[^#\s]*)?(?:#[^\s]*)?$/,$re=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:www\.)?reddit\.com\/[^"']*)/i,Gre=e=>{let t;try{const o=new URL(e.startsWith("http")?e:`https://${e}`);t=o.searchParams.get("t")||o.searchParams.get("start")}catch{const a=e.match(/[?&#](?:t|start)=([^&#\s]+)/);t=a==null?void 0:a[1]}if(!t)return 0;if(/^\d+$/.test(t))return parseInt(t,10);const n=t.match(/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/);if(!n)return 0;const[,i="0",s="0",r="0"]=n;return parseInt(i)*3600+parseInt(s)*60+parseInt(r)},A4=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com","reddit.com","forms.microsoft.com"]),zA=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","reddit.com","forms.microsoft.com"]),Lm=e=>`<html><body>${e}</body></html>`,Jf=e=>{if(!e)return null;if(Co.has(e))return Co.get(e);const t=e,n=zA.has(M4(e,zA)||"");let i="generic",s={w:560,h:840};const r=e.match(Pre);if(r!=null&&r[2]){const c=Gre(t),d=c>0?`&start=${c}`:"",u=e.includes("shorts");switch(i="video",r[1]){case"embed/":case"watch?v=":case"shorts/":e=`https://www.youtube.com/embed/${r[2]}?enablejsapi=1${d}`;break;case"playlist?list=":case"embed/videoseries?list=":e=`https://www.youtube.com/embed/videoseries?list=${r[2]}&enablejsapi=1${d}`;break;default:e=`https://www.youtube.com/embed/${r[2]}?enablejsapi=1${d}`;break}return s=u?{w:315,h:560}:{w:560,h:315},Co.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}}const o=e.match(Nre);if(o!=null&&o[1]){const c=o==null?void 0:o[1],d=/^\d+$/.test(c)?void 0:new URIError("Invalid embed link format");return i="video",e=`https://player.vimeo.com/video/${c}?api=1`,s={w:560,h:315},Co.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,error:d,sandbox:{allowSameOrigin:n}}}if(e.match(Ore))return i="generic",e=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(e)}`,s={w:550,h:550},Co.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}};const l=e.match(Hre);if(l)return e=l[1]==="embed"?l[0]:l[0].replace("/v","/embed"),Co.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}};if(Bre.test(e)&&!e.includes("embed=true")&&(e+=e.includes("?")?"&embed=true":"?embed=true"),OA.test(e)){const c=e.match(OA)[1],d=H2(`https://twitter.com/x/status/${c}`),u={type:"document",srcdoc:f=>Lm(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${f}"><a href="${d}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Co.set(t,u),u}if(BA.test(e)){const[,c,d,u]=e.match(BA),f=H2(`https://reddit.com/r/${c}/comments/${d}/${u}`),h={type:"document",srcdoc:m=>Lm(`<blockquote class="reddit-embed-bq" data-embed-theme="${m}"><a href="${f}"></a><br></blockquote><script async="" src="https://embed.reddit.com/widgets.js" charset="UTF-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return Co.set(t,h),h}if(NA.test(e)){const[,c,d]=e.match(NA),u=H2(`https://gist.github.com/${c}/${d}`),f={type:"document",srcdoc:()=>Lm(`
          <script src="${u}.js"><\/script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720},sandbox:{allowSameOrigin:n}};return Co.set(e,f),f}return Co.set(e,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}},Mz=e=>{let t;Kl(e)?t="IFrame element":t=!e.link||(e==null?void 0:e.link)===""?"Empty Web-Embed":e.link;const n=Math.max(Math.min(e.width/2,e.width/t.length),e.width/30),i=rt.Helvetica,s=bt({fontSize:n,fontFamily:i});return cr({x:e.x+e.width/2,y:e.y+e.height/2,strokeColor:e.strokeColor!=="transparent"?e.strokeColor:"black",backgroundColor:"transparent",fontFamily:i,fontSize:n,text:cd(t,s,e.width-20),textAlign:"center",verticalAlign:qs.MIDDLE,angle:e.angle??0})},M4=(e,t)=>{try{const{hostname:n}=new URL(e),i=n.replace(/^www\./,"");if(t instanceof Set){if(A4.has(i))return i;const r=i.replace(/^([^.]+)/,"*");return A4.has(r)?r:null}const s=t.replace(/^www\./,"");if(i===s)return s}catch{}return null},Xre=e=>{const t=e.match(zre);if(t&&t.length===2)return t[1];const n=e.match($re);if(n&&n.length===2)return n[1];const i=e.match(Fre);if(i&&i.length===2)return i[1];if(FA.test(e))return`https://giphy.com/embed/${FA.exec(e)[1]}`;const s=e.match(Vre);return s&&s.length===2?s[1]:e},Y2=(e,t)=>{if(!e)return!1;if(t!=null)if(typeof t=="function"){const n=t(e);if(typeof n=="boolean")return n}else{if(typeof t=="boolean")return t;if(t instanceof RegExp)return t.test(e);if(Array.isArray(t)){for(const n of t)if(n instanceof RegExp){if(e.match(n))return!0}else if(M4(e,n))return!0;return!1}}return!!M4(e,A4)},Uh=100,Bd=100,HA=e=>{switch(e){case $.ARROW_UP:return"up";case $.ARROW_DOWN:return"down";case $.ARROW_RIGHT:return"right";case $.ARROW_LEFT:return"left";default:return"right"}},kz=(e,t,n,i)=>{const s=[...n.values()].reduce((r,o)=>{var l;let a;if(ye(o)&&(a=o[e==="predecessors"?"startBinding":"endBinding"])&&((l=o[e==="predecessors"?"endBinding":"startBinding"])==null?void 0:l.elementId)===t.id){const c=n.get(a.elementId);if(!c)return r;xe(Lr(c),"not an ExcalidrawBindableElement");const d=e==="predecessors"?o.points[o.points.length-1]:[0,0],u=G_(t,ka(t,n),[d[0]+o.x,d[1]+o.y]);r.push({relative:c,heading:u})}return r},[]);switch(i){case"up":return s.filter(r=>Kn(r.heading,ro)).map(r=>r.relative);case"down":return s.filter(r=>Kn(r.heading,hs)).map(r=>r.relative);case"right":return s.filter(r=>Kn(r.heading,Yn)).map(r=>r.relative);case"left":return s.filter(r=>Kn(r.heading,Tr)).map(r=>r.relative)}},k4=(e,t,n)=>kz("successors",e,t,n),R4=(e,t,n)=>kz("predecessors",e,t,n),jre=(e,t,n)=>{const i=Bd+e.width;if(n==="up"||n==="down"){const a=Uh+e.height,l=e.x,c=e.x+e.width;if(t.every(d=>d.x+d.width<l||d.x>c))return{x:0,y:a*(n==="up"?-1:1)}}else if(n==="right"||n==="left"){const a=e.y,l=e.y+e.height;if(t.every(c=>c.y+c.height<a||c.y>l))return{x:(Bd+e.width)*(n==="left"?-1:1),y:0}}if(n==="up"||n==="down"){const a=Uh+e.height,l=(t.length===0,a),c=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*i:t.length/2*i*-1;return n==="up"?{x:c,y:l*-1}:{x:c,y:l}}const s=Uh+e.height,r=(t.length===0,Bd+e.width),o=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*s:t.length/2*s*-1;return n==="left"?{x:r*-1,y:o}:{x:r,y:o}},Yre=(e,t,n,i)=>{const s=i.getNonDeletedElementsMap(),r=k4(e,s,n),o=R4(e,s,n),a=jre(e,[...r,...o],n),l=aa({type:e.type,x:e.x+a.x,y:e.y+a.y,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});xe(Q5(l),"not an ExcalidrawFlowchartNodeElement");const c=Rz(e,l,n,t,i);return{nextNode:l,bindingArrow:c}},Wre=(e,t,n,i,s)=>{const r=[];for(let o=0;o<s;o++){let a,l;if(n==="left"||n==="right"){const u=Uh*(s-1)+s*e.height,f=e.y+e.height/2-u/2;let h=Bd+e.width;n==="left"&&(h*=-1),a=e.x+h;const m=(Uh+e.height)*o;l=f+m}else{const u=Bd*(s-1)+s*e.width,f=e.x+e.width/2-u/2;let h=Uh+e.height;n==="up"&&(h*=-1),l=e.y+h;const m=(Bd+e.width)*o;a=f+m}const c=aa({type:e.type,x:a,y:l,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});xe(Q5(c),"not an ExcalidrawFlowchartNodeElement");const d=Rz(e,c,n,t,i);r.push(c),r.push(d)}return r},Rz=(e,t,n,i,s)=>{let r,o;switch(n){case"up":{r=e.x+e.width/2,o=e.y-6;break}case"down":{r=e.x+e.width/2,o=e.y+e.height+6;break}case"right":{r=e.x+e.width+6,o=e.y+e.height/2;break}case"left":{r=e.x-6,o=e.y+e.height/2;break}}let l,c;switch(n){case"up":{l=t.x+t.width/2-r,c=t.y+t.height-o+6;break}case"down":{l=t.x+t.width/2-r,c=t.y-o-6;break}case"right":{l=t.x-r-6,c=t.y-o+t.height/2;break}case"left":{l=t.x+t.width-r+6,c=t.y-o+t.height/2;break}}const d=ph({type:"arrow",x:r,y:o,startArrowhead:null,endArrowhead:i.currentItemEndArrowhead,strokeColor:e.strokeColor,strokeStyle:e.strokeStyle,strokeWidth:e.strokeWidth,opacity:e.opacity,roughness:e.roughness,points:[C(0,0),C(l,c)],elbowed:!0}),u=s.getNonDeletedElementsMap();mu(d,e,"orbit","start",s),mu(d,t,"orbit","end",s);const f=new Map;f.set(e.id,e),f.set(t.id,t),f.set(d.id,d),re.movePoints(d,s,new Map([[1,{point:d.points[1]}]]));const h=Cg(d,ia(new Map([...u.entries(),[e.id,e],[t.id,t],[d.id,d]])),{points:d.points});return{...d,...h}};class Kre{constructor(){F(this,"isExploring",!1);F(this,"sameLevelNodes",[]);F(this,"sameLevelIndex",0);F(this,"direction",null);F(this,"visitedNodes",new Set)}clear(){this.isExploring=!1,this.sameLevelNodes=[],this.sameLevelIndex=0,this.direction=null,this.visitedNodes.clear()}exploreByDirection(t,n,i){if(!Lr(t))return null;if(i!==this.direction&&this.clear(),this.visitedNodes.has(t.id)||this.visitedNodes.add(t.id),this.isExploring&&i===this.direction&&this.sameLevelNodes.length>1)return this.sameLevelIndex=(this.sameLevelIndex+1)%this.sameLevelNodes.length,this.sameLevelNodes[this.sameLevelIndex].id;const s=[...k4(t,n,i),...R4(t,n,i)];if(s.length>0)return this.sameLevelIndex=0,this.isExploring=!0,this.sameLevelNodes=s,this.direction=i,this.visitedNodes.add(s[0].id),s[0].id;if(i===this.direction||!this.isExploring){this.isExploring||this.visitedNodes.add(t.id);const o=["up","right","down","left"].filter(a=>a!==i).map(a=>[...k4(t,n,a),...R4(t,n,a)]).flat().filter(a=>!this.visitedNodes.has(a.id));for(const a of o)if(!this.visitedNodes.has(a.id))return this.visitedNodes.add(a.id),this.isExploring=!0,this.direction=i,a.id}return null}}class Zre{constructor(){F(this,"isCreatingChart",!1);F(this,"numberOfNodes",0);F(this,"direction","right");F(this,"pendingNodes",null)}createNodes(t,n,i,s){const r=s.getNonDeletedElementsMap();if(i!==this.direction){const{nextNode:o,bindingArrow:a}=Yre(t,n,i,s);this.numberOfNodes=1,this.isCreatingChart=!0,this.direction=i,this.pendingNodes=[o,a]}else{this.numberOfNodes+=1;const o=Wre(t,n,i,s,this.numberOfNodes);this.isCreatingChart=!0,this.direction=i,this.pendingNodes=o}if(t.frameId){const o=r.get(t.frameId);xe(o&&vB(o),"not an ExcalidrawFrameElement"),o&&this.pendingNodes.every(a=>Np([a],o,r)||Vc(a,o,r))&&(this.pendingNodes=this.pendingNodes.map(a=>Cn(a,r,{frameId:t.frameId})))}}clear(){this.isCreatingChart=!1,this.pendingNodes=null,this.direction=null,this.numberOfNodes=0}}const qre=(e,t)=>{var n,i;for(const[,s]of t)if(s.type==="arrow"&&(((n=s.startBinding)==null?void 0:n.elementId)===e.id||((i=s.endBinding)==null?void 0:i.elementId)===e.id))return!0;return!1},Qre=e=>new Promise((t,n)=>{const i=new Image;i.onload=()=>{t(i)},i.onerror=s=>{n(s)},i.src=e}),Lz=async({fileIds:e,files:t,imageCache:n})=>{const i=new Map,s=new Map;return await Promise.all(e.reduce((r,o)=>{const a=t[o];return a&&!i.has(o)?(i.set(o,!0),r.concat((async()=>{try{if(a.mimeType===ve.binary)throw new Error("Only images can be added to ImageCache");const l=Qre(a.dataURL),c={image:l,mimeType:a.mimeType};n.set(o,c);const d=await l;n.set(o,{...c,image:d})}catch{s.set(o,!0)}})())):r},[])),{imageCache:n,updatedFiles:i,erroredFiles:s}},Dz=e=>e.filter(t=>On(t)),Jre=e=>(e==null?void 0:e.nodeName.toLowerCase())==="svg",VA=e=>{const t=new DOMParser().parseFromString(e,ve.svg),n=t.querySelector("svg");if(t.querySelector("parsererror")||!Jre(n))throw new Error("Invalid SVG");{n.hasAttribute("xmlns")||n.setAttribute("xmlns",lt);let s=n.getAttribute("width"),r=n.getAttribute("height");(s!=null&&s.includes("%")||s==="auto")&&(s=null),(r!=null&&r.includes("%")||r==="auto")&&(r=null);const o=n.getAttribute("viewBox");if(!s||!r){if(s=s||"50",r=r||"50",o){const a=o.match(/\d+ +\d+ +(\d+(?:\.\d+)?) +(\d+(?:\.\d+)?)/);a&&([,s,r]=a)}n.setAttribute("width",s),n.setAttribute("height",r)}return o||n.setAttribute("viewBox",`0 0 ${s} ${r}`),n.outerHTML}},$A=(e,t,n,i=50)=>{if(!e||e.length===0)return[];const s=[],r=Array.isArray(e[0])?e:e.map(h=>[h]),o=r.length,a=Math.max(1,Math.ceil(Math.sqrt(o))),l=[];for(let h=0;h<o;h+=a)l.push(r.slice(h,h+a));let c=0;const d=l.map(h=>{let m=0,p=0;const U=h.map(b=>{const[y,v,_,I]=pt(b);return{elements:b,bounds:[y,v,_,I],width:_-y,height:I-v}});return U.forEach((b,y)=>{m+=b.width,y<U.length-1&&(m+=i),b.height>p&&(p=b.height)}),c+=p,{unitBounds:U,width:m,maxHeight:p}}),u=c+Math.max(0,l.length-1)*i;let f=n-u/2;return d.forEach(h=>{const{unitBounds:m,width:p,maxHeight:U}=h;let b=t-p/2;m.forEach(y=>{const[v,_]=y.bounds,I=b-v,R=f-_;y.elements.forEach(T=>{s.push(Te(T,{x:T.x+I,y:T.y+R}))}),b+=y.width+i}),f+=U+i}),s},eoe=(e,t,n,i,s,r,o,a,l,c,d)=>{const u=i.getNonDeletedElementsMap();if(n.length===1){const[f]=n;if(t==="rotation")ye(f)||(toe(f,i,a,l,s),ps(f,i));else if(t){const h=n[0].id,m=u.get(h),p=e.get(h);if(m&&p){const{nextWidth:U,nextHeight:b}=aoe(m,p,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r});S0(U,b,m,p,e,i,t,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r})}}return fe(f)&&ps(f,i),!0}else if(n.length>1){if(t==="rotation")return ioe(e,n,i,a,l,s,c,d),!0;if(t){const{nextWidth:f,nextHeight:h,flipByX:m,flipByY:p,originalBoundingBox:U}=loe(n,e,u,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r});return Pz(n,u,t,i,e,{shouldResizeFromCenter:r,shouldMaintainAspectRatio:o,flipByX:m,flipByY:p,nextWidth:f,nextHeight:h,originalBoundingBox:U}),!0}}return!1},toe=(e,t,n,i,s)=>{const[r,o,a,l]=$e(e,t.getNonDeletedElementsMap()),c=(r+a)/2,d=(o+l)/2;let u;Ue(e)?u=0:(u=5*Math.PI/2+Math.atan2(i-d,n-c),s&&(u=u+Ys/2,u=u-u%Ys),u=co(u));const f=ra(e);let h={angle:u};if(dn(e)&&(h={...h},e.startBinding&&Vr(e,"start",t),e.endBinding&&Vr(e,"end",t)),t.mutateElement(e,h),f){const m=t.getElement(f);if(m&&!_e(e)){const{x:p,y:U}=dd(e,m,t.getNonDeletedElementsMap());t.mutateElement(m,{angle:u,x:p,y:U})}}},pw=(e,t,n,i)=>Ce(e)||ts(e)?{points:r6(0,t,r6(1,n,e.points,i),i)}:{},Uw=(e,t,n)=>{let i=e.width;if(Nt(e)){const o=Bn(e,t);o&&(i=oa(o,e))}const r=e.fontSize*(n/i);return r<y_?null:{size:r}},noe=(e,t,n,i,s,r,o)=>{const a=n.getNonDeletedElementsMap(),l=t.width*(o/t.height),c=Uw(t,a,l);if(c!==null){if(i.includes("n")||i.includes("s")){const d=C(e.x,e.y),u=L4(d,e.width,e.height,l,o,e.angle,i,!1,s);n.mutateElement(t,{fontSize:c.size,width:l,height:o,x:u.x,y:u.y});return}if(i==="e"||i==="w"){const d=B_(bt({fontSize:t.fontSize,fontFamily:t.fontFamily}),t.lineHeight),u=Math.max(d,r),f=cd(t.originalText,bt(t),Math.abs(u)),h=qn(f,bt(t),t.lineHeight),m=h.height,p=C(e.x,e.y),U=L4(p,e.width,e.height,u,m,t.angle,i,!1,s),b={width:Math.abs(u),height:Math.abs(h.height),x:U.x,y:U.y,text:f,autoResize:!1};n.mutateElement(t,b)}}},ioe=(e,t,n,i,s,r,o,a)=>{var u;const l=n.getNonDeletedElementsMap();let c=5*Math.PI/2+Math.atan2(s-a,i-o);r&&(c+=Ys/2,c-=c%Ys);const d=new Map(t.map(f=>[f.id,f]));for(const f of t)if(!Ue(f)){const[h,m,p,U]=$e(f,l),b=(h+p)/2,y=(m+U)/2,v=((u=e.get(f.id))==null?void 0:u.angle)??f.angle,[_,I]=Z(C(b,y),C(o,a),c+v-f.angle),R=ye(f)?{points:ese(f,l)}:{x:f.x+(_-b),y:f.y+(I-y),angle:co(c+v)};n.mutateElement(f,R),ps(f,n,{simultaneouslyUpdated:t}),dn(f)&&(f.startBinding&&(d.has(f.startBinding.elementId)||Vr(f,"start",n)),f.endBinding&&(d.has(f.endBinding.elementId)||Vr(f,"end",n)));const T=Re(f,l);if(T&&!_e(f)){const{x:w,y:S}=dd(f,T,l);n.mutateElement(T,{x:w,y:S,angle:co(c+v)})}}n.triggerUpdate()},soe=(e,t,n,i,s)=>{const[r,o,a,l]=t.length===1?$e(t[0],n):pt(t),c=(r+a)/2,d=(o+l)/2,u=t.length===1?t[0].angle:0;switch([i,s]=Z(C(i,s),C(c,d),-u),e){case"n":return Z(C(i-(r+a)/2,s-o),C(0,0),u);case"s":return Z(C(i-(r+a)/2,s-l),C(0,0),u);case"w":return Z(C(i-r,s-(o+l)/2),C(0,0),u);case"e":return Z(C(i-a,s-(o+l)/2),C(0,0),u);case"nw":return Z(C(i-r,s-o),C(0,0),u);case"ne":return Z(C(i-a,s-o),C(0,0),u);case"sw":return Z(C(i-r,s-l),C(0,0),u);case"se":return Z(C(i-a,s-l),C(0,0),u);default:return[0,0]}},roe=(e,t)=>{const[,[n,i]]=t.points;return e==="nw"&&(n<0||i<0)||e==="ne"&&n>=0||e==="sw"&&n<=0||e==="se"&&(n>0||i>0)?"end":"origin"},ooe=(e,t,n)=>{if(n)return"center";if(t)switch(e){case"n":return"south-side";case"e":return"west-side";case"s":return"north-side";case"w":return"east-side";case"ne":return"bottom-left";case"nw":return"bottom-right";case"se":return"top-left";case"sw":return"top-right"}return["e","se","s"].includes(e)?"top-left":["n","nw","w"].includes(e)?"bottom-right":e==="ne"?"bottom-left":"top-right"},L4=(e,t,n,i,s,r,o,a,l)=>{const c=ooe(o,a,l),[d,u]=e;switch(c){case"top-left":return{x:d+(t-i)/2+(i-t)/2*Math.cos(r)+(n-s)/2*Math.sin(r),y:u+(n-s)/2+(i-t)/2*Math.sin(r)+(s-n)/2*Math.cos(r)};case"top-right":return{x:d+(t-i)/2*(Math.cos(r)+1)+(n-s)/2*Math.sin(r),y:u+(n-s)/2+(t-i)/2*Math.sin(r)+(s-n)/2*Math.cos(r)};case"bottom-left":return{x:d+(t-i)/2*(1-Math.cos(r))+(s-n)/2*Math.sin(r),y:u+(n-s)/2*(Math.cos(r)+1)+(i-t)/2*Math.sin(r)};case"bottom-right":return{x:d+(t-i)/2*(Math.cos(r)+1)+(s-n)/2*Math.sin(r),y:u+(n-s)/2*(Math.cos(r)+1)+(t-i)/2*Math.sin(r)};case"center":return{x:d-(i-t)/2,y:u-(s-n)/2};case"east-side":return{x:d+(t-i)/2*(Math.cos(r)+1),y:u+(t-i)/2*Math.sin(r)+(n-s)/2};case"west-side":return{x:d+(t-i)/2*(1-Math.cos(r)),y:u+(i-t)/2*Math.sin(r)+(n-s)/2};case"north-side":return{x:d+(t-i)/2+(n-s)/2*Math.sin(r),y:u+(s-n)/2*(Math.cos(r)-1)};case"south-side":return{x:d+(t-i)/2+(s-n)/2*Math.sin(r),y:u+(n-s)/2*(Math.cos(r)+1)}}},S0=(e,t,n,i,s,r,o,{shouldInformMutation:a=!0,shouldMaintainAspectRatio:l=!1,shouldResizeFromCenter:c=!1}={})=>{if(fe(n)&&fe(i))return noe(i,n,r,o,c,e,t);let d={};const u=r.getNonDeletedElementsMap(),f=Re(n,u);if(f){const U=s.get(f.id);if(U&&(d={fontSize:U.fontSize}),l){const b={...n,width:e},y=Uw(f,u,oa(b,f));if(y===null)return;d={fontSize:y.size}}else{const b=kB(bt(f),f.lineHeight),y=RB(f.fontSize,f.lineHeight);e=Math.max(e,b),t=Math.max(t,y)}}const h=pw(i,e,t,!0);let m=C(i.x,i.y);if(Ce(i)){const[U,b]=Mn(i,s);m=C(U,b)}const p=L4(m,i.width,i.height,e,t,i.angle,o,l,c);if(Ce(i)&&h.points){const U=i.x-m[0],b=i.y-m[1];p.x+=U,p.y+=b;const y=h.points[0][0],v=h.points[0][1];p.x+=y,p.y+=v,h.points=h.points.map(_=>C(_[0]-y,_[1]-v))}if(e<0&&(p.x=p.x+e),t<0&&(p.y=p.y+t),"scale"in n&&"scale"in i&&r.mutateElement(n,{scale:[(Math.sign(e)||i.scale[0])*i.scale[0],(Math.sign(t)||i.scale[1])*i.scale[1]]}),_e(n)&&f&&l){const U=e/n.width*f.fontSize;if(U<y_)return;d.fontSize=U}if(e!==0&&t!==0&&Number.isFinite(p.x)&&Number.isFinite(p.y)){let U={...p,width:Math.abs(e),height:Math.abs(t),...h};dn(n)&&(n.startBinding&&(U={...U},n.startBinding&&Vr(n,"start",r)),n.endBinding&&(U={...U,endBinding:null})),r.mutateElement(n,U,{informMutation:a,isDragging:!1}),f&&d!=null&&r.mutateElement(f,{fontSize:d.fontSize}),Lp(n,r,o,l),ps(n,r)}},aoe=(e,t,n,i,s,{shouldMaintainAspectRatio:r=!1,shouldResizeFromCenter:o=!1}={})=>{const[a,l,c,d]=I0(t,t.width,t.height,!0),u=C(a,l),f=C(c,d),h=e6(u,f),m=Z(C(i,s),h,-t.angle),[p,U,b,y]=I0(e,e.width,e.height,!0),v=b-p,_=y-U,I=f[0]-u[0],R=f[1]-u[1];let T=I/v,w=R/_;n.includes("e")&&(T=(m[0]-u[0])/v),n.includes("s")&&(w=(m[1]-u[1])/_),n.includes("w")&&(T=(f[0]-m[0])/v),n.includes("n")&&(w=(f[1]-m[1])/_);let S=e.width*T,x=e.height*w;if(o&&(S=2*S-t.width,x=2*x-t.height),r){const k=Math.abs(S)/t.width,P=Math.abs(x)/t.height;if(n.length===1&&(x*=k,S*=P),n.length===2){const D=Math.max(k,P);S=t.width*D*Math.sign(S),x=t.height*D*Math.sign(x)}}return{nextWidth:S,nextHeight:x}},loe=(e,t,n,i,s,r,{shouldMaintainAspectRatio:o=!1,shouldResizeFromCenter:a=!1}={})=>{const l=e.map(D=>t.get(D.id)),c=l.reduce((D,j)=>{if(!Ce(j))return D;const G=ra(j);if(!G)return D;const V=t.get(G)??null;return Nt(V)?[...D,{...V,...re.getBoundTextElementPosition(j,V,n)}]:D},[]),d=Dr(l.map(D=>D).concat(c)),{minX:u,minY:f,maxX:h,maxY:m,midX:p,midY:U}=d,b=h-u,y=m-f,v={ne:[u,m],se:[u,f],sw:[h,f],nw:[h,m],e:[u,f+y/2],w:[h,f+y/2],n:[u+b/2,m],s:[u+b/2,f]},[_,I]=a?[p,U]:v[i],R=a?2:1,T=Math.max(Math.abs(s-_)/b||0,Math.abs(r-I)/y||0)*R;let w=i.includes("e")||i.includes("w")?Math.abs(s-_)*R:b,S=i.includes("n")||i.includes("s")?Math.abs(r-I)*R:y;o&&(w=b*T*Math.sign(s-_),S=y*T*Math.sign(r-I));const x={ne:[s<_,r>I],se:[s<_,r<I],sw:[s>_,r<I],nw:[s>_,r>I],e:[s<_,!1],w:[s>_,!1],n:[!1,r>I],s:[!1,r<I]},[k,P]=x[i].map(D=>D);return{originalBoundingBox:d,nextWidth:w,nextHeight:S,flipByX:k,flipByY:P}},Pz=(e,t,n,i,s,{shouldMaintainAspectRatio:r=!1,shouldResizeFromCenter:o=!1,flipByX:a=!1,flipByY:l=!1,nextHeight:c,nextWidth:d,originalBoundingBox:u}={})=>{if(d===void 0&&c===void 0&&a===void 0&&l===void 0||c===0||d===0)return;s||(s=t);const f=e.reduce((R,T)=>{const w=s.get(T.id);return w&&R.push({orig:w,latest:T}),R},[]);let h;if(u)h=u;else{const R=f.reduce((T,{orig:w})=>{if(!Ce(w))return T;const S=ra(w);if(!S)return T;const x=s.get(S)??null;return Nt(x)?[...T,{...x,...re.getBoundTextElementPosition(w,x,t)}]:T},[]);h=Dr(f.map(({orig:T})=>T).concat(R))}const{minX:m,minY:p,maxX:U,maxY:b,midX:y,midY:v}=h,_=U-m,I=b-p;if(d===void 0&&c===void 0&&(d=_,c=I),r&&(d===void 0?d=c*(_/I):c===void 0?c=d*(I/_):Math.abs(d/c-_/I)>.001&&(d=c*(_/I))),d&&c){let R=n.includes("e")||n.includes("w")?Math.abs(d)/_:1,T=n.includes("n")||n.includes("s")?Math.abs(c)/I:1,w;n.length===1?w=n.includes("e")||n.includes("w")?R:T:w=Math.max(Math.abs(d)/_||0,Math.abs(c)/I||0);const S={ne:[m,b],se:[m,p],sw:[U,p],nw:[U,b],e:[m,p+I/2],w:[U,p+I/2],n:[m+_/2,b],s:[m+_/2,p]},[x,k]=o?[y,v]:S[n],P=r||f.some(z=>z.latest.angle!==0||fe(z.latest)||Yh(z.latest));P&&(R=w,T=w);const[D,j]=[a?-1:1,l?-1:1],G=[];for(const{orig:z,latest:X}of f){if(fe(z)&&Nt(z))continue;const Y=z.width*R,ee=z.height*T,se=co(z.angle*D*j),oe=Ce(z)||ts(z),Fe=z.x-x,Ge=z.y-k,Me=a&&!oe?Y:0,Ne=l&&!oe?ee:0,et=x+D*(Fe*R+Me),Ot=k+j*(Ge*T+Ne),Xe=pw(z,Y*D,ee*j,!1),je={x:et,y:Ot,width:Y,height:ee,angle:se,...Xe};if(ye(z)&&(z.startBinding&&(je.startBinding={...z.startBinding,fixedPoint:[a?-z.startBinding.fixedPoint[0]+1:z.startBinding.fixedPoint[0],l?-z.startBinding.fixedPoint[1]+1:z.startBinding.fixedPoint[1]]}),z.endBinding&&(je.endBinding={...z.endBinding,fixedPoint:[a?-z.endBinding.fixedPoint[0]+1:z.endBinding.fixedPoint[0],l?-z.endBinding.fixedPoint[1]+1:z.endBinding.fixedPoint[1]]}),z.fixedSegments&&Xe.points&&(je.fixedSegments=z.fixedSegments.map(yt=>({...yt,start:Xe.points[yt.index-1],end:Xe.points[yt.index]})))),wt(z)&&(je.scale=[z.scale[0]*D,z.scale[1]*j]),fe(z)){const yt=Uw(z,t,Y);if(!yt)return;je.fontSize=yt.size}const Jt=s.get(ra(z)??"");if(Jt)if(P){const yt=Jt.fontSize*w;if(yt<y_)return;je.boundTextFontSize=yt}else je.boundTextFontSize=Jt.fontSize;G.push({element:X,update:je})}const V=G.map(({element:z})=>z),B=new Map(G.map(({element:z})=>[z.id,z]));for(const{element:z,update:{boundTextFontSize:X,...Y}}of G){const{angle:ee}=Y;i.mutateElement(z,Y),ps(z,i,{simultaneouslyUpdated:V}),dn(z)&&(z.startBinding&&(B.has(z.startBinding.elementId)||Vr(z,"start",i)),z.endBinding&&(B.has(z.endBinding.elementId)||Vr(z,"end",i)));const se=Re(z,t);se&&X&&(i.mutateElement(se,{fontSize:X,angle:Ce(z)?void 0:ee}),Lp(z,i,n,!0))}i.triggerUpdate()}},GA={mouse:8,pen:16,touch:28},coe=16,Nz={e:!0,s:!0,n:!0,w:!0},XA={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},H8={e:!0,s:!0,n:!0,w:!0},Sa=(e,t,n,i,s,r,o)=>{const[a,l]=Z(C(e+n/2,t+i/2),C(s,r),o);return[a-n/2,l-i/2,n,i]},bw=e=>!(e.formFactor==="phone"&&e.userAgent.isMobileDevice),Dm=e=>bw(e)?Nz:{},yw=([e,t,n,i,s,r],o,a,l,c={},d=4,u=fu)=>{const f=GA[l],h=f/a.value,m=f/a.value,p=f/a.value,U=f/a.value,b=n-e,y=i-t,v=d/a.value,_=(f-u*2)/(2*a.value),I={nw:c.nw?void 0:Sa(e-v-p+_,t-v-U+_,h,m,s,r,o),ne:c.ne?void 0:Sa(n+v-_,t-v-U+_,h,m,s,r,o),sw:c.sw?void 0:Sa(e-v-p+_,i+v-_,h,m,s,r,o),se:c.se?void 0:Sa(n+v-_,i+v-_,h,m,s,r,o),rotation:c.rotation?void 0:Sa(e+b/2-h/2,t-v-U+_-coe/a.value,h,m,s,r,o)},R=5*GA.mouse/a.value;return Math.abs(b)>R&&(c.n||(I.n=Sa(e+b/2-h/2,t-v-U+_,h,m,s,r,o)),c.s||(I.s=Sa(e+b/2-h/2,i+v-_,h,m,s,r,o))),Math.abs(y)>R&&(c.w||(I.w=Sa(e-v-p+_,t+y/2-m/2,h,m,s,r,o)),c.e||(I.e=Sa(n+v-_,t+y/2-m/2,h,m,s,r,o))),I},Oz=(e,t,n,i="mouse",s=Nz)=>{if(e.locked||ye(e))return{};if(e.type==="freedraw"||Ce(e)){if(e.points.length===2){const[,o]=e.points;o[0]===0||o[1]===0?s=H8:o[0]>0&&o[1]<0?s=XA:o[0]>0&&o[1]>0?s=H8:o[0]<0&&o[1]>0?s=XA:o[0]<0&&o[1]<0&&(s=H8)}}else Ue(e)&&(s={...s,rotation:!0});const r=Ce(e)?fu+8:wt(e)?0:fu;return yw($e(e,n,!0),e.angle,t,i,s,r,wt(e)?0:void 0)},Fz=(e,t,n)=>{var s,r;if((s=t.selectedLinearElement)!=null&&s.isEditing||(r=t.selectedLinearElement)!=null&&r.isDragging)return!1;if(e.length>1)return!0;const i=e[0];return ye(i)?!1:Ce(i)?i.points.length>2&&!n.userAgent.isMobileDevice:!0},D4=(e,t,n)=>t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3],doe=(e,t,n,i,s,r,o,a)=>{if(!n.selectedElementIds[e.id])return!1;const{rotation:l,...c}=Oz(e,r,t,o,Dm(a));if(l&&D4(l,i,s))return"rotation";const d=Object.keys(c).filter(u=>{const f=c[u];return f?D4(f,i,s):!1});if(d.length>0)return d[0];if(bw(a)){const[u,f,h,m,p,U]=$e(e,t);if(!(Ce(e)&&e.points.length<=2)){const b=wt(e)?0:Kb/r.value,y=Kb/r.value,v=Bz(C(u-b,f-b),C(h+b,m+b),C(p,U),e.angle);for(const[_,I]of Object.entries(v))if(t6(C(i,s),I,y))return _}}return!1},jA=(e,t,n,i,s,r,o,a)=>e.reduce((l,c)=>{if(l)return l;const d=doe(c,o,t,n,i,s,r,a);return d?{element:c,transformHandleType:d}:null},null),YA=([e,t,n,i],s,r,o,a,l)=>{const c=yw([e,t,n,i,(e+n)/2,(t+i)/2],0,o,a,Dm(l)),d=Object.keys(c).find(u=>{const f=c[u];return f&&D4(f,s,r)});if(d)return d;if(bw(l)){const u=(e+n)/2,f=(t+i)/2,h=Kb/o.value,m=Bz(C(e-h,t-h),C(n+h,i+h),C(u,f),0);for(const[p,U]of Object.entries(m))if(t6(C(s,r),U,h))return p}return!1},V8=["ns","nesw","ew","nwse"],uoe=(e,t)=>{const n=V8.indexOf(e);if(n>=0){const i=Math.round(t/(Math.PI/4));e=V8[(n+i)%V8.length]}return e},WA=e=>{const{element:t,transformHandleType:n}=e,i=t&&Math.sign(t.height)*Math.sign(t.width)===-1;let s=null;switch(n){case"n":case"s":s="ns";break;case"w":case"e":s="ew";break;case"nw":case"se":i?s="nesw":s="nwse";break;case"ne":case"sw":i?s="nwse":s="nesw";break;case"rotation":return"grab"}return s&&t&&(s=uoe(s,t.angle)),s?`${s}-resize`:""},Bz=([e,t],[n,i],s,r)=>{const o=Z(C(e,t),s,r),a=Z(C(n,t),s,r),l=Z(C(e,i),s,r),c=Z(C(n,i),s,r);return{n:[o,a],e:[a,c],s:[c,l],w:[l,o]}},foe=(e,t)=>{var n;return!!(!e.viewModeEnabled&&((n=e.openDialog)==null?void 0:n.name)!=="elementLinkSelector"&&(e.activeTool.type!=="custom"&&(e.editingTextElement||e.activeTool.type!=="selection"&&e.activeTool.type!=="lasso"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser")||Ye(t,e).length))},P4=(e,t)=>e.frameId===t||e.id===t,zz=(e,t,n)=>{let i=[],s=[],r=null,o=-1;const a=be(n||Ye(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0}));for(;++o<e.length;){const l=e[o];a.get(l.id)?(s.length&&(i=i.concat(s),s=[]),i.push(o),r=o+1):l.isDeleted&&r===o?(r=o+1,s.push(o)):s=[]}return i},hoe=e=>{let t=0;return e.reduce((n,i,s)=>(s>0&&e[s-1]!==i-1&&(t=++t),(n[t]||(n[t]=[])).push(i),n),[])},KA=(e,t,n,i)=>{var s,r;if("containerId"in e&&e.containerId){const o=i.getElement(e.containerId);if(o)return n==="left"?Math.min(t.indexOf(o),t.indexOf(e)):Math.max(t.indexOf(o),t.indexOf(e))}else{const o=(r=(s=e.boundElements)==null?void 0:s.find(a=>a.type!=="arrow"))==null?void 0:r.id;if(o){const a=i.getElement(o);if(a)return n==="left"?Math.min(t.indexOf(a),t.indexOf(e)):Math.max(t.indexOf(a),t.indexOf(e))}}},goe=(e,t)=>{let n=-1,i=-1;return e.forEach((s,r)=>{P4(s,t)&&(n===-1&&(n=r),i=r)}),n===-1?[]:e.slice(n,i+1)},ZA=(e,t,n,i,s)=>{const r=Ci(e,n,i);if(!r)return n;const o=Re(r,i),a=fe(r)?Bn(r,i):null,l=[r.id,o==null?void 0:o.id,a==null?void 0:a.id].filter(u=>!!u),c=n.findIndex(u=>l.includes(u.id)),d=n.findIndex(u=>u.id===t.id);if(d!==-1&&c!==-1&&d<c){const u=Array.from(n),f=u.splice(d,1)[0];u.splice(c,0,f),s.replaceAllElements(u)}return n},moe=(e,t,n,i,s,r)=>{const o=t[n],a=f=>f.isDeleted?!1:s?f.frameId===s:e.editingGroupId?f.groupIds.includes(e.editingGroupId):!0,l=i==="left"?Rd(t,f=>a(f),Math.max(0,n-1)):sB(t,f=>a(f),n+1),c=t[l];if(!c)return-1;if(e.editingGroupId){if((o==null?void 0:o.groupIds.join(""))===(c==null?void 0:c.groupIds.join("")))return KA(c,t,i,r)??l;if(!(c!=null&&c.groupIds.includes(e.editingGroupId)))return-1}if(!s&&(c.frameId||Ue(c))){const f=goe(t,c.frameId||c.id);return i==="left"?t.indexOf(f[0]):t.indexOf(f[f.length-1])}if(!c.groupIds.length)return KA(c,t,i,r)??l;const d=e.editingGroupId?c.groupIds[c.groupIds.indexOf(e.editingGroupId)-1]:c.groupIds[c.groupIds.length-1],u=Lt(t,d);return u.length?i==="left"?t.indexOf(u[0]):t.indexOf(u[u.length-1]):l},Hz=(e,t)=>t.reduce((n,i)=>{const s=e[i];return n.set(s.id,s),n},new Map),Vz=(e,t,n,i)=>{const s=zz(e,t),r=Hz(e,s);let o=hoe(s);n==="right"&&(o=o.reverse());const a=new Set(s.filter(l=>Ue(e[l])).map(l=>e[l].id));return o.forEach((l,c)=>{var v;const d=l[0],u=l[l.length-1],f=n==="left"?d:u,h=l.some(_=>{const I=e[_];return I.frameId&&a.has(I.frameId)})?null:(v=e[f])==null?void 0:v.frameId,m=moe(t,e,f,n,h,i);if(m===-1||f===m)return;const p=n==="left"?e.slice(0,m):e.slice(0,d),U=e.slice(d,u+1),b=n==="left"?e.slice(m,d):e.slice(u+1,m+1),y=n==="left"?e.slice(u+1):e.slice(m+1);e=n==="left"?[...p,...U,...b,...y]:[...p,...b,...U,...y]}),bo(e,r),e},$z=(e,t,n,i,s)=>{const r=zz(e,t,s),o=Hz(e,r),a=[];let l,c;if(n==="left"){if(i)l=sB(e,m=>P4(m,i));else if(t.editingGroupId){const m=Lt(e,t.editingGroupId);if(!m.length)return e;l=e.indexOf(m[0])}else l=0;c=r[r.length-1]}else{if(i)c=Rd(e,m=>P4(m,i));else if(t.editingGroupId){const m=Lt(e,t.editingGroupId);if(!m.length)return e;c=e.indexOf(m[m.length-1])}else c=e.length-1;l=r[0]}l===-1&&(l=0);for(let m=l;m<c+1;m++)r.includes(m)||a.push(e[m]);const d=Array.from(o.values()),u=e.slice(0,l),f=e.slice(c+1),h=n==="left"?[...u,...d,...a,...f]:[...u,...a,...d,...f];return bo(h,o),h};function Gz(e,t,n,i){const s=be(Ye(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),r={regularElements:[],frameChildren:new Map},o=new Set;for(const c of e)s.has(c.id)&&Ue(c)&&o.add(c.id);for(const c of e)if(s.has(c.id))if(Ue(c)||c.frameId&&o.has(c.frameId))r.regularElements.push(c);else if(!c.frameId)r.regularElements.push(c);else{const d=r.frameChildren.get(c.frameId)||[];d.push(c),r.frameChildren.set(c.frameId,d)}let a=e;const l=Array.from(r.frameChildren.entries());for(const[c,d]of l)a=i(e,t,n,c,d);return i(a,t,n,null,r.regularElements)}const poe=(e,t,n)=>Vz(e,t,"left",n),Uoe=(e,t,n)=>Vz(e,t,"right",n),boe=(e,t)=>Gz(e,t,"left",$z),yoe=(e,t)=>Gz(e,t,"right",$z),sc=e=>e.reduce((t,n)=>t+n.version,0),Xz=e=>{let t=5381;for(const n of Wl(e))t=(t<<5)+t+n.versionNonce;return t>>>0},Ew=e=>{let t=5381;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)+t+i}return t>>>0},Eoe=e=>e.filter(t=>!t.isDeleted&&!nl(t)),Yt=e=>e.filter(t=>!t.isDeleted),N4=e=>!e.isDeleted,Bt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,$t=globalThis,Gu=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,iu="9.0.1";function ly(){return cy($t),$t}function cy(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||iu,t[iu]=t[iu]||{}}function dy(e,t,n=$t){const i=n.__SENTRY__=n.__SENTRY__||{},s=i[iu]=i[iu]||{};return s[e]||(s[e]=t())}const voe="Sentry Logger ",S6=["debug","info","warn","error","log","assert","trace"],x6={};function kg(e){if(!("console"in $t))return e();const t=$t.console,n={},i=Object.keys(x6);i.forEach(s=>{const r=x6[s];n[s]=t[s],t[s]=r});try{return e()}finally{i.forEach(s=>{t[s]=n[s]})}}function _oe(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return Gu?S6.forEach(n=>{t[n]=(...i)=>{e&&kg(()=>{$t.console[n](`${voe}[${n}]:`,...i)})}}):S6.forEach(n=>{t[n]=()=>{}}),t}const He=dy("logger",_oe),jz=50,Uu="?",qA=/\(error: (.*)\)/,QA=/captureMessage|captureException/;function Yz(...e){const t=e.sort((n,i)=>n[0]-i[0]).map(n=>n[1]);return(n,i=0,s=0)=>{const r=[],o=n.split(`
`);for(let a=i;a<o.length;a++){const l=o[a];if(l.length>1024)continue;const c=qA.test(l)?l.replace(qA,"$1"):l;if(!c.match(/\S*Error: /)){for(const d of t){const u=d(c);if(u){r.push(u);break}}if(r.length>=jz+s)break}}return Toe(r.slice(s))}}function woe(e){return Array.isArray(e)?Yz(...e):e}function Toe(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(YU(t).function||"")&&t.pop(),t.reverse(),QA.test(YU(t).function||"")&&(t.pop(),QA.test(YU(t).function||"")&&t.pop()),t.slice(0,jz).map(n=>({...n,filename:n.filename||YU(t).filename,function:n.function||Uu}))}function YU(e){return e[e.length-1]||{}}const $8="<anonymous>";function Xc(e){try{return!e||typeof e!="function"?$8:e.name||$8}catch{return $8}}function JA(e){const t=e.exception;if(t){const n=[];try{return t.values.forEach(i=>{i.stacktrace.frames&&n.push(...i.stacktrace.frames)}),n}catch{return}}}const W2={},eM={};function Xu(e,t){W2[e]=W2[e]||[],W2[e].push(t)}function ju(e,t){if(!eM[e]){eM[e]=!0;try{t()}catch(n){Gu&&He.error(`Error while instrumenting ${e}`,n)}}}function ho(e,t){const n=e&&W2[e];if(n)for(const i of n)try{i(t)}catch(s){Gu&&He.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Xc(i)}
Error:`,s)}}let G8=null;function Ioe(e){const t="error";Xu(t,e),ju(t,Soe)}function Soe(){G8=$t.onerror,$t.onerror=function(e,t,n,i,s){return ho("error",{column:i,error:s,line:n,msg:e,url:t}),G8?G8.apply(this,arguments):!1},$t.onerror.__SENTRY_INSTRUMENTED__=!0}let X8=null;function xoe(e){const t="unhandledrejection";Xu(t,e),ju(t,Coe)}function Coe(){X8=$t.onunhandledrejection,$t.onunhandledrejection=function(e){return ho("unhandledrejection",e),X8?X8.apply(this,arguments):!0},$t.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Wz=Object.prototype.toString;function vw(e){switch(Wz.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return bu(e,Error)}}function Rg(e,t){return Wz.call(e)===`[object ${t}]`}function Kz(e){return Rg(e,"ErrorEvent")}function tM(e){return Rg(e,"DOMError")}function Aoe(e){return Rg(e,"DOMException")}function il(e){return Rg(e,"String")}function _w(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function ww(e){return e===null||_w(e)||typeof e!="object"&&typeof e!="function"}function Zh(e){return Rg(e,"Object")}function uy(e){return typeof Event<"u"&&bu(e,Event)}function Moe(e){return typeof Element<"u"&&bu(e,Element)}function koe(e){return Rg(e,"RegExp")}function fy(e){return!!(e!=null&&e.then&&typeof e.then=="function")}function Roe(e){return Zh(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function bu(e,t){try{return e instanceof t}catch{return!1}}function Zz(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}const Tw=$t,Loe=80;function qz(e,t={}){if(!e)return"<unknown>";try{let n=e;const i=5,s=[];let r=0,o=0;const a=" > ",l=a.length;let c;const d=Array.isArray(t)?t:t.keyAttrs,u=!Array.isArray(t)&&t.maxStringLength||Loe;for(;n&&r++<i&&(c=Doe(n,d),!(c==="html"||r>1&&o+s.length*l+c.length>=u));)s.push(c),o+=c.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Doe(e,t){const n=e,i=[];if(!(n!=null&&n.tagName))return"";if(Tw.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}i.push(n.tagName.toLowerCase());const s=t!=null&&t.length?t.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{i.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&i.push(`#${n.id}`);const o=n.className;if(o&&il(o)){const a=o.split(/\s+/);for(const l of a)i.push(`.${l}`)}}const r=["aria-label","type","name","title","alt"];for(const o of r){const a=n.getAttribute(o);a&&i.push(`[${o}="${a}"]`)}return i.join("")}function Iw(){try{return Tw.document.location.href}catch{return""}}function Poe(e){if(!Tw.HTMLElement)return null;let t=e;const n=5;for(let i=0;i<n;i++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}function bh(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function C6(e,t){if(!Array.isArray(e))return"";const n=[];for(let i=0;i<e.length;i++){const s=e[i];try{Zz(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function Noe(e,t,n=!1){return il(e)?koe(t)?t.test(e):il(t)?n?e===t:e.includes(t):!1:!1}function hy(e,t=[],n=!1){return t.some(i=>Noe(e,i,n))}function Js(e,t,n){if(!(t in e))return;const i=e[t],s=n(i);typeof s=="function"&&Qz(s,i);try{e[t]=s}catch{Gu&&He.log(`Failed to replace method "${t}" in object`,e)}}function yu(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{Gu&&He.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Qz(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,yu(e,"__sentry_original__",t)}catch{}}function Sw(e){return e.__sentry_original__}function Jz(e){if(vw(e))return{message:e.message,name:e.name,stack:e.stack,...iM(e)};if(uy(e)){const t={type:e.type,target:nM(e.target),currentTarget:nM(e.currentTarget),...iM(e)};return typeof CustomEvent<"u"&&bu(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function nM(e){try{return Moe(e)?qz(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function iM(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function Ooe(e,t=40){const n=Object.keys(Jz(e));n.sort();const i=n[0];if(!i)return"[object has no keys]";if(i.length>=t)return bh(i,t);for(let s=n.length;s>0;s--){const r=n.slice(0,s).join(", ");if(!(r.length>t))return s===n.length?r:bh(r,t)}return""}function er(e){return O4(e,new Map)}function O4(e,t){if(Foe(e)){const n=t.get(e);if(n!==void 0)return n;const i={};t.set(e,i);for(const s of Object.getOwnPropertyNames(e))typeof e[s]<"u"&&(i[s]=O4(e[s],t));return i}if(Array.isArray(e)){const n=t.get(e);if(n!==void 0)return n;const i=[];return t.set(e,i),e.forEach(s=>{i.push(O4(s,t))}),i}return e}function Foe(e){if(!Zh(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}const eH=1e3;function Op(){return Date.now()/eH}function Boe(){const{performance:e}=$t;if(!(e!=null&&e.now))return Op;const t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/eH}const sl=Boe();function Pr(){const e=$t,t=e.crypto||e.msCrypto;let n=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(n=()=>{const i=new Uint8Array(1);return t.getRandomValues(i),i[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,i=>(i^(n()&15)>>i/4).toString(16))}function tH(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)==null?void 0:n[0]}function Zl(e){const{message:t,event_id:n}=e;if(t)return t;const i=tH(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function F4(e,t,n){const i=e.exception=e.exception||{},s=i.values=i.values||[],r=s[0]=s[0]||{};r.value||(r.value=t||""),r.type||(r.type="Error")}function Eu(e,t){const n=tH(e);if(!n)return;const i={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...i,...s,...t},t&&"data"in t){const r={...s==null?void 0:s.data,...t.data};n.mechanism.data=r}}function sM(e){if(zoe(e))return!0;try{yu(e,"__sentry_captured__",!0)}catch{}return!1}function zoe(e){try{return e.__sentry_captured__}catch{}}var Aa;(function(e){e[e.PENDING=0]="PENDING";const n=1;e[e.RESOLVED=n]="RESOLVED";const i=2;e[e.REJECTED=i]="REJECTED"})(Aa||(Aa={}));function vu(e){return new jc(t=>{t(e)})}function A6(e){return new jc((t,n)=>{n(e)})}class jc{constructor(t){this._state=Aa.PENDING,this._handlers=[],this._runExecutor(t)}then(t,n){return new jc((i,s)=>{this._handlers.push([!1,r=>{if(!t)i(r);else try{i(t(r))}catch(o){s(o)}},r=>{if(!n)s(r);else try{i(n(r))}catch(o){s(o)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new jc((n,i)=>{let s,r;return this.then(o=>{r=!1,s=o,t&&t()},o=>{r=!0,s=o,t&&t()}).then(()=>{if(r){i(s);return}n(s)})})}_executeHandlers(){if(this._state===Aa.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===Aa.RESOLVED&&n[1](this._value),this._state===Aa.REJECTED&&n[2](this._value),n[0]=!0)})}_runExecutor(t){const n=(r,o)=>{if(this._state===Aa.PENDING){if(fy(o)){o.then(i,s);return}this._state=r,this._value=o,this._executeHandlers()}},i=r=>{n(Aa.RESOLVED,r)},s=r=>{n(Aa.REJECTED,r)};try{t(i,s)}catch(r){s(r)}}}function Hoe(e){const t=sl(),n={sid:Pr(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>$oe(n)};return e&&qh(n,e),n}function qh(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||sl(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:Pr()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function Voe(e,t){let n={};e.status==="ok"&&(n={status:"exited"}),qh(e,n)}function $oe(e){return er({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}function rM(){return Pr()}function nH(){return Pr().substring(16)}function Fp(e,t,n=2){if(!t||typeof t!="object"||n<=0)return t;if(e&&Object.keys(t).length===0)return e;const i={...e};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=Fp(i[s],t[s],n-1));return i}const B4="_sentrySpan";function oM(e,t){t?yu(e,B4,t):delete e[B4]}function aM(e){return e[B4]}const Goe=100;class la{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:rM(),sampleRand:Math.random()}}clone(){const t=new la;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,oM(t,aM(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&qh(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const n=typeof t=="function"?t(this):t,i=n instanceof la?n.getScopeData():Zh(n)?t:void 0,{tags:s,extra:r,user:o,contexts:a,level:l,fingerprint:c=[],propagationContext:d}=i||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...r},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),l&&(this._level=l),c.length&&(this._fingerprint=c),d&&(this._propagationContext=d),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,oM(this,void 0),this._attachments=[],this.setPropagationContext({traceId:rM(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,n){var r;const i=typeof n=="number"?n:Goe;if(i<=0)return this;const s={timestamp:Op(),...t};return this._breadcrumbs.push(s),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),(r=this._client)==null||r.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:aM(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=Fp(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const i=(n==null?void 0:n.event_id)||Pr();if(!this._client)return He.warn("No client configured on scope - will not capture exception!"),i;const s=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:s,...n,event_id:i},this),i}captureMessage(t,n,i){const s=(i==null?void 0:i.event_id)||Pr();if(!this._client)return He.warn("No client configured on scope - will not capture message!"),s;const r=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:r,...i,event_id:s},this),s}captureEvent(t,n){const i=(n==null?void 0:n.event_id)||Pr();return this._client?(this._client.captureEvent(t,{...n,event_id:i},this),i):(He.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function Xoe(){return dy("defaultCurrentScope",()=>new la)}function joe(){return dy("defaultIsolationScope",()=>new la)}class Yoe{constructor(t,n){let i;t?i=t:i=new la;let s;n?s=n:s=new la,this._stack=[{scope:i}],this._isolationScope=s}withScope(t){const n=this._pushScope();let i;try{i=t(n)}catch(s){throw this._popScope(),s}return fy(i)?i.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Qh(){const e=ly(),t=cy(e);return t.stack=t.stack||new Yoe(Xoe(),joe())}function Woe(e){return Qh().withScope(e)}function Koe(e,t){const n=Qh();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function lM(e){return Qh().withScope(()=>e(Qh().getIsolationScope()))}function Zoe(){return{withIsolationScope:lM,withScope:Woe,withSetScope:Koe,withSetIsolationScope:(e,t)=>lM(t),getCurrentScope:()=>Qh().getScope(),getIsolationScope:()=>Qh().getIsolationScope()}}function xw(e){const t=cy(e);return t.acs?t.acs:Zoe()}function Io(){const e=ly();return xw(e).getCurrentScope()}function Bp(){const e=ly();return xw(e).getIsolationScope()}function qoe(){return dy("globalScope",()=>new la)}function Cw(...e){const t=ly(),n=xw(t);if(e.length===2){const[i,s]=e;return i?n.withSetScope(i,s):n.withScope(s)}return n.withScope(e[0])}function zi(){return Io().getClient()}function Qoe(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:i,propagationSpanId:s}=t;return er({trace_id:n,span_id:s||nH(),parent_span_id:i})}const Joe="sentry.source",eae="sentry.sample_rate",tae="sentry.op",nae="sentry.origin",iH="sentry.profile_id",sH="sentry.exclusive_time",iae=0,sae=1,rae="_sentryScope",oae="_sentryIsolationScope";function rH(e){return{scope:e[rae],isolationScope:e[oae]}}function aae(e){if(typeof e=="boolean")return Number(e);const t=typeof e=="string"?parseFloat(e):e;if(!(typeof t!="number"||isNaN(t)||t<0||t>1))return t}const lae="sentry-",cae=/^sentry-/;function dae(e){const t=uae(e);if(!t)return;const n=Object.entries(t).reduce((i,[s,r])=>{if(s.match(cae)){const o=s.slice(lae.length);i[o]=r}return i},{});if(Object.keys(n).length>0)return n}function uae(e){if(!(!e||!il(e)&&!Array.isArray(e)))return Array.isArray(e)?e.reduce((t,n)=>{const i=cM(n);return Object.entries(i).forEach(([s,r])=>{t[s]=r}),t},{}):cM(e)}function cM(e){return e.split(",").map(t=>t.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((t,[n,i])=>(n&&i&&(t[n]=i),t),{})}const fae=1;let dM=!1;function hae(e){const{spanId:t,traceId:n,isRemote:i}=e.spanContext(),s=i?t:Aw(e).parent_span_id,r=rH(e).scope,o=i?(r==null?void 0:r.getPropagationContext().propagationSpanId)||nH():t;return er({parent_span_id:s,span_id:o,trace_id:n})}function uM(e){return typeof e=="number"?fM(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?fM(e.getTime()):sl()}function fM(e){return e>9999999999?e/1e3:e}function Aw(e){if(mae(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(gae(e)){const{attributes:i,startTime:s,name:r,endTime:o,parentSpanId:a,status:l}=e;return er({span_id:t,trace_id:n,data:i,description:r,parent_span_id:a,start_timestamp:uM(s),timestamp:uM(o)||void 0,status:Uae(l),op:i[tae],origin:i[nae]})}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function gae(e){const t=e;return!!t.attributes&&!!t.startTime&&!!t.name&&!!t.endTime&&!!t.status}function mae(e){return typeof e.getSpanJSON=="function"}function pae(e){const{traceFlags:t}=e.spanContext();return t===fae}function Uae(e){if(!(!e||e.code===iae))return e.code===sae?"ok":e.message||"unknown_error"}const bae="_sentryRootSpan";function oH(e){return e[bae]||e}function hM(){dM||(kg(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),dM=!0)}function yae(e){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=e||((n=zi())==null?void 0:n.getOptions());return!!t&&(t.tracesSampleRate!=null||!!t.tracesSampler)}const Mw="production",Eae="_frozenDsc";function aH(e,t){const n=t.getOptions(),{publicKey:i}=t.getDsn()||{},s=er({environment:n.environment||Mw,release:n.release,public_key:i,trace_id:e});return t.emit("createDsc",s),s}function vae(e,t){const n=t.getPropagationContext();return n.dsc||aH(n.traceId,e)}function _ae(e){var m;const t=zi();if(!t)return{};const n=oH(e),i=Aw(n),s=i.data,r=n.spanContext().traceState,o=(r==null?void 0:r.get("sentry.sample_rate"))??s[eae];function a(p){return(typeof o=="number"||typeof o=="string")&&(p.sample_rate=`${o}`),p}const l=n[Eae];if(l)return a(l);const c=r==null?void 0:r.get("sentry.dsc"),d=c&&dae(c);if(d)return a(d);const u=aH(e.spanContext().traceId,t),f=s[Joe],h=i.description;return f!=="url"&&h&&(u.transaction=h),yae()&&(u.sampled=String(pae(n)),u.sample_rand=(r==null?void 0:r.get("sentry.sample_rand"))??((m=rH(n).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),a(u),t.emit("createDsc",u,n),u}const wae=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Tae(e){return e==="http"||e==="https"}function kw(e,t=!1){const{host:n,path:i,pass:s,port:r,projectId:o,protocol:a,publicKey:l}=e;return`${a}://${l}${t&&s?`:${s}`:""}@${n}${r?`:${r}`:""}/${i&&`${i}/`}${o}`}function Iae(e){const t=wae.exec(e);if(!t){kg(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,i,s="",r="",o="",a=""]=t.slice(1);let l="",c=a;const d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){const u=c.match(/^\d+/);u&&(c=u[0])}return lH({host:r,pass:s,path:l,projectId:c,port:o,protocol:n,publicKey:i})}function lH(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Sae(e){if(!Gu)return!0;const{port:t,projectId:n,protocol:i}=e;return["protocol","publicKey","host","projectId"].find(o=>e[o]?!1:(He.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Tae(i)?t&&isNaN(parseInt(t,10))?(He.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(He.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(He.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function xae(e){const t=typeof e=="string"?Iae(e):lH(e);if(!(!t||!Sae(t)))return t}function Ma(e,t=100,n=1/0){try{return z4("",e,t,n)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function cH(e,t=3,n=100*1024){const i=Ma(e,t);return kae(i)>n?cH(e,t-1,n):i}function z4(e,t,n=1/0,i=1/0,s=Rae()){const[r,o]=s;if(t==null||["boolean","string"].includes(typeof t)||typeof t=="number"&&Number.isFinite(t))return t;const a=Cae(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const l=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(r(t))return"[Circular ~]";const c=t;if(c&&typeof c.toJSON=="function")try{const h=c.toJSON();return z4("",h,l-1,i,s)}catch{}const d=Array.isArray(t)?[]:{};let u=0;const f=Jz(t);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(u>=i){d[h]="[MaxProperties ~]";break}const m=f[h];d[h]=z4(h,m,l-1,i,s),u++}return o(t),d}function Cae(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(Zz(t))return"[VueViewModel]";if(Roe(t))return"[SyntheticEvent]";if(typeof t=="number"&&!Number.isFinite(t))return`[${t}]`;if(typeof t=="function")return`[Function: ${Xc(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=Aae(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Aae(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function Mae(e){return~-encodeURI(e).split(/%..|./).length}function kae(e){return Mae(JSON.stringify(e))}function Rae(){const e=new WeakSet;function t(i){return e.has(i)?!0:(e.add(i),!1)}function n(i){e.delete(i)}return[t,n]}function gy(e,t=[]){return[e,t]}function Lae(e,t){const[n,i]=e;return[n,[...i,t]]}function gM(e,t){const n=e[1];for(const i of n){const s=i[0].type;if(t(i,s))return!0}return!1}function H4(e){const t=cy($t);return t.encodePolyfill?t.encodePolyfill(e):new TextEncoder().encode(e)}function Dae(e){const[t,n]=e;let i=JSON.stringify(t);function s(r){typeof i=="string"?i=typeof r=="string"?i+r:[H4(i),r]:i.push(typeof r=="string"?H4(r):r)}for(const r of n){const[o,a]=r;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let l;try{l=JSON.stringify(a)}catch{l=JSON.stringify(Ma(a))}s(l)}}return typeof i=="string"?i:Pae(i)}function Pae(e){const t=e.reduce((s,r)=>s+r.length,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;return n}function Nae(e){const t=typeof e.data=="string"?H4(e.data):e.data;return[er({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const Oae={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security"};function mM(e){return Oae[e]}function dH(e){if(!(e!=null&&e.sdk))return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function Fae(e,t,n,i){var r;const s=(r=e.sdkProcessingMetadata)==null?void 0:r.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&i&&{dsn:kw(i)},...s&&{trace:er({...s})}}}function Bae(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function zae(e,t,n,i){const s=dH(n),r={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!i&&t&&{dsn:kw(t)}},o="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return gy(r,[o])}function Hae(e,t,n,i){const s=dH(n),r=e.type&&e.type!=="replay_event"?e.type:"event";Bae(e,n==null?void 0:n.sdk);const o=Fae(e,s,i,t);return delete e.sdkProcessingMetadata,gy(o,[[{type:r},e]])}function V4(e,t,n,i=0){return new jc((s,r)=>{const o=e[i];if(t===null||typeof o!="function")s(t);else{const a=o({...t},n);Bt&&o.id&&a===null&&He.log(`Event processor "${o.id}" dropped event`),fy(a)?a.then(l=>V4(e,l,n,i+1).then(s)).then(null,r):V4(e,a,n,i+1).then(s).then(null,r)}})}let WU,pM,KU;function Vae(e){const t=$t._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return KU&&n.length===pM||(pM=n.length,KU=n.reduce((i,s)=>{WU||(WU={});const r=WU[s];if(r)i[r[0]]=r[1];else{const o=e(s);for(let a=o.length-1;a>=0;a--){const l=o[a],c=l==null?void 0:l.filename,d=t[s];if(c&&d){i[c]=d,WU[s]=[c,d];break}}}return i},{})),KU}function $ae(e,t){const{fingerprint:n,span:i,breadcrumbs:s,sdkProcessingMetadata:r}=t;Gae(e,t),i&&Yae(e,i),Wae(e,n),Xae(e,s),jae(e,r)}function UM(e,t){const{extra:n,tags:i,user:s,contexts:r,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:d,attachments:u,propagationContext:f,transactionName:h,span:m}=t;ZU(e,"extra",n),ZU(e,"tags",i),ZU(e,"user",s),ZU(e,"contexts",r),e.sdkProcessingMetadata=Fp(e.sdkProcessingMetadata,a,2),o&&(e.level=o),h&&(e.transactionName=h),m&&(e.span=m),l.length&&(e.breadcrumbs=[...e.breadcrumbs,...l]),c.length&&(e.fingerprint=[...e.fingerprint,...c]),d.length&&(e.eventProcessors=[...e.eventProcessors,...d]),u.length&&(e.attachments=[...e.attachments,...u]),e.propagationContext={...e.propagationContext,...f}}function ZU(e,t,n){e[t]=Fp(e[t],n,1)}function Gae(e,t){const{extra:n,tags:i,user:s,contexts:r,level:o,transactionName:a}=t,l=er(n);Object.keys(l).length&&(e.extra={...l,...e.extra});const c=er(i);Object.keys(c).length&&(e.tags={...c,...e.tags});const d=er(s);Object.keys(d).length&&(e.user={...d,...e.user});const u=er(r);Object.keys(u).length&&(e.contexts={...u,...e.contexts}),o&&(e.level=o),a&&e.type!=="transaction"&&(e.transaction=a)}function Xae(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function jae(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function Yae(e,t){e.contexts={trace:hae(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:_ae(t),...e.sdkProcessingMetadata};const n=oH(t),i=Aw(n).description;i&&!e.transaction&&e.type==="transaction"&&(e.transaction=i)}function Wae(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}function Kae(e,t,n,i,s,r){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=e,l={...t,event_id:t.event_id||n.event_id||Pr(),timestamp:t.timestamp||Op()},c=n.integrations||e.integrations.map(U=>U.name);Zae(l,e),Jae(l,c),s&&s.emit("applyFrameMetadata",t),t.type===void 0&&qae(l,e.stackParser);const d=tle(i,n.captureContext);n.mechanism&&Eu(l,n.mechanism);const u=s?s.getEventProcessors():[],f=qoe().getScopeData();if(r){const U=r.getScopeData();UM(f,U)}if(d){const U=d.getScopeData();UM(f,U)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),$ae(l,f);const m=[...u,...f.eventProcessors];return V4(m,l,n).then(U=>(U&&Qae(U),typeof o=="number"&&o>0?ele(U,o,a):U))}function Zae(e,t){var l,c;const{environment:n,release:i,dist:s,maxValueLength:r=250}=t;e.environment=e.environment||n||Mw,!e.release&&i&&(e.release=i),!e.dist&&s&&(e.dist=s),e.message&&(e.message=bh(e.message,r));const o=(c=(l=e.exception)==null?void 0:l.values)==null?void 0:c[0];o!=null&&o.value&&(o.value=bh(o.value,r));const a=e.request;a!=null&&a.url&&(a.url=bh(a.url,r))}function qae(e,t){var i,s;const n=Vae(t);(s=(i=e.exception)==null?void 0:i.values)==null||s.forEach(r=>{var o,a;(a=(o=r.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.filename&&(l.debug_id=n[l.filename])})})}function Qae(e){var i,s;const t={};if((s=(i=e.exception)==null?void 0:i.values)==null||s.forEach(r=>{var o,a;(a=(o=r.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.debug_id&&(l.abs_path?t[l.abs_path]=l.debug_id:l.filename&&(t[l.filename]=l.debug_id),delete l.debug_id)})}),Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([r,o])=>{n.push({type:"sourcemap",code_file:r,debug_id:o})})}function Jae(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function ele(e,t,n){var s,r;if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(o=>({...o,...o.data&&{data:Ma(o.data,t,n)}}))},...e.user&&{user:Ma(e.user,t,n)},...e.contexts&&{contexts:Ma(e.contexts,t,n)},...e.extra&&{extra:Ma(e.extra,t,n)}};return(s=e.contexts)!=null&&s.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=Ma(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map(o=>({...o,...o.data&&{data:Ma(o.data,t,n)}}))),(r=e.contexts)!=null&&r.flags&&i.contexts&&(i.contexts.flags=Ma(e.contexts.flags,3,n)),i}function tle(e,t){if(!t)return e;const n=e?e.clone():new la;return n.update(t),n}function nle(e){if(e)return ile(e)?{captureContext:e}:rle(e)?{captureContext:e}:e}function ile(e){return e instanceof la||typeof e=="function"}const sle=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function rle(e){return Object.keys(e).some(t=>sle.includes(t))}function Rw(e,t){return Io().captureException(e,nle(t))}function bM(e,t){const n=typeof t=="string"?t:void 0,i=typeof t!="string"?{captureContext:t}:void 0;return Io().captureMessage(e,n,i)}function uH(e,t){return Io().captureEvent(e,t)}function yM(e){const t=Bp(),n=Io(),{userAgent:i}=$t.navigator||{},s=Hoe({user:n.getUser()||t.getUser(),...i&&{userAgent:i},...e}),r=t.getSession();return(r==null?void 0:r.status)==="ok"&&qh(r,{status:"exited"}),fH(),t.setSession(s),s}function fH(){const e=Bp(),n=Io().getSession()||e.getSession();n&&Voe(n),hH(),e.setSession()}function hH(){const e=Bp(),t=zi(),n=e.getSession();n&&t&&t.captureSession(n)}function EM(e=!1){if(e){fH();return}hH()}const ole="7";function ale(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function lle(e){return`${ale(e)}${e.projectId}/envelope/`}function cle(e,t){const n={sentry_version:ole};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}function dle(e,t,n){return t||`${lle(e)}?${cle(e,n)}`}const vM=[];function ule(e){const t={};return e.forEach(n=>{const{name:i}=n,s=t[i];s&&!s.isDefaultInstance&&n.isDefaultInstance||(t[i]=n)}),Object.values(t)}function fle(e){const t=e.defaultIntegrations||[],n=e.integrations;t.forEach(s=>{s.isDefaultInstance=!0});let i;if(Array.isArray(n))i=[...t,...n];else if(typeof n=="function"){const s=n(t);i=Array.isArray(s)?s:[s]}else i=t;return ule(i)}function hle(e,t){const n={};return t.forEach(i=>{i&&gH(e,i,n)}),n}function _M(e,t){for(const n of t)n!=null&&n.afterAllSetup&&n.afterAllSetup(e)}function gH(e,t,n){if(n[t.name]){Bt&&He.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,vM.indexOf(t.name)===-1&&typeof t.setupOnce=="function"&&(t.setupOnce(),vM.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),typeof t.preprocessEvent=="function"){const i=t.preprocessEvent.bind(t);e.on("preprocessEvent",(s,r)=>i(s,r,e))}if(typeof t.processEvent=="function"){const i=t.processEvent.bind(t),s=Object.assign((r,o)=>i(r,o,e),{id:t.name});e.addEventProcessor(s)}Bt&&He.log(`Integration installed: ${t.name}`)}function gle(e,t,n){const i=[{type:"client_report"},{timestamp:Op(),discarded_events:e}];return gy(t?{dsn:t}:{},[i])}class io extends Error{constructor(t,n="warn"){super(t),this.message=t,this.logLevel=n}}function mH(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n!=null&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}function mle(e){var l;const{trace_id:t,parent_span_id:n,span_id:i,status:s,origin:r,data:o,op:a}=((l=e.contexts)==null?void 0:l.trace)??{};return er({data:o??{},description:e.transaction,op:a,parent_span_id:n,span_id:i??"",start_timestamp:e.start_timestamp??0,status:s,timestamp:e.timestamp,trace_id:t??"",origin:r,profile_id:o==null?void 0:o[iH],exclusive_time:o==null?void 0:o[sH],measurements:e.measurements,is_segment:!0})}function ple(e){const t={type:"transaction",timestamp:e.timestamp,start_timestamp:e.start_timestamp,transaction:e.description,contexts:{trace:{trace_id:e.trace_id,span_id:e.span_id,parent_span_id:e.parent_span_id,op:e.op,status:e.status,origin:e.origin,data:{...e.data,...e.profile_id&&{[iH]:e.profile_id},...e.exclusive_time&&{[sH]:e.exclusive_time}}}},measurements:e.measurements};return er(t)}const wM="Not capturing exception because it's already been captured.",TM="Discarded session because of missing or non-string release";class Ule{constructor(t){if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=xae(t.dsn):Bt&&He.warn("No DSN provided, client will not send events."),this._dsn){const n=dle(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,i){const s=Pr();if(sM(t))return Bt&&He.log(wM),s;const r={event_id:s,...n};return this._process(this.eventFromException(t,r).then(o=>this._captureEvent(o,r,i))),r.event_id}captureMessage(t,n,i,s){const r={event_id:Pr(),...i},o=_w(t)?t:String(t),a=ww(t)?this.eventFromMessage(o,n,r):this.eventFromException(t,r);return this._process(a.then(l=>this._captureEvent(l,r,s))),r.event_id}captureEvent(t,n,i){const s=Pr();if(n!=null&&n.originalException&&sM(n.originalException))return Bt&&He.log(wM),s;const r={event_id:s,...n},o=t.sdkProcessingMetadata||{},a=o.capturedSpanScope,l=o.capturedSpanIsolationScope;return this._process(this._captureEvent(t,r,a||i,l)),r.event_id}captureSession(t){this.sendSession(t),qh(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(t).then(i=>n.flush(t).then(s=>i&&s))):vu(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some(({name:t})=>t.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const n=this._integrations[t.name];gH(this,t,this._integrations),n||_M(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let i=Hae(t,this._dsn,this._options._metadata,this._options.tunnel);for(const r of n.attachments||[])i=Lae(i,Nae(r));const s=this.sendEnvelope(i);s&&s.then(r=>this.emit("afterSendEvent",t,r),null)}sendSession(t){const{release:n,environment:i=Mw}=this._options;if("aggregates"in t){const r=t.attrs||{};if(!r.release&&!n){Bt&&He.warn(TM);return}r.release=r.release||n,r.environment=r.environment||i,t.attrs=r}else{if(!t.release&&!n){Bt&&He.warn(TM);return}t.release=t.release||n,t.environment=t.environment||i}this.emit("beforeSendSession",t);const s=zae(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(t,n,i=1){if(this._options.sendClientReports){const s=`${t}:${n}`;Bt&&He.log(`Recording outcome: "${s}"${i>1?` (${i} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+i}}on(t,n){const i=this._hooks[t]=this._hooks[t]||[];return i.push(n),()=>{const s=i.indexOf(n);s>-1&&i.splice(s,1)}}emit(t,...n){const i=this._hooks[t];i&&i.forEach(s=>s(...n))}sendEnvelope(t){return this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport?this._transport.send(t).then(null,n=>(Bt&&He.error("Error while sending envelope:",n),n)):(Bt&&He.error("Transport disabled"),vu({}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=hle(this,t),_M(this,t)}_updateSessionFromEvent(t,n){var l;let i=n.level==="fatal",s=!1;const r=(l=n.exception)==null?void 0:l.values;if(r){s=!0;for(const c of r){const d=c.mechanism;if((d==null?void 0:d.handled)===!1){i=!0;break}}}const o=t.status==="ok";(o&&t.errors===0||o&&i)&&(qh(t,{...i&&{status:"crashed"},errors:t.errors||Number(s||i)}),this.captureSession(t))}_isClientDoneProcessing(t){return new jc(n=>{let i=0;const s=1,r=setInterval(()=>{this._numProcessing==0?(clearInterval(r),n(!0)):(i+=s,t&&i>=t&&(clearInterval(r),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,i,s){const r=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",t,n),t.type||s.setLastEventId(t.event_id||n.event_id),Kae(r,t,n,i,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:Qoe(i),...a.contexts};const l=vae(this,i);return a.sdkProcessingMetadata={dynamicSamplingContext:l,...a.sdkProcessingMetadata},a})}_captureEvent(t,n={},i=Io(),s=Bp()){return Bt&&$4(t)&&He.log(`Captured error event \`${mH(t)[0]||"<unknown>"}\``),this._processEvent(t,n,i,s).then(r=>r.event_id,r=>{Bt&&(r instanceof io&&r.logLevel==="log"?He.log(r.message):He.warn(r))})}_processEvent(t,n,i,s){const r=this.getOptions(),{sampleRate:o}=r,a=pH(t),l=$4(t),c=t.type||"error",d=`before send for type \`${c}\``,u=typeof o>"u"?void 0:aae(o);if(l&&typeof u=="number"&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error"),A6(new io(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const f=c==="replay_event"?"replay":c;return this._prepareEvent(t,n,i,s).then(h=>{if(h===null)throw this.recordDroppedEvent("event_processor",f),new io("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return h;const p=yle(this,r,h,n);return ble(p,d)}).then(h=>{var U;if(h===null){if(this.recordDroppedEvent("before_send",f),a){const y=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",y)}throw new io(`${d} returned \`null\`, will not send event.`,"log")}const m=i.getSession()||s.getSession();if(l&&m&&this._updateSessionFromEvent(m,h),a){const b=((U=h.sdkProcessingMetadata)==null?void 0:U.spanCountBeforeProcessing)||0,y=h.spans?h.spans.length:0,v=b-y;v>0&&this.recordDroppedEvent("before_send","span",v)}const p=h.transaction_info;if(a&&p&&h.transaction!==t.transaction){const b="custom";h.transaction_info={...p,source:b}}return this.sendEvent(h,n),h}).then(null,h=>{throw h instanceof io?h:(this.captureException(h,{data:{__sentry__:!0},originalException:h}),new io(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${h}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map(([n,i])=>{const[s,r]=n.split(":");return{reason:s,category:r,quantity:i}})}_flushOutcomes(){Bt&&He.log("Flushing outcomes...");const t=this._clearOutcomes();if(t.length===0){Bt&&He.log("No outcomes to send");return}if(!this._dsn){Bt&&He.log("No dsn provided, will not send outcomes");return}Bt&&He.log("Sending outcomes:",t);const n=gle(t,this._options.tunnel&&kw(this._dsn));this.sendEnvelope(n)}}function ble(e,t){const n=`${t} must return \`null\` or a valid event.`;if(fy(e))return e.then(i=>{if(!Zh(i)&&i!==null)throw new io(n);return i},i=>{throw new io(`${t} rejected with ${i}`)});if(!Zh(e)&&e!==null)throw new io(n);return e}function yle(e,t,n,i){const{beforeSend:s,beforeSendTransaction:r,beforeSendSpan:o}=t;let a=n;if($4(a)&&s)return s(a,i);if(pH(a)){if(o){const l=o(mle(a));if(l?a=Fp(n,ple(l)):hM(),a.spans){const c=[];for(const d of a.spans){const u=o(d);u?c.push(u):(hM(),c.push(d))}a.spans=c}}if(r){if(a.spans){const l=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:l}}return r(a,i)}}return a}function $4(e){return e.type===void 0}function pH(e){return e.type==="transaction"}function Ele(e,t){t.debug===!0&&(Bt?He.enable():kg(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Io().update(t.initialScope);const i=new e(t);return vle(i),i.init(),i}function vle(e){Io().setClient(e)}function _le(e){const t=[];function n(){return e===void 0||t.length<e}function i(o){return t.splice(t.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return A6(new io("Not adding Promise because buffer limit was reached."));const a=o();return t.indexOf(a)===-1&&t.push(a),a.then(()=>i(a)).then(null,()=>i(a).then(null,()=>{})),a}function r(o){return new jc((a,l)=>{let c=t.length;if(!c)return a(!0);const d=setTimeout(()=>{o&&o>0&&a(!1)},o);t.forEach(u=>{vu(u).then(()=>{--c||(clearTimeout(d),a(!0))},l)})})}return{$:t,add:s,drain:r}}const wle=60*1e3;function Tle(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;const i=Date.parse(`${e}`);return isNaN(i)?wle:i-t}function Ile(e,t){return e[t]||e.all||0}function Sle(e,t,n=Date.now()){return Ile(e,t)>n}function xle(e,{statusCode:t,headers:n},i=Date.now()){const s={...e},r=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(r)for(const a of r.trim().split(",")){const[l,c,,,d]=a.split(":",5),u=parseInt(l,10),f=(isNaN(u)?60:u)*1e3;if(!c)s.all=i+f;else for(const h of c.split(";"))h==="metric_bucket"?(!d||d.split(";").includes("custom"))&&(s[h]=i+f):s[h]=i+f}else o?s.all=i+Tle(o,i):t===429&&(s.all=i+60*1e3);return s}const Cle=64;function Ale(e,t,n=_le(e.bufferSize||Cle)){let i={};const s=o=>n.drain(o);function r(o){const a=[];if(gM(o,(u,f)=>{const h=mM(f);Sle(i,h)?e.recordDroppedEvent("ratelimit_backoff",h):a.push(u)}),a.length===0)return vu({});const l=gy(o[0],a),c=u=>{gM(l,(f,h)=>{e.recordDroppedEvent(u,mM(h))})},d=()=>t({body:Dae(l)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&Bt&&He.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),i=xle(i,u),u),u=>{throw c("network_error"),u});return n.add(d).then(u=>u,u=>{if(u instanceof io)return Bt&&He.error("Skipped sending event because buffer is full."),c("queue_overflow"),vu({});throw u})}return{send:r,flush:s}}function Mle(e){var t;((t=e.user)==null?void 0:t.ip_address)===void 0&&(e.user={...e.user,ip_address:"{{auto}}"})}function kle(e){var t;"aggregates"in e?((t=e.attrs)==null?void 0:t.ip_address)===void 0&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):e.ipAddress===void 0&&(e.ipAddress="{{auto}}")}function Rle(e,t,n=[t],i="npm"){const s=e._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${t}`,packages:n.map(r=>({name:`${i}:@sentry/${r}`,version:iu})),version:iu}),e._metadata=s}const Lle=100;function _u(e,t){const n=zi(),i=Bp();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:r=Lle}=n.getOptions();if(r<=0)return;const a={timestamp:Op(),...e},l=s?kg(()=>s(a,t)):a;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,t),i.addBreadcrumb(l,r))}let IM;const Dle="FunctionToString",SM=new WeakMap,Ple=()=>({name:Dle,setupOnce(){IM=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Sw(this),n=SM.has(zi())&&t!==void 0?t:this;return IM.apply(n,e)}}catch{}},setup(e){SM.set(e,!0)}}),Nle=Ple,Ole=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],Fle="InboundFilters",Ble=(e={})=>({name:Fle,processEvent(t,n,i){const s=i.getOptions(),r=Hle(e,s);return Vle(t,r)?null:t}}),zle=Ble;function Hle(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Ole],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function Vle(e,t){return t.ignoreInternal&&Yle(e)?(Bt&&He.warn(`Event dropped due to being internal Sentry Error.
Event: ${Zl(e)}`),!0):$le(e,t.ignoreErrors)?(Bt&&He.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Zl(e)}`),!0):Kle(e)?(Bt&&He.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Zl(e)}`),!0):Gle(e,t.ignoreTransactions)?(Bt&&He.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Zl(e)}`),!0):Xle(e,t.denyUrls)?(Bt&&He.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Zl(e)}.
Url: ${M6(e)}`),!0):jle(e,t.allowUrls)?!1:(Bt&&He.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Zl(e)}.
Url: ${M6(e)}`),!0)}function $le(e,t){return e.type||!t||!t.length?!1:mH(e).some(n=>hy(n,t))}function Gle(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const n=e.transaction;return n?hy(n,t):!1}function Xle(e,t){if(!(t!=null&&t.length))return!1;const n=M6(e);return n?hy(n,t):!1}function jle(e,t){if(!(t!=null&&t.length))return!0;const n=M6(e);return n?hy(n,t):!0}function Yle(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function Wle(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function M6(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?Wle(t):null}catch{return Bt&&He.error(`Cannot extract url for event ${Zl(e)}`),null}}function Kle(e){var t,n;return e.type||!((n=(t=e.exception)==null?void 0:t.values)!=null&&n.length)?!1:!e.message&&!e.exception.values.some(i=>i.stacktrace||i.type&&i.type!=="Error"||i.value)}function Zle(e,t,n=250,i,s,r,o){var l;if(!((l=r.exception)!=null&&l.values)||!o||!bu(o.originalException,Error))return;const a=r.exception.values.length>0?r.exception.values[r.exception.values.length-1]:void 0;a&&(r.exception.values=qle(G4(e,t,s,o.originalException,i,r.exception.values,a,0),n))}function G4(e,t,n,i,s,r,o,a){if(r.length>=n+1)return r;let l=[...r];if(bu(i[s],Error)){xM(o,a);const c=e(t,i[s]),d=l.length;CM(c,s,d,a),l=G4(e,t,n,i[s],s,[c,...l],c,d)}return Array.isArray(i.errors)&&i.errors.forEach((c,d)=>{if(bu(c,Error)){xM(o,a);const u=e(t,c),f=l.length;CM(u,`errors[${d}]`,f,a),l=G4(e,t,n,c,s,[u,...l],u,f)}}),l}function xM(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function CM(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}function qle(e,t){return e.map(n=>(n.value&&(n.value=bh(n.value,t)),n))}function UH(e){const t="console";Xu(t,e),ju(t,Qle)}function Qle(){"console"in $t&&S6.forEach(function(e){e in $t.console&&Js($t.console,e,function(t){return x6[e]=t,function(...n){ho("console",{args:n,level:e});const s=x6[e];s==null||s.apply($t.console,n)}})})}function bH(e){return e==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}const Jle="CaptureConsole",ece=(e={})=>{const t=e.levels||S6,n=e.handled??!0;return{name:Jle,setup(i){"console"in $t&&UH(({args:s,level:r})=>{zi()!==i||!t.includes(r)||nce(s,r,n)})}}},tce=ece;function nce(e,t,n){const i={level:bH(t),extra:{arguments:e}};Cw(s=>{if(s.addEventProcessor(a=>(a.logger="console",Eu(a,{handled:n,type:"console"}),a)),t==="assert"){if(!e[0]){const a=`Assertion failed: ${C6(e.slice(1)," ")||"console.assert"}`;s.setExtra("arguments",e.slice(1)),bM(a,i)}return}const r=e.find(a=>a instanceof Error);if(r){Rw(r,i);return}const o=C6(e," ");bM(o,i)})}const ice="Dedupe",sce=()=>{let e;return{name:ice,processEvent(t){if(t.type)return t;try{if(oce(t,e))return Bt&&He.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},rce=sce;function oce(e,t){return t?!!(ace(e,t)||lce(e,t)):!1}function ace(e,t){const n=e.message,i=t.message;return!(!n&&!i||n&&!i||!n&&i||n!==i||!EH(e,t)||!yH(e,t))}function lce(e,t){const n=AM(t),i=AM(e);return!(!n||!i||n.type!==i.type||n.value!==i.value||!EH(e,t)||!yH(e,t))}function yH(e,t){let n=JA(e),i=JA(t);if(!n&&!i)return!0;if(n&&!i||!n&&i||(n=n,i=i,i.length!==n.length))return!1;for(let s=0;s<i.length;s++){const r=i[s],o=n[s];if(r.filename!==o.filename||r.lineno!==o.lineno||r.colno!==o.colno||r.function!==o.function)return!1}return!0}function EH(e,t){let n=e.fingerprint,i=t.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;n=n,i=i;try{return n.join("")===i.join("")}catch{return!1}}function AM(e){var t;return((t=e.exception)==null?void 0:t.values)&&e.exception.values[0]}function j8(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}function vH(e){if(e!==void 0)return e>=400&&e<500?"warning":e>=500?"error":void 0}const k6=$t;function cce(){return"history"in k6}function _H(){if(!("fetch"in k6))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function X4(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function dce(){var n;if(typeof EdgeRuntime=="string")return!0;if(!_H())return!1;if(X4(k6.fetch))return!0;let e=!1;const t=k6.document;if(t&&typeof t.createElement=="function")try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i),(n=i.contentWindow)!=null&&n.fetch&&(e=X4(i.contentWindow.fetch)),t.head.removeChild(i)}catch(i){Gu&&He.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}function uce(e,t){const n="fetch";Xu(n,e),ju(n,()=>fce(void 0,t))}function fce(e,t=!1){t&&!dce()||Js($t,"fetch",function(n){return function(...i){const s=new Error,{method:r,url:o}=hce(i),a={args:i,fetchData:{method:r,url:o},startTimestamp:sl()*1e3,virtualError:s};return ho("fetch",{...a}),n.apply($t,i).then(async l=>(ho("fetch",{...a,endTimestamp:sl()*1e3,response:l}),l),l=>{throw ho("fetch",{...a,endTimestamp:sl()*1e3,error:l}),vw(l)&&l.stack===void 0&&(l.stack=s.stack,yu(l,"framesToPop",1)),l})}})}function j4(e,t){return!!e&&typeof e=="object"&&!!e[t]}function MM(e){return typeof e=="string"?e:e?j4(e,"url")?e.url:e.toString?e.toString():"":""}function hce(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,i]=e;return{url:MM(n),method:j4(i,"method")?String(i.method).toUpperCase():"GET"}}const t=e[0];return{url:MM(t),method:j4(t,"method")?String(t.method).toUpperCase():"GET"}}function gce(){return"npm"}const Fn=$t;let Y4=0;function wH(){return Y4>0}function mce(){Y4++,setTimeout(()=>{Y4--})}function Jh(e,t={}){function n(s){return typeof s=="function"}if(!n(e))return e;try{const s=e.__sentry_wrapped__;if(s)return typeof s=="function"?s:e;if(Sw(e))return e}catch{return e}const i=function(...s){try{const r=s.map(o=>Jh(o,t));return e.apply(this,r)}catch(r){throw mce(),Cw(o=>{o.addEventProcessor(a=>(t.mechanism&&(F4(a,void 0),Eu(a,t.mechanism)),a.extra={...a.extra,arguments:s},a)),Rw(r)}),r}};try{for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=e[s])}catch{}Qz(i,e),yu(e,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return e.name}})}catch{}return i}function Lw(e,t){const n=Dw(e,t),i={type:Ece(t),value:vce(t)};return n.length&&(i.stacktrace={frames:n}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function pce(e,t,n,i){const s=zi(),r=s==null?void 0:s.getOptions().normalizeDepth,o=Sce(t),a={__serialized__:cH(t,r)};if(o)return{exception:{values:[Lw(e,o)]},extra:a};const l={exception:{values:[{type:uy(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:Tce(t,{isUnhandledRejection:i})}]},extra:a};if(n){const c=Dw(e,n);c.length&&(l.exception.values[0].stacktrace={frames:c})}return l}function Y8(e,t){return{exception:{values:[Lw(e,t)]}}}function Dw(e,t){const n=t.stacktrace||t.stack||"",i=bce(t),s=yce(t);try{return e(n,i,s)}catch{}return[]}const Uce=/Minified React error #\d+;/i;function bce(e){return e&&Uce.test(e.message)?1:0}function yce(e){return typeof e.framesToPop=="number"?e.framesToPop:0}function TH(e){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?e instanceof WebAssembly.Exception:!1}function Ece(e){const t=e==null?void 0:e.name;return!t&&TH(e)?e.message&&Array.isArray(e.message)&&e.message.length==2?e.message[0]:"WebAssembly.Exception":t}function vce(e){const t=e==null?void 0:e.message;return TH(e)?Array.isArray(e.message)&&e.message.length==2?e.message[1]:"wasm exception":t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function _ce(e,t,n,i){const s=(n==null?void 0:n.syntheticException)||void 0,r=Pw(e,t,s,i);return Eu(r),r.level="error",n!=null&&n.event_id&&(r.event_id=n.event_id),vu(r)}function wce(e,t,n="info",i,s){const r=(i==null?void 0:i.syntheticException)||void 0,o=W4(e,t,r,s);return o.level=n,i!=null&&i.event_id&&(o.event_id=i.event_id),vu(o)}function Pw(e,t,n,i,s){let r;if(Kz(t)&&t.error)return Y8(e,t.error);if(tM(t)||Aoe(t)){const o=t;if("stack"in t)r=Y8(e,t);else{const a=o.name||(tM(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;r=W4(e,l,n,i),F4(r,l)}return"code"in o&&(r.tags={...r.tags,"DOMException.code":`${o.code}`}),r}return vw(t)?Y8(e,t):Zh(t)||uy(t)?(r=pce(e,t,n,s),Eu(r,{synthetic:!0}),r):(r=W4(e,t,n,i),F4(r,`${t}`),Eu(r,{synthetic:!0}),r)}function W4(e,t,n,i){const s={};if(i&&n){const r=Dw(e,n);r.length&&(s.exception={values:[{value:t,stacktrace:{frames:r}}]}),Eu(s,{synthetic:!0})}if(_w(t)){const{__sentry_template_string__:r,__sentry_template_values__:o}=t;return s.logentry={message:r,params:o},s}return s.message=t,s}function Tce(e,{isUnhandledRejection:t}){const n=Ooe(e),i=t?"promise rejection":"exception";return Kz(e)?`Event \`ErrorEvent\` captured as ${i} with message \`${e.message}\``:uy(e)?`Event \`${Ice(e)}\` (type=${e.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function Ice(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}function Sce(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}class xce extends Ule{constructor(t){const n={parentSpanIsAlwaysRootSpan:!0,...t},i=Fn.SENTRY_SDK_SOURCE||gce();Rle(n,"browser",["browser"],i),super(n),n.sendClientReports&&Fn.document&&Fn.document.addEventListener("visibilitychange",()=>{Fn.document.visibilityState==="hidden"&&this._flushOutcomes()}),this._options.sendDefaultPii&&(this.on("postprocessEvent",Mle),this.on("beforeSendSession",kle))}eventFromException(t,n){return _ce(this._options.stackParser,t,n,this._options.attachStacktrace)}eventFromMessage(t,n="info",i){return wce(this._options.stackParser,t,n,i,this._options.attachStacktrace)}_prepareEvent(t,n,i,s){return t.platform=t.platform||"javascript",super._prepareEvent(t,n,i,s)}}const Cce=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Ms=$t,Ace=1e3;let kM,K4,Z4;function Mce(e){const t="dom";Xu(t,e),ju(t,kce)}function kce(){if(!Ms.document)return;const e=ho.bind(null,"dom"),t=RM(e,!0);Ms.document.addEventListener("click",t,!1),Ms.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{var r,o;const s=(r=Ms[n])==null?void 0:r.prototype;(o=s==null?void 0:s.hasOwnProperty)!=null&&o.call(s,"addEventListener")&&(Js(s,"addEventListener",function(a){return function(l,c,d){if(l==="click"||l=="keypress")try{const u=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=u[l]=u[l]||{refCount:0};if(!f.handler){const h=RM(e);f.handler=h,a.call(this,l,h,d)}f.refCount++}catch{}return a.call(this,l,c,d)}}),Js(s,"removeEventListener",function(a){return function(l,c,d){if(l==="click"||l=="keypress")try{const u=this.__sentry_instrumentation_handlers__||{},f=u[l];f&&(f.refCount--,f.refCount<=0&&(a.call(this,l,f.handler,d),f.handler=void 0,delete u[l]),Object.keys(u).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,l,c,d)}}))})}function Rce(e){if(e.type!==K4)return!1;try{if(!e.target||e.target._sentryId!==Z4)return!1}catch{}return!0}function Lce(e,t){return e!=="keypress"?!1:t!=null&&t.tagName?!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable):!0}function RM(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const i=Dce(n);if(Lce(n.type,i))return;yu(n,"_sentryCaptured",!0),i&&!i._sentryId&&yu(i,"_sentryId",Pr());const s=n.type==="keypress"?"input":n.type;Rce(n)||(e({event:n,name:s,global:t}),K4=n.type,Z4=i?i._sentryId:void 0),clearTimeout(kM),kM=Ms.setTimeout(()=>{Z4=void 0,K4=void 0},Ace)}}function Dce(e){try{return e.target}catch{return null}}let qU;function IH(e){const t="history";Xu(t,e),ju(t,Pce)}function Pce(){if(Ms.addEventListener("popstate",()=>{const t=Ms.location.href,n=qU;if(qU=t,n===t)return;ho("history",{from:n,to:t})}),!cce())return;function e(t){return function(...n){const i=n.length>2?n[2]:void 0;if(i){const s=qU,r=String(i);if(qU=r,s===r)return;ho("history",{from:s,to:r})}return t.apply(this,n)}}Js(Ms.history,"pushState",e),Js(Ms.history,"replaceState",e)}const K2={};function Nce(e){const t=K2[e];if(t)return t;let n=Ms[e];if(X4(n))return K2[e]=n.bind(Ms);const i=Ms.document;if(i&&typeof i.createElement=="function")try{const s=i.createElement("iframe");s.hidden=!0,i.head.appendChild(s);const r=s.contentWindow;r!=null&&r[e]&&(n=r[e]),i.head.removeChild(s)}catch(s){Cce&&He.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,s)}return n&&(K2[e]=n.bind(Ms))}function LM(e){K2[e]=void 0}const K1="__sentry_xhr_v3__";function Oce(e){const t="xhr";Xu(t,e),ju(t,Fce)}function Fce(){if(!Ms.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(t,n,i){const s=new Error,r=sl()*1e3,o=il(i[0])?i[0].toUpperCase():void 0,a=Bce(i[1]);if(!o||!a)return t.apply(n,i);n[K1]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const l=()=>{const c=n[K1];if(c&&n.readyState===4){try{c.status_code=n.status}catch{}const d={endTimestamp:sl()*1e3,startTimestamp:r,xhr:n,virtualError:s};ho("xhr",d)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(c,d,u){return l(),c.apply(d,u)}}):n.addEventListener("readystatechange",l),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(c,d,u){const[f,h]=u,m=d[K1];return m&&il(f)&&il(h)&&(m.request_headers[f.toLowerCase()]=h),c.apply(d,u)}}),t.apply(n,i)}}),e.send=new Proxy(e.send,{apply(t,n,i){const s=n[K1];if(!s)return t.apply(n,i);i[0]!==void 0&&(s.body=i[0]);const r={startTimestamp:sl()*1e3,xhr:n};return ho("xhr",r),t.apply(n,i)}})}function Bce(e){if(il(e))return e;try{return e.toString()}catch{}}function zce(e,t=Nce("fetch")){let n=0,i=0;function s(r){const o=r.body.length;n+=o,i++;const a={body:r.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};if(!t)return LM("fetch"),A6("No fetch implementation available");try{return t(e.url,a).then(l=>(n-=o,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return LM("fetch"),n-=o,i--,A6(l)}}return Ale(e,s)}const Hce=30,Vce=50;function q4(e,t,n,i){const s={filename:e,function:t==="<anonymous>"?Uu:t,in_app:!0};return n!==void 0&&(s.lineno=n),i!==void 0&&(s.colno=i),s}const $ce=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Gce=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Xce=/\((\S*)(?::(\d+))(?::(\d+))\)/,jce=e=>{const t=$ce.exec(e);if(t){const[,i,s,r]=t;return q4(i,Uu,+s,+r)}const n=Gce.exec(e);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=Xce.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,r]=SH(n[1]||Uu,n[2]);return q4(r,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},Yce=[Hce,jce],Wce=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Kce=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Zce=e=>{const t=Wce.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const r=Kce.exec(t[3]);r&&(t[1]=t[1]||"eval",t[3]=r[1],t[4]=r[2],t[5]="")}let i=t[3],s=t[1]||Uu;return[s,i]=SH(s,i),q4(i,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},qce=[Vce,Zce],Qce=[Yce,qce],Jce=Yz(...Qce),SH=(e,t)=>{const n=e.indexOf("safari-extension")!==-1,i=e.indexOf("safari-web-extension")!==-1;return n||i?[e.indexOf("@")!==-1?e.split("@")[0]:Uu,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},eg=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,QU=1024,ede="Breadcrumbs",tde=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:ede,setup(n){t.console&&UH(rde(n)),t.dom&&Mce(sde(n,t.dom)),t.xhr&&Oce(ode(n)),t.fetch&&uce(ade(n)),t.history&&IH(lde(n)),t.sentry&&n.on("beforeSendEvent",ide(n))}}},nde=tde;function ide(e){return function(n){zi()===e&&_u({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Zl(n)},{event:n})}}function sde(e,t){return function(i){if(zi()!==e)return;let s,r,o=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>QU&&(eg&&He.warn(`\`dom.maxStringLength\` cannot exceed ${QU}, but a value of ${a} was configured. Sentry will use ${QU} instead.`),a=QU),typeof o=="string"&&(o=[o]);try{const c=i.event,d=cde(c)?c.target:c;s=qz(d,{keyAttrs:o,maxStringLength:a}),r=Poe(d)}catch{s="<unknown>"}if(s.length===0)return;const l={category:`ui.${i.name}`,message:s};r&&(l.data={"ui.component_name":r}),_u(l,{event:i.event,name:i.name,global:i.global})}}function rde(e){return function(n){if(zi()!==e)return;const i={category:"console",data:{arguments:n.args,logger:"console"},level:bH(n.level),message:C6(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)i.message=`Assertion failed: ${C6(n.args.slice(1)," ")||"console.assert"}`,i.data.arguments=n.args.slice(1);else return;_u(i,{input:n.args,level:n.level})}}function ode(e){return function(n){if(zi()!==e)return;const{startTimestamp:i,endTimestamp:s}=n,r=n.xhr[K1];if(!i||!s||!r)return;const{method:o,url:a,status_code:l,body:c}=r,d={method:o,url:a,status_code:l},u={xhr:n.xhr,input:c,startTimestamp:i,endTimestamp:s},f=vH(l);_u({category:"xhr",data:d,type:"http",level:f},u)}}function ade(e){return function(n){if(zi()!==e)return;const{startTimestamp:i,endTimestamp:s}=n;if(!s||n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST")return;const r={method:n.fetchData.method,url:n.fetchData.url};if(n.error){const o={data:n.error,input:n.args,startTimestamp:i,endTimestamp:s};_u({category:"fetch",data:r,level:"error",type:"http"},o)}else{const o=n.response;r.request_body_size=n.fetchData.request_body_size,r.response_body_size=n.fetchData.response_body_size,r.status_code=o==null?void 0:o.status;const a={input:n.args,response:o,startTimestamp:i,endTimestamp:s},l=vH(r.status_code);_u({category:"fetch",data:r,type:"http",level:l},a)}}}function lde(e){return function(n){if(zi()!==e)return;let i=n.from,s=n.to;const r=j8(Fn.location.href);let o=i?j8(i):void 0;const a=j8(s);o!=null&&o.path||(o=r),r.protocol===a.protocol&&r.host===a.host&&(s=a.relative),r.protocol===o.protocol&&r.host===o.host&&(i=o.relative),_u({category:"navigation",data:{from:i,to:s}})}}function cde(e){return!!e&&!!e.target}const dde=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],ude="BrowserApiErrors",fde=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:ude,setupOnce(){t.setTimeout&&Js(Fn,"setTimeout",DM),t.setInterval&&Js(Fn,"setInterval",DM),t.requestAnimationFrame&&Js(Fn,"requestAnimationFrame",gde),t.XMLHttpRequest&&"XMLHttpRequest"in Fn&&Js(XMLHttpRequest.prototype,"send",mde);const n=t.eventTarget;n&&(Array.isArray(n)?n:dde).forEach(pde)}}},hde=fde;function DM(e){return function(...t){const n=t[0];return t[0]=Jh(n,{mechanism:{data:{function:Xc(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function gde(e){return function(t){return e.apply(this,[Jh(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Xc(e)},handled:!1,type:"instrument"}})])}}function mde(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&Js(n,s,function(r){const o={mechanism:{data:{function:s,handler:Xc(r)},handled:!1,type:"instrument"}},a=Sw(r);return a&&(o.mechanism.data.handler=Xc(a)),Jh(r,o)})}),e.apply(this,t)}}function pde(e){var i,s;const n=(i=Fn[e])==null?void 0:i.prototype;(s=n==null?void 0:n.hasOwnProperty)!=null&&s.call(n,"addEventListener")&&(Js(n,"addEventListener",function(r){return function(o,a,l){try{Ude(a)&&(a.handleEvent=Jh(a.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Xc(a),target:e},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[o,Jh(a,{mechanism:{data:{function:"addEventListener",handler:Xc(a),target:e},handled:!1,type:"instrument"}}),l])}}),Js(n,"removeEventListener",function(r){return function(o,a,l){try{const c=a.__sentry_wrapped__;c&&r.call(this,o,c,l)}catch{}return r.call(this,o,a,l)}}))}function Ude(e){return typeof e.handleEvent=="function"}const bde=()=>({name:"BrowserSession",setupOnce(){if(typeof Fn.document>"u"){eg&&He.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}yM({ignoreDuration:!0}),EM(),IH(({from:e,to:t})=>{e!==void 0&&e!==t&&(yM({ignoreDuration:!0}),EM())})}}),yde="GlobalHandlers",Ede=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:yde,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(_de(n),PM("onerror")),t.onunhandledrejection&&(wde(n),PM("onunhandledrejection"))}}},vde=Ede;function _de(e){Ioe(t=>{const{stackParser:n,attachStacktrace:i}=xH();if(zi()!==e||wH())return;const{msg:s,url:r,line:o,column:a,error:l}=t,c=Sde(Pw(n,l||s,void 0,i,!1),r,o,a);c.level="error",uH(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function wde(e){xoe(t=>{const{stackParser:n,attachStacktrace:i}=xH();if(zi()!==e||wH())return;const s=Tde(t),r=ww(s)?Ide(s):Pw(n,s,void 0,i,!0);r.level="error",uH(r,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Tde(e){if(ww(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}function Ide(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function Sde(e,t,n,i){const s=e.exception=e.exception||{},r=s.values=s.values||[],o=r[0]=r[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=i,d=n,u=il(t)&&t.length>0?t:Iw();return l.length===0&&l.push({colno:c,filename:u,function:Uu,in_app:!0,lineno:d}),e}function PM(e){eg&&He.log(`Global Handler attached: ${e}`)}function xH(){const e=zi();return(e==null?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const xde=()=>({name:"HttpContext",preprocessEvent(e){var o,a;if(!Fn.navigator&&!Fn.location&&!Fn.document)return;const t=((o=e.request)==null?void 0:o.url)||Iw(),{referrer:n}=Fn.document||{},{userAgent:i}=Fn.navigator||{},s={...(a=e.request)==null?void 0:a.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},r={...e.request,...t&&{url:t},headers:s};e.request=r}}),Cde="cause",Ade=5,Mde="LinkedErrors",kde=(e={})=>{const t=e.limit||Ade,n=e.key||Cde;return{name:Mde,preprocessEvent(i,s,r){const o=r.getOptions();Zle(Lw,o.stackParser,o.maxValueLength,n,t,i,s)}}},Rde=kde;function Lde(e){return[zle(),Nle(),hde(),nde(),vde(),Rde(),rce(),xde(),bde()]}function Dde(e={}){var n;return{...{defaultIntegrations:Lde(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(n=Fn.SENTRY_RELEASE)==null?void 0:n.id,sendClientReports:!0},...Pde(e)}}function Pde(e){const t={};for(const n of Object.getOwnPropertyNames(e)){const i=n;e[i]!==void 0&&(t[i]=e[i])}return t}function Nde(){var l;const e=typeof Fn.window<"u"&&Fn;if(!e)return!1;const t=e.chrome?"chrome":"browser",n=e[t],i=(l=n==null?void 0:n.runtime)==null?void 0:l.id,s=Iw()||"",r=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"],o=!!i&&Fn===Fn.top&&r.some(c=>s.startsWith(`${c}//`)),a=typeof e.nw<"u";return!!i&&!o&&!a}function Ode(e={}){const t=Dde(e);if(!t.skipBrowserExtensionCheck&&Nde()){eg&&kg(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}eg&&!_H()&&He.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");const n={...t,stackParser:woe(t.stackParser||Jce),integrations:fle(t),transport:t.transport||zce};return Ele(xce,n)}const Fde=100;function Bde(e){const n=Io().getScopeData().contexts.flags,i=n?n.values:[];return i.length&&(e.contexts===void 0&&(e.contexts={}),e.contexts.flags={values:[...i]}),e}function zde(e,t,n=Fde){const i=Io().getScopeData().contexts;i.flags||(i.flags={values:[]});const s=i.flags.values;Hde(s,e,t,n)}function Hde(e,t,n,i){if(typeof n!="boolean")return;if(e.length>i){eg&&He.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${i}`);return}const s=e.findIndex(r=>r.flag===t);s!==-1&&e.splice(s,1),e.length===i&&e.shift(),e.push({flag:t,result:n})}const Vde=()=>({name:"FeatureFlags",processEvent(e,t,n){return Bde(e)},addFeatureFlag(e,t){zde(e,t)}});function $de(){const e=Error.prepareStackTrace;try{let t=[];return Error.prepareStackTrace=(n,i)=>{const s=i.slice(1);return t=s,s},new Error().stack,t}finally{Error.prepareStackTrace=e}}var Gde={};const CH={"excalidraw.com":"production","staging.excalidraw.com":"staging","vercel.app":"staging"},Xde=Gde.VITE_APP_DISABLE_SENTRY==="true",W8=!Xde&&Object.keys(CH).find(e=>window.location.hostname.indexOf(e)>=0);Ode({dsn:W8?"https://7bfc596a5bf945eda6b660d3015a5460@sentry.io/5179260":void 0,environment:W8?CH[W8]:void 0,release:"",ignoreErrors:["undefined is not an object (evaluating 'window.__pad.performLoop')","InvalidStateError: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.",/(Failed to fetch|(fetch|loading) dynamically imported module)/i,/QuotaExceededError: (The quota has been exceeded|.*setItem.*Storage)/i,"Internal error opening backing store for indexedDB.open"],integrations:[tce({levels:["error"]}),Vde()],beforeSend(e){var t;return(t=e.request)!=null&&t.url&&(e.request.url=e.request.url.replace(/#.*$/,"")),e.exception||(e.exception={values:[{type:"ConsoleError",value:e.message??"Unknown error",stacktrace:{frames:$de().slice(1).filter(n=>{var i;return n.getFileName()&&!((i=n.getFileName())!=null&&i.includes("@sentry_browser.js"))}).map(n=>{var i;return{filename:n.getFileName()??void 0,function:n.getFunctionName()??void 0,in_app:!(((i=n.getFileName())==null?void 0:i.includes("node_modules"))??!1),lineno:n.getLineNumber()??void 0,colno:n.getColumnNumber()??void 0}})},mechanism:{type:"instrument",handled:!0,data:{function:"console.error",handler:"Sentry.beforeSend"}}}]}),e}});var AP;const NM=(AP=zi())==null?void 0:AP.getIntegrationByName("FeatureFlags");NM&&NM.addFeatureFlag("COMPLEX_BINDINGS",ki("COMPLEX_BINDINGS"));function AH(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=AH(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function le(){for(var e=0,t,n,i="";e<arguments.length;)(t=arguments[e++])&&(n=AH(t))&&(i&&(i+=" "),i+=n);return i}let MH=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const jde=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})};var pl={};let Yde=0;function Wt(e,t){const n=`atom${++Yde}`,i={toString(){return(pl?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?i.read=e:(i.init=e,i.read=Wde,i.write=Kde),i}function Wde(e){return e(this)}function Kde(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const OM=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,Q4=e=>"init"in e,K8=e=>!!e.write,R6=new WeakMap,J4=e=>{var t;return ev(e)&&!((t=R6.get(e))!=null&&t[1])},Zde=(e,t)=>{const n=R6.get(e);if(n)n[1]=!0,n[0].forEach(i=>i(t));else if((pl?"production":void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},qde=e=>{if(R6.has(e))return;const t=[new Set,!1];R6.set(e,t);const n=()=>{t[1]=!0};e.then(n,n),e.onCancel=i=>{t[0].add(i)}},ev=e=>typeof(e==null?void 0:e.then)=="function",FM=e=>"v"in e||"e"in e,JU=e=>{if("e"in e)throw e.e;if((pl?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},kH=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},BM=(e,t,n,i,s)=>{var r;if((pl?"production":void 0)!=="production"&&i===t)throw new Error("[Bug] atom cannot depend on itself");n.d.set(i,s.n),J4(n.v)&&kH(t,n.v,s),(r=s.m)==null||r.t.add(t),e&&Qde(e,i,t)},w1=()=>({D:new Map,H:new Set,M:new Set,L:new Set}),Pm=(e,t,n)=>{e[t].add(n)},zM=(e,t,n)=>{e.D.has(t)||(e.D.set(t,new Set),Pm(e,"M",()=>{var i;(i=n.m)==null||i.l.forEach(s=>Pm(e,"M",s))}))},Qde=(e,t,n)=>{const i=e.D.get(t);i&&i.add(n)},Jde=(e,t)=>e.D.get(t),vd=e=>{let t,n=!1;const i=s=>{try{s()}catch(r){n||(t=r,n=!0)}};for(;e.H.size||e.M.size||e.L.size;)e.D.clear(),e.H.forEach(i),e.H.clear(),e.M.forEach(i),e.M.clear(),e.L.forEach(i),e.L.clear();if(n)throw t},RH=(...[e,t,n,i])=>{const s=(b,y,v)=>{const _="v"in y,I=y.v,R=J4(y.v)?y.v:null;if(ev(v)){qde(v);for(const T of y.d.keys())kH(b,v,e(T));y.v=v}else y.v=v;delete y.e,delete y.x,(!_||!Object.is(I,y.v))&&(++y.n,R&&Zde(R,v))},r=(b,y)=>{var v;const _=e(y);if(FM(_)&&(_.m&&!_.x||Array.from(_.d).every(([x,k])=>r(b,x).n===k)))return _;_.d.clear();let I=!0;const R=x=>{if(OM(y,x)){const P=e(x);if(!FM(P))if(Q4(x))s(x,P,x.init);else throw new Error("no atom init");return JU(P)}const k=r(b,x);try{return JU(k)}finally{if(I)BM(b,y,_,x,k);else{const P=w1();BM(P,y,_,x,k),u(P,y,_),vd(P)}}};let T,w;const S={get signal(){return T||(T=new AbortController),T.signal},get setSelf(){return(pl?"production":void 0)!=="production"&&!K8(y)&&console.warn("setSelf function cannot be used with read-only atom"),!w&&K8(y)&&(w=(...x)=>{if((pl?"production":void 0)!=="production"&&I&&console.warn("setSelf function cannot be called in sync"),!I)return d(y,...x)}),w}};try{const x=t(y,R,S);if(s(y,_,x),ev(x)){(v=x.onCancel)==null||v.call(x,()=>T==null?void 0:T.abort());const k=()=>{if(_.m){const P=w1();u(P,y,_),vd(P)}};x.then(k,k)}return _}catch(x){return delete _.v,_.e=x,delete _.x,++_.n,_}finally{I=!1}},o=b=>JU(r(void 0,b)),a=(b,y,v)=>{var _,I;const R=new Map;for(const T of((_=v.m)==null?void 0:_.t)||[]){const w=e(T);w.m&&R.set(T,w)}for(const T of v.p)R.set(T,e(T));return(I=Jde(b,y))==null||I.forEach(T=>{R.set(T,e(T))}),R},l=(b,y,v)=>{const _=[],I=new Set,R=new Set,T=[[y,v]];for(;T.length>0;){const[w,S]=T[T.length-1];if(R.has(w)){T.pop();continue}if(I.has(w)){_.push([w,S,S.n]),R.add(w),S.x=!0,T.pop();continue}I.add(w);for(const[x,k]of a(b,w,S))w!==x&&!I.has(x)&&T.push([x,k])}Pm(b,"H",()=>{const w=new Set([y]);for(let S=_.length-1;S>=0;--S){const[x,k,P]=_[S];let D=!1;for(const j of k.d.keys())if(j!==x&&w.has(j)){D=!0;break}D&&(r(b,x),u(b,x,k),P!==k.n&&(zM(b,x,k),w.add(x))),delete k.x}})},c=(b,y,...v)=>{let _=!0;const I=T=>JU(r(b,T)),R=(T,...w)=>{const S=e(T);try{if(OM(y,T)){if(!Q4(T))throw new Error("atom not writable");const x=S.n,k=w[0];s(T,S,k),u(b,T,S),x!==S.n&&(zM(b,T,S),l(b,T,S));return}else return c(b,T,...w)}finally{_||vd(b)}};try{return n(y,I,R,...v)}finally{_=!1}},d=(b,...y)=>{const v=w1();try{return c(v,b,...y)}finally{vd(v)}},u=(b,y,v)=>{if(v.m&&!J4(v.v)){for(const _ of v.d.keys())v.m.d.has(_)||(f(b,_,e(_)).t.add(y),v.m.d.add(_));for(const _ of v.m.d||[])if(!v.d.has(_)){v.m.d.delete(_);const I=h(b,_,e(_));I==null||I.t.delete(y)}}},f=(b,y,v)=>{if(!v.m){r(b,y);for(const _ of v.d.keys())f(b,_,e(_)).t.add(y);if(v.m={l:new Set,d:new Set(v.d.keys()),t:new Set},K8(y)){const _=v.m;let I;const R=(T,w)=>{let S=!0;I=(...x)=>{try{return c(T,y,...x)}finally{S||vd(T)}};try{return w()}finally{S=!1}};Pm(b,"L",()=>{const T=R(b,()=>i(y,(...w)=>I(...w)));T&&(_.u=w=>R(w,T))})}}return v.m},h=(b,y,v)=>{if(v.m&&!v.m.l.size&&!Array.from(v.m.t).some(_=>{var I;return(I=e(_).m)==null?void 0:I.d.has(y)})){const _=v.m.u;_&&Pm(b,"L",()=>_(b)),delete v.m;for(const I of v.d.keys()){const R=h(b,I,e(I));R==null||R.t.delete(y)}return}return v.m};return{get:o,set:d,sub:(b,y)=>{const v=w1(),_=e(b),R=f(v,b,_).l;return R.add(y),vd(v),()=>{R.delete(y);const T=w1();h(T,b,_),vd(T)}},unstable_derive:b=>RH(...b(e,t,n,i))}},eue=e=>{const t=new WeakMap,n=new Set;let i,s=0;const r=e.unstable_derive((l,c,d,u)=>(i=l,[f=>{let h=t.get(f);if(!h){const m=l(f);h=new Proxy(m,{set(p,U,b){return U==="m"&&n.add(f),Reflect.set(p,U,b)},deleteProperty(p,U){return U==="m"&&n.delete(f),Reflect.deleteProperty(p,U)}}),t.set(f,h)}return h},c,(f,h,m,...p)=>s?m(f,...p):d(f,h,m,...p),u])),o=r.set;return Object.assign(r,{dev4_get_internal_weak_map:()=>({get:l=>{const c=i(l);if(c.n!==0)return c}}),dev4_get_mounted_atoms:()=>n,dev4_restore_atoms:l=>{o({read:()=>null,write:(d,u)=>{++s;try{for(const[f,h]of l)Q4(f)&&u(f,h)}finally{--s}}})}})},zp=()=>{const e=new WeakMap,n=RH(i=>{if((pl?"production":void 0)!=="production"&&!i)throw new Error("Atom is undefined or null");let s=e.get(i);return s||(s={d:new Map,p:new Set,n:0},e.set(i,s)),s},(i,...s)=>i.read(...s),(i,...s)=>i.write(...s),(i,...s)=>{var r;return(r=i.onMount)==null?void 0:r.call(i,...s)});return(pl?"production":void 0)!=="production"?eue(n):n};let T1;const tue=()=>(T1||(T1=zp(),(pl?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=T1),globalThis.__JOTAI_DEFAULT_STORE__!==T1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),T1);var LH={};const DH=L.createContext(void 0),my=e=>{const t=L.useContext(DH);return(e==null?void 0:e.store)||t||tue()},nue=({children:e,store:t})=>{const n=L.useRef(void 0);return!t&&!n.current&&(n.current=zp()),L.createElement(DH.Provider,{value:t||n.current},e)},tv=e=>typeof(e==null?void 0:e.then)=="function",PH=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},iue=de.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(PH(e),e)}),Z8=new WeakMap,HM=e=>{let t=Z8.get(e);return t||(t=new Promise((n,i)=>{let s=e;const r=l=>c=>{s===l&&n(c)},o=l=>c=>{s===l&&i(c)},a=l=>{"onCancel"in l&&typeof l.onCancel=="function"&&l.onCancel(c=>{if((LH?"production":void 0)!=="production"&&c===l)throw new Error("[Bug] p is not updated even after cancelation");tv(c)?(Z8.set(c,t),s=c,c.then(r(c),o(c)),a(c)):n(c)})};e.then(r(e),o(e)),a(e)}),Z8.set(e,t)),t};function yh(e,t){const n=my(t),[[i,s,r],o]=L.useReducer(c=>{const d=n.get(e);return Object.is(c[0],d)&&c[1]===n&&c[2]===e?c:[d,n,e]},void 0,()=>[n.get(e),n,e]);let a=i;(s!==n||r!==e)&&(o(),a=n.get(e));const l=t==null?void 0:t.delay;if(L.useEffect(()=>{const c=n.sub(e,()=>{if(typeof l=="number"){const d=n.get(e);tv(d)&&PH(HM(d)),setTimeout(o,l);return}o()});return o(),c},[n,e,l]),L.useDebugValue(a),tv(a)){const c=HM(a);return iue(c)}return a}function Nw(e,t){const n=my(t);return L.useCallback((...s)=>{if((LH?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...s)},[n,e])}function tg(e,t){return[yh(e,t),Nw(e,t)]}const VM=new WeakMap;function sue(e,t){const n=my(t),i=rue(n);for(const[s,r]of e)(!i.has(s)||t!=null&&t.dangerouslyForceHydrate)&&(i.add(s),n.set(s,r))}const rue=e=>{let t=VM.get(e);return t||(t=new WeakSet,VM.set(e,t)),t};function eh(){return eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},eh.apply(this,arguments)}function NH(){const e=L.createContext(null);function t({store:o,initialValues:a=[],children:l}){const c=L.useRef(o);return c.current||(c.current=zp()),sue(a,{store:c.current}),g(e.Provider,{value:c.current,children:l})}const n=o=>{const a=L.useContext(e);if(!a)throw new Error("Missing Provider from createIsolation");return my(eh({store:a},o))};return{Provider:t,useStore:n,useAtom:(o,a)=>{const l=n();return tg(o,eh({store:l},a))},useAtomValue:(o,a)=>{const l=n();return yh(o,eh({store:l},a))},useSetAtom:(o,a)=>{const l=n();return Nw(o,eh({store:l},a))}}}const{read:tAe,write:nAe}=Wt(null);L.createContext({scope:void 0,baseStore:void 0});const OH=NH(),{useAtom:gn,useSetAtom:py,useAtomValue:FH,useStore:iAe}=OH,oue=OH.Provider,Zs=zp(),BH={paste:"Paste",pasteAsPlaintext:"Paste as plaintext",pasteCharts:"Paste charts",selectAll:"Select all",multiSelect:"Add element to selection",moveCanvas:"Move canvas",cut:"Cut",copy:"Copy",copyAsPng:"Copy to clipboard as PNG",copyAsSvg:"Copy to clipboard as SVG",copyText:"Copy to clipboard as text",copySource:"Copy source to clipboard",convertToCode:"Convert to code",bringForward:"Bring forward",sendToBack:"Send to back",bringToFront:"Bring to front",sendBackward:"Send backward",delete:"Delete",copyStyles:"Copy styles",pasteStyles:"Paste styles",stroke:"Stroke",changeStroke:"Change stroke color",background:"Background",changeBackground:"Change background color",fill:"Fill",strokeWidth:"Stroke width",strokeStyle:"Stroke style",strokeStyle_solid:"Solid",strokeStyle_dashed:"Dashed",strokeStyle_dotted:"Dotted",sloppiness:"Sloppiness",opacity:"Opacity",textAlign:"Text align",edges:"Edges",sharp:"Sharp",round:"Round",arrowheads:"Arrowheads",arrowhead_none:"None",arrowhead_arrow:"Arrow",arrowhead_bar:"Bar",arrowhead_circle:"Circle",arrowhead_circle_outline:"Circle (outline)",arrowhead_triangle:"Triangle",arrowhead_triangle_outline:"Triangle (outline)",arrowhead_diamond:"Diamond",arrowhead_diamond_outline:"Diamond (outline)",arrowhead_crowfoot_many:"Crow's foot (many)",arrowhead_crowfoot_one:"Crow's foot (one)",arrowhead_crowfoot_one_or_many:"Crow's foot (one or many)",more_options:"More options",arrowtypes:"Arrow type",arrowtype_sharp:"Sharp arrow",arrowtype_round:"Curved arrow",arrowtype_elbowed:"Elbow arrow",fontSize:"Font size",fontFamily:"Font family",addWatermark:'Add "Made with Excalidraw"',handDrawn:"Hand-drawn",normal:"Normal",code:"Code",small:"Small",medium:"Medium",large:"Large",veryLarge:"Very large",solid:"Solid",hachure:"Hachure",zigzag:"Zigzag",crossHatch:"Cross-hatch",thin:"Thin",bold:"Bold",left:"Left",center:"Center",right:"Right",extraBold:"Extra bold",architect:"Architect",artist:"Artist",cartoonist:"Cartoonist",fileTitle:"File name",colorPicker:"Color picker",canvasColors:"Used on canvas",canvasBackground:"Canvas background",drawingCanvas:"Drawing canvas",clearCanvas:"Clear canvas",layers:"Layers",actions:"Actions",language:"Language",liveCollaboration:"Live collaboration...",duplicateSelection:"Duplicate",untitled:"Untitled",name:"Name",yourName:"Your name",madeWithExcalidraw:"Made with Excalidraw",group:"Group selection",ungroup:"Ungroup selection",collaborators:"Collaborators",toggleGrid:"Toggle grid",addToLibrary:"Add to library",removeFromLibrary:"Remove from library",libraryLoadingMessage:"Loading library",libraries:"Browse libraries",loadingScene:"Loading scene",loadScene:"Load scene from file",align:"Align",alignTop:"Align top",alignBottom:"Align bottom",alignLeft:"Align left",alignRight:"Align right",centerVertically:"Center vertically",centerHorizontally:"Center horizontally",distributeHorizontally:"Distribute horizontally",distributeVertically:"Distribute vertically",flipHorizontal:"Flip horizontal",flipVertical:"Flip vertical",viewMode:"View mode",share:"Share",showStroke:"Show stroke color picker",showBackground:"Show background color picker",showFonts:"Show font picker",toggleTheme:"Toggle light/dark theme",theme:"Theme",personalLib:"Personal Library",excalidrawLib:"Excalidraw Library",decreaseFontSize:"Decrease font size",increaseFontSize:"Increase font size",unbindText:"Unbind text",bindText:"Bind text to the container",createContainerFromText:"Wrap text in a container",link:{edit:"Edit link",editEmbed:"Edit embeddable link",create:"Add link",label:"Link",labelEmbed:"Link & embed",empty:"No link is set",hint:"Type or paste your link here",goToElement:"Go to target element"},lineEditor:{edit:"Edit line",editArrow:"Edit arrow"},polygon:{breakPolygon:"Break polygon",convertToPolygon:"Convert to polygon"},elementLock:{lock:"Lock",unlock:"Unlock",lockAll:"Lock all",unlockAll:"Unlock all"},statusPublished:"Published",sidebarLock:"Keep sidebar open",selectAllElementsInFrame:"Select all elements in frame",removeAllElementsFromFrame:"Remove all elements from frame",eyeDropper:"Pick color from canvas",textToDiagram:"Text to diagram",prompt:"Prompt",followUs:"Follow us",discordChat:"Discord chat",zoomToFitViewport:"Zoom to fit in viewport",zoomToFitSelection:"Zoom to fit selection",zoomToFit:"Zoom to fit all elements",installPWA:"Install Excalidraw locally (PWA)",autoResize:"Enable text auto-resizing",imageCropping:"Image cropping",unCroppedDimension:"Uncropped dimension",copyElementLink:"Copy link to object",linkToElement:"Link to object",wrapSelectionInFrame:"Wrap selection in frame",tab:"Tab",shapeSwitch:"Switch shape"},zH={title:"Link to object",desc:"Click on a shape on canvas or paste a link.",notFound:"Linked object wasn't found on canvas."},HH={noItems:"No items added yet...",hint_emptyLibrary:"Select an item on canvas to add it here, or install a library from the public repository, below.",hint_emptyPrivateLibrary:"Select an item on canvas to add it here.",search:{inputPlaceholder:"Search library",heading:"Library matches",noResults:"No matching items found...",clearSearch:"Clear search"}},VH={title:"Find on canvas",noMatch:"No matches found...",singleResult:"result",multipleResults:"results",placeholder:"Find text on canvas...",frames:"Frames",texts:"Texts"},$H={clearReset:"Reset the canvas",exportJSON:"Export to file",exportImage:"Export image...",export:"Save to...",copyToClipboard:"Copy to clipboard",copyLink:"Copy link",save:"Save to current file",saveAs:"Save as",load:"Open",getShareableLink:"Get shareable link",close:"Close",selectLanguage:"Select language",scrollBackToContent:"Scroll back to content",zoomIn:"Zoom in",zoomOut:"Zoom out",resetZoom:"Reset zoom",menu:"Menu",done:"Done",edit:"Edit",undo:"Undo",redo:"Redo",resetLibrary:"Reset library",createNewRoom:"Create new room",fullScreen:"Full screen",darkMode:"Dark mode",lightMode:"Light mode",systemMode:"System mode",zenMode:"Zen mode",objectsSnapMode:"Snap to objects",exitZenMode:"Exit zen mode",cancel:"Cancel",saveLibNames:"Save name(s) and exit",clear:"Clear",remove:"Remove",embed:"Toggle embedding",publishLibrary:"Rename or publish",submit:"Submit",confirm:"Confirm",embeddableInteractionButton:"Click to interact"},GH={clearReset:"This will clear the whole canvas. Are you sure?",couldNotCreateShareableLink:"Couldn't create shareable link.",couldNotCreateShareableLinkTooBig:"Couldn't create shareable link: the scene is too big",couldNotLoadInvalidFile:"Couldn't load invalid file",importBackendFailed:"Importing from backend failed.",cannotExportEmptyCanvas:"Cannot export empty canvas.",couldNotCopyToClipboard:"Couldn't copy to clipboard.",decryptFailed:"Couldn't decrypt data.",uploadedSecurly:"The upload has been secured with end-to-end encryption, which means that Excalidraw server and third parties can't read the content.",loadSceneOverridePrompt:"Loading external drawing will replace your existing content. Do you wish to continue?",collabStopOverridePrompt:`Stopping the session will overwrite your previous, locally stored drawing. Are you sure?

(If you want to keep your local drawing, simply close the browser tab instead.)`,errorAddingToLibrary:"Couldn't add item to the library",errorRemovingFromLibrary:"Couldn't remove item from the library",confirmAddLibrary:"This will add {{numShapes}} shape(s) to your library. Are you sure?",imageDoesNotContainScene:"This image does not seem to contain any scene data. Have you enabled scene embedding during export?",cannotRestoreFromImage:"Scene couldn't be restored from this image file",invalidSceneUrl:"Couldn't import scene from the supplied URL. It's either malformed, or doesn't contain valid Excalidraw JSON data.",resetLibrary:"This will clear your library. Are you sure?",removeItemsFromsLibrary:"Delete {{count}} item(s) from library?",invalidEncryptionKey:"Encryption key must be of 22 characters. Live collaboration is disabled.",collabOfflineWarning:`No internet connection available.
Your changes will not be saved!`,localStorageQuotaExceeded:"Browser storage quota exceeded. Changes will not be saved."},XH={unsupportedFileType:"Unsupported file type.",imageInsertError:"Couldn't insert image. Try again later...",fileTooBig:"File is too big. Maximum allowed size is {{maxSize}}.",svgImageInsertError:"Couldn't insert SVG image. The SVG markup looks invalid.",failedToFetchImage:"Failed to fetch image.",cannotResolveCollabServer:"Couldn't connect to the collab server. Please reload the page and try again.",importLibraryError:"Couldn't load library",saveLibraryError:"Couldn't save library to storage. Please save your library to a file locally to make sure you don't lose changes.",collabSaveFailed:"Couldn't save to the backend database. If problems persist, you should save your file locally to ensure you don't lose your work.",collabSaveFailed_sizeExceeded:"Couldn't save to the backend database, the canvas seems to be too big. You should save the file locally to ensure you don't lose your work.",imageToolNotSupported:"Images are disabled.",brave_measure_text_error:{line1:"Looks like you are using Brave browser with the <bold>Aggressively Block Fingerprinting</bold> setting enabled.",line2:"This could result in breaking the <bold>Text Elements</bold> in your drawings.",line3:"We strongly recommend disabling this setting. You can follow <link>these steps</link> on how to do so.",line4:"If disabling this setting doesn't fix the display of text elements, please open an <issueLink>issue</issueLink> on our GitHub, or write us on <discordLink>Discord</discordLink>"},libraryElementTypeError:{embeddable:"Embeddable elements cannot be added to the library.",iframe:"IFrame elements cannot be added to the library.",image:"Support for adding images to the library coming soon!"},asyncPasteFailedOnRead:"Couldn't paste (couldn't read from system clipboard).",asyncPasteFailedOnParse:"Couldn't paste.",copyToSystemClipboardFailed:"Couldn't copy to clipboard."},jH={selection:"Selection",lasso:"Lasso selection",image:"Insert image",rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Draw",text:"Text",library:"Library",lock:"Keep selected tool active after drawing",penMode:"Pen mode - prevent touch",link:"Add / Update link for a selected shape",eraser:"Eraser",frame:"Frame tool",magicframe:"Wireframe to code",embeddable:"Web Embed",laser:"Laser pointer",hand:"Hand (panning tool)",extraTools:"More tools",mermaidToExcalidraw:"Mermaid to Excalidraw",convertElementType:"Toggle shape type"},YH={rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Freedraw",text:"Text",image:"Image",group:"Group",frame:"Frame",magicframe:"Wireframe to code",embeddable:"Web Embed",selection:"Selection",iframe:"IFrame"},WH={canvasActions:"Canvas actions",selectedShapeActions:"Selected shape actions",shapes:"Shapes"},KH={dismissSearch:"{{shortcut}} to dismiss search",canvasPanning:"To move canvas, hold {{shortcut_1}} or {{shortcut_2}} while dragging, or use the hand tool",linearElement:"Click to start multiple points, drag for single line",arrowTool:"Click to start multiple points, drag for single line. Press {{shortcut}} again to change arrow type.",arrowBindModifiers:"Hold {{shortcut_1}} to disable binding, or {{shortcut_2}} to bind at a fixed point",freeDraw:"Click and drag, release when you're finished",text:"Tip: you can also add text by double-clicking anywhere with the selection tool",embeddable:"Click-drag to create a website embed",text_selected:"Double-click or press {{shortcut}} to edit text",text_editing:"Press {{shortcut_1}} or {{shortcut_2}} to finish editing",linearElementMulti:"Click on last point or press {{shortcut_1}} or {{shortcut_2}} to finish",lockAngle:"You can constrain angle by holding {{shortcut}}",resize:`You can constrain proportions by holding {{shortcut_1}} while resizing,
hold {{shortcut_2}} to resize from the center`,resizeImage:`You can resize freely by holding {{shortcut_1}},
hold {{shortcut_2}} to resize from the center`,rotate:"You can constrain angles by holding {{shortcut}} while rotating",lineEditor_info:"Hold {{shortcut_1}} and Double-click or press {{shortcut_2}} to edit points",lineEditor_line_info:"Double-click or press {{shortcut}} to edit points",lineEditor_pointSelected:`Press {{shortcut_1}} to remove point(s),
{{shortcut_2}} to duplicate, or drag to move`,lineEditor_nothingSelected:`Select a point to edit (hold {{shortcut_1}} to select multiple),
or hold {{shortcut_2}} and click to add new points`,publishLibrary:"Publish your own library",bindTextToElement:"{{shortcut}} to add text",createFlowchart:"{{shortcut}} to create a flowchart",deepBoxSelect:"Hold {{shortcut}} to deep select, and to prevent dragging",eraserRevert:"Hold {{shortcut}} to revert the elements marked for deletion",firefox_clipboard_write:'This feature can likely be enabled by setting the "dom.events.asyncClipboard.clipboardItem" flag to "true". To change the browser flags in Firefox, visit the "about:config" page.',disableSnapping:"Hold {{shortcut}} to disable snapping",enterCropEditor:"Double click the image or press {{shortcut}} to crop the image",leaveCropEditor:"Click outside the image or press {{shortcut_1}} or {{shortcut_2}} to finish cropping"},ZH={cannotShowPreview:"Cannot show preview",canvasTooBig:"The canvas may be too big.",canvasTooBigTip:"Tip: try moving the farthest elements a bit closer together."},qH={headingMain:"Encountered an error. Try <button>reloading the page</button>.",clearCanvasMessage:"If reloading doesn't work, try <button>clearing the canvas</button>.",clearCanvasCaveat:" This will result in loss of work ",trackedToSentry:"The error with identifier {{eventId}} was tracked on our system.",openIssueMessage:"We were very cautious not to include your scene information on the error. If your scene is not private, please consider following up on our <button>bug tracker</button>. Please include information below by copying and pasting into the GitHub issue.",sceneContent:"Scene content:"},QH={or:"Or"},JH={desc_intro:"Invite people to collaborate on your drawing.",desc_privacy:"Don't worry, the session is end-to-end encrypted, and fully private. Not even our server can see what you draw.",button_startSession:"Start session",button_stopSession:"Stop session",desc_inProgressIntro:"Live-collaboration session is now in progress.",desc_shareLink:"Share this link with anyone you want to collaborate with:",desc_exitSession:"Stopping the session will disconnect you from the room, but you'll be able to continue working with the scene, locally. Note that this won't affect other people, and they'll still be able to collaborate on their version.",shareTitle:"Join a live collaboration session on Excalidraw"},eV={title:"Error"},tV={disk_title:"Save to disk",disk_details:"Export the scene data to a file from which you can import later.",disk_button:"Save to file",link_title:"Shareable link",link_details:"Export as a read-only link.",link_button:"Export to Link",excalidrawplus_description:"Save the scene to your Excalidraw+ workspace.",excalidrawplus_button:"Export",excalidrawplus_exportError:"Couldn't export to Excalidraw+ at this moment..."},nV={blog:"Read our blog",click:"click",deepSelect:"Deep select",deepBoxSelect:"Deep select within box, and prevent dragging",createFlowchart:"Create a flowchart from a generic element",navigateFlowchart:"Navigate a flowchart",curvedArrow:"Curved arrow",curvedLine:"Curved line",documentation:"Documentation",doubleClick:"double-click",drag:"drag",editor:"Editor",editLineArrowPoints:"Edit line/arrow points",editText:"Edit text / add label",github:"Found an issue? Submit",howto:"Follow our guides",or:"or",preventBinding:"Prevent arrow binding",tools:"Tools",shortcuts:"Keyboard shortcuts",textFinish:"Finish editing (text editor)",textNewLine:"Add new line (text editor)",title:"Help",view:"View",zoomToFit:"Zoom to fit all elements",zoomToSelection:"Zoom to selection",toggleElementLock:"Lock/unlock selection",movePageUpDown:"Move page up/down",movePageLeftRight:"Move page left/right",cropStart:"Crop image",cropFinish:"Finish image cropping"},iV={title:"Clear canvas"},sV={title:"Publish library",itemName:"Item name",authorName:"Author name",githubUsername:"GitHub username",twitterUsername:"Twitter username",libraryName:"Library name",libraryDesc:"Library description",website:"Website",placeholder:{authorName:"Your name or username",libraryName:"Name of your library",libraryDesc:"Description of your library to help people understand its usage",githubHandle:"GitHub handle (optional), so you can edit the library once submitted for review",twitterHandle:"Twitter username (optional), so we know who to credit when promoting over Twitter",website:"Link to your personal website or elsewhere (optional)"},errors:{required:"Required",website:"Enter a valid URL"},noteDescription:"Submit your library to be included in the <link>public library repository</link> for other people to use in their drawings.",noteGuidelines:"The library needs to be manually approved first. Please read the <link>guidelines</link> before submitting. You will need a GitHub account to communicate and make changes if requested, but it is not strictly required.",noteLicense:"By submitting, you agree the library will be published under the <link>MIT License</link>, which in short means anyone can use them without restrictions.",noteItems:"Each library item must have its own name so it's filterable. The following library items will be included:",atleastOneLibItem:"Please select at least one library item to get started",republishWarning:"Note: some of the selected items are marked as already published/submitted. You should only resubmit items when updating an existing library or submission."},rV={title:"Library submitted",content:"Thank you {{authorName}}. Your library has been submitted for review. You can track the status <link>here</link>"},oV={resetLibrary:"Reset library",removeItemsFromLib:"Remove selected items from library"},aV={header:"Export image",label:{withBackground:"Background",onlySelected:"Only selected",darkMode:"Dark mode",embedScene:"Embed scene",scale:"Scale",padding:"Padding"},tooltip:{embedScene:`Scene data will be saved into the exported PNG/SVG file so that the scene can be restored from it.
Will increase exported file size.`},title:{exportToPng:"Export to PNG",exportToSvg:"Export to SVG",copyPngToClipboard:"Copy PNG to clipboard"},button:{exportToPng:"PNG",exportToSvg:"SVG",copyPngToClipboard:"Copy to clipboard"}},lV={tooltip:"Your drawings are end-to-end encrypted so Excalidraw's servers will never see them.",link:"Blog post on end-to-end encryption in Excalidraw"},cV={angle:"Angle",shapes:"Shapes",height:"Height",scene:"Scene",selected:"Selected",storage:"Storage",fullTitle:"Canvas & Shape properties",title:"Properties",generalStats:"General",elementProperties:"Shape properties",total:"Total",version:"Version",versionCopy:"Click to copy",versionNotAvailable:"Version not available",width:"Width"},dV={addedToLibrary:"Added to library",copyStyles:"Copied styles.",copyToClipboard:"Copied to clipboard.",copyToClipboardAsPng:`Copied {{exportSelection}} to clipboard as PNG
({{exportColorScheme}})`,copyToClipboardAsSvg:`Copied {{exportSelection}} to clipboard as SVG
({{exportColorScheme}})`,fileSaved:"File saved.",fileSavedToFilename:"Saved to {filename}",canvas:"canvas",selection:"selection",pasteAsSingleElement:`Use {{shortcut}} to paste as a single element,
or paste into an existing text editor`,unableToEmbed:"Embedding this url is currently not allowed. Raise an issue on GitHub to request the url whitelisted",unrecognizedLinkFormat:"The link you embedded does not match the expected format. Please try to paste the 'embed' string provided by the source site",elementLinkCopied:"Link copied to clipboard"},uV={transparent:"Transparent",black:"Black",white:"White",red:"Red",pink:"Pink",grape:"Grape",violet:"Violet",gray:"Gray",blue:"Blue",cyan:"Cyan",teal:"Teal",green:"Green",yellow:"Yellow",orange:"Orange",bronze:"Bronze"},fV={app:{center_heading:"All your data is saved locally in your browser.",center_heading_plus:"Did you want to go to the Excalidraw+ instead?",menuHint:"Export, preferences, languages, ..."},defaults:{menuHint:"Export, preferences, and more...",center_heading:"Diagrams. Made. Simple.",toolbarHint:"Pick a tool & Start drawing!",helpHint:"Shortcuts & help"}},hV={color:"Color",mostUsedCustomColors:"Most used custom colors",colors:"Colors",shades:"Shades",hexCode:"Hex code",noShades:"No shades available for this color"},gV={action:{exportToImage:{title:"Export as image",button:"Export as image",description:"Export the scene data as an image from which you can import later."},saveToDisk:{title:"Save to disk",button:"Save to disk",description:"Export the scene data to a file from which you can import later."},excalidrawPlus:{title:"Excalidraw+",button:"Export to Excalidraw+",description:"Save the scene to your Excalidraw+ workspace."}},modal:{loadFromFile:{title:"Load from file",button:"Load from file",description:"Loading from a file will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first using one of the options below."},shareableLink:{title:"Load from link",button:"Replace my content",description:"Loading external drawing will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first by using one of the options below."}}},mV={title:"Mermaid to Excalidraw",button:"Insert",description:"Currently only <flowchartLink>Flowchart</flowchartLink>,<sequenceLink> Sequence, </sequenceLink> and <classLink>Class </classLink>Diagrams are supported. The other types will be rendered as image in Excalidraw.",syntax:"Mermaid Syntax",preview:"Preview"},pV={placeholder:"Quick search"},UV={badge:{old:"old"},sceneFonts:"In this scene",availableFonts:"Available fonts",empty:"No fonts found"},bV={empty:"No users found",hint:{text:"Click on user to follow",followStatus:"You're currently following this user",inCall:"User is in a voice call",micMuted:"User's microphone is muted",isSpeaking:"User is speaking"}},yV={title:"Command palette",shortcuts:{select:"Select",confirm:"Confirm",close:"Close"},recents:"Recently used",search:{placeholder:"Search menus, commands, and discover hidden gems",noMatch:"No matching commands..."},itemNotAvailable:"Command is not available...",shortcutHint:"For Command palette, use {{shortcut}}"},EV={ctrl:"Ctrl",option:"Option",cmd:"Cmd",alt:"Alt",escape:"Esc",enter:"Enter",shift:"Shift",spacebar:"Space",delete:"Delete",mmb:"Scroll wheel"},Ow={labels:BH,elementLink:zH,library:HH,search:VH,buttons:$H,alerts:GH,errors:XH,toolBar:jH,element:YH,headings:WH,hints:KH,canvasError:ZH,errorSplash:qH,shareDialog:QH,roomDialog:JH,errorDialog:eV,exportDialog:tV,helpDialog:nV,clearCanvasDialog:iV,publishDialog:sV,publishSuccessDialog:rV,confirmDialog:oV,imageExportDialog:aV,encrypted:lV,stats:cV,toast:dV,colors:uV,welcomeScreen:fV,colorPicker:hV,overwriteConfirm:gV,mermaid:mV,quickSearch:pV,fontList:UV,userList:bV,commandPalette:yV,keys:EV},aue=Object.freeze(Object.defineProperty({__proto__:null,alerts:GH,buttons:$H,canvasError:ZH,clearCanvasDialog:iV,colorPicker:hV,colors:uV,commandPalette:yV,confirmDialog:oV,default:Ow,element:YH,elementLink:zH,encrypted:lV,errorDialog:eV,errorSplash:qH,errors:XH,exportDialog:tV,fontList:UV,headings:WH,helpDialog:nV,hints:KH,imageExportDialog:aV,keys:EV,labels:BH,library:HH,mermaid:mV,overwriteConfirm:gV,publishDialog:sV,publishSuccessDialog:rV,quickSearch:pV,roomDialog:JH,search:VH,shareDialog:QH,stats:cV,toast:dV,toolBar:jH,userList:bV,welcomeScreen:fV},Symbol.toStringTag,{value:"Module"})),vV=100,_V=23,wV={"ar-SA":91,"az-AZ":27,"bg-BG":70,"bn-BD":42,"bn-IN":42,"ca-ES":91,"cs-CZ":82,"da-DK":30,"de-CH":91,"de-DE":91,"el-GR":86,en:vV,"es-ES":91,"eu-ES":78,"fa-IR":91,"fi-FI":67,"fr-FR":99,"gl-ES":67,"he-IL":91,"hi-IN":91,"hu-HU":53,"id-ID":90,"it-IT":99,"ja-JP":87,kaa:_V,"kab-KAB":60,"kk-KZ":14,"km-KH":60,"ko-KR":80,"ku-TR":64,"lt-LT":37,"lv-LV":56,"mr-IN":91,"my-MM":27,"nb-NO":91,"nl-NL":58,"nn-NO":48,"oc-FR":84,"pa-IN":58,"pl-PL":99,"pt-BR":90,"pt-PT":91,"ro-RO":100,"ru-RU":99,"si-LK":75,"sk-SK":91,"sl-SI":91,"sv-SE":91,"ta-IN":86,"th-TH":63,"tr-TR":94,"uk-UA":90,"uz-UZ":0,"vi-VN":75,"zh-CN":99,"zh-HK":17,"zh-TW":91},lue=Object.freeze(Object.defineProperty({__proto__:null,default:wV,en:vV,kaa:_V},Symbol.toStringTag,{value:"Module"})),cue=85,Yu={code:"en",label:"English"},Uy=[Yu,...[{code:"ar-SA",label:"",rtl:!0},{code:"bg-BG",label:""},{code:"ca-ES",label:"Catal"},{code:"cs-CZ",label:"esky"},{code:"de-DE",label:"Deutsch"},{code:"el-GR",label:""},{code:"es-ES",label:"Espaol"},{code:"eu-ES",label:"Euskara"},{code:"fa-IR",label:"",rtl:!0},{code:"fi-FI",label:"Suomi"},{code:"fr-FR",label:"Franais"},{code:"gl-ES",label:"Galego"},{code:"he-IL",label:"",rtl:!0},{code:"hi-IN",label:""},{code:"hu-HU",label:"Magyar"},{code:"id-ID",label:"Bahasa Indonesia"},{code:"it-IT",label:"Italiano"},{code:"ja-JP",label:""},{code:"kab-KAB",label:"Taqbaylit"},{code:"kk-KZ",label:" "},{code:"ko-KR",label:""},{code:"ku-TR",label:"Kurd"},{code:"lt-LT",label:"Lietuvi"},{code:"lv-LV",label:"Latvieu"},{code:"my-MM",label:"Burmese"},{code:"nb-NO",label:"Norsk bokml"},{code:"nl-NL",label:"Nederlands"},{code:"nn-NO",label:"Norsk nynorsk"},{code:"oc-FR",label:"Occitan"},{code:"pa-IN",label:""},{code:"pl-PL",label:"Polski"},{code:"pt-BR",label:"Portugus Brasileiro"},{code:"pt-PT",label:"Portugus"},{code:"ro-RO",label:"Romn"},{code:"ru-RU",label:""},{code:"sk-SK",label:"Slovenina"},{code:"sv-SE",label:"Svenska"},{code:"sl-SI",label:"Slovenina"},{code:"tr-TR",label:"Trke"},{code:"uk-UA",label:""},{code:"zh-CN",label:""},{code:"zh-TW",label:""},{code:"vi-VN",label:"Ting Vit"},{code:"mr-IN",label:""}].filter(e=>wV[e.code]>=cue).sort((e,t)=>e.label>t.label?1:-1)],TV="__test__";let th=Yu,Z2={};const IV=async e=>{if(th=e,document.documentElement.dir=th.rtl?"rtl":"ltr",document.documentElement.lang=th.code,e.code.startsWith(TV))Z2={};else try{Z2=await jde(Object.assign({"./locales/ar-SA.json":()=>pe(()=>import("./locales/ar-SA.json-KHs7L0LD.js"),__vite__mapDeps([])),"./locales/az-AZ.json":()=>pe(()=>import("./locales/az-AZ.json-53lhA0-8.js"),__vite__mapDeps([])),"./locales/bg-BG.json":()=>pe(()=>import("./locales/bg-BG.json-BCcKOP1t.js"),__vite__mapDeps([])),"./locales/bn-BD.json":()=>pe(()=>import("./locales/bn-BD.json-B_6nsCVD.js"),__vite__mapDeps([])),"./locales/bn-IN.json":()=>pe(()=>import("./locales/bn-IN.json-2jucCil-.js"),__vite__mapDeps([])),"./locales/ca-ES.json":()=>pe(()=>import("./locales/ca-ES.json-BSLO9_jS.js"),__vite__mapDeps([])),"./locales/cs-CZ.json":()=>pe(()=>import("./locales/cs-CZ.json-eK_EuD1e.js"),__vite__mapDeps([])),"./locales/da-DK.json":()=>pe(()=>import("./locales/da-DK.json-bU2NiWS2.js"),__vite__mapDeps([])),"./locales/de-CH.json":()=>pe(()=>import("./locales/de-CH.json-BuaoKHMo.js"),__vite__mapDeps([])),"./locales/de-DE.json":()=>pe(()=>import("./locales/de-DE.json-BuaoKHMo.js"),__vite__mapDeps([])),"./locales/el-GR.json":()=>pe(()=>import("./locales/el-GR.json-Cy97-iQk.js"),__vite__mapDeps([])),"./locales/en.json":()=>pe(()=>Promise.resolve().then(()=>aue),void 0),"./locales/es-ES.json":()=>pe(()=>import("./locales/es-ES.json-oNW90JZi.js"),__vite__mapDeps([])),"./locales/eu-ES.json":()=>pe(()=>import("./locales/eu-ES.json-D5HTz-2T.js"),__vite__mapDeps([])),"./locales/fa-IR.json":()=>pe(()=>import("./locales/fa-IR.json-DkRWCMU7.js"),__vite__mapDeps([])),"./locales/fi-FI.json":()=>pe(()=>import("./locales/fi-FI.json-DK5oKACm.js"),__vite__mapDeps([])),"./locales/fr-FR.json":()=>pe(()=>import("./locales/fr-FR.json-CfzSZOeK.js"),__vite__mapDeps([])),"./locales/gl-ES.json":()=>pe(()=>import("./locales/gl-ES.json-CBAv4pxE.js"),__vite__mapDeps([])),"./locales/he-IL.json":()=>pe(()=>import("./locales/he-IL.json-R9VMCCzG.js"),__vite__mapDeps([])),"./locales/hi-IN.json":()=>pe(()=>import("./locales/hi-IN.json-DyYpI1sG.js"),__vite__mapDeps([])),"./locales/hu-HU.json":()=>pe(()=>import("./locales/hu-HU.json-CtTS9Bbc.js"),__vite__mapDeps([])),"./locales/id-ID.json":()=>pe(()=>import("./locales/id-ID.json-fqRxkw64.js"),__vite__mapDeps([])),"./locales/it-IT.json":()=>pe(()=>import("./locales/it-IT.json-CZFVb7SY.js"),__vite__mapDeps([])),"./locales/ja-JP.json":()=>pe(()=>import("./locales/ja-JP.json-bX2VL1jp.js"),__vite__mapDeps([])),"./locales/kaa.json":()=>pe(()=>import("./locales/kaa.json-CI63KOti.js"),__vite__mapDeps([])),"./locales/kab-KAB.json":()=>pe(()=>import("./locales/kab-KAB.json-DiLCteK2.js"),__vite__mapDeps([])),"./locales/kk-KZ.json":()=>pe(()=>import("./locales/kk-KZ.json-B8aT4_G6.js"),__vite__mapDeps([])),"./locales/km-KH.json":()=>pe(()=>import("./locales/km-KH.json-D_smvd1D.js"),__vite__mapDeps([])),"./locales/ko-KR.json":()=>pe(()=>import("./locales/ko-KR.json-Cam07-OM.js"),__vite__mapDeps([])),"./locales/ku-TR.json":()=>pe(()=>import("./locales/ku-TR.json-Bq0_--tc.js"),__vite__mapDeps([])),"./locales/lt-LT.json":()=>pe(()=>import("./locales/lt-LT.json-C7TFiHC0.js"),__vite__mapDeps([])),"./locales/lv-LV.json":()=>pe(()=>import("./locales/lv-LV.json-C_-UiJ78.js"),__vite__mapDeps([])),"./locales/mr-IN.json":()=>pe(()=>import("./locales/mr-IN.json-CxalHSHi.js"),__vite__mapDeps([])),"./locales/my-MM.json":()=>pe(()=>import("./locales/my-MM.json-DeIlVI0p.js"),__vite__mapDeps([])),"./locales/nb-NO.json":()=>pe(()=>import("./locales/nb-NO.json-WWMj1pJ_.js"),__vite__mapDeps([])),"./locales/nl-NL.json":()=>pe(()=>import("./locales/nl-NL.json-Cg2bxJpv.js"),__vite__mapDeps([])),"./locales/nn-NO.json":()=>pe(()=>import("./locales/nn-NO.json-DxBfYpW5.js"),__vite__mapDeps([])),"./locales/oc-FR.json":()=>pe(()=>import("./locales/oc-FR.json-D5c9D1ha.js"),__vite__mapDeps([])),"./locales/pa-IN.json":()=>pe(()=>import("./locales/pa-IN.json-YUYnLknD.js"),__vite__mapDeps([])),"./locales/percentages.json":()=>pe(()=>Promise.resolve().then(()=>lue),void 0),"./locales/pl-PL.json":()=>pe(()=>import("./locales/pl-PL.json-BhzXkx92.js"),__vite__mapDeps([])),"./locales/pt-BR.json":()=>pe(()=>import("./locales/pt-BR.json-DTbOlG7b.js"),__vite__mapDeps([])),"./locales/pt-PT.json":()=>pe(()=>import("./locales/pt-PT.json-DjdKQbMu.js"),__vite__mapDeps([])),"./locales/ro-RO.json":()=>pe(()=>import("./locales/ro-RO.json-BovkHx-j.js"),__vite__mapDeps([])),"./locales/ru-RU.json":()=>pe(()=>import("./locales/ru-RU.json-QECVyiqH.js"),__vite__mapDeps([])),"./locales/si-LK.json":()=>pe(()=>import("./locales/si-LK.json-DoDpTh9b.js"),__vite__mapDeps([])),"./locales/sk-SK.json":()=>pe(()=>import("./locales/sk-SK.json-DnhQd4Ft.js"),__vite__mapDeps([])),"./locales/sl-SI.json":()=>pe(()=>import("./locales/sl-SI.json-CLFIbh5D.js"),__vite__mapDeps([])),"./locales/sv-SE.json":()=>pe(()=>import("./locales/sv-SE.json-Cj6x9oIl.js"),__vite__mapDeps([])),"./locales/ta-IN.json":()=>pe(()=>import("./locales/ta-IN.json-FWCKqbfL.js"),__vite__mapDeps([])),"./locales/th-TH.json":()=>pe(()=>import("./locales/th-TH.json-C2vgD3gp.js"),__vite__mapDeps([])),"./locales/tr-TR.json":()=>pe(()=>import("./locales/tr-TR.json-DJwUAzH5.js"),__vite__mapDeps([])),"./locales/uk-UA.json":()=>pe(()=>import("./locales/uk-UA.json-C96Rgyij.js"),__vite__mapDeps([])),"./locales/uz-UZ.json":()=>pe(()=>import("./locales/uz-UZ.json-B1rRSw8_.js"),__vite__mapDeps([])),"./locales/vi-VN.json":()=>pe(()=>import("./locales/vi-VN.json-DNRNvYoK.js"),__vite__mapDeps([])),"./locales/zh-CN.json":()=>pe(()=>import("./locales/zh-CN.json-YRF5ioPK.js"),__vite__mapDeps([])),"./locales/zh-HK.json":()=>pe(()=>import("./locales/zh-HK.json-CulgVZl3.js"),__vite__mapDeps([])),"./locales/zh-TW.json":()=>pe(()=>import("./locales/zh-TW.json-C9FU2HEQ.js"),__vite__mapDeps([]))}),`./locales/${th.code}.json`)}catch(t){console.error(`Failed to load language ${e.code}:`,t.message),Z2=Ow}Zs.set(SV,e.code)},x0=()=>th,$M=(e,t)=>{for(let n=0;n<t.length;++n){const i=t[n];if(e[i]===void 0)return;e=e[i]}if(typeof e=="string")return e},M=(e,t,n)=>{if(th.code.startsWith(TV))return`[[${t?`${e}(${JSON.stringify(t).slice(1,-1)})`:e}]]`;const i=e.split(".");let s=$M(Z2,i)||$M(Ow,i)||n;if(s===void 0){const r=`Can't find translation for ${e}`;return console.warn(r),""}if(t)for(const r in t)s=s.replace(`{{${r}}}`,String(t[r]));return s},SV=Wt(Yu.code),mn=()=>{const e=FH(SV);return{t:M,langCode:e}},due=(e,t)=>{const[n,i,s,r]=t,{x:o,y:a}=Qs({sceneX:n,sceneY:i},e),{x:l,y:c}=Qs({sceneX:s,sceneY:r},e);return l-o>e.width||c-a>e.height},xV=({scenePoint:e,viewportDimensions:t,zoom:n,offsets:i})=>{let s=(t.width-((i==null?void 0:i.right)??0))/2/n.value-e.x;s+=((i==null?void 0:i.left)??0)/2/n.value;let r=(t.height-((i==null?void 0:i.bottom)??0))/2/n.value-e.y;return r+=((i==null?void 0:i.top)??0)/2/n.value,{scrollX:s,scrollY:r}},C0=(e,t)=>{if(e=Eoe(e),!e.length)return{scrollX:0,scrollY:0};let[n,i,s,r]=pt(e);due(t,[n,i,s,r])&&([n,i,s,r]=$se(e,Dt({clientX:t.scrollX,clientY:t.scrollY},t)));const o=(n+s)/2,a=(i+r)/2;return xV({scenePoint:{x:o,y:a},viewportDimensions:{width:t.width,height:t.height},zoom:t.zoom})},Ka=e=>Ze(Qa(e,6),v_,__),uue=e=>Ze(Math.round(e),1,100),CV=e=>Ze(Math.round(e),1,100),oo=e=>"var(--icon-fill-color)",AV=e=>e===Se.LIGHT?Ei.white:"#1e1e1e",W=(e,t=512)=>{const{width:n=512,height:i=n,mirror:s,style:r,...o}=typeof t=="number"?{width:t}:t;return g("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:`0 0 ${n} ${i}`,className:le({"rtl-mirror":s}),style:r,...o,children:typeof e=="string"?g("path",{fill:"currentColor",d:e}):e})},ce={width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},ze={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"};W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:3,y:8,width:18,height:4,rx:1}),g("line",{x1:12,y1:8,x2:12,y2:21}),g("path",{d:"M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7"}),g("path",{d:"M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5"})]}),ce);const MV=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("line",{x1:"3",y1:"6",x2:"3",y2:"19"}),g("line",{x1:"12",y1:"6",x2:"12",y2:"19"}),g("line",{x1:"21",y1:"6",x2:"21",y2:"19"})]}),ce),fue=W(N("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),ce),hue=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"1"}),g("circle",{cx:"12",cy:"19",r:"1"}),g("circle",{cx:"12",cy:"5",r:"1"})]}),ce),gue=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"})]}),ce),mue=W(N("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}),g("line",{x1:"12",y1:"16",x2:"12",y2:"21"}),g("line",{x1:"8",y1:"4",x2:"16",y2:"4"})]}),ce),GM=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M6.5 9.5l3.5 -3"}),g("path",{d:"M14 5.5l3 1.5"}),g("path",{d:"M18.5 10l-2.5 7"}),g("path",{d:"M13.5 17.5l-7 -5"})]}),ce),by=W(N("g",{children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z",stroke:"currentColor",strokeWidth:"1.25"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"UnlockedIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:6,y:1,width:9,height:9,children:g("path",{stroke:"none",d:"M6.399 9.561V5.175c0-.93.401-1.823 1.116-2.48a3.981 3.981 0 0 1 2.693-1.028c1.01 0 1.98.37 2.694 1.027.715.658 1.116 1.55 1.116 2.481",fill:"#fff"})}),g("g",{mask:"url(#UnlockedIcon)",children:g("path",{stroke:"none",d:"M5.149 9.561v1.25h2.5v-1.25h-2.5Zm5.06-7.894V.417v1.25Zm2.559 3.508v1.25h2.5v-1.25h-2.5ZM7.648 8.51V5.175h-2.5V8.51h2.5Zm0-3.334c0-.564.243-1.128.713-1.561L6.668 1.775c-.959.883-1.52 2.104-1.52 3.4h2.5Zm.713-1.561a2.732 2.732 0 0 1 1.847-.697v-2.5c-1.31 0-2.585.478-3.54 1.358L8.36 3.614Zm1.847-.697c.71 0 1.374.26 1.847.697l1.694-1.839a5.231 5.231 0 0 0-3.54-1.358v2.5Zm1.847.697c.47.433.713.997.713 1.561h2.5c0-1.296-.56-2.517-1.52-3.4l-1.693 1.839Z",fill:"currentColor"})})]}),ze),Fw=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z"}),g("path",{d:"M6.667 8.333V5.417C6.667 3.806 8.159 2.5 10 2.5c1.841 0 3.333 1.306 3.333 2.917v2.916"})]}),ze),pue=W(g("g",{fill:"currentColor",children:g("path",{d:"M12 2a5 5 0 0 1 5 5v3a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-10a3 3 0 0 1 -3 -3v-6a3 3 0 0 1 3 -3v-3a5 5 0 0 1 5 -5m0 12a2 2 0 0 0 -1.995 1.85l-.005 .15a2 2 0 1 0 2 -2m0 -10a3 3 0 0 0 -3 3v3h6v-3a3 3 0 0 0 -3 -3"})}),{width:24,height:24}),Uue=W(N(he,{children:[g("path",{d:"M38.5 83.5c-14-2-17.833-10.473-21-22.5C14.333 48.984 12 22 12 12.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.005 10.478 7.905 14.423L6 25.75l6.005-15.273Z",fill:"currentColor"}),g("path",{d:"M12.005 10.478c1.92 3.495 3.838 7 7.905 14.423m-7.905-14.423c3.11 5.683 6.23 11.368 7.905 14.423m0 0c-3.68.226-7.35.455-13.91.85m13.91-.85c-5.279.33-10.566.647-13.91.85m0 0c1.936-4.931 3.882-9.86 6.005-15.273M6 25.75c2.069-5.257 4.135-10.505 6.005-15.272",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:41,height:94,fill:"none"}),bue=W(N(he,{children:[g("path",{d:"M18.026 1.232c-5.268 13.125-5.548 33.555 3.285 42.311 8.823 8.75 33.31 12.304 42.422 13.523",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m72.181 59.247-13.058-10-2.948 13.62 16.006-3.62Z",fill:"currentColor"}),g("path",{d:"M72.181 59.247c-3.163-2.429-6.337-4.856-13.058-10m13.058 10c-5.145-3.936-10.292-7.882-13.058-10m0 0c-.78 3.603-1.563 7.196-2.948 13.62m2.948-13.62c-1.126 5.168-2.24 10.346-2.948 13.62m0 0c5.168-1.166 10.334-2.343 16.006-3.62m-16.006 3.62c5.51-1.248 11.01-2.495 16.006-3.62",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:85,height:71,fill:"none"}),yue=W(N(he,{children:[g("path",{d:"M1 77c14-2 31.833-11.973 35-24 3.167-12.016-6-35-9.5-43.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m24.165 1.093-2.132 16.309 13.27-4.258-11.138-12.05Z",fill:"currentColor"}),g("path",{d:"M24.165 1.093c-.522 3.953-1.037 7.916-2.132 16.309m2.131-16.309c-.835 6.424-1.68 12.854-2.13 16.308m0 0c3.51-1.125 7.013-2.243 13.27-4.257m-13.27 4.257c5.038-1.608 10.08-3.232 13.27-4.257m0 0c-3.595-3.892-7.197-7.777-11.14-12.05m11.14 12.05c-3.837-4.148-7.667-8.287-11.14-12.05",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:38,height:78,fill:"none"}),nv=W(g("g",{fill:"currentColor",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),{width:40,height:40,fill:"none"}),yy=W(N("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 6l4.153 11.793a0.365 .365 0 0 0 .331 .207a0.366 .366 0 0 0 .332 -.207l2.184 -4.793l4.787 -1.994a0.355 .355 0 0 0 .213 -.323a0.355 .355 0 0 0 -.213 -.323l-11.787 -4.36z"}),g("path",{d:"M13.5 13.5l4.5 4.5"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),Nm=W(N("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[g("path",{d:"M4.028 13.252c-.657 -.972 -1.028 -2.078 -1.028 -3.252c0 -3.866 4.03 -7 9 -7s9 3.134 9 7s-4.03 7 -9 7c-1.913 0 -3.686 -.464 -5.144 -1.255"}),g("path",{d:"M5 15m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 17c0 1.42 .316 2.805 1 4"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),Bw=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),ce),zw=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.5 20.4l-6.9 -6.9c-.781 -.781 -.781 -2.219 0 -3l6.9 -6.9c.781 -.781 2.219 -.781 3 0l6.9 6.9c.781 .781 .781 2.219 0 3l-6.9 6.9c-.781 .781 -2.219 .781 -3 0z"})]}),ce),Hw=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"})]}),ce),kV=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"16",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"8",x2:"19",y2:"12"})]}),ce),Vw=W(g("path",{d:"M4.167 10h11.666",strokeWidth:"1.5"}),ze),Eue=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"}),g("path",{d:"M16 7h4"}),g("path",{d:"M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"})]}),ce),Hp=W(N("g",{strokeWidth:"1.25",children:[g("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),g("path",{d:"m11.25 5.417 3.333 3.333"})]}),ze),Eh=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"7",y2:"20"}),g("line",{x1:"14",y1:"20",x2:"21",y2:"20"}),g("line",{x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),g("line",{x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),g("polyline",{points:"5 20 11 4 13 4 20 20"})]}),ce),vue=W(N("g",{stroke:"currentColor",strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),ce),q2=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M12.5 6.667h.01"}),g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z"}),g("path",{d:"m3.333 12.5 3.334-3.333c.773-.745 1.726-.745 2.5 0l4.166 4.166"}),g("path",{d:"m11.667 11.667.833-.834c.774-.744 1.726-.744 2.5 0l1.667 1.667"})]}),ze),RV=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),g("path",{d:"M18 13.3l-6.3 -6.3"})]}),ce),XM=W(g("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),ze),jM=W(g("path",{d:"M5 10h10",strokeWidth:"1.25"}),ze),_ue=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 21l-6 -6"}),g("path",{d:"M3.268 12.043a7.017 7.017 0 0 0 6.634 4.957a7.012 7.012 0 0 0 7.043 -6.131a7 7 0 0 0 -5.314 -7.672a7.021 7.021 0 0 0 -8.241 4.403"}),g("path",{d:"M3 4v4h4"})]}),ce),Yc=W(g("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"}),ze),L6=W(N("g",{strokeWidth:"1.5",children:[g("polyline",{points:"12 16 18 10 12 4"}),g("polyline",{points:"8 4 2 10 8 16"})]}),ze),iv=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{clipRule:"evenodd",d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]}),ze),sv=W(g("path",{clipRule:"evenodd",d:"M10 2.5h.328a6.25 6.25 0 0 0 6.6 10.372A7.5 7.5 0 1 1 10 2.493V2.5Z",stroke:"currentColor"}),ze),rv=W(g("g",{stroke:"currentColor",strokeLinejoin:"round",children:g("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM10 4.167V2.5M14.167 5.833l1.166-1.166M15.833 10H17.5M14.167 14.167l1.166 1.166M10 15.833V17.5M5.833 14.167l-1.166 1.166M5 10H3.333M5.833 5.833 4.667 4.667"})}),{...ze,strokeWidth:1.5}),wue=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),g("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),ce),Ey=W(g("path",{strokeWidth:"1.25",d:"M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10"}),ze),$w=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),ce),Tue=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),ce),YM=W(g("path",{strokeWidth:"1.25",d:"M9.167 5.833H5.833c-1.254 0-2.5 1.282-2.5 2.5v5.834c0 1.283 1.252 2.5 2.5 2.5h5.834c1.251 0 2.5-1.25 2.5-2.5v-3.334M8.333 11.667l8.334-8.334M12.5 3.333h4.167V7.5"}),ze),Gw=W(g("path",{d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"}),ze),LV=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M7.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM12.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM6.25 6.25c2.917-.833 4.583-.833 7.5 0M5.833 13.75c2.917.833 5.417.833 8.334 0"}),g("path",{d:"M12.917 14.167c0 .833 1.25 2.5 1.666 2.5 1.25 0 2.361-1.39 2.917-2.5.556-1.39.417-4.861-1.25-9.584-1.214-.846-2.5-1.116-3.75-1.25l-.833 2.084M7.083 14.167c0 .833-1.13 2.5-1.526 2.5-1.191 0-2.249-1.39-2.778-2.5-.529-1.39-.397-4.861 1.19-9.584 1.157-.846 2.318-1.116 3.531-1.25l.833 2.084"})]}),ze),DV=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4l11.733 16h4.267l-11.733 -16z"}),g("path",{d:"M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772"})]}),ce),Iue=W(g("polyline",{fill:"none",stroke:"currentColor",points:"20 6 9 17 4 12"}),{width:24,height:24}),D6=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M8.333 11.667a2.917 2.917 0 0 0 4.167 0l3.333-3.334a2.946 2.946 0 1 0-4.166-4.166l-.417.416"}),g("path",{d:"M11.667 8.333a2.917 2.917 0 0 0-4.167 0l-3.333 3.334a2.946 2.946 0 0 0 4.166 4.166l.417-.416"})]}),ze),Sue=W("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),xue=W("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),Xw=W(g("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"}),ze);W("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512});W("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z");const q8=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 16l1.465 1.638a2 2 0 1 1 -3.015 .099l1.55 -1.737z"}),g("path",{d:"M13.737 9.737c2.299 -2.3 3.23 -5.095 2.081 -6.245c-1.15 -1.15 -3.945 -.217 -6.244 2.082c-2.3 2.299 -3.231 5.095 -2.082 6.244c1.15 1.15 3.946 .218 6.245 -2.081z"}),g("path",{d:"M7.492 11.818c.362 .362 .768 .676 1.208 .934l6.895 4.047c1.078 .557 2.255 -.075 3.692 -1.512c1.437 -1.437 2.07 -2.614 1.512 -3.692c-.372 -.718 -1.72 -3.017 -4.047 -6.895a6.015 6.015 0 0 0 -.934 -1.208"})]}),ce),Cue=W(g("g",{strokeWidth:1.5,children:g("path",{d:"M6 18l12 -12"})}),ce),PV=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8h.01"}),g("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),g("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),g("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),g("path",{d:"M19 16v6"}),g("path",{d:"M22 19l-3 3l-3 -3"})]}),ce),Aue=W("M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",{width:512,height:512});W("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});W("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});const Mue=W("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z");W("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z");const WM=W(g("path",{d:"M7.5 10.833 4.167 7.5 7.5 4.167M4.167 7.5h9.166a3.333 3.333 0 0 1 0 6.667H12.5",strokeWidth:"1.25"}),ze),KM=W(g("path",{d:"M12.5 10.833 15.833 7.5 12.5 4.167M15.833 7.5H6.667a3.333 3.333 0 1 0 0 6.667H7.5",strokeWidth:"1.25"}),ze),kue=W("M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z",{mirror:!0}),jw=W(g("path",{d:"M5 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 7.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 17.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM7.25 8.917l5.5-2.834M7.25 11.083l5.5 2.834",strokeWidth:"1.5"}),ze),Rue=W("M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"),Lue=W("M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z",{width:24,height:24}),Due=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1"}),g("path",{d:"M12 14v-11"}),g("path",{d:"M9 6l3 -3l3 3"})]}),ce),Pue=W(N(he,{children:[g("path",{fill:"currentColor",d:"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z"}),g("path",{stroke:"currentColor",fill:"currentColor",d:"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z"})]}),{width:64,height:64});W(g("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024});const NV=N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 10l0 10"}),g("path",{d:"M12 10l4 4"}),g("path",{d:"M12 10l-4 4"}),g("path",{d:"M4 4l16 0"})]}),OV=N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5l0 14"}),g("path",{d:"M16 9l-4 -4"}),g("path",{d:"M8 9l4 -4"})]}),ZM=W(OV,ce),qM=W(OV,{...ce,style:{transform:"rotate(180deg)"}}),QM=W(NV,ce),JM=W(NV,{...ce,style:{transform:"rotate(180deg)"}}),ek=W(N(he,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v7.083c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V8.125c0-.92-.746-1.667-1.666-1.667ZM6.875 6.458h-.417c-.92 0-1.666.747-1.666 1.667v3.75c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667v-3.75c0-.92-.747-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),tk=W(N(he,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 3.125h-.417c-.92 0-1.666.746-1.666 1.667v7.083c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667V4.792c0-.92-.747-1.667-1.667-1.667ZM13.542 5.817h-.417c-.92 0-1.667.747-1.667 1.667v4.391c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V7.484c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),nk=W(N(he,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M15.208 4.792H8.125c-.92 0-1.667.746-1.667 1.666v.417c0 .92.747 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM12.516 11.458H8.125c-.92 0-1.667.746-1.667 1.667v.417c0 .92.747 1.666 1.667 1.666h4.391c.92 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),ik=W(N(he,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M11.875 4.792H4.792c-.92 0-1.667.746-1.667 1.666v.417c0 .92.746 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM11.683 11.458H7.292c-.92 0-1.667.746-1.667 1.667v.417c0 .92.746 1.666 1.667 1.666h4.39c.921 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),Nue=W(N(he,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M14.375 10.208v-.416c0-.92-.746-1.667-1.667-1.667H7.292c-.92 0-1.667.746-1.667 1.667v.416c0 .92.746 1.667 1.667 1.667h5.416c.92 0 1.667-.746 1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),Oue=W(N(he,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10.208 5.625h-.416c-.92 0-1.667.746-1.667 1.667v5.416c0 .92.746 1.667 1.667 1.667h.416c.92 0 1.667-.746 1.667-1.667V7.292c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),sk=W(N("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M1.667 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M8.333 10h3.334",strokeLinejoin:"round"}),g("path",{d:"M15.417 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 4.792h-.417c-.92 0-1.666.746-1.666 1.666v7.084c0 .92.746 1.666 1.666 1.666h.417c.92 0 1.667-.746 1.667-1.666V6.458c0-.92-.747-1.666-1.667-1.666ZM13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v3.75c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667v-3.75c0-.92-.746-1.667-1.666-1.667Z"})]}),ze),rk=W(N("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M10 18.333v-2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10 11.667V8.333",strokeLinejoin:"round"}),g("path",{d:"M10 4.583V1.667",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M4.792 13.125v.417c0 .92.746 1.666 1.666 1.666h7.084c.92 0 1.666-.746 1.666-1.666v-.417c0-.92-.746-1.667-1.666-1.667H6.458c-.92 0-1.666.746-1.666 1.667ZM6.458 6.458v.417c0 .92.747 1.667 1.667 1.667h3.75c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666h-3.75c-.92 0-1.667.746-1.667 1.666Z"})]}),ze),Yw=W(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"9",cy:"7",r:"4"}),g("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),g("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),g("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]}),ce);W("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z");W("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z");const Wu=W(N(he,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M15 5 5 15M5 5l10 10"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze);W("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0});const Fue=W("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24});W("M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z",{width:384,height:512});const ok=de.memo(({theme:e})=>W(N(he,{children:[g("path",{d:"M25 26H111V111H25",fill:oo()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:oo(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:oo()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:oo(),strokeWidth:"2"}),N("g",{fill:AV(e),stroke:oo(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"2.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),ak=de.memo(({theme:e})=>W(N(he,{children:[g("path",{d:"M25 26H111V111H25",fill:oo()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:oo(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:oo()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:oo(),strokeWidth:"2"}),N("g",{fill:AV(e),stroke:oo(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"78.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"78.5",width:"30",height:"30"}),g("rect",{x:"105.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"102.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),Bue=W(g("g",{strokeWidth:1.25,children:g("path",{d:"M5.879 2.625h8.242a3.27 3.27 0 0 1 3.254 3.254v8.242a3.27 3.27 0 0 1-3.254 3.254H5.88a3.27 3.27 0 0 1-3.254-3.254V5.88A3.27 3.27 0 0 1 5.88 2.626l-.001-.001ZM4.518 16.118l7.608-12.83m.198 13.934 5.051-9.897M2.778 9.675l9.348-6.387m-7.608 12.83 12.857-8.793"})}),ze),zue=W(N(he,{children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillHachureIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:2,y:2,width:16,height:16,children:g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1.25"})}),g("g",{mask:"url(#FillHachureIcon)",children:g("path",{d:"M2.258 15.156 15.156 2.258M7.324 20.222 20.222 7.325m-20.444 5.35L12.675-.222m-8.157 18.34L17.416 5.22",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]}),ze),Hue=W(N(he,{children:[N("g",{clipPath:"url(#a)",children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillCrossHatchIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:-1,y:-1,width:22,height:22,children:g("path",{d:"M2.426 15.044 15.044 2.426M7.383 20 20 7.383M0 12.617 12.617 0m-7.98 17.941L17.256 5.324m-2.211 12.25L2.426 4.956M20 12.617 7.383 0m5.234 20L0 7.383m17.941 7.98L5.324 2.745",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("g",{mask:"url(#FillCrossHatchIcon)",children:g("path",{d:"M14.121 2H5.88A3.879 3.879 0 0 0 2 5.879v8.242A3.879 3.879 0 0 0 5.879 18h8.242A3.879 3.879 0 0 0 18 14.121V5.88A3.879 3.879 0 0 0 14.121 2Z",fill:"currentColor"})})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),Vue=W(N(he,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z",stroke:"currentColor",strokeWidth:"1.25"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),{...ze,fill:"currentColor"}),FV=W(g(he,{children:g("path",{d:"M4.167 10h11.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),ze),$ue=W(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),ze),Gue=W(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"3.75",strokeLinecap:"round",strokeLinejoin:"round"}),ze);de.memo(({theme:e})=>W(g("path",{d:"M6 10H34",stroke:oo(),strokeWidth:2,fill:"none",strokeLinecap:"round"}),{width:40,height:20}));const Xue=W(N("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12h2"}),g("path",{d:"M17 12h2"}),g("path",{d:"M11 12h2"})]}),ce),jue=W(N("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M8 12v.01"}),g("path",{d:"M12 12v.01"}),g("path",{d:"M16 12v.01"}),g("path",{d:"M20 12v.01"})]}),ce),Yue=W(g("path",{d:"M2.5 12.038c1.655-.885 5.9-3.292 8.568-4.354 2.668-1.063.101 2.821 1.32 3.104 1.218.283 5.112-1.814 5.112-1.814",strokeWidth:"1.25"}),ze),Wue=W(g("path",{d:"M2.5 12.563c1.655-.886 5.9-3.293 8.568-4.355 2.668-1.062.101 2.822 1.32 3.105 1.218.283 5.112-1.814 5.112-1.814m-13.469 2.23c2.963-1.586 6.13-5.62 7.468-4.998 1.338.623-1.153 4.11-.132 5.595 1.02 1.487 6.133-1.43 6.133-1.43",strokeWidth:"1.25"}),ze),Kue=W(g("path",{d:"M2.5 11.936c1.737-.879 8.627-5.346 10.42-5.268 1.795.078-.418 5.138.345 5.736.763.598 3.53-1.789 4.235-2.147M2.929 9.788c1.164-.519 5.47-3.28 6.987-3.114 1.519.165 1 3.827 2.121 4.109 1.122.281 3.839-2.016 4.606-2.42",strokeWidth:"1.25"}),ze),Zue=W(N("svg",{strokeWidth:"1.5",children:[g("path",{d:"M3.33334 9.99998V6.66665C3.33334 6.04326 3.33403 4.9332 3.33539 3.33646C4.95233 3.33436 6.06276 3.33331 6.66668 3.33331H10"}),g("path",{d:"M13.3333 3.33331V3.34331"}),g("path",{d:"M16.6667 3.33331V3.34331"}),g("path",{d:"M16.6667 6.66669V6.67669"}),g("path",{d:"M16.6667 10V10.01"}),g("path",{d:"M3.33334 13.3333V13.3433"}),g("path",{d:"M16.6667 13.3333V13.3433"}),g("path",{d:"M3.33334 16.6667V16.6767"}),g("path",{d:"M6.66666 16.6667V16.6767"}),g("path",{d:"M10 16.6667V16.6767"}),g("path",{d:"M13.3333 16.6667V16.6767"}),g("path",{d:"M16.6667 16.6667V16.6767"})]}),ze),que=W(N("g",{strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v-4a4 4 0 0 1 4 -4h4"}),g("line",{x1:"16",y1:"4",x2:"16",y2:"4.01"}),g("line",{x1:"20",y1:"4",x2:"20",y2:"4.01"}),g("line",{x1:"20",y1:"8",x2:"20",y2:"8.01"}),g("line",{x1:"20",y1:"12",x2:"20",y2:"12.01"}),g("line",{x1:"4",y1:"16",x2:"4",y2:"16.01"}),g("line",{x1:"20",y1:"16",x2:"20",y2:"16.01"}),g("line",{x1:"4",y1:"20",x2:"4",y2:"20.01"}),g("line",{x1:"8",y1:"20",x2:"8",y2:"20.01"}),g("line",{x1:"12",y1:"20",x2:"12",y2:"20.01"}),g("line",{x1:"16",y1:"20",x2:"16",y2:"20.01"}),g("line",{x1:"20",y1:"20",x2:"20",y2:"20.01"})]}),ce),Que=W(N("g",{stroke:"currentColor",opacity:.3,strokeWidth:2,children:[g("path",{d:"M12 12l9 0"}),g("path",{d:"M3 9l6 6"}),g("path",{d:"M3 15l6 -6"})]}),ce),ov=de.memo(({flip:e=!1})=>W(N("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",stroke:"currentColor",strokeWidth:2,fill:"none",children:[g("path",{d:"M34 10H6M34 10L27 5M34 10L27 15"}),g("path",{d:"M27.5 5L34.5 10L27.5 15"})]}),{width:40,height:20})),Jue=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),efe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,children:[g("path",{d:"M26 10L6 10"}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),tfe=de.memo(({flip:e=!1})=>W(g("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",children:g("path",{d:"M34 10H5.99996M34 10L34 5M34 10L34 15",stroke:"currentColor",strokeWidth:2,fill:"none"})}),{width:40,height:20})),nfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("path",{d:"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5"})]}),{width:40,height:20})),ife=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,strokeLinejoin:"round",children:[g("path",{d:"M6,9.5H27"}),g("path",{d:"M27,5L34,10L27,14Z",fill:"none"})]}),{width:40,height:20})),sfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),rfe=de.memo(({flip:e=!1})=>W(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),ofe=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),afe=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,15 L15,5"})}),{width:40,height:20})),lfe=de.memo(({flip:e=!1})=>W(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,16 L15,4 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),cfe=W(N(he,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),dfe=W(N(he,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),ufe=W(N(he,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),ffe=W(g(he,{children:g("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),ze),vy=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),ce),hfe=W(g(he,{children:N("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 12h10"}),g("path",{d:"M7 5v14"}),g("path",{d:"M17 5v14"}),g("path",{d:"M15 19h4"}),g("path",{d:"M15 5h4"}),g("path",{d:"M5 19h4"}),g("path",{d:"M5 5h4"})]})}),ce),av=W(g(he,{children:g("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 16.667v-10a3.333 3.333 0 0 1 3.334-3.334h1.666a3.333 3.333 0 0 1 3.334 3.334v10M5.833 10.833h8.334"})})}),ze),BV=W(N(he,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 6.667 2.5 10l3.333 3.333M14.167 6.667 17.5 10l-3.333 3.333M11.667 3.333 8.333 16.667"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),ze),gfe=W(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"4",y1:"12",x2:"12",y2:"12"}),g("line",{x1:"4",y1:"16",x2:"16",y2:"16"})]}),ce),mfe=W(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),g("line",{x1:"6",y1:"16",x2:"18",y2:"16"})]}),ce),pfe=W(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"10",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"8",y1:"16",x2:"20",y2:"16"})]}),ce),Ufe=de.memo(({theme:e})=>W(N("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"4",x2:"20",y2:"4"}),g("rect",{x:"9",y:"8",width:"6",height:"12",rx:"2"})]}),ce)),bfe=de.memo(({theme:e})=>W(N("g",{strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),g("rect",{x:"9",y:"4",width:"6",height:"12",rx:"2"})]}),ce)),yfe=de.memo(({theme:e})=>W(N("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"12",x2:"9",y2:"12"}),g("line",{x1:"15",y1:"12",x2:"20",y2:"12"}),g("rect",{x:"9",y:"6",width:"6",height:"12",rx:"2"})]}),ce)),zV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 19h-18l9 -15"}),g("path",{d:"M20.615 15.171h.015"}),g("path",{d:"M19.515 11.771h.015"}),g("path",{d:"M17.715 8.671h.015"}),g("path",{d:"M15.415 5.971h.015"})]}),ce),Efe=W(g("path",{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z",fill:"currentColor"}),{width:640,height:512});W(g("path",{d:"M480 416C497.7 416 512 430.3 512 448C512 465.7 497.7 480 480 480H150.6C133.7 480 117.4 473.3 105.4 461.3L25.37 381.3C.3786 356.3 .3786 315.7 25.37 290.7L258.7 57.37C283.7 32.38 324.3 32.38 349.3 57.37L486.6 194.7C511.6 219.7 511.6 260.3 486.6 285.3L355.9 416H480zM265.4 416L332.7 348.7L195.3 211.3L70.63 336L150.6 416L265.4 416z"}));const HV=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),g("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"})]}),ce),lk=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M7 11l5 5l5 -5"}),g("path",{d:"M12 4l0 12"})]}),ce),Vp=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),g("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]}),ce),vfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M9.15 14.85l8.85 -10.85"}),g("path",{d:"M6 4l8.85 10.85"})]}),ce),_fe=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),g("path",{d:"M12 17l0 .01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),ce),wfe=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 4v16l13 -8z"})]}),ce),Tfe=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",strokeWidth:"0",fill:"currentColor"})]}),ce),Ife=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12l5 5l10 -10"})]}),ce),Sfe=W(N(he,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z"}),g("path",{d:"M12 9v4"}),g("path",{d:"M12 17h.01"})]}),ce),xfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l6 6"}),g("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]}),ce),lv=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l-4 7h8z"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]}),ce),su=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 7l16 0"}),g("path",{d:"M4 17l16 0"}),g("path",{d:"M7 4l0 16"}),g("path",{d:"M17 4l0 16"})]}),ce),Ww=W(g("path",{fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})),Q2=W(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M4.16602 10H15.8327"}),g("path",{d:"M12.5 13.3333L15.8333 10"}),g("path",{d:"M12.5 6.66666L15.8333 9.99999"})]}),ze),A0=W(N("g",{fill:"none",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",transform:"rotate(90 10 10)",children:[g("path",{clipRule:"evenodd",d:"m9.644 13.69 7.774-7.773a2.357 2.357 0 0 0-3.334-3.334l-7.773 7.774L8 12l1.643 1.69Z"}),g("path",{d:"m13.25 3.417 3.333 3.333M10 10l2-2M5 15l3-3M2.156 17.894l1-1M5.453 19.029l-.144-1.407M2.377 11.887l.866 1.118M8.354 17.273l-1.194-.758M.953 14.652l1.408.13"})]}),20),P6=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),ce);W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),ce);W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11.217 19.384a3.501 3.501 0 0 0 6.783 -1.217v-5.167l-6 -3.35"}),g("path",{d:"M5.214 15.014a3.501 3.501 0 0 0 4.446 5.266l4.34 -2.534v-6.946"}),g("path",{d:"M6 7.63c-1.391 -.236 -2.787 .395 -3.534 1.689a3.474 3.474 0 0 0 1.271 4.745l4.263 2.514l6 -3.348"}),g("path",{d:"M12.783 4.616a3.501 3.501 0 0 0 -6.783 1.217v5.067l6 3.45"}),g("path",{d:"M18.786 8.986a3.501 3.501 0 0 0 -4.446 -5.266l-4.34 2.534v6.946"}),g("path",{d:"M18 16.302c1.391 .236 2.787 -.395 3.534 -1.689a3.474 3.474 0 0 0 -1.271 -4.745l-4.308 -2.514l-5.955 3.42"})]}),ce);const Cfe=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),g("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),g("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),g("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"})]}),ce),Kw=W(N("g",{stroke:"currentColor",fill:"none",strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"}),g("path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"})]}),ce),Afe=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828"}),g("path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87"}),g("path",{d:"M3 3l18 18"})]}),ce),Mfe=W(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),ce),kfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),ce),wu=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),g("path",{d:"M21 21l-6 -6"})]}),ce),Rfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20.984 12.53a9 9 0 1 0 -7.552 8.355"}),g("path",{d:"M12 7v5l3 3"}),g("path",{d:"M19 16l-2 3h4l-2 3"})]}),ce),Lfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z"}),g("path",{d:"M5 10a7 7 0 0 0 14 0"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),ce),Dfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 3l18 18"}),g("path",{d:"M9 5a3 3 0 0 1 6 0v5a3 3 0 0 1 -.13 .874m-2 2a3 3 0 0 1 -3.87 -2.872v-1"}),g("path",{d:"M5 10a7 7 0 0 0 10.846 5.85m2 -2a6.967 6.967 0 0 0 1.152 -3.85"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),ce),cv=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11"})]}),ce),Pfe=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 1a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1z"}),g("path",{d:"M12 20v.01"}),g("path",{d:"M16 20v.01"}),g("path",{d:"M8 20v.01"}),g("path",{d:"M4 20v.01"}),g("path",{d:"M4 16v.01"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M4 8v.01"}),g("path",{d:"M4 4v.01"}),g("path",{d:"M8 4v.01"}),g("path",{d:"M12 4v.01"}),g("path",{d:"M16 4v.01"}),g("path",{d:"M20 4v.01"}),g("path",{d:"M20 8v.01"}),g("path",{d:"M20 12v.01"}),g("path",{d:"M20 16v.01"}),g("path",{d:"M20 20v.01"})]}),ce),Nfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3v18"}),g("path",{d:"M19 21v-18"}),g("path",{d:"M5 7h14"}),g("path",{d:"M5 15h14"}),g("path",{d:"M8 13v4"}),g("path",{d:"M11 13v4"}),g("path",{d:"M16 13v4"}),g("path",{d:"M14 5v4"}),g("path",{d:"M11 5v4"}),g("path",{d:"M8 5v4"}),g("path",{d:"M3 21h18"})]}),ce),Ofe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 12l18 0"}),g("path",{d:"M7 16l10 0l-10 5l0 -5"}),g("path",{d:"M7 8l10 0l-10 -5l0 5"})]}),ce),Ffe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l0 18"}),g("path",{d:"M16 7l0 10l5 0l-5 -10"}),g("path",{d:"M8 7l0 10l-5 0l5 -10"})]}),ce),VV=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"}),g("path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2"}),g("path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"})]}),ce),Zw=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),g("path",{d:"M22 22l-3 -3"}),g("path",{d:"M6 18h-1a2 2 0 0 1 -2 -2v-1"}),g("path",{d:"M3 11v-1"}),g("path",{d:"M3 6v-1a2 2 0 0 1 2 -2h1"}),g("path",{d:"M10 3h1"}),g("path",{d:"M15 3h1a2 2 0 0 1 2 2v1"})]}),ce),Bfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M4 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"}),g("path",{d:"M10 15l2 6l2 -6"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"})]}),ce),zfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"}),g("path",{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"}),g("path",{d:"M11 21v-6l3 6v-6"})]}),ce),Hfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 13v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a2 2 0 0 0 6 0v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a8 8 0 0 1 -16 0"}),g("path",{d:"M4 8l5 0"}),g("path",{d:"M15 8l4 0"})]}),ce),Vfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 14c.83 .642 2.077 1.017 3.5 1c1.423 .017 2.67 -.358 3.5 -1c.83 -.642 2.077 -1.017 3.5 -1c1.423 -.017 2.67 .358 3.5 1"}),g("path",{d:"M8 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M12 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M3 10h14v5a6 6 0 0 1 -6 6h-2a6 6 0 0 1 -6 -6v-5z"}),g("path",{d:"M16.746 16.726a3 3 0 1 0 .252 -5.555"})]}),ce),$fe=W(N("g",{stroke:"currentColor",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 5a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-16a1 1 0 0 1-1-1v-10zM7 20h10M9 16v4M15 16v4"})]}),{...ce,strokeWidth:1.5}),$V=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M21 12h-13l3 -3"}),g("path",{d:"M11 15l-3 -3"})]}),ce),GV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M2 8a4 4 0 0 1 4 -4h12a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-12a4 4 0 0 1 -4 -4v-8z"}),g("path",{d:"M10 9l5 3l-5 3z"})]}),ce),Gfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 6h18"}),g("path",{d:"M3 12h18"}),g("path",{d:"M3 18h18"}),g("path",{d:"M6 3v18"}),g("path",{d:"M12 3v18"}),g("path",{d:"M18 3v18"})]}),ce),Xfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M3 17m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M17 5c-6.627 0 -12 5.373 -12 12"})]}),ce),qw=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 18l12 -12"}),g("path",{d:"M18 10v-4h-4"})]}),ce),Qw=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4,19L10,19C11.097,19 12,18.097 12,17L12,9C12,7.903 12.903,7 14,7L21,7"}),g("path",{d:"M18 4l3 3l-3 3"})]}),ce),Jw=W(N("g",{children:[g("path",{d:"M16,12L20,9L16,6"}),g("path",{d:"M6 20c0 -6.075 4.925 -11 11 -11h3"})]}),ce),XV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 9l6 6l6 -6"})]}),ce),jfe=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),ce),Yfe=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),ce),ck=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 5v10a1 1 0 0 0 1 1h10"}),g("path",{d:"M5 8h10a1 1 0 0 1 1 1v10"})]}),ce),jV=W(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 7l0 10"}),g("path",{d:"M7 5l10 0"}),g("path",{d:"M7 19l10 0"}),g("path",{d:"M19 7l0 10"})]}),ce);W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 11v8a1 1 0 0 0 1 1h8m-9 -14v-1a1 1 0 0 1 1 -1h1m5 0h2m5 0h1a1 1 0 0 1 1 1v1m0 5v2m0 5v1a1 1 0 0 1 -1 1h-1"}),g("path",{d:"M4 12h7a1 1 0 0 1 1 1v7"})]}),ce);const Wfe=W(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 6l8 0"}),g("path",{d:"M16 6l4 0"}),g("path",{d:"M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 12l2 0"}),g("path",{d:"M10 12l10 0"}),g("path",{d:"M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 18l11 0"}),g("path",{d:"M19 18l1 0"})]}),ce),Kfe=W(N("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 10l4 -4 L6 14l8 -8 L6 18l12 -12 L10 18l8 -8 L14 18l4 -4"})]}),ce),Zfe=W(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"}),g("path",{d:"M13.5 6.5l4 4"})]}),ce);W(N("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l-5 5l5 5"}),g("path",{d:"M17 7l-5 5l5 5"})]}),ce);const qfe=W(N("g",{strokeWidth:"1.75",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"}),g("path",{d:"M15 4l0 16"})]}),ce),Qfe=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1"})]}),ce),Jfe=W(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 4l18 0"}),g("path",{d:"M4 4v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-10"}),g("path",{d:"M12 16l0 4"}),g("path",{d:"M9 20l6 0"}),g("path",{d:"M8 12l3 -3l2 2l3 -3"})]}),ce);class ehe extends Error{constructor(t="Couldn't export canvas.",n="CANVAS_ERROR"){super(),this.name=n,this.message=t}}class ng extends DOMException{constructor(t="Request Aborted"){super(t,"AbortError")}}class zd extends Error{constructor(n="Image Scene Data Error",i="IMAGE_SCENE_DATA_ERROR"){super(n);F(this,"code");this.name="EncodingError",this.code=i}}class YV extends Error{constructor(n="Worker URL is not defined!",i="WORKER_URL_NOT_DEFINED"){super(n);F(this,"code");this.name="WorkerUrlNotDefinedError",this.code=i}}class WV extends Error{constructor(n="Worker has to be in a separate chunk!",i="WORKER_IN_THE_MAIN_CHUNK"){super(n);F(this,"code");this.name="WorkerInTheMainChunkError",this.code=i}}class ao extends Error{constructor(t){super(t),this.name="ExcalidrawError"}}const Ul=({size:e="1em",circleWidth:t=8,synchronized:n=!1,className:i=""})=>{const r=-(de.useRef(Date.now()).current%1600);return g("div",{className:`Spinner ${i}`,children:g("svg",{viewBox:"0 0 100 100",style:{width:e,height:e,"--spinner-delay":n?`${r}ms`:0},children:g("circle",{cx:"50",cy:"50",r:50-t/2,strokeWidth:t,fill:"none",strokeMiterlimit:"10"})})})},We=de.forwardRef(({size:e="medium",visible:t=!0,className:n="",...i},s)=>{const{id:r}=Fs(),o=de.useRef(null);de.useImperativeHandle(s,()=>o.current);const a=`ToolIcon_size_${e}`,[l,c]=L.useState(!1),d=L.useRef(!0),u=async h=>{var p;const m="onClick"in i&&((p=i.onClick)==null?void 0:p.call(i,h));if(Sp(m))try{c(!0),await m}catch(U){if(U instanceof ng)console.warn(U);else throw U}finally{d.current&&c(!1)}};L.useEffect(()=>(d.current=!0,()=>{d.current=!1}),[]);const f=L.useRef(null);if(i.type==="button"||i.type==="icon"||i.type==="submit"){const h=i.type==="icon"?"button":i.type;return N("button",{className:le("ToolIcon_type_button",a,n,t&&!i.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide",{ToolIcon:!i.hidden,"ToolIcon--selected":i.selected,"ToolIcon--plain":i.type==="icon"}),style:i.style,"data-testid":i["data-testid"],hidden:i.hidden,title:i.title,"aria-label":i["aria-label"],type:h,onClick:u,ref:o,disabled:l||i.isLoading||!!i.disabled,children:[(i.icon||i.label)&&N("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":!!i.disabled,children:[i.icon||i.label,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel}),i.isLoading&&g(Ul,{})]}),i.showAriaLabel&&N("div",{className:"ToolIcon__label",children:[i["aria-label"]," ",l&&g(Ul,{})]}),i.children]})}return N("label",{className:le("ToolIcon",n),title:i.title,onPointerDown:h=>{var m;f.current=h.pointerType||null,(m=i.onPointerDown)==null||m.call(i,{pointerType:h.pointerType||null})},onPointerUp:()=>{requestAnimationFrame(()=>{f.current=null})},children:[g("input",{className:`ToolIcon_type_radio ${a}`,type:"radio",name:i.name,"aria-label":i["aria-label"],"aria-keyshortcuts":i["aria-keyshortcuts"],"data-testid":i["data-testid"],id:`${r}-${i.id}`,onChange:()=>{var h;(h=i.onChange)==null||h.call(i,{pointerType:f.current})},checked:i.checked,ref:o}),N("div",{className:"ToolIcon__icon",children:[i.icon,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel})]})]})});We.displayName="ToolButton";let dv=[];const ue=e=>(dv=dv.concat(e),e),the=(e,t,n)=>{const i=new Set(Ye(e.filter(d=>Ue(d)),t).map(d=>d.id)),s={},r=n.scene.getNonDeletedElementsMap(),o=new Set;for(const d of i){const u=or(e,d);for(const f of u)if(!o.has(f.id)){if(Nt(f)){const h=Bn(f,r);h&&(s[h.id]=!0)}else s[f.id]=!0;o.add(f.id)}}let a=!0;const l=e.map(d=>{if(t.selectedElementIds[d.id]){const u=Nt(d)?Bn(d,r):null;return d.frameId&&i.has(d.frameId)?(a=!1,s[d.id]=!0,d):u!=null&&u.frameId&&i.has(u==null?void 0:u.frameId)?d:(d.boundElements&&d.boundElements.forEach(f=>{var m,p;const h=n.scene.getNonDeletedElementsMap().get(f.id);h&&ye(h)&&n.scene.mutateElement(h,{startBinding:d.id===((m=h.startBinding)==null?void 0:m.elementId)?null:h.startBinding,endBinding:d.id===((p=h.endBinding)==null?void 0:p.elementId)?null:h.endBinding})}),Te(d,{isDeleted:!0}))}return d.frameId&&i.has(d.frameId)?(a=!1,Nt(d)||(s[d.id]=!0),Te(d,{frameId:null})):Nt(d)&&t.selectedElementIds[d.containerId]?Te(d,{isDeleted:!0}):d});let c=t.editingGroupId;if(a&&t.editingGroupId){const d=Lt(l,t.editingGroupId).filter(u=>!u.isDeleted);if(d.length>1)d[0]&&(s[d[0].id]=!0);else{c=null,d[0]&&(s[d[0].id]=!0);const u=d[0];if(u){const f=u.groupIds.findIndex(m=>m===t.editingGroupId),h=u.groupIds[f+1];if(h){const m=Lt(l,h).filter(p=>!p.isDeleted);m.length>1&&(c=h,m.forEach(p=>{s[p.id]=!0}))}}}}return{elements:l,appState:{...t,...xi({selectedElementIds:s,editingGroupId:c},l,t,null)}}},dk=(e,t)=>{if(e.editingGroupId){const n=Lt(Yt(t),e.editingGroupId);if(n.length)return{...e,selectedElementIds:{[n[0].id]:!0}}}return e},KV=ue({name:"deleteSelectedElements",label:"labels.delete",icon:Yc,trackEvent:{category:"element",action:"delete"},perform:(e,t,n,i)=>{var o;if((o=t.selectedLinearElement)!=null&&o.isEditing){const{elementId:a,selectedPointsIndices:l}=t.selectedLinearElement,c=i.scene.getNonDeletedElementsMap(),d=re.getElement(a,c);if(!d||l==null)return!1;if(l.length>=d.points.length){const u=e.map(h=>h.id===d.id?Te(h,{isDeleted:!0}):h),f=dk(t,u);return{elements:u,appState:{...f,selectedLinearElement:null},captureUpdate:q.IMMEDIATELY}}return re.deletePoints(d,i,l),{elements:e,appState:{...t,selectedLinearElement:{...t.selectedLinearElement,selectedPointsIndices:(l==null?void 0:l[0])>0?[l[0]-1]:[0]}},captureUpdate:q.IMMEDIATELY}}let{elements:s,appState:r}=the(e,t,i);return YB(s,s.filter(a=>a.isDeleted)),r=dk(r,s),{elements:s,appState:{...r,activeTool:qt(t,{type:i.state.preferredSelectionTool.type}),multiElement:null,newElement:null,activeEmbeddable:null,selectedLinearElement:null},captureUpdate:Qn(Yt(e),t)?q.IMMEDIATELY:q.EVENTUALLY}},keyTest:(e,t,n)=>(e.key===$.BACKSPACE||e.key===$.DELETE)&&!e[$.CTRL_OR_CMD],PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Ua()==="mobile";return g(We,{type:"button",icon:Yc,title:M("labels.delete"),"aria-label":M("labels.delete"),onClick:()=>n(null),disabled:!Qn(Yt(e),t),style:{...s&&t.openPopup!=="compactOtherProperties"?vp:{}}})}}),Q=e=>e.replace(/\b(Opt(?:ion)?|Alt)\b/i,M(po?"keys.option":"keys.alt")).replace(/\bShift\b/i,M("keys.shift")).replace(/\b(Enter|Return)\b/i,M("keys.enter")).replace(/\b(Ctrl|Cmd|Command|CtrlOrCmd)\b/gi,M(po?"keys.cmd":"keys.ctrl")).replace(/\b(Esc(?:ape)?)\b/i,M("keys.escape")).replace(/\b(Space(?:bar)?)\b/i,M("keys.spacebar")).replace(/\b(Del(?:ete)?)\b/i,M("keys.delete")),nhe=ue({name:"sendBackward",label:"labels.sendBackward",keywords:["move down","zindex","layer"],icon:qM,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:poe(e,t,i.scene),appState:t,captureUpdate:q.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[$.CTRL_OR_CMD]&&!e.shiftKey&&e.code===ot.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.sendBackward")}  ${Q("CtrlOrCmd+[")}`,children:qM})}),ihe=ue({name:"bringForward",label:"labels.bringForward",keywords:["move up","zindex","layer"],icon:ZM,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Uoe(e,t,i.scene),appState:t,captureUpdate:q.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[$.CTRL_OR_CMD]&&!e.shiftKey&&e.code===ot.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.bringForward")}  ${Q("CtrlOrCmd+]")}`,children:ZM})}),she=ue({name:"sendToBack",label:"labels.sendToBack",keywords:["move down","zindex","layer"],icon:JM,trackEvent:{category:"element"},perform:(e,t)=>({elements:boe(e,t),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>po?e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.BRACKET_LEFT:e[$.CTRL_OR_CMD]&&e.shiftKey&&e.code===ot.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.sendToBack")}  ${Q(po?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")}`,children:JM})}),rhe=ue({name:"bringToFront",label:"labels.bringToFront",keywords:["move up","zindex","layer"],icon:QM,trackEvent:{category:"element"},perform:(e,t)=>({elements:yoe(e,t),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>po?e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.BRACKET_RIGHT:e[$.CTRL_OR_CMD]&&e.shiftKey&&e.code===ot.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:n=>e(null),title:`${M("labels.bringToFront")}  ${Q(po?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")}`,children:QM})}),ohe=ue({name:"selectAll",label:"labels.selectAll",icon:Pfe,trackEvent:{category:"canvas"},viewMode:!1,perform:(e,t,n,i)=>{var r;if((r=t.selectedLinearElement)!=null&&r.isEditing)return!1;const s=e.filter(o=>!o.isDeleted&&!(fe(o)&&o.containerId)&&!o.locked).reduce((o,a)=>(o[a.id]=!0,o),{});return{appState:{...t,...xi({editingGroupId:null,selectedElementIds:s},Yt(e),t,i),selectedLinearElement:Object.keys(s).length===1&&Ce(e[0])?new re(e[0],be(e)):null},captureUpdate:q.IMMEDIATELY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.A}),ahe=ue({name:"duplicateSelection",label:"labels.duplicateSelection",icon:iv,trackEvent:{category:"element"},perform:(e,t,n,i)=>{var o;if(t.selectedElementsAreBeingDragged)return!1;if((o=t.selectedLinearElement)!=null&&o.isEditing)try{const a=re.duplicateSelectedPoints(t,i.scene);return{elements:e,appState:a,captureUpdate:q.IMMEDIATELY}}catch{return!1}let{duplicatedElements:s,elementsWithDuplicates:r}=Rm({type:"in-place",elements:e,idsOfElementsToDuplicate:be(Ye(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),appState:t,randomizeSeed:!0,overrides:({origElement:a,origIdToDuplicateId:l})=>{const c=a.frameId&&l.get(a.frameId);return{x:a.x+Zb/2,y:a.y+Zb/2,frameId:c??a.frameId}}});if(i.props.onDuplicate&&r){const a=i.props.onDuplicate(r,e);a&&(r=a)}return{elements:bo(r,be(s)),appState:{...t,...JB(s,Yt(r),t)},captureUpdate:q.IMMEDIATELY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.D,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Ua()==="mobile";return g(We,{type:"button",icon:iv,title:`${M("labels.duplicateSelection")}  ${Q("CtrlOrCmd+D")}`,"aria-label":M("labels.duplicateSelection"),onClick:()=>n(null),disabled:!Qn(Yt(e),t),style:{...s&&t.openPopup!=="compactOtherProperties"?vp:{}}})}});var lhe={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"https://oss-collab.excalidraw.com",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_ENABLE_TRACKING:"true",VITE_APP_PLUS_EXPORT_PUBLIC_KEY:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`,VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX:"false",VITE_APP_COLLAPSE_OVERLAY:"false",VITE_APP_ENABLE_ESLINT:"false",VITE_APP_GIT_SHA:"",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const che=new Set(["command_palette","export"]),it=(e,t,n,i)=>{try{if(typeof window>"u"||lhe.VITE_WORKER_ID||!che.has(e))return;k_(),window.sa_event&&window.sa_event(t,{category:e,label:n,value:i})}catch(s){console.error("error during analytics",s)}},eT=L.forwardRef((e,t)=>{const{title:n,className:i,testId:s,active:r,standalone:o,icon:a,onClick:l}=e;return g("button",{type:"button",ref:t,title:n,"data-testid":s,className:le(i,{standalone:o,active:r}),onClick:l,style:e.style,children:a},n)}),ma=e=>g(he,{children:e.options.map(t=>e.type==="button"?g(eT,{icon:t.icon,title:t.text,testId:t.testId,active:t.active??e.value===t.value,onClick:n=>e.onClick(t.value,n)},t.text):N("label",{className:le({active:e.value===t.value}),title:t.text,children:[g("input",{type:"radio",name:e.group,onChange:()=>e.onChange(t.value),checked:e.value===t.value,"data-testid":t.testId}),t.icon]},t.text))});function Oi(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function uk(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function ZV(...e){return t=>{let n=!1;const i=e.map(s=>{const r=uk(s,t);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let s=0;s<i.length;s++){const r=i[s];typeof r=="function"?r():uk(e[s],null)}}}}function Eo(...e){return L.useCallback(ZV(...e),e)}function $p(e,t=[]){let n=[];function i(r,o){const a=L.createContext(o),l=n.length;n=[...n,o];const c=u=>{var b;const{scope:f,children:h,...m}=u,p=((b=f==null?void 0:f[e])==null?void 0:b[l])||a,U=L.useMemo(()=>m,Object.values(m));return g(p.Provider,{value:U,children:h})};c.displayName=r+"Provider";function d(u,f){var p;const h=((p=f==null?void 0:f[e])==null?void 0:p[l])||a,m=L.useContext(h);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${u}\` must be used within \`${r}\``)}return[c,d]}const s=()=>{const r=n.map(o=>L.createContext(o));return function(a){const l=(a==null?void 0:a[e])||r;return L.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[i,dhe(s,...t)]}function dhe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(r){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const u=l(r)[`__scope${c}`];return{...a,...u}},{});return L.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var M0=L.forwardRef((e,t)=>{const{children:n,...i}=e,s=L.Children.toArray(n),r=s.find(fhe);if(r){const o=r.props.children,a=s.map(l=>l===r?L.Children.count(o)>1?L.Children.only(null):L.isValidElement(o)?o.props.children:null:l);return g(uv,{...i,ref:t,children:L.isValidElement(o)?L.cloneElement(o,void 0,a):null})}return g(uv,{...i,ref:t,children:n})});M0.displayName="Slot";var uv=L.forwardRef((e,t)=>{const{children:n,...i}=e;if(L.isValidElement(n)){const s=ghe(n),r=hhe(i,n.props);return n.type!==L.Fragment&&(r.ref=t?ZV(t,s):s),L.cloneElement(n,r)}return L.Children.count(n)>1?L.Children.only(null):null});uv.displayName="SlotClone";var uhe=({children:e})=>g(he,{children:e});function fhe(e){return L.isValidElement(e)&&e.type===uhe}function hhe(e,t){const n={...t};for(const i in t){const s=e[i],r=t[i];/^on[A-Z]/.test(i)?s&&r?n[i]=(...a)=>{r(...a),s(...a)}:s&&(n[i]=s):i==="style"?n[i]={...s,...r}:i==="className"&&(n[i]=[s,r].filter(Boolean).join(" "))}return{...e,...n}}function ghe(e){var i,s;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var mhe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ws=mhe.reduce((e,t)=>{const n=L.forwardRef((i,s)=>{const{asChild:r,...o}=i,a=r?M0:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g(a,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function phe(e,t){e&&cn.flushSync(()=>e.dispatchEvent(t))}function bl(e){const t=L.useRef(e);return L.useEffect(()=>{t.current=e}),L.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function Uhe(e,t=globalThis==null?void 0:globalThis.document){const n=bl(e);L.useEffect(()=>{const i=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var bhe="DismissableLayer",fv="dismissableLayer.update",yhe="dismissableLayer.pointerDownOutside",Ehe="dismissableLayer.focusOutside",fk,qV=L.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),QV=L.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:r,onInteractOutside:o,onDismiss:a,...l}=e,c=L.useContext(qV),[d,u]=L.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=L.useState({}),m=Eo(t,T=>u(T)),p=Array.from(c.layers),[U]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=p.indexOf(U),y=d?p.indexOf(d):-1,v=c.layersWithOutsidePointerEventsDisabled.size>0,_=y>=b,I=whe(T=>{const w=T.target,S=[...c.branches].some(x=>x.contains(w));!_||S||(s==null||s(T),o==null||o(T),T.defaultPrevented||a==null||a())},f),R=The(T=>{const w=T.target;[...c.branches].some(x=>x.contains(w))||(r==null||r(T),o==null||o(T),T.defaultPrevented||a==null||a())},f);return Uhe(T=>{y===c.layers.size-1&&(i==null||i(T),!T.defaultPrevented&&a&&(T.preventDefault(),a()))},f),L.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(fk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),hk(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=fk)}},[d,f,n,c]),L.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),hk())},[d,c]),L.useEffect(()=>{const T=()=>h({});return document.addEventListener(fv,T),()=>document.removeEventListener(fv,T)},[]),g(ws.div,{...l,ref:m,style:{pointerEvents:v?_?"auto":"none":void 0,...e.style},onFocusCapture:Oi(e.onFocusCapture,R.onFocusCapture),onBlurCapture:Oi(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Oi(e.onPointerDownCapture,I.onPointerDownCapture)})});QV.displayName=bhe;var vhe="DismissableLayerBranch",_he=L.forwardRef((e,t)=>{const n=L.useContext(qV),i=L.useRef(null),s=Eo(t,i);return L.useEffect(()=>{const r=i.current;if(r)return n.branches.add(r),()=>{n.branches.delete(r)}},[n.branches]),g(ws.div,{...e,ref:s})});_he.displayName=vhe;function whe(e,t=globalThis==null?void 0:globalThis.document){const n=bl(e),i=L.useRef(!1),s=L.useRef(()=>{});return L.useEffect(()=>{const r=a=>{if(a.target&&!i.current){let l=function(){JV(yhe,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);i.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",r)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",r),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function The(e,t=globalThis==null?void 0:globalThis.document){const n=bl(e),i=L.useRef(!1);return L.useEffect(()=>{const s=r=>{r.target&&!i.current&&JV(Ehe,n,{originalEvent:r},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function hk(){const e=new CustomEvent(fv);document.dispatchEvent(e)}function JV(e,t,n,{discrete:i}){const s=n.originalEvent.target,r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),i?phe(s,r):s.dispatchEvent(r)}var Q8=0;function Ihe(){L.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??gk()),document.body.insertAdjacentElement("beforeend",e[1]??gk()),Q8++,()=>{Q8===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Q8--}},[])}function gk(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var J8="focusScope.autoFocusOnMount",e3="focusScope.autoFocusOnUnmount",mk={bubbles:!1,cancelable:!0},She="FocusScope",e$=L.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:s,onUnmountAutoFocus:r,...o}=e,[a,l]=L.useState(null),c=bl(s),d=bl(r),u=L.useRef(null),f=Eo(t,p=>l(p)),h=L.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;L.useEffect(()=>{if(i){let p=function(v){if(h.paused||!a)return;const _=v.target;a.contains(_)?u.current=_:$l(u.current,{select:!0})},U=function(v){if(h.paused||!a)return;const _=v.relatedTarget;_!==null&&(a.contains(_)||$l(u.current,{select:!0}))},b=function(v){if(document.activeElement===document.body)for(const I of v)I.removedNodes.length>0&&$l(a)};document.addEventListener("focusin",p),document.addEventListener("focusout",U);const y=new MutationObserver(b);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",U),y.disconnect()}}},[i,a,h.paused]),L.useEffect(()=>{if(a){Uk.add(h);const p=document.activeElement;if(!a.contains(p)){const b=new CustomEvent(J8,mk);a.addEventListener(J8,c),a.dispatchEvent(b),b.defaultPrevented||(xhe(Rhe(t$(a)),{select:!0}),document.activeElement===p&&$l(a))}return()=>{a.removeEventListener(J8,c),setTimeout(()=>{const b=new CustomEvent(e3,mk);a.addEventListener(e3,d),a.dispatchEvent(b),b.defaultPrevented||$l(p??document.body,{select:!0}),a.removeEventListener(e3,d),Uk.remove(h)},0)}}},[a,c,d,h]);const m=L.useCallback(p=>{if(!n&&!i||h.paused)return;const U=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,b=document.activeElement;if(U&&b){const y=p.currentTarget,[v,_]=Che(y);v&&_?!p.shiftKey&&b===_?(p.preventDefault(),n&&$l(v,{select:!0})):p.shiftKey&&b===v&&(p.preventDefault(),n&&$l(_,{select:!0})):b===y&&p.preventDefault()}},[n,i,h.paused]);return g(ws.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});e$.displayName=She;function xhe(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if($l(i,{select:t}),document.activeElement!==n)return}function Che(e){const t=t$(e),n=pk(t,e),i=pk(t.reverse(),e);return[n,i]}function t$(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const s=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||s?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function pk(e,t){for(const n of e)if(!Ahe(n,{upTo:t}))return n}function Ahe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Mhe(e){return e instanceof HTMLInputElement&&"select"in e}function $l(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Mhe(e)&&t&&e.select()}}var Uk=khe();function khe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=bk(e,t),e.unshift(t)},remove(t){var n;e=bk(e,t),(n=e[0])==null||n.resume()}}}function bk(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function Rhe(e){return e.filter(t=>t.tagName!=="A")}var Tu=globalThis!=null&&globalThis.document?L.useLayoutEffect:()=>{},Lhe=JZ.useId||(()=>{}),Dhe=0;function tT(e){const[t,n]=L.useState(Lhe());return Tu(()=>{n(i=>i??String(Dhe++))},[e]),e||(t?`radix-${t}`:"")}const Phe=["top","right","bottom","left"],Wc=Math.min,Ws=Math.max,N6=Math.round,e2=Math.floor,Jo=e=>({x:e,y:e}),Nhe={left:"right",right:"left",bottom:"top",top:"bottom"},Ohe={start:"end",end:"start"};function hv(e,t,n){return Ws(e,Wc(t,n))}function yl(e,t){return typeof e=="function"?e(t):e}function El(e){return e.split("-")[0]}function Lg(e){return e.split("-")[1]}function nT(e){return e==="x"?"y":"x"}function iT(e){return e==="y"?"height":"width"}function Kc(e){return["top","bottom"].includes(El(e))?"y":"x"}function sT(e){return nT(Kc(e))}function Fhe(e,t,n){n===void 0&&(n=!1);const i=Lg(e),s=sT(e),r=iT(s);let o=s==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=O6(o)),[o,O6(o)]}function Bhe(e){const t=O6(e);return[gv(e),t,gv(t)]}function gv(e){return e.replace(/start|end/g,t=>Ohe[t])}function zhe(e,t,n){const i=["left","right"],s=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:i:t?i:s;case"left":case"right":return t?r:o;default:return[]}}function Hhe(e,t,n,i){const s=Lg(e);let r=zhe(El(e),n==="start",i);return s&&(r=r.map(o=>o+"-"+s),t&&(r=r.concat(r.map(gv)))),r}function O6(e){return e.replace(/left|right|bottom|top/g,t=>Nhe[t])}function Vhe(e){return{top:0,right:0,bottom:0,left:0,...e}}function n$(e){return typeof e!="number"?Vhe(e):{top:e,right:e,bottom:e,left:e}}function F6(e){const{x:t,y:n,width:i,height:s}=e;return{width:i,height:s,top:n,left:t,right:t+i,bottom:n+s,x:t,y:n}}function yk(e,t,n){let{reference:i,floating:s}=e;const r=Kc(t),o=sT(t),a=iT(o),l=El(t),c=r==="y",d=i.x+i.width/2-s.width/2,u=i.y+i.height/2-s.height/2,f=i[a]/2-s[a]/2;let h;switch(l){case"top":h={x:d,y:i.y-s.height};break;case"bottom":h={x:d,y:i.y+i.height};break;case"right":h={x:i.x+i.width,y:u};break;case"left":h={x:i.x-s.width,y:u};break;default:h={x:i.x,y:i.y}}switch(Lg(t)){case"start":h[o]-=f*(n&&c?-1:1);break;case"end":h[o]+=f*(n&&c?-1:1);break}return h}const $he=async(e,t,n)=>{const{placement:i="bottom",strategy:s="absolute",middleware:r=[],platform:o}=n,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:u}=yk(c,i,l),f=i,h={},m=0;for(let p=0;p<a.length;p++){const{name:U,fn:b}=a[p],{x:y,y:v,data:_,reset:I}=await b({x:d,y:u,initialPlacement:i,placement:f,strategy:s,middlewareData:h,rects:c,platform:o,elements:{reference:e,floating:t}});d=y??d,u=v??u,h={...h,[U]:{...h[U],..._}},I&&m<=50&&(m++,typeof I=="object"&&(I.placement&&(f=I.placement),I.rects&&(c=I.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):I.rects),{x:d,y:u}=yk(c,f,l)),p=-1)}return{x:d,y:u,placement:f,strategy:s,middlewareData:h}};async function k0(e,t){var n;t===void 0&&(t={});const{x:i,y:s,platform:r,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:f=!1,padding:h=0}=yl(t,e),m=n$(h),U=a[f?u==="floating"?"reference":"floating":u],b=F6(await r.getClippingRect({element:(n=await(r.isElement==null?void 0:r.isElement(U)))==null||n?U:U.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),y=u==="floating"?{x:i,y:s,width:o.floating.width,height:o.floating.height}:o.reference,v=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),_=await(r.isElement==null?void 0:r.isElement(v))?await(r.getScale==null?void 0:r.getScale(v))||{x:1,y:1}:{x:1,y:1},I=F6(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:v,strategy:l}):y);return{top:(b.top-I.top+m.top)/_.y,bottom:(I.bottom-b.bottom+m.bottom)/_.y,left:(b.left-I.left+m.left)/_.x,right:(I.right-b.right+m.right)/_.x}}const Ghe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:s,rects:r,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=yl(e,t)||{};if(c==null)return{};const u=n$(d),f={x:n,y:i},h=sT(s),m=iT(h),p=await o.getDimensions(c),U=h==="y",b=U?"top":"left",y=U?"bottom":"right",v=U?"clientHeight":"clientWidth",_=r.reference[m]+r.reference[h]-f[h]-r.floating[m],I=f[h]-r.reference[h],R=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let T=R?R[v]:0;(!T||!await(o.isElement==null?void 0:o.isElement(R)))&&(T=a.floating[v]||r.floating[m]);const w=_/2-I/2,S=T/2-p[m]/2-1,x=Wc(u[b],S),k=Wc(u[y],S),P=x,D=T-p[m]-k,j=T/2-p[m]/2+w,G=hv(P,j,D),V=!l.arrow&&Lg(s)!=null&&j!==G&&r.reference[m]/2-(j<P?x:k)-p[m]/2<0,B=V?j<P?j-P:j-D:0;return{[h]:f[h]+B,data:{[h]:G,centerOffset:j-G-B,...V&&{alignmentOffset:B}},reset:V}}}),Xhe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:s,middlewareData:r,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...U}=yl(e,t);if((n=r.arrow)!=null&&n.alignmentOffset)return{};const b=El(s),y=Kc(a),v=El(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),I=f||(v||!p?[O6(a)]:Bhe(a)),R=m!=="none";!f&&R&&I.push(...Hhe(a,p,m,_));const T=[a,...I],w=await k0(t,U),S=[];let x=((i=r.flip)==null?void 0:i.overflows)||[];if(d&&S.push(w[b]),u){const j=Fhe(s,o,_);S.push(w[j[0]],w[j[1]])}if(x=[...x,{placement:s,overflows:S}],!S.every(j=>j<=0)){var k,P;const j=(((k=r.flip)==null?void 0:k.index)||0)+1,G=T[j];if(G)return{data:{index:j,overflows:x},reset:{placement:G}};let V=(P=x.filter(B=>B.overflows[0]<=0).sort((B,z)=>B.overflows[1]-z.overflows[1])[0])==null?void 0:P.placement;if(!V)switch(h){case"bestFit":{var D;const B=(D=x.filter(z=>{if(R){const X=Kc(z.placement);return X===y||X==="y"}return!0}).map(z=>[z.placement,z.overflows.filter(X=>X>0).reduce((X,Y)=>X+Y,0)]).sort((z,X)=>z[1]-X[1])[0])==null?void 0:D[0];B&&(V=B);break}case"initialPlacement":V=a;break}if(s!==V)return{reset:{placement:V}}}return{}}}};function Ek(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function vk(e){return Phe.some(t=>e[t]>=0)}const jhe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...s}=yl(e,t);switch(i){case"referenceHidden":{const r=await k0(t,{...s,elementContext:"reference"}),o=Ek(r,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:vk(o)}}}case"escaped":{const r=await k0(t,{...s,altBoundary:!0}),o=Ek(r,n.floating);return{data:{escapedOffsets:o,escaped:vk(o)}}}default:return{}}}}};async function Yhe(e,t){const{placement:n,platform:i,elements:s}=e,r=await(i.isRTL==null?void 0:i.isRTL(s.floating)),o=El(n),a=Lg(n),l=Kc(n)==="y",c=["left","top"].includes(o)?-1:1,d=r&&l?-1:1,u=yl(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof m=="number"&&(h=a==="end"?m*-1:m),l?{x:h*d,y:f*c}:{x:f*c,y:h*d}}const Whe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:s,y:r,placement:o,middlewareData:a}=t,l=await Yhe(t,e);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:s+l.x,y:r+l.y,data:{...l,placement:o}}}}},Khe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:s}=t,{mainAxis:r=!0,crossAxis:o=!1,limiter:a={fn:U=>{let{x:b,y}=U;return{x:b,y}}},...l}=yl(e,t),c={x:n,y:i},d=await k0(t,l),u=Kc(El(s)),f=nT(u);let h=c[f],m=c[u];if(r){const U=f==="y"?"top":"left",b=f==="y"?"bottom":"right",y=h+d[U],v=h-d[b];h=hv(y,h,v)}if(o){const U=u==="y"?"top":"left",b=u==="y"?"bottom":"right",y=m+d[U],v=m-d[b];m=hv(y,m,v)}const p=a.fn({...t,[f]:h,[u]:m});return{...p,data:{x:p.x-n,y:p.y-i,enabled:{[f]:r,[u]:o}}}}}},Zhe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:s,rects:r,middlewareData:o}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=yl(e,t),d={x:n,y:i},u=Kc(s),f=nT(u);let h=d[f],m=d[u];const p=yl(a,t),U=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const v=f==="y"?"height":"width",_=r.reference[f]-r.floating[v]+U.mainAxis,I=r.reference[f]+r.reference[v]-U.mainAxis;h<_?h=_:h>I&&(h=I)}if(c){var b,y;const v=f==="y"?"width":"height",_=["top","left"].includes(El(s)),I=r.reference[u]-r.floating[v]+(_&&((b=o.offset)==null?void 0:b[u])||0)+(_?0:U.crossAxis),R=r.reference[u]+r.reference[v]+(_?0:((y=o.offset)==null?void 0:y[u])||0)-(_?U.crossAxis:0);m<I?m=I:m>R&&(m=R)}return{[f]:h,[u]:m}}}},qhe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:s,rects:r,platform:o,elements:a}=t,{apply:l=()=>{},...c}=yl(e,t),d=await k0(t,c),u=El(s),f=Lg(s),h=Kc(s)==="y",{width:m,height:p}=r.floating;let U,b;u==="top"||u==="bottom"?(U=u,b=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=u,U=f==="end"?"top":"bottom");const y=p-d.top-d.bottom,v=m-d.left-d.right,_=Wc(p-d[U],y),I=Wc(m-d[b],v),R=!t.middlewareData.shift;let T=_,w=I;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(w=v),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(T=y),R&&!f){const x=Ws(d.left,0),k=Ws(d.right,0),P=Ws(d.top,0),D=Ws(d.bottom,0);h?w=m-2*(x!==0||k!==0?x+k:Ws(d.left,d.right)):T=p-2*(P!==0||D!==0?P+D:Ws(d.top,d.bottom))}await l({...t,availableWidth:w,availableHeight:T});const S=await o.getDimensions(a.floating);return m!==S.width||p!==S.height?{reset:{rects:!0}}:{}}}};function _y(){return typeof window<"u"}function Dg(e){return i$(e)?(e.nodeName||"").toLowerCase():"#document"}function ar(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function pa(e){var t;return(t=(i$(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function i$(e){return _y()?e instanceof Node||e instanceof ar(e).Node:!1}function vo(e){return _y()?e instanceof Element||e instanceof ar(e).Element:!1}function ca(e){return _y()?e instanceof HTMLElement||e instanceof ar(e).HTMLElement:!1}function _k(e){return!_y()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ar(e).ShadowRoot}function Gp(e){const{overflow:t,overflowX:n,overflowY:i,display:s}=_o(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(s)}function Qhe(e){return["table","td","th"].includes(Dg(e))}function wy(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function rT(e){const t=oT(),n=vo(e)?_o(e):e;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function Jhe(e){let t=Zc(e);for(;ca(t)&&!ig(t);){if(rT(t))return t;if(wy(t))return null;t=Zc(t)}return null}function oT(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ig(e){return["html","body","#document"].includes(Dg(e))}function _o(e){return ar(e).getComputedStyle(e)}function Ty(e){return vo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Zc(e){if(Dg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_k(e)&&e.host||pa(e);return _k(t)?t.host:t}function s$(e){const t=Zc(e);return ig(t)?e.ownerDocument?e.ownerDocument.body:e.body:ca(t)&&Gp(t)?t:s$(t)}function R0(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=s$(e),r=s===((i=e.ownerDocument)==null?void 0:i.body),o=ar(s);if(r){const a=mv(o);return t.concat(o,o.visualViewport||[],Gp(s)?s:[],a&&n?R0(a):[])}return t.concat(s,R0(s,[],n))}function mv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function r$(e){const t=_o(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=ca(e),r=s?e.offsetWidth:n,o=s?e.offsetHeight:i,a=N6(n)!==r||N6(i)!==o;return a&&(n=r,i=o),{width:n,height:i,$:a}}function aT(e){return vo(e)?e:e.contextElement}function vh(e){const t=aT(e);if(!ca(t))return Jo(1);const n=t.getBoundingClientRect(),{width:i,height:s,$:r}=r$(t);let o=(r?N6(n.width):n.width)/i,a=(r?N6(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const ege=Jo(0);function o$(e){const t=ar(e);return!oT()||!t.visualViewport?ege:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function tge(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ar(e)?!1:t}function Iu(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),r=aT(e);let o=Jo(1);t&&(i?vo(i)&&(o=vh(i)):o=vh(e));const a=tge(r,n,i)?o$(r):Jo(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,d=s.width/o.x,u=s.height/o.y;if(r){const f=ar(r),h=i&&vo(i)?ar(i):i;let m=f,p=mv(m);for(;p&&i&&h!==m;){const U=vh(p),b=p.getBoundingClientRect(),y=_o(p),v=b.left+(p.clientLeft+parseFloat(y.paddingLeft))*U.x,_=b.top+(p.clientTop+parseFloat(y.paddingTop))*U.y;l*=U.x,c*=U.y,d*=U.x,u*=U.y,l+=v,c+=_,m=ar(p),p=mv(m)}}return F6({width:d,height:u,x:l,y:c})}function lT(e,t){const n=Ty(e).scrollLeft;return t?t.left+n:Iu(pa(e)).left+n}function a$(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=i.left+t.scrollLeft-(n?0:lT(e,i)),r=i.top+t.scrollTop;return{x:s,y:r}}function nge(e){let{elements:t,rect:n,offsetParent:i,strategy:s}=e;const r=s==="fixed",o=pa(i),a=t?wy(t.floating):!1;if(i===o||a&&r)return n;let l={scrollLeft:0,scrollTop:0},c=Jo(1);const d=Jo(0),u=ca(i);if((u||!u&&!r)&&((Dg(i)!=="body"||Gp(o))&&(l=Ty(i)),ca(i))){const h=Iu(i);c=vh(i),d.x=h.x+i.clientLeft,d.y=h.y+i.clientTop}const f=o&&!u&&!r?a$(o,l,!0):Jo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+f.x,y:n.y*c.y-l.scrollTop*c.y+d.y+f.y}}function ige(e){return Array.from(e.getClientRects())}function sge(e){const t=pa(e),n=Ty(e),i=e.ownerDocument.body,s=Ws(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),r=Ws(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+lT(e);const a=-n.scrollTop;return _o(i).direction==="rtl"&&(o+=Ws(t.clientWidth,i.clientWidth)-s),{width:s,height:r,x:o,y:a}}function rge(e,t){const n=ar(e),i=pa(e),s=n.visualViewport;let r=i.clientWidth,o=i.clientHeight,a=0,l=0;if(s){r=s.width,o=s.height;const c=oT();(!c||c&&t==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:r,height:o,x:a,y:l}}function oge(e,t){const n=Iu(e,!0,t==="fixed"),i=n.top+e.clientTop,s=n.left+e.clientLeft,r=ca(e)?vh(e):Jo(1),o=e.clientWidth*r.x,a=e.clientHeight*r.y,l=s*r.x,c=i*r.y;return{width:o,height:a,x:l,y:c}}function wk(e,t,n){let i;if(t==="viewport")i=rge(e,n);else if(t==="document")i=sge(pa(e));else if(vo(t))i=oge(t,n);else{const s=o$(e);i={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return F6(i)}function l$(e,t){const n=Zc(e);return n===t||!vo(n)||ig(n)?!1:_o(n).position==="fixed"||l$(n,t)}function age(e,t){const n=t.get(e);if(n)return n;let i=R0(e,[],!1).filter(a=>vo(a)&&Dg(a)!=="body"),s=null;const r=_o(e).position==="fixed";let o=r?Zc(e):e;for(;vo(o)&&!ig(o);){const a=_o(o),l=rT(o);!l&&a.position==="fixed"&&(s=null),(r?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Gp(o)&&!l&&l$(e,o))?i=i.filter(d=>d!==o):s=a,o=Zc(o)}return t.set(e,i),i}function lge(e){let{element:t,boundary:n,rootBoundary:i,strategy:s}=e;const o=[...n==="clippingAncestors"?wy(t)?[]:age(t,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,d)=>{const u=wk(t,d,s);return c.top=Ws(u.top,c.top),c.right=Wc(u.right,c.right),c.bottom=Wc(u.bottom,c.bottom),c.left=Ws(u.left,c.left),c},wk(t,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function cge(e){const{width:t,height:n}=r$(e);return{width:t,height:n}}function dge(e,t,n){const i=ca(t),s=pa(t),r=n==="fixed",o=Iu(e,!0,r,t);let a={scrollLeft:0,scrollTop:0};const l=Jo(0);if(i||!i&&!r)if((Dg(t)!=="body"||Gp(s))&&(a=Ty(t)),i){const f=Iu(t,!0,r,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else s&&(l.x=lT(s));const c=s&&!i&&!r?a$(s,a):Jo(0),d=o.left+a.scrollLeft-l.x-c.x,u=o.top+a.scrollTop-l.y-c.y;return{x:d,y:u,width:o.width,height:o.height}}function t3(e){return _o(e).position==="static"}function Tk(e,t){if(!ca(e)||_o(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return pa(e)===n&&(n=n.ownerDocument.body),n}function c$(e,t){const n=ar(e);if(wy(e))return n;if(!ca(e)){let s=Zc(e);for(;s&&!ig(s);){if(vo(s)&&!t3(s))return s;s=Zc(s)}return n}let i=Tk(e,t);for(;i&&Qhe(i)&&t3(i);)i=Tk(i,t);return i&&ig(i)&&t3(i)&&!rT(i)?n:i||Jhe(e)||n}const uge=async function(e){const t=this.getOffsetParent||c$,n=this.getDimensions,i=await n(e.floating);return{reference:dge(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function fge(e){return _o(e).direction==="rtl"}const hge={convertOffsetParentRelativeRectToViewportRelativeRect:nge,getDocumentElement:pa,getClippingRect:lge,getOffsetParent:c$,getElementRects:uge,getClientRects:ige,getDimensions:cge,getScale:vh,isElement:vo,isRTL:fge};function d$(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function gge(e,t){let n=null,i;const s=pa(e);function r(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),r();const c=e.getBoundingClientRect(),{left:d,top:u,width:f,height:h}=c;if(a||t(),!f||!h)return;const m=e2(u),p=e2(s.clientWidth-(d+f)),U=e2(s.clientHeight-(u+h)),b=e2(d),v={rootMargin:-m+"px "+-p+"px "+-U+"px "+-b+"px",threshold:Ws(0,Wc(1,l))||1};let _=!0;function I(R){const T=R[0].intersectionRatio;if(T!==l){if(!_)return o();T?o(!1,T):i=setTimeout(()=>{o(!1,1e-7)},1e3)}T===1&&!d$(c,e.getBoundingClientRect())&&o(),_=!1}try{n=new IntersectionObserver(I,{...v,root:s.ownerDocument})}catch{n=new IntersectionObserver(I,v)}n.observe(e)}return o(!0),r}function mge(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=aT(e),d=s||r?[...c?R0(c):[],...R0(t)]:[];d.forEach(b=>{s&&b.addEventListener("scroll",n,{passive:!0}),r&&b.addEventListener("resize",n)});const u=c&&a?gge(c,n):null;let f=-1,h=null;o&&(h=new ResizeObserver(b=>{let[y]=b;y&&y.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var v;(v=h)==null||v.observe(t)})),n()}),c&&!l&&h.observe(c),h.observe(t));let m,p=l?Iu(e):null;l&&U();function U(){const b=Iu(e);p&&!d$(p,b)&&n(),p=b,m=requestAnimationFrame(U)}return n(),()=>{var b;d.forEach(y=>{s&&y.removeEventListener("scroll",n),r&&y.removeEventListener("resize",n)}),u==null||u(),(b=h)==null||b.disconnect(),h=null,l&&cancelAnimationFrame(m)}}const pge=Whe,Uge=Khe,bge=Xhe,yge=qhe,Ege=jhe,Ik=Ghe,vge=Zhe,_ge=(e,t,n)=>{const i=new Map,s={platform:hge,...n},r={...s.platform,_c:i};return $he(e,t,{...s,platform:r})};var J2=typeof document<"u"?L.useLayoutEffect:L.useEffect;function B6(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!B6(e[i],t[i]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,s[i]))return!1;for(i=n;i--!==0;){const r=s[i];if(!(r==="_owner"&&e.$$typeof)&&!B6(e[r],t[r]))return!1}return!0}return e!==e&&t!==t}function u$(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Sk(e,t){const n=u$(e);return Math.round(t*n)/n}function n3(e){const t=L.useRef(e);return J2(()=>{t.current=e}),t}function wge(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:s,elements:{reference:r,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[d,u]=L.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=L.useState(i);B6(f,i)||h(i);const[m,p]=L.useState(null),[U,b]=L.useState(null),y=L.useCallback(z=>{z!==R.current&&(R.current=z,p(z))},[]),v=L.useCallback(z=>{z!==T.current&&(T.current=z,b(z))},[]),_=r||m,I=o||U,R=L.useRef(null),T=L.useRef(null),w=L.useRef(d),S=l!=null,x=n3(l),k=n3(s),P=n3(c),D=L.useCallback(()=>{if(!R.current||!T.current)return;const z={placement:t,strategy:n,middleware:f};k.current&&(z.platform=k.current),_ge(R.current,T.current,z).then(X=>{const Y={...X,isPositioned:P.current!==!1};j.current&&!B6(w.current,Y)&&(w.current=Y,cn.flushSync(()=>{u(Y)}))})},[f,t,n,k,P]);J2(()=>{c===!1&&w.current.isPositioned&&(w.current.isPositioned=!1,u(z=>({...z,isPositioned:!1})))},[c]);const j=L.useRef(!1);J2(()=>(j.current=!0,()=>{j.current=!1}),[]),J2(()=>{if(_&&(R.current=_),I&&(T.current=I),_&&I){if(x.current)return x.current(_,I,D);D()}},[_,I,D,x,S]);const G=L.useMemo(()=>({reference:R,floating:T,setReference:y,setFloating:v}),[y,v]),V=L.useMemo(()=>({reference:_,floating:I}),[_,I]),B=L.useMemo(()=>{const z={position:n,left:0,top:0};if(!V.floating)return z;const X=Sk(V.floating,d.x),Y=Sk(V.floating,d.y);return a?{...z,transform:"translate("+X+"px, "+Y+"px)",...u$(V.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:X,top:Y}},[n,a,V.floating,d.x,d.y]);return L.useMemo(()=>({...d,update:D,refs:G,elements:V,floatingStyles:B}),[d,D,G,V,B])}const Tge=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:s}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?Ik({element:i.current,padding:s}).fn(n):{}:i?Ik({element:i,padding:s}).fn(n):{}}}},Ige=(e,t)=>({...pge(e),options:[e,t]}),Sge=(e,t)=>({...Uge(e),options:[e,t]}),xge=(e,t)=>({...vge(e),options:[e,t]}),Cge=(e,t)=>({...bge(e),options:[e,t]}),Age=(e,t)=>({...yge(e),options:[e,t]}),Mge=(e,t)=>({...Ege(e),options:[e,t]}),kge=(e,t)=>({...Tge(e),options:[e,t]});var Rge="Arrow",f$=L.forwardRef((e,t)=>{const{children:n,width:i=10,height:s=5,...r}=e;return g(ws.svg,{...r,ref:t,width:i,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:g("polygon",{points:"0,0 30,0 15,10"})})});f$.displayName=Rge;var Lge=f$;function Dge(e){const[t,n]=L.useState(void 0);return Tu(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const r=s[0];let o,a;if("borderBoxSize"in r){const l=r.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=e.offsetWidth,a=e.offsetHeight;n({width:o,height:a})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var cT="Popper",[h$,g$]=$p(cT),[Pge,m$]=h$(cT),p$=e=>{const{__scopePopper:t,children:n}=e,[i,s]=L.useState(null);return g(Pge,{scope:t,anchor:i,onAnchorChange:s,children:n})};p$.displayName=cT;var U$="PopperAnchor",b$=L.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...s}=e,r=m$(U$,n),o=L.useRef(null),a=Eo(t,o);return L.useEffect(()=>{r.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:g(ws.div,{...s,ref:a})});b$.displayName=U$;var dT="PopperContent",[Nge,Oge]=h$(dT),y$=L.forwardRef((e,t)=>{var Ne,et,Ot,Xe,je,Jt;const{__scopePopper:n,side:i="bottom",sideOffset:s=0,align:r="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:u="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...p}=e,U=m$(dT,n),[b,y]=L.useState(null),v=Eo(t,yt=>y(yt)),[_,I]=L.useState(null),R=Dge(_),T=(R==null?void 0:R.width)??0,w=(R==null?void 0:R.height)??0,S=i+(r!=="center"?"-"+r:""),x=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},k=Array.isArray(c)?c:[c],P=k.length>0,D={padding:x,boundary:k.filter(Bge),altBoundary:P},{refs:j,floatingStyles:G,placement:V,isPositioned:B,middlewareData:z}=wge({strategy:"fixed",placement:S,whileElementsMounted:(...yt)=>mge(...yt,{animationFrame:h==="always"}),elements:{reference:U.anchor},middleware:[Ige({mainAxis:s+w,alignmentAxis:o}),l&&Sge({mainAxis:!0,crossAxis:!1,limiter:u==="partial"?xge():void 0,...D}),l&&Cge({...D}),Age({...D,apply:({elements:yt,rects:ss,availableWidth:Gr,availableHeight:ba})=>{const{width:It,height:ui}=ss.reference,Ts=yt.floating.style;Ts.setProperty("--radix-popper-available-width",`${Gr}px`),Ts.setProperty("--radix-popper-available-height",`${ba}px`),Ts.setProperty("--radix-popper-anchor-width",`${It}px`),Ts.setProperty("--radix-popper-anchor-height",`${ui}px`)}}),_&&kge({element:_,padding:a}),zge({arrowWidth:T,arrowHeight:w}),f&&Mge({strategy:"referenceHidden",...D})]}),[X,Y]=_$(V),ee=bl(m);Tu(()=>{B&&(ee==null||ee())},[B,ee]);const se=(Ne=z.arrow)==null?void 0:Ne.x,oe=(et=z.arrow)==null?void 0:et.y,Fe=((Ot=z.arrow)==null?void 0:Ot.centerOffset)!==0,[Ge,Me]=L.useState();return Tu(()=>{b&&Me(window.getComputedStyle(b).zIndex)},[b]),g("div",{ref:j.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:B?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ge,"--radix-popper-transform-origin":[(Xe=z.transformOrigin)==null?void 0:Xe.x,(je=z.transformOrigin)==null?void 0:je.y].join(" "),...((Jt=z.hide)==null?void 0:Jt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:g(Nge,{scope:n,placedSide:X,onArrowChange:I,arrowX:se,arrowY:oe,shouldHideArrow:Fe,children:g(ws.div,{"data-side":X,"data-align":Y,...p,ref:v,style:{...p.style,animation:B?void 0:"none"}})})})});y$.displayName=dT;var E$="PopperArrow",Fge={top:"bottom",right:"left",bottom:"top",left:"right"},v$=L.forwardRef(function(t,n){const{__scopePopper:i,...s}=t,r=Oge(E$,i),o=Fge[r.placedSide];return g("span",{ref:r.onArrowChange,style:{position:"absolute",left:r.arrowX,top:r.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[r.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[r.placedSide],visibility:r.shouldHideArrow?"hidden":void 0},children:g(Lge,{...s,ref:n,style:{...s.style,display:"block"}})})});v$.displayName=E$;function Bge(e){return e!==null}var zge=e=>({name:"transformOrigin",options:e,fn(t){var U,b,y;const{placement:n,rects:i,middlewareData:s}=t,o=((U=s.arrow)==null?void 0:U.centerOffset)!==0,a=o?0:e.arrowWidth,l=o?0:e.arrowHeight,[c,d]=_$(n),u={start:"0%",center:"50%",end:"100%"}[d],f=(((b=s.arrow)==null?void 0:b.x)??0)+a/2,h=(((y=s.arrow)==null?void 0:y.y)??0)+l/2;let m="",p="";return c==="bottom"?(m=o?u:`${f}px`,p=`${-l}px`):c==="top"?(m=o?u:`${f}px`,p=`${i.floating.height+l}px`):c==="right"?(m=`${-l}px`,p=o?u:`${h}px`):c==="left"&&(m=`${i.floating.width+l}px`,p=o?u:`${h}px`),{data:{x:m,y:p}}}});function _$(e){const[t,n="center"]=e.split("-");return[t,n]}var Hge=p$,w$=b$,Vge=y$,$ge=v$,Gge="Portal",T$=L.forwardRef((e,t)=>{var a;const{container:n,...i}=e,[s,r]=L.useState(!1);Tu(()=>r(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?sq.createPortal(g(ws.div,{...i,ref:t}),o):null});T$.displayName=Gge;function Xge(e,t){return L.useReducer((n,i)=>t[n][i]??n,e)}var Iy=e=>{const{present:t,children:n}=e,i=jge(t),s=typeof n=="function"?n({present:i.isPresent}):L.Children.only(n),r=Eo(i.ref,Yge(s));return typeof n=="function"||i.isPresent?L.cloneElement(s,{ref:r}):null};Iy.displayName="Presence";function jge(e){const[t,n]=L.useState(),i=L.useRef({}),s=L.useRef(e),r=L.useRef("none"),o=e?"mounted":"unmounted",[a,l]=Xge(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return L.useEffect(()=>{const c=t2(i.current);r.current=a==="mounted"?c:"none"},[a]),Tu(()=>{const c=i.current,d=s.current;if(d!==e){const f=r.current,h=t2(c);e?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(d&&f!==h?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),Tu(()=>{if(t){let c;const d=t.ownerDocument.defaultView??window,u=h=>{const p=t2(i.current).includes(h.animationName);if(h.target===t&&p&&(l("ANIMATION_END"),!s.current)){const U=t.style.animationFillMode;t.style.animationFillMode="forwards",c=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=U)})}},f=h=>{h.target===t&&(r.current=t2(i.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{d.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:L.useCallback(c=>{c&&(i.current=getComputedStyle(c)),n(c)},[])}}function t2(e){return(e==null?void 0:e.animationName)||"none"}function Yge(e){var i,s;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function uT({prop:e,defaultProp:t,onChange:n=()=>{}}){const[i,s]=Wge({defaultProp:t,onChange:n}),r=e!==void 0,o=r?e:i,a=bl(n),l=L.useCallback(c=>{if(r){const u=typeof c=="function"?c(e):c;u!==e&&a(u)}else s(c)},[r,e,s,a]);return[o,l]}function Wge({defaultProp:e,onChange:t}){const n=L.useState(e),[i]=n,s=L.useRef(i),r=bl(t);return L.useEffect(()=>{s.current!==i&&(r(i),s.current=i)},[i,s,r]),n}var Kge=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},uf=new WeakMap,n2=new WeakMap,i2={},i3=0,I$=function(e){return e&&(e.host||I$(e.parentNode))},Zge=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=I$(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},qge=function(e,t,n,i){var s=Zge(t,Array.isArray(e)?e:[e]);i2[n]||(i2[n]=new WeakMap);var r=i2[n],o=[],a=new Set,l=new Set(s),c=function(u){!u||a.has(u)||(a.add(u),c(u.parentNode))};s.forEach(c);var d=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(f){if(a.has(f))d(f);else try{var h=f.getAttribute(i),m=h!==null&&h!=="false",p=(uf.get(f)||0)+1,U=(r.get(f)||0)+1;uf.set(f,p),r.set(f,U),o.push(f),p===1&&m&&n2.set(f,!0),U===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return d(t),a.clear(),i3++,function(){o.forEach(function(u){var f=uf.get(u)-1,h=r.get(u)-1;uf.set(u,f),r.set(u,h),f||(n2.has(u)||u.removeAttribute(i),n2.delete(u)),h||u.removeAttribute(n)}),i3--,i3||(uf=new WeakMap,uf=new WeakMap,n2=new WeakMap,i2={})}},Qge=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),s=Kge(e);return s?(i.push.apply(i,Array.from(s.querySelectorAll("[aria-live]"))),qge(i,s,n,"aria-hidden")):function(){return null}},Ho=function(){return Ho=Object.assign||function(t){for(var n,i=1,s=arguments.length;i<s;i++){n=arguments[i];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ho.apply(this,arguments)};function S$(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n}function Jge(e,t,n){if(n||arguments.length===2)for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var eb="right-scroll-bar-position",tb="width-before-scroll-bar",e1e="with-scroll-bars-hidden",t1e="--removed-body-scroll-bar-size";function s3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function n1e(e,t){var n=L.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var s=n.value;s!==i&&(n.value=i,n.callback(i,s))}}}})[0];return n.callback=t,n.facade}var i1e=typeof window<"u"?L.useLayoutEffect:L.useEffect,xk=new WeakMap;function s1e(e,t){var n=n1e(null,function(i){return e.forEach(function(s){return s3(s,i)})});return i1e(function(){var i=xk.get(n);if(i){var s=new Set(i),r=new Set(e),o=n.current;s.forEach(function(a){r.has(a)||s3(a,null)}),r.forEach(function(a){s.has(a)||s3(a,o)})}xk.set(n,e)},[e]),n}function r1e(e){return e}function o1e(e,t){t===void 0&&(t=r1e);var n=[],i=!1,s={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(r){var o=t(r,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(r){for(i=!0;n.length;){var o=n;n=[],o.forEach(r)}n={push:function(a){return r(a)},filter:function(){return n}}},assignMedium:function(r){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(r),o=n}var l=function(){var d=o;o=[],d.forEach(r)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(d){o.push(d),c()},filter:function(d){return o=o.filter(d),n}}}};return s}function a1e(e){e===void 0&&(e={});var t=o1e(null);return t.options=Ho({async:!0,ssr:!1},e),t}var x$=function(e){var t=e.sideCar,n=S$(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return L.createElement(i,Ho({},n))};x$.isSideCarExport=!0;function l1e(e,t){return e.useMedium(t),x$}var C$=a1e(),r3=function(){},Sy=L.forwardRef(function(e,t){var n=L.useRef(null),i=L.useState({onScrollCapture:r3,onWheelCapture:r3,onTouchMoveCapture:r3}),s=i[0],r=i[1],o=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,d=e.enabled,u=e.shards,f=e.sideCar,h=e.noIsolation,m=e.inert,p=e.allowPinchZoom,U=e.as,b=U===void 0?"div":U,y=e.gapMode,v=S$(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=f,I=s1e([n,t]),R=Ho(Ho({},v),s);return L.createElement(L.Fragment,null,d&&L.createElement(_,{sideCar:C$,removeScrollBar:c,shards:u,noIsolation:h,inert:m,setCallbacks:r,allowPinchZoom:!!p,lockRef:n,gapMode:y}),o?L.cloneElement(L.Children.only(a),Ho(Ho({},R),{ref:I})):L.createElement(b,Ho({},R,{className:l,ref:I}),a))});Sy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Sy.classNames={fullWidth:tb,zeroRight:eb};var c1e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function d1e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=c1e();return t&&e.setAttribute("nonce",t),e}function u1e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function f1e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var h1e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=d1e())&&(u1e(t,n),f1e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},g1e=function(){var e=h1e();return function(t,n){L.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},A$=function(){var e=g1e(),t=function(n){var i=n.styles,s=n.dynamic;return e(i,s),null};return t},m1e={left:0,top:0,right:0,gap:0},o3=function(e){return parseInt(e||"",10)||0},p1e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[o3(n),o3(i),o3(s)]},U1e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return m1e;var t=p1e(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},b1e=A$(),_h="data-scroll-locked",y1e=function(e,t,n,i){var s=e.left,r=e.top,o=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(e1e,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(_h,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(r,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(eb,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(tb,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(eb," .").concat(eb,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(tb," .").concat(tb,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(_h,`] {
    `).concat(t1e,": ").concat(a,`px;
  }
`)},Ck=function(){var e=parseInt(document.body.getAttribute(_h)||"0",10);return isFinite(e)?e:0},E1e=function(){L.useEffect(function(){return document.body.setAttribute(_h,(Ck()+1).toString()),function(){var e=Ck()-1;e<=0?document.body.removeAttribute(_h):document.body.setAttribute(_h,e.toString())}},[])},v1e=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,s=i===void 0?"margin":i;E1e();var r=L.useMemo(function(){return U1e(s)},[s]);return L.createElement(b1e,{styles:y1e(r,!t,s,n?"":"!important")})},pv=!1;if(typeof window<"u")try{var s2=Object.defineProperty({},"passive",{get:function(){return pv=!0,!0}});window.addEventListener("test",s2,s2),window.removeEventListener("test",s2,s2)}catch{pv=!1}var ff=pv?{passive:!1}:!1,_1e=function(e){return e.tagName==="TEXTAREA"},M$=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!_1e(e)&&n[t]==="visible")},w1e=function(e){return M$(e,"overflowY")},T1e=function(e){return M$(e,"overflowX")},Ak=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var s=k$(e,i);if(s){var r=R$(e,i),o=r[1],a=r[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},I1e=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},S1e=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},k$=function(e,t){return e==="v"?w1e(t):T1e(t)},R$=function(e,t){return e==="v"?I1e(t):S1e(t)},x1e=function(e,t){return e==="h"&&t==="rtl"?-1:1},C1e=function(e,t,n,i,s){var r=x1e(e,window.getComputedStyle(t).direction),o=r*i,a=n.target,l=t.contains(a),c=!1,d=o>0,u=0,f=0;do{var h=R$(e,a),m=h[0],p=h[1],U=h[2],b=p-U-r*m;(m||b)&&k$(e,a)&&(u+=b,f+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(d&&Math.abs(u)<1||!d&&Math.abs(f)<1)&&(c=!0),c},r2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Mk=function(e){return[e.deltaX,e.deltaY]},kk=function(e){return e&&"current"in e?e.current:e},A1e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},M1e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},k1e=0,hf=[];function R1e(e){var t=L.useRef([]),n=L.useRef([0,0]),i=L.useRef(),s=L.useState(k1e++)[0],r=L.useState(A$)[0],o=L.useRef(e);L.useEffect(function(){o.current=e},[e]),L.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var p=Jge([e.lockRef.current],(e.shards||[]).map(kk),!0).filter(Boolean);return p.forEach(function(U){return U.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),p.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=L.useCallback(function(p,U){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!o.current.allowPinchZoom;var b=r2(p),y=n.current,v="deltaX"in p?p.deltaX:y[0]-b[0],_="deltaY"in p?p.deltaY:y[1]-b[1],I,R=p.target,T=Math.abs(v)>Math.abs(_)?"h":"v";if("touches"in p&&T==="h"&&R.type==="range")return!1;var w=Ak(T,R);if(!w)return!0;if(w?I=T:(I=T==="v"?"h":"v",w=Ak(T,R)),!w)return!1;if(!i.current&&"changedTouches"in p&&(v||_)&&(i.current=I),!I)return!0;var S=i.current||I;return C1e(S,U,p,S==="h"?v:_)},[]),l=L.useCallback(function(p){var U=p;if(!(!hf.length||hf[hf.length-1]!==r)){var b="deltaY"in U?Mk(U):r2(U),y=t.current.filter(function(I){return I.name===U.type&&(I.target===U.target||U.target===I.shadowParent)&&A1e(I.delta,b)})[0];if(y&&y.should){U.cancelable&&U.preventDefault();return}if(!y){var v=(o.current.shards||[]).map(kk).filter(Boolean).filter(function(I){return I.contains(U.target)}),_=v.length>0?a(U,v[0]):!o.current.noIsolation;_&&U.cancelable&&U.preventDefault()}}},[]),c=L.useCallback(function(p,U,b,y){var v={name:p,delta:U,target:b,should:y,shadowParent:L1e(b)};t.current.push(v),setTimeout(function(){t.current=t.current.filter(function(_){return _!==v})},1)},[]),d=L.useCallback(function(p){n.current=r2(p),i.current=void 0},[]),u=L.useCallback(function(p){c(p.type,Mk(p),p.target,a(p,e.lockRef.current))},[]),f=L.useCallback(function(p){c(p.type,r2(p),p.target,a(p,e.lockRef.current))},[]);L.useEffect(function(){return hf.push(r),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:f}),document.addEventListener("wheel",l,ff),document.addEventListener("touchmove",l,ff),document.addEventListener("touchstart",d,ff),function(){hf=hf.filter(function(p){return p!==r}),document.removeEventListener("wheel",l,ff),document.removeEventListener("touchmove",l,ff),document.removeEventListener("touchstart",d,ff)}},[]);var h=e.removeScrollBar,m=e.inert;return L.createElement(L.Fragment,null,m?L.createElement(r,{styles:M1e(s)}):null,h?L.createElement(v1e,{gapMode:e.gapMode}):null)}function L1e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const D1e=l1e(C$,R1e);var L$=L.forwardRef(function(e,t){return L.createElement(Sy,Ho({},e,{ref:t,sideCar:D1e}))});L$.classNames=Sy.classNames;var fT="Popover",[D$,sAe]=$p(fT,[g$]),Xp=g$(),[P1e,hd]=D$(fT),P$=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:s,onOpenChange:r,modal:o=!1}=e,a=Xp(t),l=L.useRef(null),[c,d]=L.useState(!1),[u=!1,f]=uT({prop:i,defaultProp:s,onChange:r});return g(Hge,{...a,children:g(P1e,{scope:t,contentId:tT(),triggerRef:l,open:u,onOpenChange:f,onOpenToggle:L.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:c,onCustomAnchorAdd:L.useCallback(()=>d(!0),[]),onCustomAnchorRemove:L.useCallback(()=>d(!1),[]),modal:o,children:n})})};P$.displayName=fT;var N$="PopoverAnchor",N1e=L.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=hd(N$,n),r=Xp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=s;return L.useEffect(()=>(o(),()=>a()),[o,a]),g(w$,{...r,...i,ref:t})});N1e.displayName=N$;var O$="PopoverTrigger",F$=L.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=hd(O$,n),r=Xp(n),o=Eo(t,s.triggerRef),a=g(ws.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":G$(s.open),...i,ref:o,onClick:Oi(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?a:g(w$,{asChild:!0,...r,children:a})});F$.displayName=O$;var hT="PopoverPortal",[O1e,F1e]=D$(hT,{forceMount:void 0}),B$=e=>{const{__scopePopover:t,forceMount:n,children:i,container:s}=e,r=hd(hT,t);return g(O1e,{scope:t,forceMount:n,children:g(Iy,{present:n||r.open,children:g(T$,{asChild:!0,container:s,children:i})})})};B$.displayName=hT;var sg="PopoverContent",z$=L.forwardRef((e,t)=>{const n=F1e(sg,e.__scopePopover),{forceMount:i=n.forceMount,...s}=e,r=hd(sg,e.__scopePopover);return g(Iy,{present:i||r.open,children:r.modal?g(B1e,{...s,ref:t}):g(z1e,{...s,ref:t})})});z$.displayName=sg;var B1e=L.forwardRef((e,t)=>{const n=hd(sg,e.__scopePopover),i=L.useRef(null),s=Eo(t,i),r=L.useRef(!1);return L.useEffect(()=>{const o=i.current;if(o)return Qge(o)},[]),g(L$,{as:M0,allowPinchZoom:!0,children:g(H$,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Oi(e.onCloseAutoFocus,o=>{var a;o.preventDefault(),r.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Oi(e.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;r.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Oi(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),z1e=L.forwardRef((e,t)=>{const n=hd(sg,e.__scopePopover),i=L.useRef(!1),s=L.useRef(!1);return g(H$,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:r=>{var o,a;(o=e.onCloseAutoFocus)==null||o.call(e,r),r.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),r.preventDefault()),i.current=!1,s.current=!1},onInteractOutside:r=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,r),r.defaultPrevented||(i.current=!0,r.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=r.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&r.preventDefault(),r.detail.originalEvent.type==="focusin"&&s.current&&r.preventDefault()}})}),H$=L.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:r,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:d,...u}=e,f=hd(sg,n),h=Xp(n);return Ihe(),g(e$,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:s,onUnmountAutoFocus:r,children:g(QV,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:g(Vge,{"data-state":G$(f.open),role:"dialog",id:f.contentId,...h,...u,ref:t,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),V$="PopoverClose",H1e=L.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=hd(V$,n);return g(ws.button,{type:"button",...i,ref:t,onClick:Oi(e.onClick,()=>s.onOpenChange(!1))})});H1e.displayName=V$;var V1e="PopoverArrow",$$=L.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=Xp(n);return g($ge,{...s,...i,ref:t})});$$.displayName=V1e;function G$(e){return e?"open":"closed"}var Al=P$,Ml=F$,$1e=B$,xy=z$,X$=$$;const j$=()=>g("div",{style:{width:1,height:"1rem",backgroundColor:"var(--default-border-color)",margin:"0 auto"}}),Y$=de.createContext(null),di=()=>de.useContext(Y$),W$=e=>{const[t,n]=L.useState(null),i=Hn(),{theme:s}=di(),{container:r}=Fs();return L.useLayoutEffect(()=>{var o;t&&(t.className="",t.classList.add("excalidraw",...((o=e==null?void 0:e.className)==null?void 0:o.split(/\s+/))||[]),t.classList.toggle("excalidraw--mobile",i.formFactor==="phone"),t.classList.toggle("theme--dark",s===Se.DARK))},[t,s,i.formFactor,e==null?void 0:e.className]),L.useLayoutEffect(()=>{const o=e!=null&&e.parentSelector?r==null?void 0:r.querySelector(e.parentSelector):document.body;if(!o)return;const a=document.createElement("div");return o.appendChild(a),n(a),()=>{o.removeChild(a)}},[r,e==null?void 0:e.parentSelector]),t};function gT(e,t,n){L.useEffect(()=>{function i(s){const r=s;if(!e.current)return;const o=n==null?void 0:n(r,e.current);if(o===!0)return;if(o===!1)return t(r);e.current.contains(r.target)||!document.documentElement.contains(r.target)||r.target.closest("[data-radix-portal]")||r.target===document.documentElement&&document.body.style.pointerEvents==="none"||r.target.closest("[data-prevent-outside-click]")||t(r)}return document.addEventListener(te.POINTER_DOWN,i),document.addEventListener(te.TOUCH_START,i),()=>{document.removeEventListener(te.POINTER_DOWN,i),document.removeEventListener(te.TOUCH_START,i)}},[e,t,n])}const Cy=e=>{const t=L.useRef(e);return Object.assign(t.current,e),t.current},Ay=Wt(null),G1e=({onCancel:e,onChange:t,onSelect:n,colorPickerType:i})=>{const s=W$({className:"excalidraw-eye-dropper-backdrop",parentSelector:".excalidraw-eye-dropper-container"}),r=di(),o=sE(),a=So(),l=Ye(o,r),c=Cy({app:a,onCancel:e,onChange:t,onSelect:n,selectedElements:l}),{container:d}=Fs();L.useEffect(()=>{const f=u.current;if(!f||!a.canvas||!s)return;let h=!1;const m=a.canvas.getContext("2d"),p=({clientX:R,clientY:T})=>{const w=m.getImageData((R-r.offsetLeft)*window.devicePixelRatio,(T-r.offsetTop)*window.devicePixelRatio,1,1).data;return ree(w[0],w[1],w[2])},U=({clientX:R,clientY:T,altKey:w})=>{f.style.top=`${T+20}px`,f.style.left=`${R+20}px`;const S=p({clientX:R,clientY:T});h&&c.onChange(i,S,c.selectedElements,{altKey:w}),f.style.background=S},b=()=>{c.onCancel()},y=(R,T)=>{c.onSelect(R,T)},v=R=>{h=!0,R.stopImmediatePropagation()},_=R=>{h=!1,d==null||d.focus(),R.stopImmediatePropagation(),R.preventDefault(),y(p(R),R)},I=R=>{R.key===$.ESCAPE&&(R.preventDefault(),R.stopImmediatePropagation(),b())};return s.tabIndex=-1,s.focus(),U({clientX:c.app.lastViewportPosition.x,clientY:c.app.lastViewportPosition.y,altKey:!1}),s.addEventListener(te.KEYDOWN,I),s.addEventListener(te.POINTER_DOWN,v),s.addEventListener(te.POINTER_UP,_),window.addEventListener("pointermove",U,{passive:!0}),window.addEventListener(te.BLUR,b),()=>{h=!1,s.removeEventListener(te.KEYDOWN,I),s.removeEventListener(te.POINTER_DOWN,v),s.removeEventListener(te.POINTER_UP,_),window.removeEventListener("pointermove",U),window.removeEventListener(te.BLUR,b)}},[c,a.canvas,s,i,d,r.offsetLeft,r.offsetTop]);const u=L.useRef(null);return gT(u,()=>{e()},f=>!!f.target.closest(".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop")),s?cn.createPortal(g("div",{ref:u,className:"excalidraw-eye-dropper-preview"}),s):null},Ar=de.forwardRef(({children:e,padding:t,className:n,style:i},s)=>g("div",{className:le("Island",n),style:{"--padding":t,...i},ref:s,children:e})),Pg=de.forwardRef(({className:e,container:t,children:n,style:i,onClose:s,onKeyDown:r,onFocusOutside:o,onPointerLeave:a,onPointerDownOutside:l,preventAutoFocusOnTouch:c=!1},d)=>{const u=Hn(),f=u.formFactor==="phone"&&!u.isLandscape;return g($1e,{container:t,children:N(xy,{ref:d,className:le("focus-visible-none",e),"data-prevent-outside-click":!0,side:f?"bottom":"right",align:f?"center":"start",alignOffset:-16,sideOffset:20,collisionBoundary:t??void 0,style:{zIndex:"var(--zIndex-ui-styles-popup)",marginLeft:u.formFactor==="phone"?"0.5rem":void 0},onPointerLeave:a,onKeyDown:r,onFocusOutside:o,onPointerDownOutside:l,onOpenAutoFocus:h=>{c&&u.isTouchScreen&&h.preventDefault()},onCloseAutoFocus:h=>{h.stopPropagation(),h.preventDefault(),t&&!bte(document.activeElement)&&t.focus(),s()},children:[g(Ar,{padding:3,style:i,children:n}),g(X$,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})}),My=()=>document.querySelector(".excalidraw-wysiwyg"),mT=()=>{const e=My();return e?{start:e.selectionStart,end:e.selectionEnd}:null},pT=e=>{setTimeout(()=>{const t=My();t&&(t.focus(),e&&(t.selectionStart=e.start,t.selectionEnd=e.end))},0)},ky=(e,t,n,i)=>{t&&i&&i();const s=t&&n?mT():null;e(),t&&n&&pT(s)},X1e=()=>{const[e,t]=L.useState(null),n=L.useCallback(()=>{const r=mT();t(r)},[]),i=L.useCallback(()=>{setTimeout(()=>{const r=My();r&&(r.focus(),e&&(r.selectionStart=e.start,r.selectionEnd=e.end,t(null)))},0)},[e]),s=L.useCallback(()=>{t(null)},[]);return{saveCaretPosition:n,restoreCaretPosition:i,clearSavedPosition:s,hasSavedPosition:!!e}},j1e=(e=100)=>{const t=My();if(t){const n=t.onblur;t.onblur=null,setTimeout(()=>{t.onblur=n},e)}},Ry=({palette:e,color:t})=>{if(!t)return null;for(const[n,i]of Object.entries(e))if(Array.isArray(i)){const s=i.indexOf(t);if(s>-1)return{colorName:n,shade:s}}else if(i===t)return{colorName:n,shade:null};return null},Uv=[["q","w","e","r","t"],["a","s","d","f","g"],["z","x","c","v","b"]].flat(),K$=({color:e,palette:t})=>!Object.values(t).flat().includes(e),Y1e=(e,t,n)=>{const i={elementBackground:"backgroundColor",elementStroke:"strokeColor"},s=e.filter(o=>{if(o.isDeleted)return!1;const a=o[i[t]];return K$({color:a,palette:n})}),r=new Map;return s.forEach(o=>{const a=o[i[t]];r.has(a)?r.set(a,r.get(a)+1):r.set(a,1)}),[...r.entries()].sort((o,a)=>a[1]-o[1]).map(o=>o[0]).slice(0,eee)},Ng=Wt(null),Rk=(e,t,n)=>(e*299+t*587+n*114)/1e3,z6=(e,t=160)=>{if(!e)return!0;if(e==="transparent")return!1;if(!e.startsWith("#")){const r=document.createElement("div");if(r.style.color=e,r.style.color){r.style.position="absolute",r.style.visibility="hidden",r.style.width="0",r.style.height="0",document.body.appendChild(r);const o=getComputedStyle(r).color;document.body.removeChild(r);const a=o.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),l=parseInt(a[0]),c=parseInt(a[1]),d=parseInt(a[2]);return Rk(l,c,d)<t}return!0}const n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);return Rk(n,i,s)<t},W1e=({color:e,onChange:t,label:n,colorPickerType:i,placeholder:s})=>{const r=Hn(),[o,a]=L.useState(e),[l,c]=gn(Ng);L.useEffect(()=>{a(e)},[e]);const d=L.useCallback(p=>{const U=p.toLowerCase(),b=nme(U);b&&t(b),a(U)},[t]),u=L.useRef(null),f=L.useRef(null);L.useEffect(()=>{u.current&&u.current.focus()},[l]);const[h,m]=gn(Ay);return L.useEffect(()=>()=>{m(null)},[m]),N("div",{className:"color-picker__input-label",children:[g("div",{className:"color-picker__input-hash",children:"#"}),g("input",{ref:l==="hex"?u:void 0,style:{border:0,padding:0},spellCheck:!1,className:"color-picker-input","aria-label":n,onChange:p=>{d(p.target.value)},value:(o||"").replace(/^#/,""),onBlur:()=>{a(e)},tabIndex:-1,onFocus:()=>c("hex"),onKeyDown:p=>{var U;p.key!==$.TAB&&(p.key===$.ESCAPE&&((U=f.current)==null||U.focus()),p.stopPropagation())},placeholder:s}),r.formFactor!=="phone"&&N(he,{children:[g("div",{style:{width:"1px",height:"1.25rem",backgroundColor:"var(--default-border-color)"}}),g("div",{ref:f,className:le("excalidraw-eye-dropper-trigger",{selected:h}),onClick:()=>m(p=>p?null:{keepOpenOnAlt:!1,onSelect:U=>t(U),colorPickerType:i}),title:`${M("labels.eyeDropper")}  ${$.I.toLocaleUpperCase()} or ${Q("Alt")} `,children:xfe})]})]})},UT=({color:e,keyLabel:t,isShade:n=!1})=>N("div",{className:"color-picker__button__hotkey-label",style:{color:z6(e)?"#fff":"#000"},children:[n&&"",t]}),K1e=({colors:e,color:t,onChange:n,label:i})=>{const[s,r]=gn(Ng),o=L.useRef(null);return L.useEffect(()=>{o.current&&o.current.focus()},[t,s]),g("div",{className:"color-picker-content--default",children:e.map((a,l)=>N("button",{ref:t===a?o:void 0,tabIndex:-1,type:"button",className:le("color-picker__button color-picker__button--large has-outline",{active:t===a,"is-transparent":a==="transparent"||!a}),onClick:()=>{n(a),r("custom")},title:a,"aria-label":i,style:{"--swatch-color":a},children:[g("div",{className:"color-picker__button-outline"}),g(UT,{color:a,keyLabel:l+1})]},l))})},Z1e=({palette:e,color:t,onChange:n,activeShade:i,showHotKey:s=!0})=>{const r=Ry({color:t,palette:e}),[o,a]=gn(Ng),l=L.useRef(null);return L.useEffect(()=>{l.current&&o==="baseColors"&&l.current.focus()},[r==null?void 0:r.colorName,o]),g("div",{className:"color-picker-content--default",children:Object.entries(e).map(([c,d],u)=>{const f=(Array.isArray(d)?d[i]:d)||"transparent",h=Uv[u],m=M(`colors.${c.replace(/\d+/,"")}`,null,"");return N("button",{ref:(r==null?void 0:r.colorName)===c?l:void 0,tabIndex:-1,type:"button",className:le("color-picker__button color-picker__button--large has-outline",{active:(r==null?void 0:r.colorName)===c,"is-transparent":f==="transparent"||!1}),onClick:()=>{n(f),a("baseColors")},title:`${m}${f.startsWith("#")?` ${f}`:""}  ${h}`,"aria-label":`${m}  ${h}`,style:{"--swatch-color":f},"data-testid":`color-${c}`,children:[g("div",{className:"color-picker__button-outline"}),s&&g(UT,{color:f,keyLabel:h})]},c)})})},nb=({children:e})=>g("div",{className:"color-picker__heading",children:e}),q1e=({color:e,onChange:t,palette:n,showHotKey:i})=>{const s=Ry({color:e||"transparent",palette:n}),[r,o]=gn(Ng),a=L.useRef(null);if(L.useEffect(()=>{a.current&&r==="shades"&&a.current.focus()},[s,r]),s){const{colorName:l,shade:c}=s,d=n[l];if(Array.isArray(d))return g("div",{className:"color-picker-content--default shades",children:d.map((u,f)=>N("button",{ref:f===c&&r==="shades"?a:void 0,tabIndex:-1,type:"button",className:le("color-picker__button color-picker__button--large has-outline",{active:f===c}),"aria-label":"Shade",title:`${l} - ${f+1}`,style:u?{"--swatch-color":u}:void 0,onClick:()=>{t(u),o("shades")},children:[g("div",{className:"color-picker__button-outline"}),i&&g(UT,{color:u,keyLabel:f+1,isShade:!0})]},f))})}return N("div",{className:"color-picker-content--default",style:{position:"relative"},tabIndex:-1,children:[g("button",{type:"button",tabIndex:-1,className:"color-picker__button color-picker__button--large color-picker__button--no-focus-visible"}),g("div",{tabIndex:-1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.75rem"},children:M("colorPicker.noShades")})]})},a3=(e,t,n)=>{const i=Math.ceil(n/wf);switch(t=t??-1,e){case"ArrowLeft":{const s=t-1;return s<0?n-1:s}case"ArrowRight":return(t+1)%n;case"ArrowDown":{const s=t+wf;return s>=n?t%wf:s}case"ArrowUp":{const s=t-wf,r=s<0?wf*i+s:s;return r>=n?void 0:r}}},Q1e=({e,colorObj:t,onChange:n,palette:i,customColors:s,setActiveColorPickerSection:r,activeShade:o})=>{if((t==null?void 0:t.shade)!=null&&["Digit1","Digit2","Digit3","Digit4","Digit5"].includes(e.code)&&e.shiftKey){const a=Number(e.code.slice(-1))-1;return n(i[t.colorName][a]),r("shades"),!0}if(["1","2","3","4","5"].includes(e.key)&&s[Number(e.key)-1])return n(s[Number(e.key)-1]),r("custom"),!0;if(Uv.includes(e.key)){const a=Uv.indexOf(e.key),l=Object.keys(i)[a],c=i[l],d=Array.isArray(c)?c[o]:c;return n(d),r("baseColors"),!0}return!1},J1e=({event:e,activeColorPickerSection:t,palette:n,color:i,onChange:s,customColors:r,setActiveColorPickerSection:o,updateData:a,activeShade:l,onEyeDropperToggle:c,onEscape:d})=>{if(e[$.CTRL_OR_CMD])return!1;if(e.key===$.ESCAPE)return d(e),!0;if(e.key===$.ALT)return c(!0),!0;if(e.key===$.I)return c(),!0;const u=Ry({color:i,palette:n});if(e.key===$.TAB){const f={custom:!!r.length,baseColors:!0,shades:(u==null?void 0:u.shade)!=null,hex:!0},h=Object.entries(f).reduce((y,[v,_])=>(_&&y.push(v),y),[]),m=h.indexOf(t),p=e.shiftKey?-1:1,U=m+p>h.length-1?0:m+p<0?h.length-1:m+p,b=h[U];return b&&o(b),b==="custom"?s(r[0]):b==="baseColors"&&(Object.entries(n).find(([v,_])=>Array.isArray(_)?_.includes(i):_===i?v:null)||s(Ke.black)),e.preventDefault(),e.stopPropagation(),!0}if(Q1e({e,colorObj:u,onChange:s,palette:n,customColors:r,setActiveColorPickerSection:o,activeShade:l}))return!0;if(t==="shades"&&u){const{shade:f}=u,h=a3(e.key,f,wf);if(h!==void 0)return s(n[u.colorName][h]),!0}if(t==="baseColors"&&u){const{colorName:f}=u,h=Object.keys(n),m=h.indexOf(f),p=a3(e.key,m,h.length);if(p!==void 0){const U=h[p],b=n[U];return s(Array.isArray(b)?b[l]:b),!0}}if(t==="custom"){const f=i!=null?r.indexOf(i):0,h=a3(e.key,f,r.length);if(h!==void 0){const m=r[h];return s(m),!0}}return!1},eme=de.forwardRef(({color:e,onChange:t,type:n,elements:i,palette:s,updateData:r,children:o,showTitle:a,onEyeDropperToggle:l,onEscape:c,showHotKey:d=!0},u)=>{const f=a?n==="elementStroke"?M("labels.stroke"):n==="elementBackground"?M("labels.background"):null:null,[h]=de.useState(()=>n==="canvasBackground"?[]:Y1e(i,n,s)),[m,p]=gn(Ng),U=Ry({color:e,palette:s});L.useEffect(()=>{if(!m){const _=!!e&&K$({color:e,palette:s}),I=_&&!h.includes(e);p(I?null:_?"custom":(U==null?void 0:U.shade)!=null?"shades":"baseColors")}},[m,e,s,p,U,h]);const[b,y]=L.useState((U==null?void 0:U.shade)??(n==="elementBackground"?G1:$1));L.useEffect(()=>{(U==null?void 0:U.shade)!=null&&y(U.shade);const _=I=>{I.key===$.ALT&&l(!1)};return document.addEventListener(te.KEYUP,_,{capture:!0}),()=>{document.removeEventListener(te.KEYUP,_,{capture:!0})}},[U,l]);const v=de.useRef(null);return L.useImperativeHandle(u,()=>v.current),L.useEffect(()=>{var _;(_=v==null?void 0:v.current)==null||_.focus()},[]),g("div",{role:"dialog","aria-modal":"true","aria-label":M("labels.colorPicker"),children:N("div",{ref:v,onKeyDown:_=>{J1e({event:_,activeColorPickerSection:m,palette:s,color:e,onChange:t,onEyeDropperToggle:l,customColors:h,setActiveColorPickerSection:p,updateData:r,activeShade:b,onEscape:c})&&(_.preventDefault(),_.stopPropagation())},className:"color-picker-content properties-content",tabIndex:-1,children:[f&&g("div",{className:"color-picker__title",children:f}),!!h.length&&N("div",{children:[g(nb,{children:M("colorPicker.mostUsedCustomColors")}),g(K1e,{colors:h,color:e,label:M("colorPicker.mostUsedCustomColors"),onChange:t})]}),N("div",{children:[g(nb,{children:M("colorPicker.colors")}),g(Z1e,{color:e,palette:s,onChange:t,activeShade:b,showHotKey:d})]}),N("div",{children:[g(nb,{children:M("colorPicker.shades")}),g(q1e,{color:e,onChange:t,palette:s,showHotKey:d})]}),o]})})}),tme=({onChange:e,type:t,activeColor:n,topPicks:i})=>{let s;return t==="elementStroke"&&(s=wF),t==="elementBackground"&&(s=TF),t==="canvasBackground"&&(s=IF),i&&(s=i),s?g("div",{className:"color-picker__top-picks",children:s.map(r=>g("button",{className:le("color-picker__button",{active:r===n,"is-transparent":r==="transparent"||!r,"has-outline":!z6(r,r4)}),style:{"--swatch-color":r},type:"button",title:r,onClick:()=>e(r),"data-testid":`color-top-pick-${r}`,children:g("div",{className:"color-picker__button-outline"})},r))}):(console.error("Invalid type for TopPicks"),null)},Lk=e=>{const t=new Option().style;return t.color=e,!!t.color},nme=e=>ms(e)?e:Lk(`#${e}`)?`#${e}`:Lk(e)?e:null,ime=({type:e,color:t,onChange:n,label:i,elements:s,palette:r=Ke,updateData:o,getOpenPopup:a,appState:l})=>{const{container:c}=Fs(),d=Ua(),u=d!=="full",f=d==="mobile",[,h]=gn(Ng),[m,p]=gn(Ay),U=N("div",{children:[g(nb,{children:M("colorPicker.hexCode")}),g(W1e,{color:t||"",label:i,onChange:v=>{n(v)},colorPickerType:e,placeholder:M("colorPicker.color")})]}),b=L.useRef(null),y=()=>{var v;(v=b.current)==null||v.focus()};return g(Pg,{container:c,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!l.editingTextElement,onFocusOutside:v=>{Ba(v.target)||y(),v.preventDefault()},onPointerDownOutside:v=>{m&&v.preventDefault()},onClose:()=>{a()===e&&o({openPopup:null}),h(null),l.editingTextElement&&setTimeout(()=>{const v=document.querySelector(".excalidraw-wysiwyg");v&&v.focus()},0)},children:r?g(eme,{ref:b,palette:r,color:t,onChange:v=>{const _=l.editingTextElement?mT():null;n(v),l.editingTextElement&&_&&pT(_)},onEyeDropperToggle:v=>{p(_=>v?(_=_||{keepOpenOnAlt:!0,onSelect:n,colorPickerType:e},_.keepOpenOnAlt=!0,_):v===!1||_?null:{keepOpenOnAlt:!1,onSelect:n,colorPickerType:e})},onEscape:v=>{m?p(null):o({openPopup:null})},type:e,elements:s,updateData:o,showTitle:u,showHotKey:!f,children:U}):U})},sme=({label:e,color:t,type:n,mode:i="background",onToggle:s,editingTextElement:r})=>{const o=Ua(),a=o!=="full",l=o==="mobile",c=d=>{d.preventDefault(),d.stopPropagation(),r&&j1e(),s()};return N(Ml,{type:"button",className:le("color-picker__button active-color properties-trigger",{"is-transparent":!t||t==="transparent","has-outline":!t||!z6(t,r4),"compact-sizing":a,"mobile-border":l}),"aria-label":e,style:t?{"--swatch-color":t}:void 0,title:M(n==="elementStroke"?"labels.showStroke":"labels.showBackground"),"data-openpopup":n,onClick:c,children:[g("div",{className:"color-picker__button-outline",children:!t&&Cue}),a&&t&&i==="stroke"&&g("div",{className:"color-picker__button-background",children:g("span",{style:{color:t&&z6(t,r4)?"#fff":"#111"},children:Kfe})})]})},bT=({type:e,color:t,onChange:n,label:i,elements:s,palette:r=Ke,topPicks:o,updateData:a,appState:l})=>{const c=L.useRef(l.openPopup);L.useEffect(()=>{c.current=l.openPopup},[l.openPopup]);const u=Ua()!=="full";return g("div",{children:N("div",{role:"dialog","aria-modal":"true",className:le("color-picker-container",{"color-picker-container--no-top-picks":u}),children:[!u&&g(tme,{activeColor:t,onChange:n,type:e,topPicks:o}),!u&&g(j$,{}),N(Al,{open:l.openPopup===e,onOpenChange:f=>{f&&a({openPopup:e})},children:[g(sme,{color:t,label:i,type:e,mode:e==="elementStroke"?"stroke":"background",editingTextElement:!!l.editingTextElement,onToggle:()=>{l.openPopup===e?a({openPopup:null}):l.openPopup?a({openPopup:e}):a({openPopup:e})}}),l.openPopup===e&&g(ime,{type:e,color:t,onChange:n,label:i,elements:s,palette:r,updateData:a,getOpenPopup:()=>c.current,appState:l})]})]})})},rme="/fonts/CascadiaCode/CascadiaCode-Regular.woff2",ome=[{uri:rme}],ame="/fonts/ComicShanns/ComicShanns-Regular-279a7b317d12eb88de06167bd672b4b4.woff2",lme="/fonts/ComicShanns/ComicShanns-Regular-6e066e8de2ac57ea9283adb9c24d7f0c.woff2",cme="/fonts/ComicShanns/ComicShanns-Regular-dc6a8806fa96795d7b3be5026f989a17.woff2",dme="/fonts/ComicShanns/ComicShanns-Regular-fcb0fc02dcbee4c9846b3e2508668039.woff2",ume=[{uri:ame,descriptors:{unicodeRange:"U+20-7e,U+a1-a6,U+a8,U+ab-ac,U+af-b1,U+b4,U+b8,U+bb-bc,U+bf-cf,U+d1-d7,U+d9-de,U+e0-ef,U+f1-f7,U+f9-ff,U+131,U+152-153,U+2c6,U+2da,U+2dc,U+2013-2014,U+2018-201a,U+201c-201d,U+2020-2022,U+2026,U+2039-203a,U+2044,U+20ac,U+2191,U+2193,U+2212"}},{uri:dme,descriptors:{unicodeRange:"U+100-10f,U+112-125,U+128-130,U+134-137,U+139-13c,U+141-148,U+14c-151,U+154-161,U+164-165,U+168-17f,U+1bf,U+1f7,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+a75b"}},{uri:cme,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+315,U+2190,U+2192,U+2200,U+2203-2204,U+2264-2265,U+f6c3"}},{uri:lme,descriptors:{unicodeRange:"U+3bb"}}],fme=[{uri:I_}];class hme{constructor(t){F(this,"instance");F(this,"debounceTerminate");this.instance=new Worker(t,{type:"module"})}}class yT{constructor(t,n){F(this,"idleWorkers",new Set);F(this,"workerUrl");F(this,"workerTTL");this.workerUrl=t,this.workerTTL=n.ttl||1e3}static create(t,n={}){if(!t)throw new YV;if(!import.meta.url||t.toString()===import.meta.url)throw new WV;return new yT(t,n)}async postMessage(t,n){let i;const s=Array.from(this.idleWorkers).shift();return s?(this.idleWorkers.delete(s),i=s):i=await this.createWorker(),new Promise((r,o)=>{i.instance.onmessage=this.onMessageHandler(i,r),i.instance.onerror=this.onErrorHandler(i,o),i.instance.postMessage(t,n),i.debounceTerminate(()=>o(new Error(`Active worker did not respond for ${this.workerTTL}ms!`)))})}async clear(){for(const t of this.idleWorkers)t.debounceTerminate.cancel(),t.instance.terminate();this.idleWorkers.clear()}async createWorker(){const t=new hme(this.workerUrl);return t.debounceTerminate=ul(n=>{t.instance.terminate(),this.idleWorkers.has(t)?(this.idleWorkers.delete(t),console.debug("Job finished! Idle worker has been released from the pool.")):n?n():console.error("Worker has been terminated!")},this.workerTTL),t}onMessageHandler(t,n){return i=>{t.debounceTerminate(),this.idleWorkers.add(t),n(i.data)}}onErrorHandler(t,n){return i=>{t.debounceTerminate(()=>n(i)),t.debounceTerminate.flush(),this.clear()}}}let Dk=typeof Worker<"u";const gme=async(e,t)=>{const{Commands:n,subsetToBase64:i,toBase64:s}=await pme();return Dk?Hc(async()=>{try{const r=await Ume(),o=e.slice(0),a=await r.postMessage({command:n.Subset,arrayBuffer:o,codePoints:t},{transfer:[o]});return s(a)}catch(r){return Dk=!1,Rte()&&(r instanceof YV||r instanceof WV)||console.error("Failed to use workers for subsetting, falling back to the main thread.",r),i(e,t)}}):i(e,t)};let l3=null,c3=null;const mme=async()=>(l3||(l3=pe(()=>import("./subset-worker.chunk-CVR6pt27.js"),__vite__mapDeps([0,1]))),l3),pme=async()=>(c3||(c3=pe(()=>import("./subset-shared.chunk-D3ioWSie.js"),__vite__mapDeps([]))),c3);let d3=null;const Ume=()=>(d3||(d3=Hc(async()=>{const{WorkerUrl:e}=await mme();return yT.create(e)})),d3);var u3={};const nh=class nh{constructor(t,n,i){F(this,"urls");F(this,"fontFace");this.urls=nh.createUrls(n);const s=this.urls.map(r=>`url(${r}) ${nh.getFormat(r)}`).join(", ");this.fontFace=new FontFace(t,s,{display:"swap",style:"normal",weight:"400",...i})}toCSS(t){if(!this.getUnicodeRangeRegex().test(t))return;const n=Array.from(t).map(i=>i.codePointAt(0));return this.getContent(n).then(i=>`@font-face { font-family: ${this.fontFace.family}; src: url(${i}); }`)}async getContent(t){let n=0;const i=[];for(;n<this.urls.length;){const s=this.urls[n];try{const r=await this.fetchFont(s);return await gme(r,t)}catch(r){i.push(`"${s.toString()}" returned error "${r}"`)}n++}return console.error(`Failed to fetch font family "${this.fontFace.family}"`,JSON.stringify(i,void 0,2)),this.urls.length?this.urls[this.urls.length-1].toString():""}fetchFont(t){return Hc(async()=>{const n=await fetch(t,{cache:"force-cache",headers:{Accept:"font/woff2"}});if(!n.ok){const s=t instanceof URL?t.toString():"dataurl";throw new Error(`Failed to fetch "${s}": ${n.statusText}`)}return await n.arrayBuffer()})}getUnicodeRangeRegex(){const t=this.fontFace.unicodeRange.split(/,\s*/).map(n=>{const[i,s]=n.replace("U+","").split("-");return s?`\\u{${i}}-\\u{${s}}`:`\\u{${i}}`}).join("");return new RegExp(`[${t}]`,"u")}static createUrls(t){if(t.startsWith("data"))return[t];if(t.startsWith(I_))return[];if(t.startsWith("http"))return[new URL(t)];const n=t.replace(/^\/+/,""),i=[];if(typeof window.EXCALIDRAW_ASSET_PATH=="string"){const s=this.normalizeBaseUrl(window.EXCALIDRAW_ASSET_PATH);i.push(new URL(n,s))}else Array.isArray(window.EXCALIDRAW_ASSET_PATH)&&window.EXCALIDRAW_ASSET_PATH.forEach(s=>{const r=this.normalizeBaseUrl(s);i.push(new URL(n,r))});return i.push(new URL(n,nh.ASSETS_FALLBACK_URL)),i}static getFormat(t){if(!(t instanceof URL))return"";try{const n=new URL(t).pathname.split(".");return n.length===1?"":`format('${n.pop()}')`}catch{return""}}static normalizeBaseUrl(t){var i;let n=t;return/^\.?\//.test(n)&&(n=new URL(n.replace(/^\.?\/+/,""),(i=window==null?void 0:window.location)==null?void 0:i.origin).toString()),n=`${n.replace(/\/+$/,"")}/`,n}};F(nh,"ASSETS_FALLBACK_URL",`https://esm.sh/${u3.PKG_NAME?`${u3.PKG_NAME}@${u3.PKG_VERSION}`:"@excalidraw/excalidraw"}/dist/prod/`);let bv=nh;const bme="/fonts/Excalifont/Excalifont-Regular-349fac6ca4700ffec595a7150a0d1e1d.woff2",yme="/fonts/Excalifont/Excalifont-Regular-3f2c5db56cc93c5a6873b1361d730c16.woff2",Eme="/fonts/Excalifont/Excalifont-Regular-41b173a47b57366892116a575a43e2b6.woff2",vme="/fonts/Excalifont/Excalifont-Regular-623ccf21b21ef6b3a0d87738f77eb071.woff2",_me="/fonts/Excalifont/Excalifont-Regular-a88b72a24fb54c9f94e3b5fdaa7481c9.woff2",wme="/fonts/Excalifont/Excalifont-Regular-b9dcf9d2e50a1eaf42fc664b50a3fd0d.woff2",Tme="/fonts/Excalifont/Excalifont-Regular-be310b9bcd4f1a43f571c46df7809174.woff2",Ime=[{uri:_me,descriptors:{unicodeRange:"U+20-7e,U+a0-a3,U+a5-a6,U+a8-ab,U+ad-b1,U+b4,U+b6-b8,U+ba-ff,U+131,U+152-153,U+2bc,U+2c6,U+2da,U+2dc,U+304,U+308,U+2013-2014,U+2018-201a,U+201c-201e,U+2020,U+2022,U+2024-2026,U+2030,U+2039-203a,U+20ac,U+2122,U+2212"}},{uri:Tme,descriptors:{unicodeRange:"U+100-130,U+132-137,U+139-149,U+14c-151,U+154-17e,U+192,U+1fc-1ff,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+2113"}},{uri:wme,descriptors:{unicodeRange:"U+400-45f,U+490-491,U+2116"}},{uri:Eme,descriptors:{unicodeRange:"U+37e,U+384-38a,U+38c,U+38e-393,U+395-3a1,U+3a3-3a8,U+3aa-3cf,U+3d7"}},{uri:yme,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+302,U+306-307,U+30a-30c,U+326-328,U+212e,U+2211,U+fb01-fb02"}},{uri:bme,descriptors:{unicodeRange:"U+462-463,U+472-475,U+4d8-4d9,U+4e2-4e3,U+4e6-4e9,U+4ee-4ef"}},{uri:vme,descriptors:{unicodeRange:"U+300-301,U+303"}}],Sme=[{uri:I_}],xme="/fonts/LiberationSans/LiberationSans-Regular.woff2",Cme=[{uri:xme}],Ame="/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYE98RXi4EwSsbg.woff2",Mme="/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYEF8RXi4EwQ.woff2",kme=[{uri:Ame,descriptors:{unicodeRange:kd.LATIN_EXT}},{uri:Mme,descriptors:{unicodeRange:kd.LATIN}}],Rme="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTA3j6zbXWjgevT5.woff2",Lme="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTQ3j6zbXWjgeg.woff2",Dme="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTk3j6zbXWjgevT5.woff2",Pme="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTo3j6zbXWjgevT5.woff2",Nme="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTs3j6zbXWjgevT5.woff2",Ome=[{uri:Dme,descriptors:{unicodeRange:kd.CYRILIC_EXT,weight:"500"}},{uri:Rme,descriptors:{unicodeRange:kd.CYRILIC,weight:"500"}},{uri:Nme,descriptors:{unicodeRange:kd.VIETNAMESE,weight:"500"}},{uri:Pme,descriptors:{unicodeRange:kd.LATIN_EXT,weight:"500"}},{uri:Lme,descriptors:{unicodeRange:kd.LATIN,weight:"500"}}],Fme="/fonts/Virgil/Virgil-Regular.woff2",Bme=[{uri:Fme}],zme="/fonts/Xiaolai/Xiaolai-Regular-019d66dcad46dc156b162d267f981c20.woff2",Hme="/fonts/Xiaolai/Xiaolai-Regular-04b718e5623574919c8b0dea5f301444.woff2",Vme="/fonts/Xiaolai/Xiaolai-Regular-069e77aac84590e2e991d0a0176d34f2.woff2",$me="/fonts/Xiaolai/Xiaolai-Regular-06c77b8c66e51ed6c63ccb502dd8b8af.woff2",Gme="/fonts/Xiaolai/Xiaolai-Regular-08e0dc436ad0ad61ba5558db0674d762.woff2",Xme="/fonts/Xiaolai/Xiaolai-Regular-093b9ef39a46ceae95a1df18a0a3a326.woff2",jme="/fonts/Xiaolai/Xiaolai-Regular-095c169f3314805276f603a362766abd.woff2",Yme="/fonts/Xiaolai/Xiaolai-Regular-09850c4077f3fffe707905872e0e2460.woff2",Wme="/fonts/Xiaolai/Xiaolai-Regular-41521fade99856108931b4768b1b2648.woff2",Kme="/fonts/Xiaolai/Xiaolai-Regular-544fc28abe2c5c30e62383fd4dac255f.woff2",Zme="/fonts/Xiaolai/Xiaolai-Regular-60a3089806700d379f11827ee9843b6b.woff2",qme="/fonts/Xiaolai/Xiaolai-Regular-7eb9fffd1aa890d07d0f88cc82e6cfe4.woff2",Qme="/fonts/Xiaolai/Xiaolai-Regular-6fe5c5973cc06f74b2387a631ea36b88.woff2",Jme="/fonts/Xiaolai/Xiaolai-Regular-a4c34be6d42152e64b0df90bc4607f64.woff2",e0e="/fonts/Xiaolai/Xiaolai-Regular-b96d9226ce77ec94ceca043d712182e6.woff2",t0e="/fonts/Xiaolai/Xiaolai-Regular-6ae5b42180ad70b971c91e7eefb8eba2.woff2",n0e="/fonts/Xiaolai/Xiaolai-Regular-c69f61a4ab18d0488c8d1fc12e7028e8.woff2",i0e="/fonts/Xiaolai/Xiaolai-Regular-cb17fc3db95f6d139afc9d31a8e93293.woff2",s0e="/fonts/Xiaolai/Xiaolai-Regular-e3fcf5180fd466c8915c4e8069491054.woff2",r0e="/fonts/Xiaolai/Xiaolai-Regular-c1f94158256bb1f3bf665b053d895af9.woff2",o0e="/fonts/Xiaolai/Xiaolai-Regular-7197d6fda6cba7c3874c53d6381ca239.woff2",a0e="/fonts/Xiaolai/Xiaolai-Regular-70c2eb8d64e71a42a834eb857ea9df51.woff2",l0e="/fonts/Xiaolai/Xiaolai-Regular-a004ddfcb26e67bd6e678c8ed19e25ce.woff2",c0e="/fonts/Xiaolai/Xiaolai-Regular-7e4bde7e9c7f84cd34d8a845e384c746.woff2",d0e="/fonts/Xiaolai/Xiaolai-Regular-23686f7f29da6e8008c36dd3a80c83d6.woff2",u0e="/fonts/Xiaolai/Xiaolai-Regular-69c09cc5fa3e55c74fc4821f76909cc3.woff2",f0e="/fonts/Xiaolai/Xiaolai-Regular-25b7f38e18f035f96cb5e547bd2bd08c.woff2",h0e="/fonts/Xiaolai/Xiaolai-Regular-ba3de316d63c7e339987b16f41a0b879.woff2",g0e="/fonts/Xiaolai/Xiaolai-Regular-12b52b58eb3df36804b9a654ec9ee194.woff2",m0e="/fonts/Xiaolai/Xiaolai-Regular-b1220a3c61f85cc0408deedb4c5f57a2.woff2",p0e="/fonts/Xiaolai/Xiaolai-Regular-4535823663ad81405188a528d8f2b1a2.woff2",U0e="/fonts/Xiaolai/Xiaolai-Regular-3eaa538115d76932653c21d8dc28f207.woff2",b0e="/fonts/Xiaolai/Xiaolai-Regular-7e929f262f30c8ee78bf398150b1a7cd.woff2",y0e="/fonts/Xiaolai/Xiaolai-Regular-73e309718fd16cea44b4d54a33581811.woff2",E0e="/fonts/Xiaolai/Xiaolai-Regular-9eb5a99df4e76ac3363453ac9ca288b1.woff2",v0e="/fonts/Xiaolai/Xiaolai-Regular-3e63ed8162808a9e425ed80a8bc79114.woff2",_0e="/fonts/Xiaolai/Xiaolai-Regular-c8b71798409ccc126ee264a00aadcf21.woff2",w0e="/fonts/Xiaolai/Xiaolai-Regular-11c345711937f0ba4b8f7b6b919c8440.woff2",T0e="/fonts/Xiaolai/Xiaolai-Regular-e480d9c614742d05f0e78f274f1e69e6.woff2",I0e="/fonts/Xiaolai/Xiaolai-Regular-95429962233afd82db1c27df1500a28c.woff2",S0e="/fonts/Xiaolai/Xiaolai-Regular-2cf96d082d35ea3d8106851223ad0d16.woff2",x0e="/fonts/Xiaolai/Xiaolai-Regular-2d43040e86ff03ba677f6f9c04cd0805.woff2",C0e="/fonts/Xiaolai/Xiaolai-Regular-2a26d20a23b00898ce82f09d2ee47c3f.woff2",A0e="/fonts/Xiaolai/Xiaolai-Regular-a365e82ed54697a52f27adcea1315fe8.woff2",M0e="/fonts/Xiaolai/Xiaolai-Regular-e4bca6cfa53e499cae0a6be4894a90e9.woff2",k0e="/fonts/Xiaolai/Xiaolai-Regular-e51ef413167c6e14e0c0fdcc585f2fc9.woff2",R0e="/fonts/Xiaolai/Xiaolai-Regular-e5f453bb04da18eed01675eeebd88bf8.woff2",L0e="/fonts/Xiaolai/Xiaolai-Regular-e656f091b9dc4709722c9f4b84d3c797.woff2",D0e="/fonts/Xiaolai/Xiaolai-Regular-f0f13b5c60e0af5553bd359f5513be1b.woff2",P0e="/fonts/Xiaolai/Xiaolai-Regular-f5d079153c99a25b9be5b8583c4cc8a7.woff2",N0e="/fonts/Xiaolai/Xiaolai-Regular-10a7ae9a371830a80c3d844acf1c02d7.woff2",O0e="/fonts/Xiaolai/Xiaolai-Regular-60a41c7e1c68f22424e6d22df544bc82.woff2",F0e="/fonts/Xiaolai/Xiaolai-Regular-7ab2bed91166a9dca83a5ebfbe2a7f38.woff2",B0e="/fonts/Xiaolai/Xiaolai-Regular-670ba603758d94268e8606f240a42e12.woff2",z0e="/fonts/Xiaolai/Xiaolai-Regular-15dc6d811c9cd078f9086a740d5a1038.woff2",H0e="/fonts/Xiaolai/Xiaolai-Regular-8c2f33cee3993174f7e87c28e4bf42ee.woff2",V0e="/fonts/Xiaolai/Xiaolai-Regular-761d05e3cd968cf574166867998ef06a.woff2",$0e="/fonts/Xiaolai/Xiaolai-Regular-642b26e2e5f5fb780b51b593dbc8c851.woff2",G0e="/fonts/Xiaolai/Xiaolai-Regular-5572b3513ba8df57a3d5d7303ee6b11b.woff2",X0e="/fonts/Xiaolai/Xiaolai-Regular-3c9de2ae0ea4bc91a510942dfa4be8d2.woff2",j0e="/fonts/Xiaolai/Xiaolai-Regular-671a2c20b1eb9e4ef8a192833940e319.woff2",Y0e="/fonts/Xiaolai/Xiaolai-Regular-4dc6d5f188d5c96d44815cd1e81aa885.woff2",W0e="/fonts/Xiaolai/Xiaolai-Regular-ce4884f96f11589608b76b726a755803.woff2",K0e="/fonts/Xiaolai/Xiaolai-Regular-8f476c4c99813d57cbe6eca4727388ad.woff2",Z0e="/fonts/Xiaolai/Xiaolai-Regular-5935a5775af3d5c6307ac667bd9ae74e.woff2",q0e="/fonts/Xiaolai/Xiaolai-Regular-79f007c1c6d07557120982951ea67998.woff2",Q0e="/fonts/Xiaolai/Xiaolai-Regular-bafff7a14c27403dcc6cf1432e8ea836.woff2",J0e="/fonts/Xiaolai/Xiaolai-Regular-543fa46ace099a7099dad69123399400.woff2",epe="/fonts/Xiaolai/Xiaolai-Regular-4ddc14ed3eb0c3e46364317dfc0144a3.woff2",tpe="/fonts/Xiaolai/Xiaolai-Regular-0fa55a080fcd0f9dc2e0b0058b793df8.woff2",npe="/fonts/Xiaolai/Xiaolai-Regular-66493ba5a8367f2928812f446f47b56a.woff2",ipe="/fonts/Xiaolai/Xiaolai-Regular-57862b464a55b18c7bf234ce22907d73.woff2",spe="/fonts/Xiaolai/Xiaolai-Regular-8d3bcabb847b56243b16afe62adaaf21.woff2",rpe="/fonts/Xiaolai/Xiaolai-Regular-2b77e8ebfb2367ab2662396a60e7d320.woff2",ope="/fonts/Xiaolai/Xiaolai-Regular-0b5d723fdc4e249c140f0909e87d03b4.woff2",ape="/fonts/Xiaolai/Xiaolai-Regular-cdbce89e82cc1ab53a2decbf5819278f.woff2",lpe="/fonts/Xiaolai/Xiaolai-Regular-739bc1a567439c7cffcd1614644593d2.woff2",cpe="/fonts/Xiaolai/Xiaolai-Regular-72252d73220fa3cd856677888cee1635.woff2",dpe="/fonts/Xiaolai/Xiaolai-Regular-cf6ff4e0f491ca0cf3038187a997b9b4.woff2",upe="/fonts/Xiaolai/Xiaolai-Regular-9cfb2a77a4e45025105ad29a1748b90d.woff2",fpe="/fonts/Xiaolai/Xiaolai-Regular-450da755d5bcb70906e1295e559b9602.woff2",hpe="/fonts/Xiaolai/Xiaolai-Regular-0986d134c05864f5025962eef9f994a0.woff2",gpe="/fonts/Xiaolai/Xiaolai-Regular-1ee544f0f1dac422545c505baa788992.woff2",mpe="/fonts/Xiaolai/Xiaolai-Regular-4806e761d750087c2d734fc64596eaff.woff2",ppe="/fonts/Xiaolai/Xiaolai-Regular-33432927cd87d40cfe393c7482bf221f.woff2",Upe="/fonts/Xiaolai/Xiaolai-Regular-be549ab72f0719d606a5c01e2c0219b6.woff2",bpe="/fonts/Xiaolai/Xiaolai-Regular-b5c1596551c256e0e9cf02028595b092.woff2",ype="/fonts/Xiaolai/Xiaolai-Regular-cf2cc71752631e579e35b0e423bf2638.woff2",Epe="/fonts/Xiaolai/Xiaolai-Regular-6f3256af8454371776bc46670d33cc65.woff2",vpe="/fonts/Xiaolai/Xiaolai-Regular-23f228f3999c01983860012330e4be08.woff2",_pe="/fonts/Xiaolai/Xiaolai-Regular-21430ee05a1248901da8d0de08744d47.woff2",wpe="/fonts/Xiaolai/Xiaolai-Regular-5330a2119a716e4e7224ed108b085dac.woff2",Tpe="/fonts/Xiaolai/Xiaolai-Regular-cd145ce4a0ea18469358df53c207bc1b.woff2",Ipe="/fonts/Xiaolai/Xiaolai-Regular-36925dfe329a45086cbb7fc5c20d45ac.woff2",Spe="/fonts/Xiaolai/Xiaolai-Regular-4bfaa8ffa64c5ee560aa2daba7c9cbd3.woff2",xpe="/fonts/Xiaolai/Xiaolai-Regular-112c051027b2d766c19a519f6ee1f4f7.woff2",Cpe="/fonts/Xiaolai/Xiaolai-Regular-5b0ed6971aaab9c8ad563230bd5471a7.woff2",Ape="/fonts/Xiaolai/Xiaolai-Regular-98f2ad84457de7f3740d9920b8fa8667.woff2",Mpe="/fonts/Xiaolai/Xiaolai-Regular-733171b4ffcd17ea1fe1c0ba627173bf.woff2",kpe="/fonts/Xiaolai/Xiaolai-Regular-684d65f1793cac449dde5d59cb3c47fb.woff2",Rpe="/fonts/Xiaolai/Xiaolai-Regular-cbaaefaaf326668277aa24dfa93c4d28.woff2",Lpe="/fonts/Xiaolai/Xiaolai-Regular-58fd02350d0bc52cf1ca3bb32ce9766e.woff2",Dpe="/fonts/Xiaolai/Xiaolai-Regular-7ccce86603f80a099ddb0cb21d4ae3e3.woff2",Ppe="/fonts/Xiaolai/Xiaolai-Regular-3717077e38f98d89eae729b6c14e56dc.woff2",Npe="/fonts/Xiaolai/Xiaolai-Regular-dbea1af6dcd9860be40c3d18254338f5.woff2",Ope="/fonts/Xiaolai/Xiaolai-Regular-4a0fdb40036e87b40aa08dd30584cb85.woff2",Fpe="/fonts/Xiaolai/Xiaolai-Regular-0f626226ba1272e832aea87bafd9720e.woff2",Bpe="/fonts/Xiaolai/Xiaolai-Regular-938d90c10ff8c20386af7f242c05d6b0.woff2",zpe="/fonts/Xiaolai/Xiaolai-Regular-b6d128682ee29e471486354d486a1b90.woff2",Hpe="/fonts/Xiaolai/Xiaolai-Regular-9d81066dd2b337c938df6e90380a00dc.woff2",Vpe="/fonts/Xiaolai/Xiaolai-Regular-20e7bf72fa05de9adf7dbcc7bf51dde6.woff2",$pe="/fonts/Xiaolai/Xiaolai-Regular-4095eb84ef3874e2600247bee0b04026.woff2",Gpe="/fonts/Xiaolai/Xiaolai-Regular-4ee10ae43505e2e0bc62656ced49c0fa.woff2",Xpe="/fonts/Xiaolai/Xiaolai-Regular-7494dc504ae00ee9cd0505f990f88c5d.woff2",jpe="/fonts/Xiaolai/Xiaolai-Regular-8de5b863cb50dfefdd07cb11c774d579.woff2",Ype="/fonts/Xiaolai/Xiaolai-Regular-3e1f8f654357353bf0e04ba5c34b5f7f.woff2",Wpe="/fonts/Xiaolai/Xiaolai-Regular-2e33e8dc771ef5e1d9127d60a6b73679.woff2",Kpe="/fonts/Xiaolai/Xiaolai-Regular-173945821411c09f70c95f98d590e697.woff2",Zpe="/fonts/Xiaolai/Xiaolai-Regular-b358f7a51ece39a3247942b1feabdb29.woff2",qpe="/fonts/Xiaolai/Xiaolai-Regular-23ad2d71b280f00b1363b95b7bea94eb.woff2",Qpe="/fonts/Xiaolai/Xiaolai-Regular-5882ffa04f32584d26109137e2da4352.woff2",Jpe="/fonts/Xiaolai/Xiaolai-Regular-a203b91dad570bf05a58c3c3ddb529bf.woff2",eUe="/fonts/Xiaolai/Xiaolai-Regular-bd77e3c7f9e0b072d96af37f73d1aa32.woff2",tUe="/fonts/Xiaolai/Xiaolai-Regular-5a45d991244d4c7140217e1e5f5ca4f4.woff2",nUe="/fonts/Xiaolai/Xiaolai-Regular-f56414bf9bced67990def8660e306759.woff2",iUe="/fonts/Xiaolai/Xiaolai-Regular-583d166e56ba0de4b77eabb47ef67839.woff2",sUe="/fonts/Xiaolai/Xiaolai-Regular-7f855356ab893b0d2b9c1c83b8116f0e.woff2",rUe="/fonts/Xiaolai/Xiaolai-Regular-b57aaedfd8ebdf3931f25119dc6a5eb2.woff2",oUe="/fonts/Xiaolai/Xiaolai-Regular-b6fd38ca30869792244804b04bc058da.woff2",aUe="/fonts/Xiaolai/Xiaolai-Regular-452225341522a7942f0f6aab1a5c91a3.woff2",lUe="/fonts/Xiaolai/Xiaolai-Regular-866fa7613df6b3fd272bcfd4530c0bb9.woff2",cUe="/fonts/Xiaolai/Xiaolai-Regular-52a84a22fd1369bffeaf21da2d6158dc.woff2",dUe="/fonts/Xiaolai/Xiaolai-Regular-829615148e6357d826b9242eb7fbbd1e.woff2",uUe="/fonts/Xiaolai/Xiaolai-Regular-c99eda15fc26a2941579560f76c3a5cf.woff2",fUe="/fonts/Xiaolai/Xiaolai-Regular-395c35dd584b56b0789f58a0559beaf1.woff2",hUe="/fonts/Xiaolai/Xiaolai-Regular-203b0e569e3b14aac86a003dc3fa523e.woff2",gUe="/fonts/Xiaolai/Xiaolai-Regular-51a0e808bbc8361236ac521a119758a3.woff2",mUe="/fonts/Xiaolai/Xiaolai-Regular-6e092f71c1e634059ada0e52abadce67.woff2",pUe="/fonts/Xiaolai/Xiaolai-Regular-0f7fb1e0d5015bb1371343153ecf7ce3.woff2",UUe="/fonts/Xiaolai/Xiaolai-Regular-d0cf73942fea1c74edbdf0b3011f4656.woff2",bUe="/fonts/Xiaolai/Xiaolai-Regular-968cffdc8ee679da094e77ebf50f58ef.woff2",yUe="/fonts/Xiaolai/Xiaolai-Regular-7a07ddc0f0c0f5f4a9bad6ee3dda66b5.woff2",EUe="/fonts/Xiaolai/Xiaolai-Regular-ec181b795ac1fb5a50d700b6e996d745.woff2",vUe="/fonts/Xiaolai/Xiaolai-Regular-cfb211578629b7e8153b37240de6a9d5.woff2",_Ue="/fonts/Xiaolai/Xiaolai-Regular-59e9ff77b0efaf684bc09274fb6908c9.woff2",wUe="/fonts/Xiaolai/Xiaolai-Regular-2adbc89c11e65905393d3dfc468b9d5b.woff2",TUe="/fonts/Xiaolai/Xiaolai-Regular-70e811fd7994e61f408c923de6ddd078.woff2",IUe="/fonts/Xiaolai/Xiaolai-Regular-c4a687ac4f0c2766eefc9f77ed99cddf.woff2",SUe="/fonts/Xiaolai/Xiaolai-Regular-51502f1206be09c565f1547c406e9558.woff2",xUe="/fonts/Xiaolai/Xiaolai-Regular-1fdc0c67ed57263a80fd108c1f6ccf24.woff2",CUe="/fonts/Xiaolai/Xiaolai-Regular-e11567fd2accf9957cd0d3c2be937d87.woff2",AUe="/fonts/Xiaolai/Xiaolai-Regular-20cc1bbf50e7efb442756cb605672c1f.woff2",MUe="/fonts/Xiaolai/Xiaolai-Regular-5d2898fbc097a7e24c6f38d80587621e.woff2",kUe="/fonts/Xiaolai/Xiaolai-Regular-ac9ceb44437becc3e9c4dbfebab7fc2d.woff2",RUe="/fonts/Xiaolai/Xiaolai-Regular-c16ed9740b85badf16e86ea782a3062f.woff2",LUe="/fonts/Xiaolai/Xiaolai-Regular-aa0d470430e6391eca720c7cfa44446f.woff2",DUe="/fonts/Xiaolai/Xiaolai-Regular-f2b54d4e7be0eaefe1c2c56836fa5368.woff2",PUe="/fonts/Xiaolai/Xiaolai-Regular-99a16ef6a64934d5781933dbd9c46b2e.woff2",NUe="/fonts/Xiaolai/Xiaolai-Regular-c40533fdf4cc57177b12803598af7e59.woff2",OUe="/fonts/Xiaolai/Xiaolai-Regular-91ddb2969bf2d31ba02ad82998d1314c.woff2",FUe="/fonts/Xiaolai/Xiaolai-Regular-774d4f764a1299da5d28ec2f2ffe0d69.woff2",BUe="/fonts/Xiaolai/Xiaolai-Regular-7718fe60986d8b42b1be9c5ace5ccf25.woff2",zUe="/fonts/Xiaolai/Xiaolai-Regular-aa5c9ca6cf4fba00433b7aa3fa10671a.woff2",HUe="/fonts/Xiaolai/Xiaolai-Regular-4f50e5136e136527280bc902c5817561.woff2",VUe="/fonts/Xiaolai/Xiaolai-Regular-a0ca5df4258213d7fc9fce80f65ce760.woff2",$Ue="/fonts/Xiaolai/Xiaolai-Regular-d2666cbed13462c5dc36fa2f15c202ca.woff2",GUe="/fonts/Xiaolai/Xiaolai-Regular-1e6fd68f1f3902ce48ce8c69df385622.woff2",XUe="/fonts/Xiaolai/Xiaolai-Regular-87599f94b6cc129d505b375798d0d751.woff2",jUe="/fonts/Xiaolai/Xiaolai-Regular-13ae07ed2e272d26d59bc0691cd7117a.woff2",YUe="/fonts/Xiaolai/Xiaolai-Regular-353f33792a8f60dc69323ddf635a269e.woff2",WUe="/fonts/Xiaolai/Xiaolai-Regular-0facdf1ea213ba40261022f5d5ed4493.woff2",KUe="/fonts/Xiaolai/Xiaolai-Regular-f6032fc06eb20480f096199713f70885.woff2",ZUe="/fonts/Xiaolai/Xiaolai-Regular-f8ee5d36068a42b51d0e4a1116cfcec1.woff2",qUe="/fonts/Xiaolai/Xiaolai-Regular-79d494361ae093b69e74ee9dbe65bfd4.woff2",QUe="/fonts/Xiaolai/Xiaolai-Regular-74e2263a91439c25b91d5132ce9f4d62.woff2",JUe="/fonts/Xiaolai/Xiaolai-Regular-ee8bae97908d5147b423f77ad0d3c1bb.woff2",e2e="/fonts/Xiaolai/Xiaolai-Regular-56467a5c8840c4d23a60b2f935114848.woff2",t2e="/fonts/Xiaolai/Xiaolai-Regular-145aa02cdd91946e67dc934e1acffe75.woff2",n2e="/fonts/Xiaolai/Xiaolai-Regular-54acdfc2166ad7fcbd074f75fd4a56ba.woff2",i2e="/fonts/Xiaolai/Xiaolai-Regular-29cec36cd205b211da97acabaa62f055.woff2",s2e="/fonts/Xiaolai/Xiaolai-Regular-3756e81d3e149cf6099163ee79944fec.woff2",r2e="/fonts/Xiaolai/Xiaolai-Regular-8e9f97f01034820170065b2921b4fb5e.woff2",o2e="/fonts/Xiaolai/Xiaolai-Regular-13d2887ec8ee73c43acdabc52a05af7b.woff2",a2e="/fonts/Xiaolai/Xiaolai-Regular-72536a3d71b694a0d53dd90ddceae41e.woff2",l2e="/fonts/Xiaolai/Xiaolai-Regular-603aefd23e350ba7eb124273e3c9bcf1.woff2",c2e="/fonts/Xiaolai/Xiaolai-Regular-9544732d2e62d1a429674f8ee41b5d3a.woff2",d2e="/fonts/Xiaolai/Xiaolai-Regular-d3716376641d615e2995605b29bca7b6.woff2",u2e="/fonts/Xiaolai/Xiaolai-Regular-5a1ce3117cfe90c48e8fb4a9a00f694d.woff2",f2e="/fonts/Xiaolai/Xiaolai-Regular-b7d203b051eff504ff59ddca7576b6a9.woff2",h2e="/fonts/Xiaolai/Xiaolai-Regular-4a38cc3e9cf104e69ba246d37f8cf135.woff2",g2e="/fonts/Xiaolai/Xiaolai-Regular-982b630266d87db93d2539affb1275c6.woff2",m2e="/fonts/Xiaolai/Xiaolai-Regular-9592bfc861f07bcb8d75c196b370e548.woff2",p2e="/fonts/Xiaolai/Xiaolai-Regular-a7accba310e821da5505f71c03b76bdb.woff2",U2e="/fonts/Xiaolai/Xiaolai-Regular-dac48066b5883d8b4551fc584f0c2a3e.woff2",b2e="/fonts/Xiaolai/Xiaolai-Regular-a1f916d6039285c4ffb900cd654e418f.woff2",y2e="/fonts/Xiaolai/Xiaolai-Regular-95bfd249da4902577b4b7d76ebdd0b44.woff2",E2e="/fonts/Xiaolai/Xiaolai-Regular-93fc8f28a33234bcadf1527cafabd502.woff2",v2e="/fonts/Xiaolai/Xiaolai-Regular-903bb6865f3452e2fda42e3a25547bc5.woff2",_2e="/fonts/Xiaolai/Xiaolai-Regular-4aca6a43e59aceee2166b0c7e4e85ef1.woff2",w2e="/fonts/Xiaolai/Xiaolai-Regular-24476a126f129212beb33f66853ea151.woff2",T2e="/fonts/Xiaolai/Xiaolai-Regular-1b611157cd46bb184d4fa4dae2d6a2b8.woff2",I2e="/fonts/Xiaolai/Xiaolai-Regular-56a32a7689abd0326e57c10c6c069bb4.woff2",S2e="/fonts/Xiaolai/Xiaolai-Regular-3cc70dbb64df5b21f1326cc24dee2195.woff2",x2e="/fonts/Xiaolai/Xiaolai-Regular-e2ead7ea7da0437f085f42ffc05f8d13.woff2",C2e="/fonts/Xiaolai/Xiaolai-Regular-97f7f48ce90c9429bf32ae51469db74d.woff2",A2e="/fonts/Xiaolai/Xiaolai-Regular-24a21c1e4449222e8d1898d69ff3a404.woff2",M2e="/fonts/Xiaolai/Xiaolai-Regular-726303e0774b4e678bff8c2deb6ca603.woff2",k2e="/fonts/Xiaolai/Xiaolai-Regular-5a7fac4b8b23a6e4e5ba0c9bf1756c91.woff2",R2e="/fonts/Xiaolai/Xiaolai-Regular-2b7441d46298788ac94e610ffcc709b6.woff2",L2e=[{uri:Yme,descriptors:{unicodeRange:"U+f9b8-fa6d,U+fe32,U+fe45-fe4f,U+ff02-ff0b,U+ff0d-ff1e,U+ff20-ff2a"}},{uri:qme,descriptors:{unicodeRange:"U+20dd-20de,U+25ef,U+ff2b-ffbe,U+ffc2-ffc7,U+ffca-ffcf,U+ffd2-ffd7,U+ffda-ffdc,U+ffe0-ffe6,U+ffe8-ffee"}},{uri:Zme,descriptors:{unicodeRange:"U+d7eb-d7fb,U+f900-f9b7"}},{uri:Qme,descriptors:{unicodeRange:"U+d6f2-d7a3,U+d7b0-d7c6,U+d7cb-d7ea"}},{uri:e0e,descriptors:{unicodeRange:"U+d609-d6f1"}},{uri:t0e,descriptors:{unicodeRange:"U+d520-d608"}},{uri:Jme,descriptors:{unicodeRange:"U+d437-d51f"}},{uri:n0e,descriptors:{unicodeRange:"U+d34e-d436"}},{uri:s0e,descriptors:{unicodeRange:"U+d265-d34d"}},{uri:r0e,descriptors:{unicodeRange:"U+d17c-d264"}},{uri:Kme,descriptors:{unicodeRange:"U+d093-d17b"}},{uri:o0e,descriptors:{unicodeRange:"U+cfaa-d092"}},{uri:a0e,descriptors:{unicodeRange:"U+cec1-cfa9"}},{uri:Vme,descriptors:{unicodeRange:"U+cdd8-cec0"}},{uri:Wme,descriptors:{unicodeRange:"U+ccf1-cdd7"}},{uri:l0e,descriptors:{unicodeRange:"U+cc08-ccf0"}},{uri:Hme,descriptors:{unicodeRange:"U+cb43-cc07"}},{uri:c0e,descriptors:{unicodeRange:"U+ca83-cb42"}},{uri:d0e,descriptors:{unicodeRange:"U+c9a1-ca82"}},{uri:u0e,descriptors:{unicodeRange:"U+c8b8-c9a0"}},{uri:f0e,descriptors:{unicodeRange:"U+c7cf-c8b7"}},{uri:h0e,descriptors:{unicodeRange:"U+c6e6-c7ce"}},{uri:g0e,descriptors:{unicodeRange:"U+c5fd-c6e5"}},{uri:m0e,descriptors:{unicodeRange:"U+c514-c5fc"}},{uri:p0e,descriptors:{unicodeRange:"U+c42b-c513"}},{uri:U0e,descriptors:{unicodeRange:"U+c341-c34e,U+c350-c42a"}},{uri:b0e,descriptors:{unicodeRange:"U+c258-c340"}},{uri:y0e,descriptors:{unicodeRange:"U+c16f-c257"}},{uri:E0e,descriptors:{unicodeRange:"U+c086-c16e"}},{uri:v0e,descriptors:{unicodeRange:"U+bf9d-c085"}},{uri:i0e,descriptors:{unicodeRange:"U+beb4-bf9c"}},{uri:_0e,descriptors:{unicodeRange:"U+bdcb-beb3"}},{uri:w0e,descriptors:{unicodeRange:"U+bce2-bdca"}},{uri:T0e,descriptors:{unicodeRange:"U+bbf9-bce1"}},{uri:I0e,descriptors:{unicodeRange:"U+bb10-bbf8"}},{uri:S0e,descriptors:{unicodeRange:"U+ba27-bb0f"}},{uri:x0e,descriptors:{unicodeRange:"U+b93e-ba26"}},{uri:C0e,descriptors:{unicodeRange:"U+b855-b93d"}},{uri:A0e,descriptors:{unicodeRange:"U+b76c-b854"}},{uri:P0e,descriptors:{unicodeRange:"U+b683-b76b"}},{uri:N0e,descriptors:{unicodeRange:"U+b59a-b682"}},{uri:M0e,descriptors:{unicodeRange:"U+b4b1-b599"}},{uri:O0e,descriptors:{unicodeRange:"U+11fb-11ff,U+b3cd-b4b0"}},{uri:F0e,descriptors:{unicodeRange:"U+11e6-11fa,U+b2f9-b3cc"}},{uri:B0e,descriptors:{unicodeRange:"U+11d1-11e5,U+b225-b2f8"}},{uri:L0e,descriptors:{unicodeRange:"U+11bc-11d0,U+b151-b224"}},{uri:z0e,descriptors:{unicodeRange:"U+11a7-11bb,U+b07d-b150"}},{uri:D0e,descriptors:{unicodeRange:"U+1191-11a6,U+afaa-b07c"}},{uri:H0e,descriptors:{unicodeRange:"U+117c-1190,U+aed6-afa9"}},{uri:V0e,descriptors:{unicodeRange:"U+1167-117b,U+ae02-aed5"}},{uri:$0e,descriptors:{unicodeRange:"U+1152-115e,U+1160-1166,U+ad2d-ae01"}},{uri:G0e,descriptors:{unicodeRange:"U+113d-1151,U+ac59-ad2c"}},{uri:X0e,descriptors:{unicodeRange:"U+1100-113c,U+9f95-9f98,U+9f9c-9f9e,U+9fa1-9fce,U+9fd0,U+a960-a97c,U+ac00-ac58"}},{uri:j0e,descriptors:{unicodeRange:"U+9771-9772,U+9775,U+9777-977b,U+977d-9784,U+9786-978a,U+978c,U+978e-9790,U+9793,U+9795-9797,U+9799-979f,U+97a1-97a2,U+97a4-97aa,U+97ac,U+97ae,U+97b0-97b1,U+97b3,U+97b5-97e5,U+97e8,U+97ee-97f2,U+97f4,U+97f7-982d"}},{uri:Y0e,descriptors:{unicodeRange:"U+9491,U+9496,U+9498,U+94c7,U+94cf,U+94d3-94d4,U+94da,U+94e6,U+94fb,U+951c,U+9520,U+9527,U+9533,U+953d,U+9543,U+9548,U+954b,U+9555,U+955a,U+9560,U+956e,U+9574-9575,U+9577-957e,U+9580-95e7,U+95ec,U+95ff,U+9607,U+9613,U+9618,U+961b,U+961e,U+9620,U+9623-9629,U+962b-962d,U+962f-9630,U+9637-963a,U+963e,U+9641,U+9643,U+964a,U+964e-964f,U+9651-9653,U+9656-965a,U+965c-965e,U+9660,U+9663,U+9665-9666,U+966b,U+966d-9671,U+9673,U+9678-9684,U+9687,U+9689-968a,U+968c,U+968e,U+9691-9693"}},{uri:W0e,descriptors:{unicodeRange:"U+923c-9273,U+9275-928d,U+928f-92ad,U+92af-92c7,U+92c9-92ee"}},{uri:K0e,descriptors:{unicodeRange:"U+9159,U+915b-915c,U+915f-9160,U+9166-9168,U+916b,U+916d,U+9173,U+917a-917c,U+9180-9184,U+9186,U+9188,U+918a,U+918e-918f,U+9193-9199,U+919c-91a1,U+91a4-91a9,U+91ab-91ac,U+91b0-91b3,U+91b6-91b9,U+91bb-91c6,U+91c8,U+91cb,U+91d0,U+91d2-91db,U+91dd-923b"}},{uri:Z0e,descriptors:{unicodeRange:"U+902b-902c,U+9030-9034,U+9037,U+9039-903a,U+903d,U+903f-9040,U+9043,U+9045-9046,U+9048-904c,U+904e,U+9054-9056,U+9059-905a,U+905c-9061,U+9064,U+9066-9067,U+9069-906c,U+906f-9073,U+9076-907c,U+907e,U+9081,U+9084-9087,U+9089-908a,U+908c-9090,U+9092,U+9094,U+9096,U+9098,U+909a,U+909c,U+909e-90a0,U+90a4-90a5,U+90a7-90a9,U+90ab,U+90ad,U+90b2,U+90b7,U+90bc-90bd,U+90bf-90c0,U+90c2-90c3,U+90c6,U+90c8-90c9,U+90cb-90cd,U+90d2,U+90d4-90d6,U+90d8-90da,U+90de-90e0,U+90e3-90e5,U+90e9-90ea,U+90ec,U+90ee,U+90f0-90f3,U+90f5-90f7,U+90f9-90fc,U+90ff-9101,U+9103,U+9105-9118,U+911a-911d,U+911f-9121,U+9124-912e,U+9130,U+9132-9138,U+913a-9142,U+9144-9145,U+9147-9148,U+9151,U+9153-9156,U+9158"}},{uri:q0e,descriptors:{unicodeRange:"U+8f03-8f65,U+8f6a,U+8f80,U+8f8c,U+8f92,U+8f9d,U+8fa0-8fa2,U+8fa4-8fa7,U+8faa,U+8fac-8faf,U+8fb2-8fb5,U+8fb7-8fb8,U+8fba-8fbc,U+8fbf-8fc0,U+8fc3,U+8fc6,U+8fc9-8fcd,U+8fcf,U+8fd2,U+8fd6-8fd7,U+8fda,U+8fe0-8fe1,U+8fe3,U+8fe7,U+8fec,U+8fef,U+8ff1-8ff2,U+8ff4-8ff6,U+8ffa-8ffc,U+8ffe-8fff,U+9007-9008,U+900c,U+900e,U+9013,U+9015,U+9018-9019,U+901c,U+9023-9025,U+9027-902a"}},{uri:Q0e,descriptors:{unicodeRange:"U+8d03-8d1c,U+8d20,U+8d51-8d52,U+8d57,U+8d5f,U+8d65,U+8d68-8d6a,U+8d6c,U+8d6e-8d6f,U+8d71-8d72,U+8d78-8d80,U+8d82-8d83,U+8d86-8d89,U+8d8c-8d90,U+8d92-8d93,U+8d95-8d9e,U+8da0-8da2,U+8da4-8db0,U+8db2,U+8db6-8db7,U+8db9,U+8dbb,U+8dbd,U+8dc0-8dc2,U+8dc5,U+8dc7-8dca,U+8dcd,U+8dd0,U+8dd2-8dd5,U+8dd8-8dd9,U+8ddc,U+8de0-8de2,U+8de5-8de7,U+8de9,U+8ded-8dee,U+8df0-8df2,U+8df4,U+8df6,U+8dfc,U+8dfe-8e04,U+8e06-8e08,U+8e0b,U+8e0d-8e0e,U+8e10-8e13,U+8e15-8e1c,U+8e20-8e21,U+8e24-8e28,U+8e2b,U+8e2d,U+8e30,U+8e32-8e34,U+8e36-8e38,U+8e3b-8e3c,U+8e3e-8e3f,U+8e43,U+8e45-8e46"}},{uri:J0e,descriptors:{unicodeRange:"U+8bea,U+8c09,U+8c1e,U+8c38-8c40,U+8c42-8c45,U+8c48,U+8c4a-8c4b,U+8c4d-8c54,U+8c56-8c59,U+8c5b-8c60,U+8c63-8c69,U+8c6c-8c72,U+8c74-8c77,U+8c7b-8c81,U+8c83-8c84,U+8c86-8c88,U+8c8b,U+8c8d-8c93,U+8c95-8c97,U+8c99-8d02"}},{uri:epe,descriptors:{unicodeRange:"U+8a64-8a78,U+8a7a-8a88,U+8a8b-8a92,U+8a94-8b06,U+8b08-8b1b"}},{uri:tpe,descriptors:{unicodeRange:"U+8987-89c0,U+89c3,U+89cd,U+89d3-89d5,U+89d7-89d9,U+89db,U+89dd,U+89df-89e2,U+89e4,U+89e7-89ea,U+89ec-89ee,U+89f0-89f2,U+89f4-89ff,U+8a01-8a06,U+8a08-8a3d,U+8a3f-8a47,U+8a49-8a63"}},{uri:npe,descriptors:{unicodeRange:"U+87e3-87e4,U+87e6-87e9,U+87eb-87ed,U+87ef-87f8,U+87fa-87fd,U+87ff-8802,U+8804-8809,U+880b-8812,U+8814,U+8817-881a,U+881c-8820,U+8823-8831,U+8833-8838,U+883a-883b,U+883d-883f,U+8841-8843,U+8846-884b,U+884e-8853,U+8855-8856,U+8858,U+885a-8860,U+8866-8867,U+886a,U+886d,U+886f,U+8871,U+8873-8876,U+8878-887c,U+8880,U+8883,U+8886-8887,U+8889-888a,U+888c,U+888e-8891,U+8893-8895,U+8897-889b,U+889d-88a1,U+88a3,U+88a5-88aa,U+88ac,U+88ae-88b0,U+88b2-88b6,U+88b8-88bb"}},{uri:ipe,descriptors:{unicodeRange:"U+86e7-86e8,U+86ea-86ec,U+86ef,U+86f5-86f7,U+86fa-86fd,U+86ff,U+8701,U+8704-8706,U+870b-870c,U+870e-8711,U+8714,U+8716,U+8719,U+871b,U+871d,U+871f-8720,U+8724,U+8726-8728,U+872a-872d,U+872f-8730,U+8732-8733,U+8735-8736,U+8738-873a,U+873c-873d,U+8740-8746,U+874a-874b,U+874d,U+874f-8752,U+8754-8756,U+8758,U+875a-875f,U+8761-8762,U+8766-876d,U+876f,U+8771-8773,U+8775,U+8777-877a,U+877f-8781,U+8784,U+8786-8787,U+8789-878a,U+878c,U+878e-8792,U+8794-8796,U+8798-879e,U+87a0-87a7,U+87a9-87aa,U+87ae,U+87b0-87b2,U+87b4,U+87b6-87b9,U+87bb-87bc,U+87be-87bf,U+87c1-87c5,U+87c7-87c9,U+87cc-87d0,U+87d4-87da,U+87dc-87df,U+87e1-87e2"}},{uri:spe,descriptors:{unicodeRange:"U+8604,U+8606-8610,U+8612-8615,U+8617-8626,U+8628,U+862a-8637,U+8639-863b,U+863d-864c,U+8652-8653,U+8655-8659,U+865b-865d,U+865f-8661,U+8663-866a,U+866d,U+866f-8670,U+8672-8678,U+8683-8689,U+868e-8692,U+8694,U+8696-869b,U+869e-86a2,U+86a5-86a6,U+86ab,U+86ad-86ae,U+86b2-86b3,U+86b7-86b9,U+86bb-86bf,U+86c1-86c3,U+86c5,U+86c8,U+86cc-86cd,U+86d2-86d3,U+86d5-86d7,U+86da,U+86dc-86dd,U+86e0-86e3,U+86e5-86e6"}},{uri:rpe,descriptors:{unicodeRange:"U+8456,U+8458,U+845d-8460,U+8462,U+8464-8468,U+846a,U+846e-8470,U+8472,U+8474,U+8477,U+8479,U+847b-8481,U+8483-8486,U+848a,U+848d,U+848f-8496,U+8498,U+849a-849b,U+849d-84a0,U+84a2-84ae,U+84b0-84b1,U+84b3,U+84b5-84b7,U+84bb-84bc,U+84be,U+84c0,U+84c2-84c3,U+84c5-84c8,U+84cb-84cc,U+84ce-84cf,U+84d2,U+84d4-84d5,U+84d7-84dc,U+84de,U+84e1-84e2,U+84e4,U+84e7-84eb,U+84ed-84ef,U+84f1-84fb,U+84fd-84fe,U+8500-850b,U+850d-8510,U+8512,U+8514-8516,U+8518-8519,U+851b-851e,U+8520,U+8522-852a,U+852d-8536,U+853e-8542,U+8544-8547,U+854b-854f"}},{uri:ope,descriptors:{unicodeRange:"U+82c2-82c3,U+82c5-82c6,U+82c9,U+82d0,U+82d6,U+82d9-82da,U+82dd,U+82e2,U+82e7-82ea,U+82ec-82ee,U+82f0,U+82f2-82f3,U+82f5-82f6,U+82f8,U+82fa,U+82fc-8300,U+830a-830b,U+830d,U+8310,U+8312-8313,U+8316,U+8318-8319,U+831d-8326,U+8329-832a,U+832e,U+8330,U+8332,U+8337,U+833b,U+833d-833f,U+8341-8342,U+8344-8345,U+8348,U+834a-834e,U+8353,U+8355-8359,U+835d,U+8362,U+8370-8376,U+8379-837a,U+837e-8384,U+8387-8388,U+838a-838d,U+838f-8391,U+8394-8397,U+8399-839a,U+839d,U+839f,U+83a1-83a7,U+83ac-83af,U+83b5,U+83bb,U+83be-83bf,U+83c2-83c4,U+83c6,U+83c8-83c9,U+83cb,U+83cd-83ce,U+83d0-83d3,U+83d5,U+83d7,U+83d9-83db,U+83de,U+83e2-83e4,U+83e6-83e8,U+83eb-83ef,U+83f3-83f7,U+83fa-83fc,U+83fe-8400,U+8402,U+8405,U+8407-840a,U+8410,U+8412-8417,U+8419-841b,U+841e-8423,U+8429-8430,U+8432-8437,U+8439-843b,U+843e-8445,U+8447-8450,U+8452-8455"}},{uri:ape,descriptors:{unicodeRange:"U+81a4-81a5,U+81a7,U+81a9,U+81ab-81b2,U+81b4-81b9,U+81bc-81bf,U+81c4-81c5,U+81c7-81c9,U+81cb,U+81cd-81e2,U+81e4-81e6,U+81e8-81e9,U+81eb,U+81ee-81f2,U+81f5-81fa,U+81fd,U+81ff,U+8203,U+8207-820b,U+820e-820f,U+8211,U+8213,U+8215-821a,U+821d,U+8220,U+8224-8227,U+8229,U+822e,U+8232,U+823a,U+823c-823d,U+823f-8243,U+8245-8246,U+8248,U+824a,U+824c-824e,U+8250-8257,U+8259,U+825b-825e,U+8260-8267,U+8269-826d,U+8271,U+8275-8278,U+827b-827c,U+8280-8281,U+8283,U+8285-8287,U+8289,U+828c,U+8290,U+8293-8296,U+829a-829b,U+829e,U+82a0,U+82a2-82a3,U+82a7,U+82b2,U+82b5-82b6,U+82ba-82bc,U+82bf-82c0"}},{uri:lpe,descriptors:{unicodeRange:"U+8059,U+805b-8068,U+806b-8070,U+8072-807e,U+8081-8082,U+8085,U+8088,U+808a,U+808d-8092,U+8094-8095,U+8097,U+8099,U+809e,U+80a3,U+80a6-80a8,U+80ac,U+80b0,U+80b3,U+80b5-80b6,U+80b8-80b9,U+80bb,U+80c5,U+80c7-80cb,U+80cf-80d5,U+80d8,U+80df-80e0,U+80e2-80e3,U+80e6,U+80ee,U+80f5,U+80f7,U+80f9,U+80fb,U+80fe-8101,U+8103-8105,U+8107-8108,U+810b-810c,U+8115,U+8117,U+8119,U+811b-811d,U+811f-812b,U+812d-812e,U+8130,U+8133-8135,U+8137,U+8139-813d,U+813f-8145,U+8147,U+8149,U+814d-814f,U+8152,U+8156-8158,U+815b-815f,U+8161-8164,U+8166,U+8168,U+816a-816c,U+816f,U+8172-8173,U+8175-8178,U+8181,U+8183-8187,U+8189,U+818b-818e,U+8190,U+8192-8197,U+8199-819a,U+819e-81a2"}},{uri:cpe,descriptors:{unicodeRange:"U+7f3c-7f41,U+7f43,U+7f46-7f4f,U+7f52-7f53,U+7f56,U+7f59,U+7f5b-7f5e,U+7f60,U+7f63-7f67,U+7f6b-7f6d,U+7f6f-7f70,U+7f73,U+7f75-7f78,U+7f7a-7f7d,U+7f7f-7f80,U+7f82-7f89,U+7f8b,U+7f8d,U+7f8f-7f93,U+7f95-7f99,U+7f9b-7f9c,U+7fa0,U+7fa2-7fa3,U+7fa5-7fa6,U+7fa8-7fae,U+7fb1,U+7fb3-7fb7,U+7fba-7fbb,U+7fbe,U+7fc0,U+7fc2-7fc4,U+7fc6-7fc9,U+7fcb,U+7fcd,U+7fcf-7fd3,U+7fd6-7fd7,U+7fd9-7fde,U+7fe2-7fe4,U+7fe7-7fe8,U+7fea-7fed,U+7fef,U+7ff2,U+7ff4-7ffa,U+7ffd-7fff,U+8002,U+8007-800a,U+800e-800f,U+8011,U+8013,U+801a-801b,U+801d-801f,U+8021,U+8023-8024,U+802b-8030,U+8032,U+8034,U+8039-803a,U+803c,U+803e,U+8040-8041,U+8044-8045,U+8047-8049,U+804e-8051,U+8053,U+8055-8057"}},{uri:Gme,descriptors:{unicodeRange:"U+7cd8,U+7cda-7cdb,U+7cdd-7cde,U+7ce1-7ce7,U+7ce9-7cee,U+7cf0-7cf7,U+7cf9-7cfa,U+7cfc-7d09,U+7d0b-7d1f,U+7d21,U+7d23-7d26,U+7d28-7d2a,U+7d2c-7d2e,U+7d30-7d6d,U+7d6f-7d76,U+7d78-7d94"}},{uri:dpe,descriptors:{unicodeRange:"U+7afe,U+7b00-7b02,U+7b05,U+7b07,U+7b09,U+7b0c-7b0e,U+7b10,U+7b12-7b13,U+7b16-7b18,U+7b1a,U+7b1c-7b1d,U+7b1f,U+7b21-7b23,U+7b27,U+7b29,U+7b2d,U+7b2f-7b30,U+7b32,U+7b34-7b37,U+7b39,U+7b3b,U+7b3d,U+7b3f-7b44,U+7b46,U+7b48,U+7b4a,U+7b4d-7b4e,U+7b53,U+7b55,U+7b57,U+7b59,U+7b5c,U+7b5e-7b5f,U+7b61,U+7b63-7b6d,U+7b6f-7b70,U+7b73-7b74,U+7b76,U+7b78,U+7b7a,U+7b7c-7b7d,U+7b7f,U+7b81-7b84,U+7b86-7b8c,U+7b8e-7b8f,U+7b91-7b93,U+7b96,U+7b98-7b9b,U+7b9e-7ba0,U+7ba3-7ba5,U+7bae-7bb0,U+7bb2-7bb3,U+7bb5-7bb7,U+7bb9-7bc0,U+7bc2-7bc5,U+7bc8-7bcb,U+7bcd-7bd0,U+7bd2,U+7bd4-7bd8,U+7bdb-7bdc,U+7bde-7be0,U+7be2-7be4,U+7be7-7be9,U+7beb-7bed,U+7bef-7bf0,U+7bf2-7bf6,U+7bf8-7bfb,U+7bfd,U+7bff-7c06,U+7c08-7c0a,U+7c0d-7c0e,U+7c10-7c13"}},{uri:upe,descriptors:{unicodeRange:"U+7a10-7a13,U+7a15-7a16,U+7a18-7a19,U+7a1b-7a1d,U+7a1f,U+7a21-7a22,U+7a24-7a32,U+7a34-7a36,U+7a38,U+7a3a,U+7a3e,U+7a40-7a45,U+7a47-7a50,U+7a52-7a56,U+7a58-7a6f,U+7a71-7a73,U+7a75,U+7a7b-7a7e,U+7a82,U+7a85,U+7a87,U+7a89-7a8c,U+7a8e-7a90,U+7a93-7a94,U+7a99-7a9b,U+7a9e,U+7aa1-7aa4,U+7aa7,U+7aa9-7aab,U+7aae-7ab2,U+7ab4-7abe,U+7ac0-7aca,U+7acc-7ad5,U+7ad7-7ad8,U+7ada-7add,U+7ae1-7ae2,U+7ae4,U+7ae7-7aec,U+7aee,U+7af0-7af8,U+7afb-7afc"}},{uri:fpe,descriptors:{unicodeRange:"U+790d-7912,U+7914-791d,U+791f-7923,U+7925-7933,U+7935-7939,U+793d,U+793f,U+7942-7945,U+7947,U+794a-7952,U+7954-7955,U+7958-7959,U+7961,U+7963-7964,U+7966,U+7969-796c,U+796e,U+7970-7976,U+7979,U+797b-797f,U+7982-7983,U+7986-7989,U+798b-798e,U+7990-7999,U+799b-79a6,U+79a8-79b2,U+79b4-79b8,U+79bc,U+79bf,U+79c2,U+79c4-79c5,U+79c7-79c8,U+79ca,U+79cc,U+79ce-79d0,U+79d3-79d4,U+79d6-79d7,U+79d9-79de,U+79e0-79e2,U+79e5,U+79e8,U+79ea,U+79ec,U+79ee,U+79f1-79f7,U+79f9-79fa,U+79fc,U+79fe-79ff,U+7a01,U+7a04-7a05,U+7a07-7a0a,U+7a0c,U+7a0f"}},{uri:hpe,descriptors:{unicodeRange:"U+77d8-77da,U+77dd-77e1,U+77e4,U+77e6,U+77e8,U+77ea,U+77ef-77f2,U+77f4-77f5,U+77f7,U+77f9-77fc,U+7803-7808,U+780a-780b,U+780e-7810,U+7813,U+7815,U+7819,U+781b,U+781e,U+7820-7822,U+7824,U+7828,U+782a-782b,U+782e-782f,U+7831-7833,U+7835-7836,U+783d,U+783f,U+7841-7844,U+7846,U+7848-784b,U+784d,U+784f,U+7851,U+7853-7854,U+7858-785c,U+785e-7869,U+786f-7876,U+7878-787b,U+787d-7886,U+7888,U+788a-788b,U+788f-7890,U+7892,U+7894-7896,U+7899,U+789d-789e,U+78a0,U+78a2,U+78a4,U+78a6,U+78a8-78af,U+78b5-78b8,U+78ba-78bd,U+78bf-78c0,U+78c2-78c4,U+78c6-78c8,U+78cc-78cf,U+78d1-78d3,U+78d6-78d8,U+78da-78e7,U+78e9-78eb,U+78ed-78f1,U+78f3,U+78f5-78f6,U+78f8-78f9,U+78fb-7900,U+7902-7904,U+7906-790c"}},{uri:gpe,descriptors:{unicodeRange:"U+76af-76b0,U+76b3,U+76b5-76be,U+76c0-76c1,U+76c3-76c4,U+76c7,U+76c9,U+76cb-76cc,U+76d3,U+76d5,U+76d9-76da,U+76dc-76de,U+76e0-76e4,U+76e6-76ed,U+76f0,U+76f3,U+76f5-76f7,U+76fa-76fb,U+76fd,U+76ff-7703,U+7705-7706,U+770a,U+770c,U+770e-7718,U+771b-771e,U+7721,U+7723-7725,U+7727,U+772a-772c,U+772e,U+7730-7734,U+7739,U+773b,U+773d-773f,U+7742,U+7744-7746,U+7748-774f,U+7752-7759,U+775c-7760,U+7764,U+7767,U+7769-776a,U+776d-7778,U+777a-777c,U+7781-7783,U+7786-778b,U+778f-7790,U+7793-779e,U+77a1,U+77a3-77a4,U+77a6,U+77a8,U+77ab,U+77ad-77af,U+77b1-77b2,U+77b4,U+77b6-77ba,U+77bc,U+77be,U+77c0-77cc,U+77ce-77d6"}},{uri:mpe,descriptors:{unicodeRange:"U+7589-758a,U+758c-758e,U+7590,U+7593,U+7595,U+7598,U+759b-759c,U+759e,U+75a2,U+75a6-75aa,U+75ad,U+75b6-75b7,U+75ba-75bb,U+75bf-75c1,U+75c6,U+75cb-75cc,U+75ce-75d1,U+75d3,U+75d7,U+75d9-75da,U+75dc-75dd,U+75df-75e1,U+75e5,U+75e9,U+75ec-75ef,U+75f2-75f3,U+75f5-75f8,U+75fa-75fb,U+75fd-75fe,U+7602,U+7604,U+7606-7609,U+760b,U+760d-760f,U+7611-7614,U+7616,U+761a,U+761c-761e,U+7621,U+7623,U+7627-7628,U+762c,U+762e-762f,U+7631-7632,U+7636-7637,U+7639-763b,U+763d,U+7641-7642,U+7644-764b,U+764e-7653,U+7655,U+7657-765b,U+765d,U+765f-7662,U+7664-766a,U+766c-766e,U+7670-7677,U+7679-767a,U+767c,U+767f-7681,U+7683,U+7685,U+7689-768a,U+768c-768d,U+768f-7690,U+7692,U+7694-7695,U+7697-7698,U+769a-76a3,U+76a5-76ad"}},{uri:ppe,descriptors:{unicodeRange:"U+7492-749b,U+749d,U+749f-74a6,U+74aa-74b9,U+74bb-74d1,U+74d3-74db,U+74dd,U+74df,U+74e1,U+74e5,U+74e7-74ed,U+74f0-74f3,U+74f5,U+74f8-74fe,U+7500-7503,U+7505-750c,U+750e,U+7510,U+7512,U+7514-7517,U+751b,U+751d-751e,U+7520-7524,U+7526-7527,U+752a,U+752e,U+7534,U+7536,U+7539,U+753c-753d,U+753f,U+7541-7544,U+7546-7547,U+7549-754a,U+754d,U+7550-7553,U+7555-7558,U+755d-7564,U+7567-7569,U+756b-7571,U+7573,U+7575-7577,U+757a-757e,U+7580-7582,U+7584-7585,U+7587-7588"}},{uri:Upe,descriptors:{unicodeRange:"U+7372-737d,U+737f-7383,U+7385-7386,U+7388,U+738a,U+738c-738d,U+738f-7390,U+7392-7395,U+7397-739a,U+739c-739e,U+73a0-73a1,U+73a3-73a8,U+73aa,U+73ac-73ad,U+73b1,U+73b4-73b6,U+73b8-73b9,U+73bc-73bf,U+73c1,U+73c3-73c7,U+73cb-73cc,U+73ce,U+73d2-73d8,U+73da-73dd,U+73df,U+73e1-73e4,U+73e6,U+73e8,U+73ea-73ec,U+73ee-73f1,U+73f3-7402,U+7404,U+7407-7408,U+740b-740e,U+7411-7419,U+741c-7421,U+7423-7424,U+7427,U+7429,U+742b,U+742d,U+742f,U+7431-7432,U+7437-743b,U+743d-7440,U+7442-7454,U+7456,U+7458,U+745d,U+7460-746c,U+746e-746f,U+7471-7475,U+7478-747d,U+747f,U+7482,U+7484-7486,U+7488-748a,U+748c-748d,U+748f,U+7491"}},{uri:zme,descriptors:{unicodeRange:"U+7054-705d,U+705f-706a,U+706e,U+7071-7074,U+7077,U+7079-707b,U+707d,U+7081-7084,U+7086-7088,U+708b-708d,U+708f-7091,U+7093,U+7097-7098,U+709a-709b,U+709e-70aa,U+70b0,U+70b2,U+70b4-70b6,U+70ba,U+70be-70bf,U+70c4-70c7,U+70c9,U+70cb-70d7,U+70da,U+70dc-70de,U+70e0-70e3,U+70e5,U+70ea,U+70ee,U+70f0-70f6,U+70f8,U+70fa-70fc,U+70fe-7108,U+710b-710f,U+7111-7112,U+7114,U+7117,U+711b-7125,U+7127-712e,U+7132-7135,U+7137-7144,U+7146-7149,U+714b,U+714d,U+714f-715b,U+715d,U+715f-7163,U+7165,U+7169-716d,U+716f-7171,U+7174-7177"}},{uri:bpe,descriptors:{unicodeRange:"U+722e-722f,U+7232-7234,U+723a,U+723c,U+723e,U+7240-7246,U+7249-724b,U+724e-7251,U+7253-7255,U+7257-7258,U+725a,U+725c,U+725e,U+7260,U+7263-7265,U+7268,U+726a-726d,U+7270-7271,U+7273-7274,U+7276-7278,U+727b-727d,U+7282-7283,U+7285-7289,U+728c,U+728e,U+7290-7291,U+7293-729e,U+72a0-72ab,U+72ae,U+72b1-72b3,U+72b5,U+72ba-72c0,U+72c5-72c7,U+72c9-72cc,U+72cf,U+72d1,U+72d3-72d6,U+72d8,U+72da-72dd,U+72df,U+72e2-72e7,U+72ea-72eb,U+72f5-72f6,U+72f9,U+72fd-7300,U+7302,U+7304-7309,U+730b-730d,U+730f-7312,U+7314,U+7318-731a,U+731f-7320,U+7323-7324,U+7326-7328,U+732d,U+732f-7330,U+7332-7333,U+7335-7336,U+733a-733d,U+7340-734c,U+734e-734f,U+7351,U+7353-7356,U+7358-735f,U+7361-736b,U+736e,U+7370-7371"}},{uri:R0e,descriptors:{unicodeRange:"U+6ec5-6ec6,U+6ec8-6eca,U+6ecc-6ece,U+6ed0,U+6ed2,U+6ed6,U+6ed8-6ed9,U+6edb-6edd,U+6ee3,U+6ee7,U+6eea-6ef3,U+6ef5-6ef8,U+6efa-6f01,U+6f03-6f05,U+6f07-6f08,U+6f0a-6f0e,U+6f10-6f12,U+6f16-6f1f,U+6f21-6f23,U+6f25-6f28,U+6f2c,U+6f2e,U+6f30,U+6f32,U+6f34-6f35,U+6f37-6f3d,U+6f3f-6f45,U+6f48-6f4a,U+6f4c,U+6f4e-6f57,U+6f59-6f5b,U+6f5d,U+6f5f-6f61,U+6f63-6f65,U+6f67-6f6c,U+6f6f-6f71,U+6f73,U+6f75-6f77,U+6f79,U+6f7b,U+6f7d-6f83,U+6f85-6f87,U+6f8a-6f8b,U+6f8f-6f9b,U+6f9d-6fa0,U+6fa2-6fa6,U+6fa8-6fb1"}},{uri:ype,descriptors:{unicodeRange:"U+6d73,U+6d75-6d76,U+6d79-6d7b,U+6d7d-6d81,U+6d83-6d84,U+6d86-6d87,U+6d8a-6d8b,U+6d8d,U+6d8f-6d90,U+6d92,U+6d96-6d9a,U+6d9c,U+6da2,U+6da5,U+6dac-6dad,U+6db0-6db1,U+6db3-6db4,U+6db6-6db7,U+6db9-6dbe,U+6dc1-6dc3,U+6dc8-6dca,U+6dcd-6dd0,U+6dd2-6dd5,U+6dd7,U+6dda-6ddc,U+6ddf,U+6de2-6de3,U+6de5,U+6de7-6dea,U+6ded,U+6def-6df0,U+6df2,U+6df4-6df6,U+6df8,U+6dfa,U+6dfd-6e04,U+6e06-6e09,U+6e0b,U+6e0f,U+6e12-6e13,U+6e15,U+6e18-6e19,U+6e1b-6e1c,U+6e1e-6e1f,U+6e22,U+6e26-6e28,U+6e2a,U+6e2c,U+6e2e,U+6e30-6e31,U+6e33,U+6e35-6e37,U+6e39,U+6e3b-6e42,U+6e45-6e4c,U+6e4f-6e52,U+6e55,U+6e57,U+6e59-6e5a,U+6e5c-6e5e,U+6e60-6e6a,U+6e6c-6e6d,U+6e6f-6e7d,U+6e80-6e82,U+6e84,U+6e87-6e88,U+6e8a-6e8e,U+6e91-6e97,U+6e99-6e9b,U+6e9d-6e9e,U+6ea0-6ea1,U+6ea3-6ea4,U+6ea6,U+6ea8-6ea9,U+6eab-6eae,U+6eb0,U+6eb3,U+6eb5,U+6eb8-6eb9,U+6ebc,U+6ebe-6ec0,U+6ec3-6ec4"}},{uri:Epe,descriptors:{unicodeRange:"U+6bbb-6bbe,U+6bc0,U+6bc3-6bc4,U+6bc6-6bca,U+6bcc,U+6bce,U+6bd0-6bd1,U+6bd8,U+6bda,U+6bdc-6be0,U+6be2-6be9,U+6bec-6bee,U+6bf0-6bf2,U+6bf4,U+6bf6-6bf8,U+6bfa-6bfc,U+6bfe-6c04,U+6c08-6c0c,U+6c0e,U+6c12,U+6c17,U+6c1c-6c1e,U+6c20,U+6c23,U+6c25,U+6c2b-6c2d,U+6c31,U+6c33,U+6c36-6c37,U+6c39-6c3c,U+6c3e-6c3f,U+6c43-6c45,U+6c48,U+6c4b-6c4f,U+6c51-6c53,U+6c56,U+6c58-6c5a,U+6c62-6c63,U+6c65-6c67,U+6c6b-6c6f,U+6c71,U+6c73,U+6c75,U+6c77-6c78,U+6c7a-6c7c,U+6c7f-6c80,U+6c84,U+6c87,U+6c8a-6c8b,U+6c8d-6c8e,U+6c91-6c92,U+6c95-6c98,U+6c9a,U+6c9c-6c9e,U+6ca0,U+6ca2,U+6ca8,U+6cac,U+6caf-6cb0,U+6cb4-6cb7,U+6cba,U+6cc0-6cc3,U+6cc6-6cc8,U+6ccb,U+6ccd-6ccf,U+6cd1-6cd2,U+6cd8-6cda,U+6cdc-6cdd,U+6cdf,U+6ce4,U+6ce6-6ce7,U+6ce9,U+6cec-6ced,U+6cf2,U+6cf4,U+6cf9,U+6cff-6d00,U+6d02-6d03,U+6d05-6d06,U+6d08-6d0a,U+6d0d,U+6d0f-6d11,U+6d13-6d16,U+6d18,U+6d1c-6d1d,U+6d1f-6d24,U+6d26,U+6d28-6d29,U+6d2c-6d2d,U+6d2f-6d30,U+6d34,U+6d36-6d38,U+6d3a,U+6d3f-6d40,U+6d42,U+6d44,U+6d49,U+6d4c,U+6d50,U+6d55-6d58,U+6d5b,U+6d5d,U+6d5f,U+6d61-6d62,U+6d64-6d65,U+6d67-6d68,U+6d6b-6d6d,U+6d70-6d72"}},{uri:vpe,descriptors:{unicodeRange:"U+6967-696a,U+696c-696d,U+696f-6970,U+6972-6976,U+697a-697b,U+697d-697f,U+6981,U+6983,U+6985,U+698a-698c,U+698e-6993,U+6996-6997,U+6999-699a,U+699d-69a6,U+69a9-69aa,U+69ac,U+69ae-69b0,U+69b2-69b3,U+69b5-69b6,U+69b8-69ba,U+69bc-69c0,U+69c2-69c9,U+69cb,U+69cd,U+69cf,U+69d1-69d3,U+69d5-69da,U+69dc-69de,U+69e1-69ec,U+69ee-69f1,U+69f3-69fc,U+69fe,U+6a00-6a09,U+6a0b-6a16,U+6a19-6a1e,U+6a20,U+6a22-6a27,U+6a29,U+6a2b-6a2e,U+6a30,U+6a32-6a34,U+6a36-6a3c,U+6a3f-6a43,U+6a45-6a46,U+6a48-6a4a"}},{uri:_pe,descriptors:{unicodeRange:"U+6830-6831,U+6834-6836,U+683a-683b,U+683f,U+6847,U+684b,U+684d,U+684f,U+6852,U+6856-685f,U+686a,U+686c-6873,U+6875,U+6878-6880,U+6882,U+6884,U+6887-688e,U+6890-6892,U+6894-6896,U+6898-68a1,U+68a3-68a5,U+68a9-68ac,U+68ae,U+68b1-68b2,U+68b4,U+68b6-68bf,U+68c1,U+68c3-68c8,U+68ca,U+68cc,U+68ce-68d1,U+68d3-68d4,U+68d6-68d7,U+68d9,U+68db-68df,U+68e1-68e2,U+68e4-68ed,U+68ef,U+68f2-68f4,U+68f6-68f8,U+68fb,U+68fd-6900,U+6902-6904,U+6906-690a,U+690c,U+690f,U+6911,U+6913-691e,U+6921-6923,U+6925-692c,U+692e-692f,U+6931-6933,U+6935-6938,U+693a-693c,U+693e,U+6940-6941,U+6943-6953,U+6955-6956,U+6958-6959,U+695b-695c,U+695f,U+6961-6962,U+6964-6965"}},{uri:wpe,descriptors:{unicodeRange:"U+66b8,U+66ba-66bd,U+66bf-66d8,U+66da,U+66de-66e5,U+66e7-66e8,U+66ea-66ef,U+66f1,U+66f5-66f6,U+66f8,U+66fa-66fb,U+66fd,U+6701-6707,U+670c,U+670e-670f,U+6711-6713,U+6716,U+6718-671a,U+671c,U+671e,U+6720-6725,U+6727,U+6729,U+672e,U+6730,U+6732-6733,U+6736-6739,U+673b-673c,U+673e-673f,U+6741,U+6744-6745,U+6747,U+674a-674b,U+674d,U+6752,U+6754-6755,U+6757-675b,U+675d,U+6762-6764,U+6766-6767,U+676b-676c,U+676e,U+6771,U+6774,U+6776,U+6778-677b,U+677d,U+6780,U+6782-6783,U+6785-6786,U+6788,U+678a,U+678c-678f,U+6791-6794,U+6796,U+6799,U+679b,U+679f-67a1,U+67a4,U+67a6,U+67a9,U+67ac,U+67ae,U+67b1-67b2,U+67b4,U+67b9-67c0,U+67c2,U+67c5-67ce,U+67d5-67d7,U+67db,U+67df,U+67e1,U+67e3-67e4,U+67e6-67e8,U+67ea-67eb,U+67ed-67ee,U+67f2,U+67f5-67fc,U+67fe,U+6801-6804,U+6806,U+680d,U+6810,U+6812,U+6814-6815,U+6818-681c,U+681e-6820,U+6822-6828,U+682b-682f"}},{uri:Tpe,descriptors:{unicodeRange:"U+6569-656a,U+656d-656f,U+6571,U+6573,U+6575-6576,U+6578-6586,U+6588-658a,U+658d-658f,U+6592,U+6594-6596,U+6598,U+659a,U+659d-659e,U+65a0,U+65a2-65a3,U+65a6,U+65a8,U+65aa,U+65ac,U+65ae,U+65b1-65b8,U+65ba-65bb,U+65be-65c0,U+65c2,U+65c7-65ca,U+65cd,U+65d0-65d1,U+65d3-65d5,U+65d8-65df,U+65e1,U+65e3-65e4,U+65ea-65eb,U+65f2-65f5,U+65f8-65f9,U+65fb-65ff,U+6601,U+6604-6605,U+6607-6609,U+660b,U+660d,U+6610-6612,U+6616-6618,U+661a-661c,U+661e,U+6621-6624,U+6626,U+6629-662c,U+662e,U+6630,U+6632-6633,U+6637-663b,U+663d,U+663f-6640,U+6642,U+6644-664a,U+664d-664e,U+6650-6651,U+6658-6659,U+665b-665e,U+6660,U+6662-6663,U+6665,U+6667,U+6669-666d,U+6671-6673,U+6675,U+6678-6679,U+667b-667d,U+667f-6681,U+6683,U+6685-6686,U+6688-668b,U+668d-6690,U+6692-6695,U+6698-669c,U+669e-66a6,U+66a9-66ad,U+66af-66b3,U+66b5-66b7"}},{uri:Ipe,descriptors:{unicodeRange:"U+5f30,U+5f32-5f38,U+5f3b,U+5f3d-5f3f,U+5f41-5f4f,U+5f51,U+5f54,U+5f59-5f5c,U+5f5e-5f60,U+5f63,U+5f65,U+5f67-5f68,U+5f6b,U+5f6e-5f6f,U+5f72,U+5f74-5f76,U+5f78,U+5f7a,U+5f7d-5f7f,U+5f83,U+5f86,U+5f8d-5f8f,U+5f91,U+5f93-5f94,U+5f96,U+5f9a-5f9b,U+5f9d-5fa0,U+5fa2-5fa7,U+5fa9,U+5fab-5fac,U+5faf-5fb4,U+5fb6,U+5fb8-5fbb,U+5fbe-5fc2,U+5fc7-5fc8,U+5fca-5fcb,U+5fce,U+5fd3-5fd5,U+5fda-5fdc,U+5fde-5fdf,U+5fe2-5fe3,U+5fe5-5fe6,U+5fe8-5fe9,U+5fec,U+5fef-5ff0,U+5ff2-5ff4,U+5ff6-5ff7,U+5ff9-5ffa,U+5ffc,U+6007-6009,U+600b-600c,U+6010-6011,U+6013,U+6017-6018,U+601a,U+601e-601f,U+6022-6024,U+602c-602e,U+6030-6034,U+6036-603a,U+603d-603e,U+6040,U+6044-604a,U+604c,U+604e-604f,U+6051,U+6053-6054,U+6056-6058,U+605b-605c,U+605e-6061,U+6065-6066,U+606e,U+6071-6072,U+6074-6075,U+6077,U+607e,U+6080-6082,U+6085-6088,U+608a-608b,U+608e-6091,U+6093,U+6095,U+6097-6099,U+609c,U+609e,U+60a1-60a2,U+60a4-60a5,U+60a7,U+60a9-60aa,U+60ae,U+60b0,U+60b3,U+60b5-60b7,U+60b9-60ba,U+60bd-60c4,U+60c7-60c9,U+60cc"}},{uri:Spe,descriptors:{unicodeRange:"U+635a-635d,U+6360,U+6364-6366,U+6368,U+636a-636c,U+636f-6370,U+6372-6375,U+6378-6379,U+637c-637f,U+6381,U+6383-6386,U+638b,U+638d,U+6391,U+6393-6395,U+6397,U+6399-639f,U+63a1,U+63a4,U+63a6,U+63ab,U+63af,U+63b1-63b2,U+63b5-63b6,U+63b9,U+63bb,U+63bd,U+63bf-63c3,U+63c5,U+63c7-63c8,U+63ca-63cc,U+63d1,U+63d3-63d5,U+63d7-63dd,U+63df,U+63e2,U+63e4-63e8,U+63eb-63ec,U+63ee-63f1,U+63f3,U+63f5,U+63f7,U+63f9-63fc,U+63fe,U+6403-6404,U+6406-640a,U+640d-640e,U+6411-6412,U+6415-641a,U+641d,U+641f,U+6422-6425,U+6427-6429,U+642b,U+642e-6433,U+6435-6439,U+643b-643c,U+643e,U+6440,U+6442-6443,U+6449,U+644b-6451,U+6453,U+6455-6457,U+6459-645d,U+645f-6466,U+6468,U+646a-646c,U+646e-6477,U+647b-6481,U+6483,U+6486,U+6488-648f"}},{uri:xpe,descriptors:{unicodeRange:"U+61c5-61c7,U+61c9,U+61cc-61d0,U+61d3,U+61d5-61e5,U+61e7-61f4,U+61f6-61fe,U+6200-6205,U+6207,U+6209,U+6213-6214,U+6219,U+621c-621e,U+6220,U+6223,U+6226-6229,U+622b,U+622d,U+622f-6232,U+6235-6236,U+6238-623c,U+6242,U+6244-6246,U+624a,U+624f-6250,U+6255-6257,U+6259-625a,U+625c-6262,U+6264-6265,U+6268,U+6271-6272,U+6274-6275,U+6277-6278,U+627a-627b,U+627d,U+6281-6283,U+6285-6288,U+628b-6290,U+6294,U+6299,U+629c-629e,U+62a3,U+62a6-62a7,U+62a9-62aa,U+62ad-62b0,U+62b2-62b4,U+62b6-62b8,U+62ba,U+62be,U+62c0-62c1,U+62c3,U+62cb,U+62cf,U+62d1,U+62d5,U+62dd-62de,U+62e0-62e1,U+62e4,U+62ea-62eb,U+62f0,U+62f2,U+62f5,U+62f8-62fb,U+6300,U+6303-6306,U+630a-630d,U+630f-6310,U+6312-6315,U+6317-6319,U+631c,U+6326-6327,U+6329,U+632c-632e,U+6330-6331,U+6333-6338,U+633b-633c,U+633e-6341,U+6344,U+6347-6348,U+634a,U+6351-6354,U+6356-6359"}},{uri:Cpe,descriptors:{unicodeRange:"U+5dd0-5dda,U+5ddc,U+5ddf-5de0,U+5de3-5de4,U+5dea,U+5dec-5ded,U+5df0,U+5df5-5df6,U+5df8-5dfc,U+5dff-5e00,U+5e04,U+5e07,U+5e09-5e0b,U+5e0d-5e0e,U+5e12-5e13,U+5e17,U+5e1e-5e25,U+5e28-5e2c,U+5e2f-5e30,U+5e32-5e36,U+5e39-5e3a,U+5e3e-5e41,U+5e43,U+5e46-5e4b,U+5e4d-5e53,U+5e56-5e5a,U+5e5c-5e5d,U+5e5f-5e60,U+5e63-5e71,U+5e75,U+5e77,U+5e79,U+5e7e,U+5e81-5e83,U+5e85,U+5e88-5e89,U+5e8c-5e8e,U+5e92,U+5e98,U+5e9b,U+5e9d,U+5ea1-5ea4,U+5ea8-5eac,U+5eae-5eb2,U+5eb4,U+5eba-5ebd,U+5ebf-5ec8,U+5ecb-5ed0,U+5ed4-5ed5,U+5ed7-5eda,U+5edc-5ee7,U+5ee9,U+5eeb-5ef3,U+5ef5,U+5ef8-5ef9,U+5efb-5efd,U+5f05-5f07,U+5f09,U+5f0c-5f0e,U+5f10,U+5f12,U+5f14,U+5f16,U+5f19-5f1a,U+5f1c-5f1e,U+5f21-5f24,U+5f28,U+5f2b-5f2c,U+5f2e"}},{uri:Ape,descriptors:{unicodeRange:"U+60cd-60d0,U+60d2-60d4,U+60d6-60d7,U+60d9,U+60db,U+60de,U+60e1-60e5,U+60ea,U+60f1-60f2,U+60f5,U+60f7-60f8,U+60fb-60ff,U+6102-6105,U+6107,U+610a-610c,U+6110-6114,U+6116-6119,U+611b-611e,U+6121-6122,U+6125,U+6128-612a,U+612c-613e,U+6140-6147,U+6149,U+614b,U+614d,U+614f-6150,U+6152-6154,U+6156-615c,U+615e-6161,U+6163-6166,U+6169-616f,U+6171-6174,U+6176,U+6178-618a,U+618c-618d,U+618f-6193,U+6195-619c,U+619e-61a6,U+61aa-61ab,U+61ad-61b6,U+61b8-61bd,U+61bf-61c1,U+61c3-61c4"}},{uri:Mpe,descriptors:{unicodeRange:"U+5cf4-5cfa,U+5cfc-5d01,U+5d04-5d05,U+5d08-5d0d,U+5d0f-5d13,U+5d15,U+5d17-5d1a,U+5d1c-5d1d,U+5d1f-5d23,U+5d25,U+5d28,U+5d2a-5d2c,U+5d2f-5d33,U+5d35-5d3c,U+5d3f-5d46,U+5d48-5d49,U+5d4d-5d57,U+5d59-5d5a,U+5d5c,U+5d5e-5d68,U+5d6a,U+5d6d-5d6e,U+5d70-5d73,U+5d75-5d81,U+5d83-5d98,U+5d9a-5d9c,U+5d9e-5db6,U+5db8-5dc4,U+5dc6-5dcc,U+5dce-5dcf"}},{uri:kpe,descriptors:{unicodeRange:"U+5b52,U+5b56,U+5b5e,U+5b60-5b61,U+5b67-5b68,U+5b6b,U+5b6d-5b6f,U+5b72,U+5b74,U+5b76-5b79,U+5b7b-5b7c,U+5b7e-5b7f,U+5b82,U+5b86,U+5b8a,U+5b8d-5b8e,U+5b90-5b92,U+5b94,U+5b96,U+5b9f,U+5ba7-5ba9,U+5bac-5baf,U+5bb1-5bb2,U+5bb7,U+5bba-5bbc,U+5bc0-5bc1,U+5bc3,U+5bc8-5bcb,U+5bcd-5bcf,U+5bd1,U+5bd4-5bdc,U+5be0,U+5be2-5be3,U+5be6-5be7,U+5be9-5bed,U+5bef,U+5bf1-5bf7,U+5bfd-5bfe,U+5c00,U+5c02-5c03,U+5c05,U+5c07-5c08,U+5c0b-5c0e,U+5c10,U+5c12-5c13,U+5c17,U+5c19,U+5c1b,U+5c1e-5c21,U+5c23,U+5c26,U+5c28-5c2b,U+5c2d-5c30,U+5c32-5c33,U+5c35-5c37,U+5c43-5c44,U+5c46-5c47,U+5c4c-5c4d,U+5c52-5c54,U+5c56-5c58,U+5c5a-5c5d,U+5c5f,U+5c62,U+5c64,U+5c67-5c6d,U+5c70,U+5c72-5c78,U+5c7b-5c7e,U+5c80,U+5c83-5c87,U+5c89-5c8b,U+5c8e-5c8f,U+5c92-5c93,U+5c95,U+5c9d-5ca1,U+5ca4-5ca8,U+5caa,U+5cae-5cb0,U+5cb2,U+5cb4,U+5cb6,U+5cb9-5cbc,U+5cbe,U+5cc0,U+5cc2-5cc3,U+5cc5-5cca,U+5ccc-5cd1,U+5cd3-5cd8,U+5cda-5ce0,U+5ce2-5ce3,U+5ce7,U+5ce9,U+5ceb-5cec,U+5cee-5cef,U+5cf1-5cf3"}},{uri:Rpe,descriptors:{unicodeRange:"U+593b,U+593d-5940,U+5943,U+5945-5946,U+594a,U+594c-594d,U+5950,U+5952-5953,U+5959,U+595b-595f,U+5961,U+5963-5964,U+5966-5972,U+5975,U+5977,U+597a-597c,U+597e-5980,U+5985,U+5989,U+598b-598c,U+598e-5991,U+5994-5995,U+5998,U+599a-599d,U+599f-59a2,U+59a6-59a7,U+59ac-59ad,U+59b0-59b1,U+59b3-59b8,U+59ba,U+59bc-59bd,U+59bf-59c5,U+59c7-59c9,U+59cc-59cf,U+59d5-59d6,U+59d9,U+59db,U+59de-59e2,U+59e4,U+59e6-59e7,U+59e9-59eb,U+59ed-59f8,U+59fa,U+59fc-59fe,U+5a00,U+5a02,U+5a0a-5a0b,U+5a0d-5a10,U+5a12,U+5a14-5a17,U+5a19-5a1b,U+5a1d-5a1e,U+5a21-5a22,U+5a24,U+5a26-5a28,U+5a2a-5a30,U+5a33,U+5a35,U+5a37-5a3b,U+5a3d-5a3f,U+5a41-5a45,U+5a47-5a48,U+5a4b-5a54,U+5a56-5a59,U+5a5b-5a61,U+5a63-5a66,U+5a68-5a69,U+5a6b-5a73,U+5a78-5a79,U+5a7b-5a7e,U+5a80-5a90"}},{uri:Lpe,descriptors:{unicodeRange:"U+5a91,U+5a93-5a99,U+5a9c-5aa9,U+5aab-5ab1,U+5ab4,U+5ab6-5ab7,U+5ab9-5abd,U+5abf-5ac0,U+5ac3-5ac8,U+5aca-5acb,U+5acd-5ad1,U+5ad3,U+5ad5,U+5ad7,U+5ad9-5adb,U+5add-5adf,U+5ae2,U+5ae4-5ae5,U+5ae7-5ae8,U+5aea,U+5aec-5af0,U+5af2-5b08,U+5b0a-5b15,U+5b18-5b31,U+5b33,U+5b35-5b36,U+5b38-5b3f,U+5b41-5b4f"}},{uri:Dpe,descriptors:{unicodeRange:"U+5843,U+5845-584b,U+584e-5850,U+5852-5853,U+5855-5857,U+5859-585d,U+585f-5864,U+5866-586a,U+586d-587d,U+587f,U+5882,U+5884,U+5886-5888,U+588a-5891,U+5894-5898,U+589b-589d,U+58a0-58a7,U+58aa-58bb,U+58bd-58c0,U+58c2-58c4,U+58c6-58d0,U+58d2-58d4,U+58d6-58e3,U+58e5-58ea,U+58ed,U+58ef,U+58f1-58f2,U+58f4-58f5,U+58f7-58f8,U+58fa-5901,U+5903,U+5905-5906,U+5908-590c,U+590e,U+5910-5913,U+5917-5918,U+591b,U+591d-591e,U+5920-5923,U+5926,U+5928,U+592c,U+5930,U+5932-5933,U+5935-5936"}},{uri:Ppe,descriptors:{unicodeRange:"U+56d0-56d3,U+56d5-56d6,U+56d8-56d9,U+56dc,U+56e3,U+56e5-56ea,U+56ec,U+56ee-56ef,U+56f2-56f3,U+56f6-56f8,U+56fb-56fc,U+5700-5702,U+5705,U+5707,U+570b-571b,U+571d-571e,U+5720-5722,U+5724-5727,U+572b,U+5731-5732,U+5734-5738,U+573c-573d,U+573f,U+5741,U+5743-5746,U+5748-5749,U+574b,U+5752-5756,U+5758-5759,U+5762-5763,U+5765,U+5767,U+576c,U+576e,U+5770-5772,U+5774-5775,U+5778-577a,U+577d-5781,U+5787-578a,U+578d-5791,U+5794-579a,U+579c-579f,U+57a5,U+57a8,U+57aa,U+57ac,U+57af-57b1,U+57b3,U+57b5-57b7,U+57b9-57c1,U+57c4-57ca,U+57cc-57cd,U+57d0-57d1,U+57d3,U+57d6-57d7,U+57db-57dc,U+57de,U+57e1-57e3,U+57e5-57ec,U+57ee,U+57f0-57f3,U+57f5-57f7,U+57fb-57fc,U+57fe-57ff,U+5801,U+5803-5805,U+5808-580a,U+580c,U+580e-5810,U+5812-5814,U+5816-5818,U+581a-581d,U+581f,U+5822-5823,U+5825-5829,U+582b-582f,U+5831-5834,U+5836-5842"}},{uri:Npe,descriptors:{unicodeRange:"U+55f9-55fc,U+55ff,U+5602-5607,U+560a-560b,U+560d,U+5610-5617,U+5619-561a,U+561c-561d,U+5620-5622,U+5625-5626,U+5628-562b,U+562e-5630,U+5633,U+5635,U+5637-5638,U+563a,U+563c-563e,U+5640-564b,U+564f-5653,U+5655-5656,U+565a-565b,U+565d-5661,U+5663,U+5665-5667,U+566d-5670,U+5672-5675,U+5677-567a,U+567d-5684,U+5687-568d,U+5690-5692,U+5694-56a2,U+56a4-56ae,U+56b0-56b6,U+56b8-56bb,U+56bd-56c9,U+56cb-56cf"}},{uri:Ope,descriptors:{unicodeRange:"U+5286-5287,U+5289-528f,U+5291-5292,U+5294-529a,U+529c,U+52a4-52a7,U+52ae-52b0,U+52b4-52bd,U+52c0-52c2,U+52c4-52c6,U+52c8,U+52ca,U+52cc-52cf,U+52d1,U+52d3-52d5,U+52d7,U+52d9-52de,U+52e0-52e3,U+52e5-52ef,U+52f1-52f8,U+52fb-52fd,U+5301-5304,U+5307,U+5309-530c,U+530e,U+5311-5314,U+5318,U+531b-531c,U+531e-531f,U+5322,U+5324-5325,U+5327-5329,U+532b-532d,U+532f-5338,U+533c-533d,U+5340,U+5342,U+5344,U+5346,U+534b-534d,U+5350,U+5354,U+5358-5359,U+535b,U+535d,U+5365,U+5368,U+536a,U+536c-536d,U+5372,U+5376,U+5379,U+537b-537e,U+5380-5381,U+5383,U+5387-5388,U+538a,U+538e-5394,U+5396-5397,U+5399,U+539b-539c,U+539e,U+53a0-53a1,U+53a4,U+53a7,U+53aa-53ad,U+53af-53b5,U+53b7-53ba,U+53bc-53be,U+53c0,U+53c3-53c7,U+53ce-53d0,U+53d2-53d3,U+53d5,U+53da,U+53dc-53de,U+53e1-53e2,U+53e7,U+53f4,U+53fa,U+53fe-5400,U+5402,U+5405,U+5407,U+540b,U+5414,U+5418-541a,U+541c,U+5422,U+5424-5425,U+542a,U+5430,U+5433,U+5436-5437,U+543a"}},{uri:Fpe,descriptors:{unicodeRange:"U+5101-5105,U+5108-510a,U+510c-5111,U+5113-5120,U+5122-513e,U+5142,U+5147,U+514a,U+514c,U+514e-5150,U+5152-5153,U+5157-5159,U+515b,U+515d-5161,U+5163-5164,U+5166-5167,U+5169-516a,U+516f,U+5172,U+517a,U+517e-517f,U+5183-5184,U+5186-5187,U+518a-518b,U+518e-5191,U+5193-5194,U+5198,U+519a,U+519d-519f,U+51a1,U+51a3,U+51a6-51aa,U+51ad-51ae,U+51b4,U+51b8-51ba,U+51be-51bf,U+51c1-51c3,U+51c5,U+51c8,U+51ca,U+51cd-51ce,U+51d0,U+51d2-51da,U+51dc,U+51de-51df,U+51e2-51e3,U+51e5-51ea,U+51ec,U+51ee,U+51f1-51f2,U+51f4,U+51f7,U+51fe,U+5204-5205,U+5209,U+520b-520c,U+520f-5210,U+5213-5215,U+521c,U+521e-521f,U+5221-5223,U+5225-5227,U+522a,U+522c,U+522f,U+5231-5232,U+5234-5235,U+523c,U+523e,U+5244-5249,U+524b,U+524e-524f,U+5252-5253,U+5255,U+5257-525b,U+525d,U+525f-5260,U+5262-5264,U+5266,U+5268,U+526b-526e,U+5270-5271,U+5273-527c,U+527e,U+5280,U+5283-5285"}},{uri:Bpe,descriptors:{unicodeRange:"U+543d,U+543f,U+5441-5442,U+5444-5445,U+5447,U+5449,U+544c-544f,U+5451,U+545a,U+545d-5461,U+5463,U+5465,U+5467,U+5469-5470,U+5474,U+5479-547a,U+547e-547f,U+5481,U+5483,U+5485,U+5487-548a,U+548d,U+5491,U+5493,U+5497-5498,U+549c,U+549e-54a2,U+54a5,U+54ae,U+54b0,U+54b2,U+54b5-54b7,U+54b9-54ba,U+54bc,U+54be,U+54c3,U+54c5,U+54ca-54cb,U+54d6,U+54d8,U+54db,U+54e0-54e4,U+54eb-54ec,U+54ef-54f1,U+54f4-54f9,U+54fb,U+54fe,U+5500,U+5502-5505,U+5508,U+550a-550e,U+5512-5513,U+5515-551a,U+551c-551f,U+5521,U+5525-5526,U+5528-5529,U+552b,U+552d,U+5532,U+5534-5536,U+5538-553b,U+553d,U+5540,U+5542,U+5545,U+5547-5548,U+554b-554f,U+5551-5554,U+5557-555b,U+555d-5560,U+5562-5563,U+5568-5569,U+556b,U+556f-5574,U+5579-557a,U+557d,U+557f,U+5585-5586,U+558c-558e,U+5590,U+5592-5593,U+5595-5597,U+559a-559b,U+559e,U+55a0-55a6,U+55a8-55b0,U+55b2,U+55b4,U+55b6,U+55b8,U+55ba,U+55bc,U+55bf-55c3,U+55c6-55c8,U+55ca-55cb,U+55ce-55d0,U+55d5,U+55d7-55db,U+55de,U+55e0,U+55e2,U+55e7,U+55e9,U+55ed-55ee,U+55f0-55f1,U+55f4,U+55f6,U+55f8"}},{uri:zpe,descriptors:{unicodeRange:"U+4fe0,U+4fe2,U+4fe4-4fe5,U+4fe7,U+4feb-4fec,U+4ff0,U+4ff2,U+4ff4-4ff7,U+4ff9,U+4ffb-4ffd,U+4fff-500b,U+500e,U+5010-5011,U+5013,U+5015-5017,U+501b,U+501d-501e,U+5020,U+5022-5024,U+5027,U+502b,U+502f-5039,U+503b,U+503d,U+503f-5042,U+5044-5046,U+5049-504b,U+504d,U+5050-5054,U+5056-5059,U+505b,U+505d-5064,U+5066-506b,U+506d-5075,U+5078-507a,U+507c-507d,U+5081-5084,U+5086-5087,U+5089-508c,U+508e-50a2,U+50a4,U+50a6,U+50aa-50ab,U+50ad-50b1,U+50b3-50b9,U+50bc-50ce,U+50d0-50d5,U+50d7-50d9,U+50db-50e5,U+50e8-50eb,U+50ef-50f2,U+50f4,U+50f6-50fa,U+50fc-5100"}},{uri:k0e,descriptors:{unicodeRange:"U+49d5-4a77"}},{uri:Hpe,descriptors:{unicodeRange:"U+4dac-4dad,U+4daf-4db5,U+4e02,U+4e04-4e06,U+4e0f,U+4e12,U+4e17,U+4e1f-4e21,U+4e23,U+4e26,U+4e29,U+4e2e-4e2f,U+4e31,U+4e33,U+4e35,U+4e37,U+4e3c,U+4e40-4e42,U+4e44,U+4e46,U+4e4a,U+4e51,U+4e55,U+4e57,U+4e5a-4e5b,U+4e62-4e65,U+4e67-4e68,U+4e6a-4e6f,U+4e72,U+4e74-4e7d,U+4e7f-4e85,U+4e87,U+4e8a,U+4e90,U+4e96-4e97,U+4e99,U+4e9c-4e9e,U+4ea3,U+4eaa,U+4eaf-4eb1,U+4eb4,U+4eb6-4eb9,U+4ebc-4ebe,U+4ec8,U+4ecc,U+4ecf-4ed0,U+4ed2,U+4eda-4edc,U+4ee0,U+4ee2,U+4ee6-4ee7,U+4ee9,U+4eed-4eef,U+4ef1,U+4ef4,U+4ef8-4efa,U+4efc,U+4efe,U+4f00,U+4f02-4f08,U+4f0b-4f0c,U+4f12-4f16,U+4f1c-4f1d,U+4f21,U+4f23,U+4f28-4f29,U+4f2c-4f2e,U+4f31,U+4f33,U+4f35,U+4f37,U+4f39,U+4f3b,U+4f3e-4f42,U+4f44-4f45,U+4f47-4f4c,U+4f52,U+4f54,U+4f56,U+4f61-4f62,U+4f66,U+4f68,U+4f6a-4f6b,U+4f6d-4f6e,U+4f71-4f72,U+4f75,U+4f77-4f7a,U+4f7d,U+4f80-4f82,U+4f85-4f87,U+4f8a,U+4f8c,U+4f8e,U+4f90,U+4f92-4f93,U+4f95-4f96,U+4f98-4f9a,U+4f9c,U+4f9e-4f9f,U+4fa1-4fa2,U+4fa4,U+4fab,U+4fad,U+4fb0-4fb4,U+4fb6-4fbe,U+4fc0-4fc2,U+4fc6-4fc9,U+4fcb-4fcd,U+4fd2-4fd6,U+4fd9,U+4fdb"}},{uri:Vpe,descriptors:{unicodeRange:"U+4933-49d4"}},{uri:$pe,descriptors:{unicodeRange:"U+487a-4932"}},{uri:Gpe,descriptors:{unicodeRange:"U+47d2-4879,U+2ce7c,U+2ce88,U+2ce93"}},{uri:Xpe,descriptors:{unicodeRange:"U+4756-47d1,U+2ca02,U+2ca0e,U+2ca7d,U+2caa9,U+2cb29,U+2cb2e,U+2cb31,U+2cb38-2cb39,U+2cb3f,U+2cb41,U+2cb4e,U+2cb5a,U+2cb64,U+2cb69,U+2cb6c,U+2cb6f,U+2cb76,U+2cb78,U+2cb7c,U+2cbb1,U+2cbbf-2cbc0,U+2cbce,U+2cc5f,U+2ccf5-2ccf6,U+2ccfd,U+2ccff,U+2cd02-2cd03,U+2cd0a,U+2cd8b,U+2cd8d,U+2cd8f-2cd90,U+2cd9f-2cda0,U+2cda8,U+2cdad-2cdae,U+2cdd5,U+2ce18,U+2ce1a,U+2ce23,U+2ce26,U+2ce2a"}},{uri:jpe,descriptors:{unicodeRange:"U+46c3-4755,U+2c488,U+2c494,U+2c497,U+2c542,U+2c613,U+2c618,U+2c621,U+2c629,U+2c62b-2c62d,U+2c62f,U+2c642,U+2c64a-2c64b,U+2c72c,U+2c72f,U+2c79f,U+2c7c1,U+2c7fd,U+2c8d9,U+2c8de,U+2c8e1,U+2c8f3,U+2c907,U+2c90a,U+2c91d"}},{uri:Ype,descriptors:{unicodeRange:"U+4629-46c2,U+2bdf7,U+2be29,U+2c029-2c02a,U+2c0a9,U+2c0ca,U+2c1d5,U+2c1d9,U+2c1f9,U+2c27c,U+2c288,U+2c2a4,U+2c317,U+2c35b,U+2c361,U+2c364"}},{uri:Wpe,descriptors:{unicodeRange:"U+458e-4628,U+2b7a9,U+2b7c5,U+2b7e6,U+2b7f9,U+2b806,U+2b80a,U+2b81c,U+2b8b8,U+2bac7,U+2bb5f,U+2bb62,U+2bb7c,U+2bb83,U+2bc1b,U+2bd77,U+2bd87"}},{uri:Kpe,descriptors:{unicodeRange:"U+4449-4511,U+2afa2,U+2b127-2b128,U+2b137-2b138,U+2b1ed"}},{uri:Zpe,descriptors:{unicodeRange:"U+439b-4448,U+2a437,U+2a5f1,U+2a602,U+2a61a,U+2a6b2,U+2a7dd,U+2a8fb,U+2a917,U+2aa30,U+2aa36,U+2aa58"}},{uri:qpe,descriptors:{unicodeRange:"U+4275-430d,U+298c6,U+29a72,U+29d98,U+29ddb,U+29e15,U+29e3d,U+29e49"}},{uri:Qpe,descriptors:{unicodeRange:"U+4132-41de,U+28bef,U+28c47,U+28c4f,U+28c51,U+28c54,U+28d10,U+28d71,U+28dfb,U+28e1f,U+28e36,U+28e89,U+28e99,U+28eeb,U+28f32,U+28ff8,U+292a0"}},{uri:Jpe,descriptors:{unicodeRange:"U+41df-4274,U+292b1,U+29490,U+295cf,U+2967f,U+296f0,U+29719,U+29750"}},{uri:eUe,descriptors:{unicodeRange:"U+408e-4131,U+285c8-285c9,U+28678,U+28695,U+286d7,U+286fa,U+287e0,U+28946,U+28949,U+2896b,U+28987-28988,U+289ba-289bb,U+28a1e,U+28a29,U+28a43,U+28a71,U+28a99,U+28acd,U+28add,U+28ae4,U+28b49,U+28bc1"}},{uri:tUe,descriptors:{unicodeRange:"U+3e83-3f2f,U+27139,U+273da-273db,U+273fe,U+27410,U+27449,U+27614-27615,U+27631,U+27684,U+27693,U+2770e,U+27723,U+27752"}},{uri:nUe,descriptors:{unicodeRange:"U+3f30-3fdb,U+27985,U+27a84,U+27bb3,U+27bbe,U+27bc7,U+27cb8,U+27da0,U+27e10"}},{uri:iUe,descriptors:{unicodeRange:"U+3fdc-408d,U+27fb7,U+27ff9,U+2808a,U+280bb,U+2815d,U+28277,U+28282,U+282e2,U+282f3,U+283cd,U+28408,U+2840c,U+28455,U+28468,U+2856b"}},{uri:sUe,descriptors:{unicodeRange:"U+3dd2-3e82,U+26a58,U+26a8c,U+26ab7,U+26aff,U+26b5c,U+26c21,U+26c29,U+26c73,U+26cdd,U+26e40,U+26e65,U+26f94,U+26ff6-26ff8,U+270f4,U+2710d"}},{uri:rUe,descriptors:{unicodeRange:"U+3d34-3dd1,U+2648d,U+26676,U+2667e,U+266b0,U+2671d,U+2677c,U+267cc,U+268dd,U+268ea,U+26951,U+2696f,U+269dd,U+269fa,U+26a1e"}},{uri:oUe,descriptors:{unicodeRange:"U+3c76-3d33,U+25d0a,U+25da1,U+25e2e,U+25e56,U+25e62,U+25e65,U+25ec2,U+25ed7-25ed8,U+25ee8,U+25f23,U+25f5c,U+25fd4,U+25fe0,U+25ffb,U+2600c,U+26017,U+26060,U+260ed,U+26221,U+26270,U+26286,U+2634c,U+26402"}},{uri:aUe,descriptors:{unicodeRange:"U+3bda-3c75,U+25771,U+257a9,U+257b4,U+259c4,U+259d4,U+25ae3-25ae4,U+25af1,U+25bb2,U+25c14,U+25c4b,U+25c64"}},{uri:lUe,descriptors:{unicodeRange:"U+3b25-3bd9,U+2504a,U+25055,U+25122,U+2512b,U+251a9,U+251cd,U+251e5,U+2521e,U+2524c,U+2542e,U+2548e,U+254d9,U+2550e,U+25532,U+25562,U+255a7-255a8"}},{uri:cUe,descriptors:{unicodeRange:"U+3a6b-3b24,U+24896,U+249db,U+24a4d,U+24a7d,U+24ac9,U+24b56,U+24b6f,U+24c16,U+24d14,U+24dea,U+24e0e,U+24e37,U+24e6a,U+24e8b,U+24eaa"}},{uri:dUe,descriptors:{unicodeRange:"U+39a9-3a6a,U+24096,U+24103,U+241ac,U+241c6,U+241fe,U+243bc,U+243f8,U+244d3,U+24629,U+246a5,U+247f1"}},{uri:uUe,descriptors:{unicodeRange:"U+38e3-39a8,U+23a98,U+23c7f,U+23c97-23c98,U+23cfe,U+23d00,U+23d0e,U+23d40,U+23dd3,U+23df9-23dfa,U+23e23,U+23f7e"}},{uri:fUe,descriptors:{unicodeRange:"U+3760-382a,U+22ab8,U+22b43,U+22b46,U+22b4f-22b50,U+22ba6,U+22bca,U+22c1d,U+22c24,U+22c55,U+22d4c,U+22de1"}},{uri:hUe,descriptors:{unicodeRange:"U+382b-38e2,U+231b6,U+231c3-231c4,U+231f5,U+23350,U+23372,U+233d0,U+233d2-233d3,U+233d5,U+233da,U+233df,U+233e4,U+2344a-2344b,U+23451,U+23465,U+234e4,U+2355a,U+23594,U+235c4,U+235cb,U+23638-2363a,U+23647,U+2370c,U+2371c,U+2373f,U+23763-23764,U+237e7,U+237ff,U+23824,U+2383d"}},{uri:gUe,descriptors:{unicodeRange:"U+3698-375f,U+22218,U+2231e,U+223ad,U+224dc,U+226f3,U+2285b,U+228ab,U+2298f"}},{uri:mUe,descriptors:{unicodeRange:"U+35e6-3697,U+21c56,U+21cde,U+21d2d,U+21d45,U+21d62,U+21d78,U+21d92,U+21d9c,U+21da1,U+21db7,U+21de0,U+21e33-21e34,U+21f1e,U+21f76,U+21ffa,U+2217b"}},{uri:pUe,descriptors:{unicodeRange:"U+3444-350e,U+20ad3,U+20b1d,U+20b9f,U+20c41,U+20cbf,U+20cd0,U+20d45,U+20de1,U+20e64,U+20e6d,U+20e95,U+20e9d,U+20ea2,U+20f5f,U+210c1,U+21201,U+2123d,U+21255,U+21274,U+2127b"}},{uri:UUe,descriptors:{unicodeRange:"U+350f-35e5,U+212d7,U+212e4,U+212fd,U+2131b,U+21336,U+21344,U+2139a,U+213c4,U+21413,U+2146d-2146e,U+215d7,U+21647,U+216b4,U+21706,U+21742,U+218bd,U+219c3"}},{uri:bUe,descriptors:{unicodeRange:"U+336d-3443,U+2032b,U+20371,U+20381,U+203f9,U+2044a,U+20509,U+20547,U+205d6,U+20628,U+20676,U+2074f,U+20779,U+20807,U+2083a,U+20895,U+208b9,U+2097c,U+2099d"}},{uri:yUe,descriptors:{unicodeRange:"U+328b-336c,U+2000b,U+20089,U+200a2,U+200a4,U+20164,U+201a2,U+20213"}},{uri:EUe,descriptors:{unicodeRange:"U+3192-31ba,U+31c0-31e3,U+31f0-321e,U+3220-328a,U+1f250-1f251"}},{uri:vUe,descriptors:{unicodeRange:"U+2f74-2fd5,U+3000,U+3003-3007,U+3012-3013,U+3018-301c,U+3020-3029,U+302f-303f,U+3041-3096,U+3099-30a1"}},{uri:_Ue,descriptors:{unicodeRange:"U+30a2-30ff,U+3105-312f,U+3131-318e,U+3190-3191"}},{uri:wUe,descriptors:{unicodeRange:"U+4e36,U+4ea0,U+4f74,U+4f91,U+4f94,U+4fc5,U+507e,U+50ed,U+5182,U+51f5,U+525e,U+5282,U+52f9,U+5326,U+537a,U+53a3,U+5423,U+5459,U+54b4,U+54d9,U+55c9,U+57f4,U+580b,U+5902,U+5925,U+5a08,U+5ab5,U+5b84,U+5be4,U+5c22,U+5cb5,U+5cbd,U+5d3e,U+5e31,U+5e5e,U+5e80,U+5ee8,U+5f82,U+5fc9,U+5fed,U+600a,U+605d,U+609b,U+609d,U+60dd,U+6243,U+6322,U+63ce,U+640c,U+643f,U+6445,U+64d7,U+6534,U+6549,U+656b,U+6603,U+674c,U+680a,U+6864,U+69d4,U+6a65,U+6c2a,U+6c46,U+6c5c,U+6d0e,U+6d48,U+6e2b,U+6eb2,U+6eb7,U+6f89,U+706c,U+70b1,U+7113,U+71d4,U+727f,U+72f3,U+7303,U+7321,U+736c,U+736f,U+74a9,U+74de,U+750d,U+7513,U+7592,U+75c4,U+7605,U+760a,U+761b,U+7625,U+762d,U+7643,U+7707,U+7747,U+77b5,U+7839,U+784e,U+78a5,U+7924,U+793b,U+798a,U+7a03,U+7a06,U+7a78,U+7a80,U+7aad,U+7ba8,U+7be5,U+7cc8,U+7ec1,U+7f0b,U+7f0f,U+7f12,U+7f68,U+7f9d,U+8025,U+809c,U+80ad,U+80b7,U+80e8,U+811e,U+8204,U+8223,U+822d,U+823b,U+824b,U+825a,U+827d,U+827f,U+828f,U+82c8,U+8307,U+831b,U+8347,U+837d,U+839b,U+83a9,U+83f9,U+84b9,U+8579,U+864d,U+867f,U+86b0,U+86d1,U+86d8,U+86f2,U+8764,U+8770,U+8788,U+8797,U+87ac-87ad,U+87b5,U+881b,U+8844,U+88bc,U+88fc,U+8930,U+89cf,U+89d6,U+8ba0,U+8bd4,U+8c02,U+8c2b,U+8c85,U+8e23,U+8f81-8f82,U+8fd5,U+90b6,U+90db,U+914e,U+9164,U+91ad,U+943e,U+94b7-94b8,U+94eb,U+950d,U+9514,U+9516,U+9518,U+9529,U+9538,U+953f,U+954e,U+955f,U+95fc,U+9667,U+96b3,U+9792,U+97b2,U+98a1,U+9969,U+9987,U+9998,U+9a80,U+9a92,U+9a96,U+9adf,U+9cb4,U+9cbd,U+9cd0,U+9cd4,U+9e31,U+9e3a,U+9e71,U+9ee5,U+9eea,U+9ef9,U+9fa0"}},{uri:TUe,descriptors:{unicodeRange:"U+4e0c,U+4e28,U+4e3f,U+4ec2,U+502e,U+50ba,U+5155,U+5181,U+522d,U+5281,U+5290,U+5369,U+53b6,U+54d5,U+54dc,U+54ff,U+552a,U+553c,U+5588,U+55b5,U+5686,U+570a,U+5776,U+5786,U+57a4,U+5820,U+5865,U+58bc,U+5b32,U+5b65,U+5c1c,U+5c66,U+5c6e,U+5c8d,U+5ddb,U+5f2a,U+5f50,U+5f61,U+6067,U+614a,U+615d,U+619d,U+61d4,U+620b,U+6224-6225,U+6343,U+63ad,U+63f2,U+640b,U+6420,U+6434,U+6496,U+64d0,U+6509,U+652e,U+67a8,U+6833,U+6844,U+684a,U+6920,U+6957,U+6971,U+6a8e,U+6a91,U+6aa0,U+6b43,U+6bea,U+6bf5,U+6c15,U+6cd0,U+6ee0,U+6f24,U+6f2d,U+70c0,U+721d,U+728b,U+72c3,U+72e8,U+730a,U+7338-7339,U+734d,U+746d,U+752f,U+754e,U+770d,U+7735,U+778d,U+77a2,U+77e7,U+7857,U+786d,U+78c9,U+78f2,U+791e,U+7953,U+7b58,U+7b9d,U+7bda,U+7cd7,U+7f32-7f33,U+8022,U+8028-8029,U+8035,U+804d,U+8080,U+80c2,U+80e9,U+80ec,U+80f2,U+810e,U+8221,U+8274,U+82b0,U+82e0,U+83b0,U+8487-8488,U+848e,U+84cd,U+84d0,U+8539,U+857a,U+85a8,U+85b7,U+867c,U+871e,U+8723,U+877e,U+878b,U+8793,U+8803,U+88d2,U+8966,U+89cc,U+89eb,U+8b26,U+8c8a,U+8c98,U+8d33,U+8d47,U+8d55,U+8dbc,U+8e40,U+8e94,U+8f77,U+8f79,U+9058,U+91a2,U+91b5,U+928e,U+9494,U+94b6,U+94de,U+94f4,U+94f9,U+950a,U+950e,U+951e,U+952b,U+953c,U+953e,U+9544,U+9561,U+9564,U+9569,U+95f6,U+9603,U+960d,U+963d,U+9674,U+9794,U+97ab,U+98a5,U+9a9f,U+9ab1,U+9ad1,U+9b0f,U+9b2f,U+9c92,U+9c95,U+9cba,U+9cbc,U+9cc6,U+9ccb,U+9cd8,U+9e32,U+9e38,U+9e5b,U+9e7e,U+9eb4,U+9efb-9efc,U+9f3d"}},{uri:IUe,descriptors:{unicodeRange:"U+2e3b,U+2e80-2e99,U+2e9b-2ef3,U+2f00-2f73,U+ffffd"}},{uri:SUe,descriptors:{unicodeRange:"U+4e69,U+4f1b,U+4f67,U+4f7e,U+4fdc,U+50e6,U+5196,U+5202,U+5233,U+523f,U+52a2,U+536e,U+5476,U+54ad,U+54cf,U+5537,U+561e,U+56dd,U+56df,U+5709,U+572c,U+57cf,U+57f8,U+580d,U+5881,U+589a,U+5941,U+59b2,U+5c25,U+5d24,U+5d74,U+5e42,U+5e8b,U+5eb3,U+5ed2,U+5fad,U+6003,U+603c,U+6083,U+6100,U+6126,U+6206,U+62ca,U+638e,U+63b4,U+6426,U+646d,U+6535,U+65c4,U+66db,U+6715,U+6769,U+6798,U+67c3,U+6861,U+698d,U+69ca,U+69ed,U+69f2,U+69ff,U+6a18,U+6b39,U+6bb3,U+6c0d,U+6cb2,U+6cd6,U+6cf7,U+6cfa,U+6d33,U+6e16,U+6e53-6e54,U+6ebb,U+6fb6,U+709d,U+72ad,U+72f7,U+72fb,U+7313,U+739f,U+74ba,U+754b,U+755b,U+758b,U+75ac,U+75d6,U+7617,U+7635,U+7640,U+76a4,U+76b2,U+775a,U+77bd,U+781f,U+79b3,U+7b2b,U+7b31,U+7b3e,U+7b6e,U+7b9c,U+7c0b,U+7c9e,U+7cc1,U+7ce8,U+7ea5,U+7f21,U+7f27,U+7f74,U+7fb0,U+8031,U+8071,U+80ea,U+8114,U+8160,U+81a6,U+81c1,U+829f,U+82a4,U+82fb,U+831a,U+8333,U+836c,U+83b6,U+83f8,U+8411,U+841c,U+8489,U+848c,U+85a4,U+8627,U+8629,U+866e,U+86b5,U+872e,U+8731,U+877b,U+877d,U+87ea,U+8813,U+8816,U+8864,U+88ce,U+88e5,U+897b,U+89cb,U+89f3,U+8bfc,U+8c35,U+8d46,U+8d4d,U+8dba,U+8e3a,U+8f75,U+8f7e,U+8fd3,U+9161,U+9179,U+917e,U+91a3,U+94ac,U+94d7,U+94e5,U+952a,U+952c,U+9545,U+9565,U+9568,U+956a,U+961d,U+96e0,U+972a,U+9730,U+989f,U+98e7,U+990d,U+9967,U+9993,U+9aa3,U+9ac0,U+9ae1,U+9aeb,U+9af9,U+9c86,U+9c8b,U+9ca0-9ca1,U+9ca3,U+9ce2,U+9e48,U+9e6a,U+9e87,U+9ee2,U+9ee9,U+9f17,U+9f19,U+9f2c,U+9f80"}},{uri:xUe,descriptors:{unicodeRange:"U+4ef3,U+50d6,U+50ec,U+51ab,U+51b1,U+52d6,U+54a9,U+54da,U+55be,U+55cd,U+564d,U+572f,U+574c,U+576b,U+57d8,U+57fd,U+5844,U+59d2,U+5ae0,U+5b16,U+5b37,U+5b5b,U+5b80,U+5d1e,U+5d6b,U+5efe,U+5f11,U+5f56,U+5f58,U+5f73,U+5f8c,U+5fc4,U+5fe4,U+602b,U+6106,U+610d,U+63de,U+63f8,U+641b,U+64e4,U+6634,U+676a,U+67b5,U+681d,U+6883,U+69b1,U+69e0,U+6b37,U+6b9b,U+6d7c,U+6ed7,U+6f36,U+6f72,U+6f8c,U+7035,U+7039,U+7173,U+7178,U+7228,U+728f,U+72b4,U+72ef,U+72f4,U+7331,U+7481,U+74e0,U+7540,U+75c3,U+75e6,U+763c,U+764d,U+76cd,U+7704,U+7743,U+7780,U+7847,U+786a,U+78b9,U+7962,U+7a02,U+7aac,U+7ab3,U+7b0a,U+7b4c,U+7b7b,U+7bfc,U+7c0f,U+7c16,U+7c40,U+7ca2,U+7cc7,U+7cf8,U+7d77,U+7e3b,U+7ea1,U+7ea9,U+7ef2,U+7f02,U+7f07,U+7f0c,U+7f23,U+7f2f,U+7fbc,U+8016,U+8020,U+812c,U+8136,U+8182,U+822f,U+8233,U+825f,U+8268,U+8284,U+8288,U+8291,U+8308,U+8311,U+835b,U+836d,U+83dd,U+8406,U+840f,U+845c,U+84b4,U+84e3,U+850c,U+855e,U+863c,U+86ba,U+86c4,U+86de,U+86f1,U+873e,U+87bd,U+87db,U+880a,U+883c,U+887f,U+88f0,U+890a,U+892b,U+895e,U+89ef,U+8a48,U+8bdc,U+8c18,U+8c33,U+8c94,U+8db1,U+8dcf,U+8dd6,U+8de3,U+8e6f,U+8e90,U+8f7a,U+8fb6,U+902d,U+90be,U+91af,U+936a,U+948b,U+94d8,U+9513,U+953a,U+956c,U+963c,U+9654,U+966c,U+9688,U+97b4,U+996b,U+9a75,U+9a7a,U+9aba,U+9aed,U+9b08,U+9b43,U+9c8e,U+9c94,U+9c9a,U+9e2b,U+9e36,U+9e4b,U+9e4e,U+9e55,U+9e63,U+9e68-9e69,U+9ebd,U+9ec9,U+9f0d,U+9f37,U+9f51"}},{uri:CUe,descriptors:{unicodeRange:"U+50a7,U+5240,U+5261,U+52ac,U+531a,U+5363,U+5432,U+5452,U+5456,U+5472,U+5478,U+553f,U+5575,U+5581,U+55cc,U+55fe,U+5601,U+572e,U+57d2,U+57ef,U+581e,U+5924,U+5981,U+5997,U+59a3,U+5aaa,U+5ab8,U+5b34,U+5d5d,U+5def,U+5e11,U+5e91,U+5ed1,U+5ef4,U+5f40,U+600d,U+6019,U+601b,U+605a,U+6092,U+60ab,U+6217,U+623d,U+6369,U+65d2,U+6661,U+670a,U+6753,U+67a7,U+6855,U+68f9,U+6939,U+696e,U+6980,U+6a7c,U+6aab,U+6b82,U+6bf3,U+6bf9,U+6c05,U+6c19-6c1a,U+6ca9,U+6cf6,U+6d1a,U+6dab,U+6f74,U+7085,U+7198,U+71b5,U+7256,U+725d,U+727e,U+72fa,U+7322,U+738e,U+73e5,U+750f,U+755a,U+7594,U+75b3,U+760c,U+7615,U+7630,U+763f,U+77ec,U+7817,U+78a1,U+78d9,U+7905,U+7b2a,U+7b2e,U+7b62,U+7b85,U+7bcc,U+7bea,U+7c26,U+7c74,U+7c9c-7c9d,U+7e47,U+7e9b,U+7e9f,U+7ee0,U+7ee8,U+7ef1,U+7f01,U+7f11,U+7f17,U+7f36,U+7f7e,U+7fee,U+802a,U+80cd,U+8112,U+8169,U+8234,U+8279,U+8298,U+82ca,U+82d8,U+82e1,U+83c0,U+83d4,U+83df,U+8401,U+8451,U+845a,U+8476,U+8478,U+84ba,U+84bd,U+84e0,U+851f,U+8548,U+8556,U+8585,U+868d,U+86e9,U+86f4,U+86f8,U+8765,U+8785,U+87ab,U+87ee,U+8832,U+8872,U+88b7,U+88e2-88e3,U+89da,U+8bce,U+8bd3,U+8bd6,U+8bf9,U+8c16,U+8c73,U+8d5c,U+8dde,U+8f6d,U+8f94,U+8fe8,U+9011,U+915e,U+9185,U+918c,U+94ab,U+94d1,U+94f3,U+9515,U+951d,U+9558,U+9567,U+96ce,U+96e9,U+9785,U+9878,U+987c,U+9883,U+98d1,U+9954,U+9963,U+9a93,U+9ac1,U+9acc,U+9b1f,U+9b49,U+9b4d,U+9b51,U+9ca7,U+9cae,U+9cce,U+9cd3,U+9e37,U+9e39,U+9e41,U+9e46,U+9f22,U+9f2f,U+9f39,U+9f85"}},{uri:AUe,descriptors:{unicodeRange:"U+4e5c,U+4edf,U+4f25,U+4f32,U+4f5e,U+4f76,U+4faa,U+4fe6,U+5028,U+5048,U+5250,U+535f,U+538d,U+53c1,U+5412,U+5443,U+54d4,U+54dd,U+5541,U+5550,U+5577,U+55dd,U+55f3,U+560f,U+562c,U+5657-5658,U+5664,U+56af,U+575c,U+577c,U+57b2,U+57da,U+5800,U+5a62,U+5aeb,U+5c3b,U+5ca3,U+5d26,U+5d9d,U+5f01,U+5fb5,U+5fdd,U+5ff8,U+6029,U+6041,U+6079,U+60b1,U+6222,U+629f,U+6332,U+63bc,U+63e0,U+6485,U+65ab,U+65c3,U+65c6,U+668c,U+669d,U+66be,U+67fd,U+6800,U+68fc,U+690b,U+6924,U+6978,U+69a7,U+6a3e,U+6a50,U+6a5b,U+6a97,U+6b24,U+6b8d,U+6baa,U+6c10,U+6c54,U+6ceb,U+6d04,U+6d4d,U+6eb1,U+6ebd,U+7110,U+71b3,U+71f9,U+7230,U+728d,U+7292,U+72b8,U+72d2,U+7360,U+73a2,U+7511,U+75a0,U+75c8,U+779f,U+7826,U+7877,U+7a39,U+7aa8,U+7ae6,U+7b04,U+7b0f,U+7baa,U+7bac,U+7c1f,U+7ccd,U+7ecb,U+7ed4,U+7ed7,U+7efb,U+7f0d,U+7f5f,U+7faf,U+7fd5,U+7fe5,U+8027,U+80bc,U+80dd,U+80fc,U+8132,U+815a,U+8167,U+816d,U+81ca,U+8228,U+82a1,U+82a9,U+82ab,U+82cc,U+8351,U+8368,U+83b8,U+83d8,U+83ea,U+83f0,U+8497,U+84c1,U+858f,U+85ff,U+867b,U+86a8-86a9,U+870a,U+8722,U+876e,U+877c,U+87e5,U+8888,U+88df,U+8919,U+8bcc,U+8bdf,U+8be8,U+8bee,U+8c20,U+8c2f,U+8d36,U+8df8,U+8e05,U+8e2f,U+8f9a,U+9021,U+908b,U+90b4,U+90ba,U+90d0,U+90eb,U+90fe,U+91aa,U+933e,U+9486-9487,U+948d,U+9490,U+94ad,U+94bd,U+94d6,U+94d9,U+9507,U+9546,U+955e,U+956b,U+95e9,U+9604,U+960b,U+9612,U+9615,U+9617,U+96b9,U+989a-989b,U+989e,U+9a78,U+9a7d,U+9aa0,U+9aa2,U+9ac2,U+9b23,U+9b3b,U+9c82,U+9cca,U+9cd9,U+9e28,U+9e5a,U+9e5e,U+9e6c,U+9efe,U+9f0b"}},{uri:MUe,descriptors:{unicodeRange:"U+4e47,U+4e8d,U+4f65,U+4f89,U+50ee,U+520e,U+5416,U+5454,U+54bb,U+54c2,U+54d3,U+54de,U+5591,U+55e5,U+560c,U+566b,U+5769,U+578c,U+5793,U+57e4,U+5889,U+593c,U+59ab,U+5ad4,U+5ad8,U+5af1,U+5b53,U+5ba5,U+5c59,U+5c63,U+5d5b,U+5e0f,U+5e14,U+5edb,U+5fbc,U+6004,U+60ad,U+610e,U+61b7,U+624c,U+634c,U+647a,U+64ba,U+65f0,U+6600,U+66f7,U+67e2,U+67f0,U+680c,U+686b,U+6874,U+691f,U+6989,U+6a17,U+6b81,U+6b84,U+6c06-6c07,U+6c3d,U+6d07,U+6d27,U+6d2b,U+6d91,U+6e6b,U+6e8f,U+6fde,U+70bb,U+723b,U+726e,U+72b0,U+72ce,U+72f2,U+7301,U+731e,U+737e,U+7477,U+748e,U+74ff,U+7633,U+7654,U+771a,U+7726,U+7765,U+7768,U+781c,U+7829,U+78d4,U+7913,U+7957,U+79d5,U+79eb,U+7a70,U+7a86,U+7b25,U+7b38,U+7b47,U+7b72,U+7ba6-7ba7,U+7dae,U+7ee1,U+7efe,U+7f26,U+7f31,U+7f35,U+801c,U+8043,U+809f,U+80ab,U+80d7,U+8118,U+8188,U+81cc,U+823e,U+8244,U+824f,U+82b4,U+82c1,U+82e4,U+82f4,U+8306,U+833a,U+835c,U+839c,U+83b3,U+83bc,U+846d,U+867a,U+868b,U+8734,U+87ca,U+886e,U+887e,U+88a2,U+88c9,U+8921,U+8bb5,U+8bf3,U+8c04,U+8c17,U+8c1d,U+8c25,U+8c36,U+8c55,U+8c78,U+8d3d,U+8d40,U+8d59,U+8d67,U+8d91,U+8dbf,U+8deb-8dec,U+8dfd,U+8e14,U+8e41,U+8f8e,U+900b,U+9044,U+9062,U+90cf,U+9123,U+9146,U+9162,U+9172,U+918d,U+9190,U+92c8,U+93ca,U+948c,U+94aa,U+94b2,U+94c8,U+94ca,U+94d5,U+94df,U+94e9-94ea,U+94f7,U+94fc-94fd,U+951b,U+954f,U+9554,U+9559,U+9566,U+9571-9572,U+95f1,U+9608,U+960f,U+97af,U+988f,U+98d5,U+992e,U+9955,U+9ab0,U+9b32,U+9c90,U+9c9e,U+9ca5,U+9ca9,U+9cad,U+9cb1,U+9cc3,U+9e47,U+9ee7,U+9f87"}},{uri:kUe,descriptors:{unicodeRange:"U+4e93,U+4ec4,U+4ef5,U+4f27,U+4f7b,U+4fe3,U+5080,U+5121,U+51eb,U+5208,U+52f0,U+53f5,U+5453,U+5466,U+54a6,U+54bf,U+54d0,U+5533,U+5549,U+5556,U+556d,U+558f,U+55f2,U+55f5,U+5627,U+567b,U+56d4,U+571c,U+5739,U+57b4,U+5807,U+58c5,U+59a4,U+59af,U+59d8,U+5a09,U+5a0c,U+5a4a,U+5ad2,U+5b6c,U+5ca2,U+5cac,U+5d03,U+5d6c,U+5db7,U+5ebe,U+5f2d,U+5fea,U+6042,U+6120,U+6175,U+6221,U+623e,U+6339,U+638a,U+643d,U+64b8,U+64e2,U+66e9,U+67b3,U+67c1,U+67d2,U+6832,U+6877,U+68f0,U+6934,U+6966,U+6987,U+6998,U+69c1,U+69ce,U+6a3d,U+6a84,U+6aa9,U+6b87,U+6bd6,U+6c16,U+6c18,U+6cd4,U+6cee,U+6de0,U+6e0c,U+6ecf,U+6f4b,U+70b7,U+7168,U+72d9,U+7352,U+73b3,U+73d0,U+7441,U+74d2,U+75a5,U+75e7-75e8,U+7610,U+7619,U+765e,U+772d,U+7812,U+782c,U+784c,U+7850,U+7856,U+789b,U+78f4,U+7a51,U+7b15,U+7b1e,U+7b24,U+7b5a,U+7bb8,U+7bc1,U+7bd9,U+7ed0,U+7ee6,U+7efa,U+7f1b,U+7f1f,U+7f22,U+7f45,U+7f71,U+7fa7,U+7fbf,U+7ff3,U+8052,U+80b1,U+80db,U+80f4,U+81bb,U+81ec,U+8202,U+8210,U+8249,U+828a,U+828e,U+82e3,U+8315,U+8369,U+8378,U+83a8,U+83aa,U+83b4,U+83e1,U+84fc,U+8538,U+853b,U+859c,U+85ae,U+86b4,U+86c9,U+86cf,U+8725,U+879f,U+87b3,U+887d,U+88fe,U+8a8a,U+8ba7,U+8c07,U+8c14,U+8c30,U+8c47,U+8db5,U+8dd7,U+8e1f,U+8e69,U+8e70,U+8e85,U+8f78,U+8f87,U+8f8b,U+8f8f,U+90c4,U+9143,U+917d,U+948f,U+94cd,U+94d2,U+94ef,U+954a,U+9609-960a,U+96d2,U+9708,U+9765,U+97ea,U+9880,U+98a7,U+996c,U+9980,U+9991,U+9a88,U+9ab6,U+9afb,U+9b47,U+9c87,U+9c9b,U+9cb5,U+9cc7,U+9e2c,U+9e42,U+9e58,U+9ecd,U+9ecf,U+9f8a,U+9f8c"}},{uri:RUe,descriptors:{unicodeRange:"U+4ebb,U+4edd,U+4fa9,U+502c,U+50a5,U+51c7,U+51fc,U+523d,U+5241,U+530f,U+5464,U+549d,U+54a3,U+5514,U+5527,U+555c,U+556e,U+5576,U+55b1,U+55b9,U+55eb,U+5624,U+564c,U+5671,U+5685,U+568f,U+56d7,U+56e1,U+57a1,U+57d9,U+5942,U+5a67,U+5c50,U+5c7a,U+5c98,U+5d06,U+5d27,U+5d6f,U+5df3,U+5dfd,U+5e19,U+5ea0,U+5eb9,U+5eea,U+5ffe,U+600f,U+606b,U+6215,U+622c,U+6266,U+62bb,U+62bf,U+6308,U+6387,U+63b8,U+63c4,U+63c6,U+63f6,U+6441,U+6555,U+659b,U+6677,U+66a7,U+6775,U+678b,U+679e,U+6840,U+6849,U+6860,U+68c2,U+6910,U+6a28,U+6a2f,U+6a79,U+6b92-6b93,U+6bc2,U+6bfd,U+6c29,U+6c32,U+6c86,U+6cc5,U+6d0c,U+6d60,U+6da0,U+6ddd,U+6e86,U+6ed3,U+6edf,U+6fb9,U+6fd1,U+6fef,U+7023,U+7080,U+70ca,U+712f,U+7145,U+7284,U+732c,U+73c8,U+73d9,U+740a,U+7457,U+7596,U+759d,U+75a3,U+75d8,U+75e3-75e4,U+75ff,U+7622,U+7688,U+76b4,U+76e5,U+7818,U+7887,U+789a,U+78b2,U+7b08,U+7b33,U+7c2a,U+7ccc,U+7ea8,U+7ec0,U+7fe6,U+8012,U+8084,U+8093,U+80e4,U+80ef,U+8297,U+82a8,U+82be,U+8331,U+8366,U+83c5,U+83fd,U+8473,U+84a1,U+84ca,U+84d1,U+857b,U+85c1,U+85d3,U+8605,U+8662,U+86aa,U+86b1,U+86d4,U+86ed,U+86f3,U+8709,U+8748,U+874c,U+8763,U+89c7,U+89de,U+89e5,U+8a3e,U+8ba6,U+8c00,U+8c21,U+8c49,U+8c7a,U+8d30,U+8df9,U+8e51,U+8e59,U+8f6b,U+8f73,U+8ff3,U+9016,U+9026,U+902f,U+9099,U+909b,U+90c7,U+914a,U+91ae,U+91ba,U+9495,U+94a3,U+94af,U+94ba,U+94bf,U+94cc,U+94e1,U+94f0,U+9531,U+955d,U+95f3,U+9697,U+96bc,U+975b,U+977c,U+98a2,U+998a,U+9994-9995,U+9a9b,U+9ab7,U+9ac5,U+9c91,U+9ccf,U+9cd5,U+9e29,U+9edc,U+9edf,U+9f83,U+9f88-9f89"}},{uri:LUe,descriptors:{unicodeRange:"U+4ee8,U+4f22,U+4f43,U+4f57,U+4f5d,U+4f6f,U+4ff8,U+502d,U+507b,U+5345,U+53df,U+53fb,U+544b,U+5482,U+54a7,U+54cc,U+550f,U+5544,U+5555,U+5594,U+55e8,U+55ec,U+55ef,U+564e,U+56f9,U+5704,U+576d,U+5785,U+57ad,U+5914,U+5958,U+599e,U+59aa,U+59be,U+5a06,U+5abe,U+5ae1,U+5b40,U+5bee,U+5cbf,U+5cc4,U+5ccb,U+5d47,U+603f,U+6078,U+607d,U+607f,U+608c,U+609a,U+60fa,U+61ff,U+621b,U+622e,U+626a,U+6371,U+63ae,U+63cd,U+63d6,U+6410,U+6414,U+6421,U+6448,U+64d8,U+6710,U+6748,U+6772,U+680e,U+6954,U+69ab,U+6c68,U+6c8f,U+6ca4,U+6d2e,U+6e4e,U+6e98,U+6fe0,U+7094,U+70e9,U+7116,U+7119,U+723f,U+73c9,U+74e4,U+753e,U+7548,U+75bd,U+75cd,U+7618,U+7634,U+76c5,U+76f1,U+7708,U+7719,U+777e,U+7791,U+77b3,U+7823,U+7827,U+7830,U+7889,U+7893,U+7949,U+795c,U+79e3,U+7a14,U+7a88,U+7a95,U+7aa0,U+7afd,U+7b90,U+7bd1,U+7bfe,U+7da6,U+7ec2,U+7eef,U+7f03-7f04,U+7f08,U+7f58,U+7f61,U+7f9f,U+8174,U+8200,U+828d,U+82c4,U+82d5,U+82dc,U+82f7,U+832d,U+835a,U+840b,U+8438,U+852b,U+869d,U+86ac,U+86d0,U+86f0,U+8782,U+87a8,U+87d1-87d2,U+87e0,U+8839,U+8913,U+891b,U+8934,U+8941,U+89ca,U+89ce,U+8a07,U+8ba3,U+8bc5,U+8bcb,U+8bdb,U+8c11,U+8c15,U+8c29,U+8c32,U+8dc4,U+8dce,U+8ddb,U+8dfa,U+8e09,U+8e1d,U+8e39,U+8e42,U+8e49,U+8e4b,U+8e8f,U+8f71-8f72,U+9004,U+9036,U+9097,U+90dc,U+90e2,U+90e6,U+90ef,U+9104,U+919a,U+91b4,U+938f,U+9497,U+950f,U+9557,U+9562-9563,U+9573,U+9606,U+9649,U+972d,U+973e,U+97a3,U+97eb,U+988c,U+9894,U+98a6,U+9974,U+9977,U+997d,U+9a90,U+9a9d,U+9aef,U+9ca2,U+9ccd,U+9cdf,U+9e20,U+9e4c,U+9e6b,U+9f3e"}},{uri:DUe,descriptors:{unicodeRange:"U+4ede,U+4ee1,U+4eeb,U+4fda,U+4ffe,U+5025,U+506c,U+50f3,U+5106,U+520d,U+525c,U+52ad,U+530d,U+5310,U+539d,U+53a9,U+53fc,U+5421,U+5477,U+54e7,U+551b,U+5530,U+557e,U+5599,U+55c4,U+55d1,U+55d4,U+55df,U+55e4,U+55ea,U+5623,U+562d,U+5654,U+56eb,U+56f5,U+57a7,U+57d5,U+57dd,U+584d,U+5880,U+58ec,U+59dd,U+5a32,U+5a55,U+5a75,U+5b51,U+5b71,U+5b73,U+5cd2,U+5ce4,U+5e5b,U+5e96,U+5fd2,U+607b,U+61d1,U+634b,U+636d,U+63b3,U+63ff,U+64c0,U+661d,U+6657,U+66dc,U+67a5,U+6841,U+6867,U+6901,U+699b,U+6a47,U+6b46,U+6c21,U+6c24,U+6c35,U+6c4a,U+6c94,U+6ca3,U+6d39,U+6d63,U+6d6f,U+6d94,U+705e,U+71e7,U+726f,U+72cd,U+72de,U+72f0,U+7325,U+7350,U+7391,U+741a,U+757f,U+7583,U+75b1,U+75b4,U+75b8,U+75c2,U+75f1,U+766f,U+7699,U+7751,U+789c,U+7a17,U+7be6,U+7cb2,U+7ea3,U+7eb0,U+7ebe,U+7eeb,U+7f25,U+7f2c,U+7fb8,U+8026,U+8037,U+8153,U+8171,U+8191,U+8214,U+821b,U+8222,U+826e,U+82eb,U+830c,U+8314,U+8334,U+83d6,U+8418,U+843c,U+84ff,U+8564,U+8572,U+8616,U+866c,U+8693,U+86a3,U+86a7,U+86af,U+86b6,U+86c6,U+86ca,U+8708,U+870d,U+8759,U+8760,U+87af,U+87c6,U+8869,U+88c6,U+89d0,U+8b07,U+8baa-8bab,U+8bc2,U+8be4,U+8bf0,U+8c2a,U+8c62,U+8c89,U+8d49,U+8d6d,U+8d84,U+8d94,U+8db8,U+8dc6,U+8e2e,U+8e3d,U+8e47,U+8e7f,U+9005,U+9051,U+907d,U+9082,U+9088,U+90b0,U+90d3,U+9150,U+949c,U+94a4,U+94b9,U+94cb,U+94e0,U+9509,U+9512,U+951f,U+9534,U+9552-9553,U+965f,U+96b0,U+9791,U+9889,U+9990,U+9a9c,U+9aa7,U+9c88,U+9cb2-9cb3,U+9cb6-9cb7,U+9cc5,U+9cdc,U+9e22,U+9e2a,U+9e57,U+9e67,U+9e73,U+9e82,U+9eb8,U+9ee0,U+9f9b"}},{uri:PUe,descriptors:{unicodeRange:"U+4eb5,U+4f09,U+4f5a,U+4f8f,U+4fce,U+4fdf,U+4fea,U+4ff3,U+500c,U+500f,U+504e,U+5088,U+52be,U+5420,U+5457,U+5499,U+549b,U+54c6,U+54d2,U+558b,U+559f,U+55bd,U+55d6,U+565c,U+567c,U+568e,U+5768,U+577b,U+57a9,U+57ed,U+59f9,U+5a11,U+5a40,U+5ae6,U+5b6a,U+5b93,U+5bb8,U+5c15,U+5c99,U+5c9c,U+5cc1,U+5d2e,U+5d4b,U+5d99,U+5e54,U+5e61,U+5fcf-5fd1,U+6002,U+6006,U+6014,U+60af,U+60c6,U+60da,U+60f4,U+621f,U+62c8,U+631b,U+631e,U+63e9,U+64b5,U+655d,U+6619,U+6635,U+6641,U+67ad,U+67b0,U+67b7,U+67e9,U+684e,U+688f,U+695d,U+696b,U+69b7,U+6a58,U+6c26,U+6d35,U+6d43,U+6d9e,U+6dd9,U+6dec,U+6e11,U+6e6e,U+6e9f,U+6ec2,U+6ee2,U+6ef9,U+6f09,U+6f66,U+6f8d,U+6fc2,U+6fc9,U+729f,U+72c8,U+73de,U+7430,U+7566,U+7579,U+75c9,U+75e2,U+75fc,U+762a,U+7638,U+7678,U+76c2,U+76f9,U+778c,U+77cd,U+77dc,U+7800,U+781d,U+782d,U+783b-783c,U+78a3,U+78ec,U+7980,U+7a23,U+7b95,U+7bdd,U+7c0c,U+7c41,U+7c91,U+7cb3,U+7cc5,U+7ecc,U+7f19,U+7fca,U+8006,U+8069,U+807f,U+80bd,U+80ed,U+814b,U+8198,U+82cb,U+82d2,U+834f,U+8360,U+847a,U+84d6,U+84e5,U+8537,U+85d0,U+8671,U+86a4,U+86ce,U+86f9,U+8703,U+8707,U+8737,U+873b,U+8815,U+8936,U+8bc3,U+8bcf,U+8bd2,U+8bd8,U+8be9,U+8c0c,U+8c0f,U+8c4c,U+8d45,U+8d5d,U+8d73,U+8e31,U+8e6d,U+8e76,U+8fe4,U+9041,U+90d7,U+9169,U+92ae,U+94a1,U+94c4,U+94c9,U+94db,U+94e7,U+9503,U+9506,U+9517,U+9528,U+9537,U+9542,U+9549,U+95fe,U+9616,U+961a,U+96c9,U+96f3,U+9701,U+970e,U+9739,U+9753,U+9798,U+98d2-98d3,U+98d9-98da,U+9968,U+996f,U+9984,U+9997,U+9acb,U+9b03,U+9c85,U+9ca8,U+9cab,U+9e49,U+9e51,U+9e66,U+9f10"}},{uri:NUe,descriptors:{unicodeRange:"U+4e15,U+4e1e,U+4e2b,U+4eb3,U+4ec9,U+4f0e,U+4f64,U+501c,U+50a9,U+510b,U+51a2,U+51bc,U+527d,U+52d0,U+53fd,U+5429,U+542e,U+5486,U+54af,U+5506,U+5511,U+5522,U+552c,U+556c,U+55b3,U+55d2,U+55e6,U+55fd,U+561f,U+5639,U+5659,U+5662,U+5693,U+572a,U+5892,U+598a,U+5992,U+59a9,U+5a20,U+5ae3,U+5b17,U+5b7d,U+5d34,U+5d3d,U+5d4a,U+5d82,U+5e1a-5e1b,U+5ea5,U+5f0b,U+5f77,U+5fd6,U+5fff,U+6026,U+6035,U+6063,U+60b4,U+60bb,U+60ee,U+612b,U+6194,U+61ca,U+61e6,U+61f5,U+620a,U+6248,U+62a1,U+62d7,U+6376,U+637b,U+652b,U+65bc,U+65cc,U+65ce,U+65d6,U+664c,U+665f,U+6666,U+6684,U+66b9,U+6773,U+6777,U+6787,U+67de,U+6845,U+693d,U+6994,U+6a35,U+6d54,U+6d5c,U+6d8e,U+6dd6,U+6eb4,U+6f2a,U+6f78,U+704f,U+70ec,U+7118,U+714a,U+7172,U+71b9,U+724d,U+728a,U+7337,U+733e,U+7396,U+73b7,U+73cf,U+7428,U+742c,U+742e,U+74ee,U+74f4,U+7525,U+753a,U+7572,U+75d4,U+765c,U+768e,U+7762,U+777d,U+77fd,U+7825,U+7837,U+78b4,U+795f,U+79ed,U+7a1e,U+7b06,U+7b20,U+7ba9,U+7bab,U+7c7c,U+7cbd,U+7cdc,U+7ec9,U+7ef6,U+7f30,U+7f42,U+7f44,U+7f54,U+7f94,U+8004,U+800b,U+8019,U+809b,U+80ae,U+80c4,U+80f1,U+8146,U+816e,U+817c,U+81c0,U+81fc,U+81fe,U+822b,U+830f,U+832f,U+8340,U+8365,U+8385,U+8392,U+83a0,U+8424,U+84af,U+869c,U+8713,U+8717-8718,U+87c0,U+87cb,U+87fe,U+8821,U+8902,U+89d1,U+8bb9,U+8c12,U+8d32,U+8d53,U+8df7,U+8e7c,U+8f7c,U+8f95,U+8fab,U+9052,U+905b,U+9095,U+909d,U+90c5,U+911e,U+9122,U+916a,U+919b,U+948e,U+9492,U+949a,U+94b5,U+94bc,U+94c6,U+94f1,U+9502,U+9511,U+9536,U+956f-9570,U+9602,U+9621,U+9631,U+998b,U+99a5,U+9a81,U+9a9e,U+9ebe,U+9f8b"}},{uri:OUe,descriptors:{unicodeRange:"U+4f2b,U+4f3d,U+4fac,U+5043,U+5055,U+5140,U+5156,U+51cb,U+5243,U+531d,U+536f,U+53a5,U+53ae,U+53f1,U+541d,U+5431,U+547b,U+5492,U+5494,U+54a4,U+54aa,U+54ce,U+54fd,U+5509,U+5520,U+553e,U+557b,U+55c5,U+55e1,U+55f7,U+5608,U+5636,U+563b,U+5773,U+57a0,U+5811,U+587e,U+58d5,U+59e3,U+5a29,U+5a6a,U+5a76,U+5a7a,U+5ac9,U+5b62,U+5b95,U+5c49,U+5c8c,U+5cab,U+5cb7,U+5d02,U+5d58,U+5e44,U+5e7a,U+5eff,U+5f29,U+5f89,U+5f9c,U+5fa8,U+6005,U+6043,U+60b8,U+60d8,U+60ec,U+60f0,U+6115,U+618e,U+630e,U+637a,U+6390,U+63ac,U+63b0,U+64de,U+6525,U+6538,U+65ee-65ef,U+6631,U+6636,U+6654,U+677c,U+67b8,U+67d8,U+683e,U+6886,U+68b5,U+692d,U+6963,U+6979,U+6988,U+6b59,U+6b9a,U+6c69,U+6c74,U+6cae,U+6ce0,U+6cef,U+6d95,U+6dc5,U+6dde,U+6de6,U+6dfc,U+6ea7,U+6f15,U+6f29,U+7096,U+70c3,U+7131,U+715c,U+7166,U+7266,U+7317,U+731d,U+7329,U+73e9,U+7425,U+7455,U+7490,U+74ef,U+7519,U+75b5,U+75b9,U+75de,U+7656,U+7663,U+7691,U+7729,U+77fe,U+783e,U+787c,U+795a,U+7a79,U+7abf,U+7b3a,U+7b4f,U+7b60,U+7b75,U+7b8d,U+7bb4,U+7bd3,U+7be1,U+7cbc,U+7edb,U+7f1c,U+7f8c,U+7fb2,U+7fb9,U+7fce,U+7ff1,U+810d,U+81c6,U+82a5,U+82aa,U+82de,U+8317,U+8343,U+835e,U+8364,U+836a,U+853a,U+8543,U+854a,U+8559,U+8568,U+85b0,U+85b9,U+864f,U+86e4,U+8715,U+8845,U+8884,U+88e8,U+88f1,U+8983,U+8be1,U+8c1f,U+8c27,U+8c5a,U+8c82,U+8d58,U+8dbe,U+8f98,U+9035,U+9074,U+90a1,U+9149,U+9157,U+93d6,U+949d,U+94c2,U+94e3-94e4,U+95eb,U+95f0,U+9611,U+9619,U+9642,U+968d,U+9706,U+970f,U+97ed,U+988a,U+9893,U+98e8,U+9a77,U+9a87,U+9aa1,U+9abc,U+9cdd,U+9e2f,U+9e33,U+9e44,U+9e5c,U+9e9d,U+9edd"}},{uri:FUe,descriptors:{unicodeRange:"U+4f58,U+4f6c,U+4f70,U+4fd0,U+5014,U+51bd,U+524c,U+5315,U+5323,U+535e,U+540f,U+542d,U+545b,U+548e,U+549a,U+54ab,U+54fc,U+5567,U+556a,U+5600,U+5618,U+563f,U+5669,U+56f1,U+56ff,U+573b,U+574d,U+579b,U+57b8,U+57c2,U+586c,U+58f9,U+595a,U+598d,U+5993,U+5996,U+59d7,U+5b7a,U+5ba6,U+5c4e,U+5c96,U+5ce5,U+5eb6,U+5f08,U+5f99,U+602f,U+6059,U+606c,U+607a,U+60ed,U+61a9,U+620c,U+6249,U+62a8,U+62c4,U+62ed,U+62fd,U+6342,U+6345,U+6396,U+63a3,U+6402,U+6413,U+642a,U+6487,U+64a9,U+64ac,U+64ae,U+64b7,U+659f,U+65a1,U+667e,U+66f3,U+67e0,U+69db,U+69df,U+6aac,U+6b86,U+6c50,U+6c5e,U+6c76,U+6c85,U+6c8c,U+6cde,U+6d19,U+6d52,U+6da7,U+6db8,U+6e1a,U+6e25,U+6e4d,U+6e5f,U+6ec1,U+6f31,U+6f7a,U+6fa7,U+6fe1,U+701b,U+70ab,U+70f7,U+717d,U+71a8,U+7252,U+72c4,U+72e1,U+7315,U+736d,U+73ae,U+73c0,U+73c2,U+740f,U+75a4,U+7600-7601,U+768b,U+76bf,U+76d4,U+7728,U+772f,U+776c,U+77a0,U+77b0,U+77f8,U+783a,U+78d0,U+78fa,U+7977,U+7a37,U+7a92,U+7afa,U+7b71,U+7b94,U+7cef,U+7f28,U+7fe1,U+808b,U+80e5,U+80eb,U+8110,U+8113,U+812f,U+814c,U+81c3,U+8235,U+82d4,U+8309,U+83c1,U+8431,U+8469,U+84bf,U+84d3,U+84df,U+84e6,U+8511,U+8638,U+86c0,U+86db,U+86fe,U+8757,U+8822,U+8882,U+8885,U+8892,U+88f3,U+892a,U+8ba5,U+8bd9,U+8be0,U+8be7,U+8bfd,U+8c1a,U+8d4a,U+8d4e,U+8d66,U+8dda,U+8e0c,U+8e52,U+8e74,U+8e87,U+8f76,U+8fc2,U+8fe6,U+900d,U+9068,U+90ac,U+90b3,U+90b8,U+90e7,U+9119,U+9131,U+915a,U+916e,U+94b4,U+94d0,U+94e2,U+94ec,U+94ff,U+9522,U+9535,U+9556,U+965b,U+96f9,U+9774,U+9981,U+998d,U+998f,U+9a6e,U+9a7f,U+9a8a,U+9b13,U+9c9f,U+9e3e,U+9e43,U+9e6d,U+9e8b,U+9e92,U+9edb,U+9eef"}},{uri:BUe,descriptors:{unicodeRange:"U+4e10,U+4e56,U+4e98,U+4ec3,U+4f3a,U+4f5f,U+4f88,U+4f97,U+4fa5,U+4fe8,U+504c,U+5197,U+52fa,U+5364,U+53e8,U+5406,U+543c,U+545c,U+5471,U+5480,U+5495,U+54b3,U+54df,U+54e6,U+54ee,U+557c,U+5583,U+55dc,U+55e3,U+566c,U+592f,U+5944,U+5983,U+59ca,U+59e5,U+5a13,U+5a7f,U+5b09,U+5bd0,U+5e4c,U+5eb5,U+5f1b,U+5f3c,U+608d,U+60cb,U+61a7,U+61ac,U+61cb,U+6233,U+62a0,U+62e7,U+62ee,U+62f4,U+62f7,U+634e,U+6382,U+63c9,U+63ea,U+6400,U+645e,U+6482,U+6556,U+6593,U+6615,U+664f,U+66e6,U+672d,U+675e,U+67da,U+6805,U+6808,U+6868,U+68a2,U+695e,U+69ad,U+6a80,U+6a90,U+6b83,U+6be1,U+6c30,U+6cad,U+6cb1,U+6cf1,U+6d31,U+6d93,U+6dae,U+6dbf,U+6dc6-6dc7,U+6e0d,U+6e32,U+6e3a,U+6e85,U+6eba,U+6f3e,U+6f5e,U+6f7c,U+6fee,U+71ee,U+722a,U+72b7,U+72e9,U+73ba,U+73d1,U+7409,U+7435-7436,U+7459-745a,U+747e,U+7487,U+74e2,U+7504,U+752c-752d,U+7599,U+759f,U+75a1,U+75ca,U+75f0,U+761f,U+7629,U+777f,U+7785,U+77a5,U+77bf,U+78d5,U+7934,U+7940,U+79a7,U+7b19,U+7c38,U+7c95,U+7cb1,U+7ce0,U+7eca,U+7ef7,U+7f2b,U+7f81,U+7fcc,U+8046,U+8148,U+8165,U+819b,U+81ba,U+828b,U+82ae,U+82b7,U+82d3,U+8301,U+830e,U+831c,U+8338,U+837c,U+8393,U+8398,U+83ba,U+83e0,U+83e9,U+853c,U+8654,U+86df,U+8712,U+873f,U+874e,U+8783,U+8859,U+88a4,U+8925,U+8bb7,U+8bff,U+8c19,U+8c1b,U+8c24,U+8c2c,U+8d61,U+8db4,U+8e6c,U+8f8a,U+8fe5,U+8ff8,U+901e,U+90f4,U+912f,U+9163,U+9170,U+91dc,U+949b,U+94a8,U+94b3,U+94c0,U+94e8,U+9525,U+9530,U+9539,U+954c-954d,U+9550,U+955b,U+962a,U+9685,U+96cc,U+9776,U+988d,U+9975,U+9985,U+9a6f,U+9aa5,U+9ab8,U+9c7f,U+9ca4,U+9cb8,U+9e25,U+9e35,U+9e4a"}},{uri:zUe,descriptors:{unicodeRange:"U+4ea2,U+4ea5,U+4f36,U+4f84,U+4f8d,U+501a,U+5029,U+516e,U+51a5,U+51c4,U+51f8,U+5201,U+527f,U+5321,U+5352,U+5366,U+53e9,U+54c7,U+5632,U+5676,U+56b7,U+56bc,U+56da,U+56e4,U+5703,U+5729,U+5742,U+57a2-57a3,U+5815,U+58d1,U+5919,U+592d,U+5955,U+5a05,U+5a25,U+5a34,U+5b70,U+5b75,U+5bdd,U+5bf0,U+5c41,U+5c79,U+5c91,U+5c94,U+5ce6,U+5ced,U+5d69,U+5dc5,U+5e16,U+5e27,U+5f27,U+5f95,U+5ffb,U+6020,U+604d,U+6055,U+60e6,U+60eb,U+6123,U+618b,U+61a8,U+620d,U+62c7,U+62ce,U+62d9,U+631f,U+634d,U+6452,U+6479,U+64ce,U+64d2,U+655b,U+660a,U+6726,U+67c4,U+6809,U+6853,U+68e3,U+68f1,U+68fa,U+693f,U+6942,U+6995,U+69a8,U+69b4,U+6a71,U+6b89,U+6bcb,U+6bd3,U+6bd9,U+6c40,U+6cf8,U+6cfe,U+6d85,U+6da3,U+6daa,U+6e0e,U+6e43-6e44,U+6f88,U+7078,U+7099,U+70bd,U+70d9,U+70fd,U+7109,U+7184,U+7239,U+733f,U+73f2,U+748b,U+749c,U+749e,U+759a,U+75d2,U+75eb,U+7620,U+766b,U+7693,U+76cf,U+7738,U+773a,U+776b,U+778e,U+77aa,U+7852,U+78be,U+7948,U+795b,U+7960,U+796f,U+79ba,U+7a20,U+7a96,U+7aa5,U+7b03,U+7b28,U+7b50,U+7b77,U+7bc6,U+7bf1,U+7c27,U+7d0a,U+7ead,U+7ec5,U+7ee2,U+7ef0,U+7efd,U+7f0e,U+7f2e,U+7f79,U+7f9a,U+8098,U+80da,U+80e7,U+80f0,U+80f3,U+80fa,U+818a,U+81e7,U+8237-8238,U+8299,U+82b8,U+82ce,U+837b,U+83bd,U+83cf,U+8426,U+8475,U+85c9,U+85d5,U+85dc,U+85e9,U+871a,U+8747,U+8749,U+888d,U+8910,U+891a,U+8bb4,U+8be3,U+8bec,U+8bf2,U+8c06,U+8c0d,U+8d31,U+8d48,U+8de4,U+8e1e,U+8e4a,U+8e66,U+8f84,U+8f97,U+9083,U+90e1,U+9165,U+91c9,U+94b0,U+94f5,U+9504,U+9532,U+956d,U+95f5,U+95fa,U+9668,U+9698,U+96bd,U+9704,U+9773,U+9890,U+996a,U+997a,U+9a74,U+9a8b,U+9cc4,U+9ccc"}},{uri:HUe,descriptors:{unicodeRange:"U+4ea8,U+4f1e,U+4f51,U+4f63,U+4f7c,U+4f83,U+4fa0,U+4fd1,U+4ffa,U+5018,U+5026,U+508d,U+50bb,U+50f5,U+50fb,U+5162,U+5319,U+5320,U+538c,U+5413,U+541f,U+5475,U+54bd,U+54d1,U+5589,U+5598,U+575f,U+57ae,U+57e0,U+5937,U+5974,U+5978,U+59ae,U+5a1f,U+5a49,U+5ab3,U+5b99,U+5b9b,U+5ba0,U+5be1,U+5be5,U+5c09,U+5c27,U+5de2,U+5e9a,U+5f26,U+5f8a,U+5f98,U+6021,U+606d,U+60bc,U+60d5,U+60e7,U+611a,U+614c,U+6254,U+626f,U+6292,U+6296,U+62b9,U+62e2,U+631a,U+631d,U+6320,U+6346,U+63ba,U+6467,U+64bc,U+658b,U+663c,U+6643,U+6652,U+6656,U+6687,U+66d9,U+66dd,U+66f0,U+673d,U+67ab,U+6816-6817,U+68a7,U+68ad,U+68cd,U+68e0,U+6986,U+69fd,U+6b47,U+6bd7,U+6c1f,U+6c2e-6c2f,U+6cbe,U+6de4,U+6e1d,U+6e83,U+6e9c,U+6ed4-6ed5,U+6f4d,U+70f9,U+7130,U+716e,U+718f,U+71ac,U+71e5,U+72fc,U+731c,U+7334,U+73ca,U+7422,U+7426,U+745f,U+7470,U+75af,U+75f4,U+762b,U+763e,U+7696,U+7737,U+7741,U+77a7,U+77bb,U+77ee,U+785d,U+788c,U+78ca,U+7901,U+796d,U+7985,U+79fd,U+7a3c,U+7a57,U+7a74,U+7b5b,U+7caa,U+7cb9,U+7cd5,U+7eac,U+7eb6,U+7ed1,U+7ee5,U+7f20,U+7f2a,U+7f38,U+7f69,U+7fa1,U+8018,U+8038,U+803f,U+804b,U+80a2,U+80be,U+80d6,U+817a,U+81fb,U+820c,U+82ad,U+82af,U+82bd,U+8327,U+8354,U+835f,U+8367,U+836b,U+840c,U+841d,U+8471,U+849c,U+84b2,U+84c9,U+8517,U+851a,U+8549,U+8681,U+8721,U+8776,U+88d9,U+88f9,U+89c5,U+8c1c,U+8c34,U+8d81,U+8d9f,U+8e0a,U+8e72,U+8eb2,U+8fed,U+901b,U+902e,U+906e,U+9091,U+90aa,U+90af,U+915d,U+9171,U+946b,U+9489,U+9499,U+94a5,U+9508,U+9524,U+952d,U+9551,U+9576,U+95f7,U+9600,U+96b6,U+96c0,U+9756,U+97f6,U+98a0,U+98a4,U+997f,U+9a73,U+9a86,U+9ad3,U+9e3d,U+9ed4"}},{uri:Xme,descriptors:{unicodeRange:"U+4e4d,U+4e5e,U+4ec7,U+4ed5,U+50da,U+50e7,U+515c,U+51a4,U+51ff,U+5203,U+5254,U+5300,U+533e,U+5375,U+53ee,U+5435,U+543b,U+5455,U+548b,U+548f,U+54d7,U+54fa,U+5578,U+5587,U+55a7,U+560e,U+5760,U+576f,U+5777,U+5830,U+58a9,U+5962,U+59e8,U+5a07,U+5a23,U+5a3c,U+5b5a,U+5bb5,U+5bc5,U+5bde,U+5c7f,U+5cb1,U+5ce8,U+5cea,U+5d29,U+5d4c,U+5e18,U+5f57,U+5f5d,U+5f87,U+5ff1,U+6016,U+601c,U+6064,U+6177,U+61d2,U+625b,U+62e3,U+62f1,U+634f,U+63a0,U+6401,U+6405,U+6495,U+64c2,U+6512,U+6577,U+6590,U+65a7,U+65a9,U+65f7,U+6627,U+6655,U+6714,U+6795,U+67d1,U+67ff,U+68b3,U+68d5,U+68d8,U+6930,U+6960,U+6977,U+69bb,U+69d0,U+6a31,U+6b7c,U+6bb4,U+6c22,U+6c72,U+6c79,U+6c7e,U+6c81,U+6c93,U+6ca5,U+6cbc,U+6ce3,U+6cfb,U+6d3c,U+6da9,U+6df3,U+6e2d,U+6eaf,U+6ec7,U+6f13,U+6f33,U+6f62,U+6fa1,U+7011,U+707c,U+708a,U+70c1,U+70d8,U+70eb,U+711a,U+7194,U+7281,U+7316,U+7357,U+7384,U+7405,U+742a,U+745b,U+7574,U+7578,U+75ea,U+7682,U+7792,U+77d7,U+77e9,U+77eb,U+77f6,U+780c,U+78c5,U+7941,U+79e4,U+7a1a,U+7a9c,U+7ad6,U+7b5d,U+7bf7,U+7c07,U+7c3f,U+7c9f,U+7ca5,U+7cdf,U+7e82,U+7eab,U+7ece,U+7eda,U+7f09,U+7f15,U+7f9e,U+7fdf,U+7fe9,U+803b,U+803d,U+80aa,U+80b4,U+813e,U+8155,U+817b,U+819d,U+821c,U+82b9,U+82df,U+82ef,U+8304,U+83b9,U+8446,U+853d,U+85af,U+85fb,U+8650,U+865e,U+86d9,U+86ee,U+8700,U+8862,U+889c,U+88d4,U+88f8,U+895f,U+8a79,U+8bb3,U+8bb6,U+8bc0,U+8beb,U+8bf5,U+8c23,U+8c79,U+8d1e,U+8dcb,U+8e29,U+8e44,U+8e81,U+8eac,U+8eaf,U+8f8d,U+9050,U+90f8,U+914b,U+948a,U+94be,U+94ee,U+950c,U+9540,U+962e,U+9647,U+9661,U+9699,U+96cf,U+9716,U+9761,U+97a0,U+97e7,U+9a7c,U+9a8f,U+9ae6,U+9cd6,U+9e26"}},{uri:VUe,descriptors:{unicodeRange:"U+4fa3,U+4fae,U+4fd8,U+4fef,U+50a3,U+5189,U+5195,U+51db,U+51f3,U+51f9,U+5220,U+5228,U+5288,U+52ff,U+532e,U+533f,U+5351,U+53db,U+53ed,U+5450,U+5484,U+5490,U+54c9,U+54e9,U+5501,U+5507,U+5543,U+55d3,U+56a3,U+575e,U+589f,U+5984,U+59ec,U+5a04,U+5a36,U+5a77,U+5a9a-5a9b,U+5ab2,U+5ac2,U+5ad6,U+5bc7,U+5c2c,U+5c34,U+5c51,U+5cd9,U+5d0e,U+5deb,U+5e3c,U+5e87,U+5ed3,U+5f13,U+5f64,U+5fe1,U+606a,U+6096,U+60df,U+60f6,U+60f9,U+6151,U+620e,U+6241,U+6252,U+6273,U+627c,U+6289,U+62c2,U+62cc,U+62ef,U+6361,U+6363,U+63b7,U+63e3,U+6518,U+66ae,U+6756,U+6789,U+6813,U+6829,U+6862,U+6866,U+6893,U+6897,U+690e,U+6984,U+69cc,U+6a1f,U+6a44,U+6a59,U+6ba1,U+6c13,U+6c90,U+6ca6,U+6cbd,U+6ccc,U+6cd3,U+6cd7,U+6d4a,U+6d4f,U+6d5a,U+6d9f,U+6da1,U+6dcc,U+6ea5,U+6ee4,U+6ee6,U+6f2f,U+6f8e,U+701a,U+7095,U+709c,U+70af,U+70db,U+70e8,U+714e,U+715e,U+71a0,U+71ce,U+7235,U+7280,U+72d0,U+72f8,U+73ab,U+7410,U+745c,U+7480,U+74a7-74a8,U+74e3,U+75ae,U+75f9,U+76b1,U+76ce,U+7736,U+77e2-77e3,U+781a,U+789f,U+797a,U+79be,U+79c3,U+79c6,U+79f8,U+7a8d,U+7a98,U+7aa6,U+7aff,U+7b1b,U+7cd9,U+7d6e,U+7ede,U+7eee,U+7f00,U+7f24,U+7f2d,U+7fd8,U+800d,U+8116,U+8151,U+81b3,U+8205,U+82c7,U+82db,U+832c,U+8335,U+8339,U+8386,U+846b,U+8587,U+8611,U+8682,U+868a,U+868c,U+8774,U+88d8,U+88f4,U+8912,U+8b6c,U+8bbd,U+8c0e,U+8c41,U+8d26,U+8d3b-8d3c,U+8d50,U+8dea,U+8e35,U+8f99,U+8fe2,U+8fe9,U+9017,U+914c,U+916f,U+9175-9176,U+918b,U+94a0,U+94ae,U+94ce,U+94f2,U+951a,U+952f,U+9541,U+9640,U+9672,U+968b,U+96cd,U+96ef,U+9713,U+97ec,U+9885,U+9992,U+9a6d,U+9a79,U+9a85,U+9cbb,U+9cd7,U+9cde,U+9e93,U+9f9f"}},{uri:$Ue,descriptors:{unicodeRange:"U+4e11,U+4ed7,U+4fcf,U+4fe9,U+4fed,U+50ac,U+50b2,U+5112,U+5180,U+5188,U+51f6,U+522e,U+5265,U+52cb,U+52df,U+5349,U+5367,U+5378,U+537f,U+5395,U+5398,U+53d4,U+543e,U+5440,U+5446,U+54b8,U+5565-5566,U+5580,U+55bb,U+56ca,U+572d,U+573e,U+574e,U+5782-5784,U+58f3,U+5938-5939,U+5948,U+594e,U+5a1c,U+5a74,U+5ae9,U+5b55,U+5b5c,U+5bb0,U+5bd3,U+5bf8,U+5c3f,U+5d14,U+5d2d,U+5df7,U+5dfe,U+5e05-5e06,U+5e1c,U+5e62,U+5e7b,U+5e7d,U+5ed6,U+5f2f,U+5f66,U+5f6c,U+5fa1,U+604b,U+609f,U+60a6,U+60e8,U+6101,U+6124,U+6127,U+6148,U+61be,U+6247,U+62d8,U+62da,U+633d,U+635e,U+6367,U+6380,U+638f,U+63a9,U+63fd,U+641c,U+64e6,U+655e,U+6572,U+6591,U+65a5,U+6691,U+6735,U+67a2-67a3,U+67ef,U+680b,U+6876,U+6905,U+6a0a,U+6a61,U+6b79,U+6bb7,U+6bbf,U+6c41,U+6c55,U+6c83,U+6c9b,U+6ca7,U+6cfc,U+6d46,U+6d51,U+6d74,U+6d9d,U+6daf,U+6dc0,U+6deb,U+6e17,U+6e24,U+6e89,U+6ea2,U+6ef4,U+6f6d,U+707f,U+70b3,U+70e4,U+70ef,U+710a,U+722c,U+725f,U+7261,U+72ee,U+72f1,U+730e,U+732b,U+7433,U+7538,U+75bc,U+7624,U+7709,U+7750,U+7779,U+7802,U+7898,U+78a7,U+78b1,U+78cb,U+78f7,U+7984,U+7a83,U+7aed,U+7b3c,U+7b4b,U+7c92,U+7c98,U+7ca4,U+7eb9,U+7ee3,U+7ef3,U+7ef5,U+7f05,U+7f55,U+7f62,U+7fc1,U+7fd4,U+7fe0,U+8042,U+806a,U+80a0,U+80a4,U+80c3,U+8102,U+8106,U+814a,U+8154,U+8247,U+8258,U+82cd,U+8328,U+832b,U+8389,U+83ca,U+845b,U+846c,U+84b8,U+8574,U+859b,U+8680,U+8695,U+86c7,U+8702,U+886c,U+8896,U+88b1,U+88e4,U+8bc8,U+8c10,U+8c26,U+8c28,U+8c2d,U+8d4c,U+8d63,U+8f67,U+8f74,U+8fc4,U+9006,U+9063,U+90a2,U+90b1,U+90c1,U+9177,U+9189,U+9493,U+949e,U+94fe,U+9610,U+961c,U+96a7,U+96fe,U+978d,U+97f5,U+9888,U+997c,U+9a84,U+9b3c,U+9b44-9b45,U+9b54,U+9e64,U+9f0e,U+9f9a"}},{uri:GUe,descriptors:{unicodeRange:"U+4e19,U+4e38,U+4e53,U+4e7e,U+4e9f,U+4ec6,U+4f50,U+4fde,U+502a,U+5154,U+517d,U+51d1,U+51f0,U+5239,U+5256,U+52c9,U+52fe,U+5308,U+532a,U+535c,U+5384,U+53a2,U+53a8,U+53c9,U+53e0,U+5496,U+54ac,U+54c0,U+54c4,U+54e8,U+5561,U+5582,U+561b,U+5631,U+566a,U+5764,U+576a,U+5792,U+57ab,U+584c,U+5885,U+58f6,U+59a8,U+5acc,U+5bc2,U+5c38-5c39,U+5c60,U+5c6f,U+5c82,U+5c90,U+5d16,U+5dcd,U+5e37,U+5e90,U+5eb8,U+5f6a,U+5fcc,U+6012,U+6068,U+6073,U+607c,U+6094,U+6109,U+621a,U+626e,U+6284,U+62d0,U+62e6,U+62fe,U+6321,U+6328,U+632b,U+6349,U+6454,U+65ed,U+660f,U+6674,U+66a8,U+6749,U+674f,U+6760,U+67af,U+6850,U+6854,U+6869,U+68a8,U+68d2,U+68f5,U+6912,U+6b49,U+6b6a,U+6bef,U+6c28,U+6c5d,U+6c82,U+6cab,U+6cb8,U+6cc4,U+6cf5,U+6d47,U+6d78,U+6da4,U+6dc4,U+6dcb,U+6df9,U+6e0a,U+6e23,U+6e5b,U+6eb6,U+6f06,U+6f47,U+6f84,U+6f9c,U+6fd2,U+7076,U+70ac,U+7199,U+723d,U+72ac,U+72ed,U+7476,U+7529,U+752b,U+754f,U+7554,U+75d5,U+7626,U+76ef,U+7720,U+7766,U+7784,U+77ac,U+780d,U+7838,U+7845,U+786b,U+78b3,U+7978,U+79b9,U+79c9,U+79e7,U+7a3d,U+7a84,U+7a9f,U+7b0b,U+7b52,U+7c7d,U+7f1a,U+7fc5,U+7ff0,U+804a,U+8086-8087,U+808c,U+809a,U+80ba,U+810a,U+8180,U+818f,U+81c2,U+81ed,U+8231,U+8292,U+829c,U+82a6,U+82d1,U+8346,U+838e,U+839e,U+83c7,U+83f1,U+8403,U+840e,U+8513,U+857e,U+85e4,U+867e,U+871c,U+87ba,U+87f9,U+884d,U+8944,U+8a93,U+8c05,U+8d2c,U+8d2e,U+8d42-8d43,U+8dfb,U+8e22,U+8eba,U+8f69,U+8f9c,U+8fa3,U+8fa8,U+8fb1,U+900a,U+9038,U+903b,U+9042,U+904f,U+90b5,U+90dd,U+9102,U+9187,U+94a7,U+94c5,U+9523,U+95f8,U+95fd,U+960e,U+964b-964c,U+96c1,U+9709,U+971c,U+97ad,U+9882,U+9965,U+9976,U+9988,U+99a8,U+9a82,U+9a9a,U+9b41,U+9c8d,U+9e45,U+9e70,U+9e9f,U+9f3b,U+9f7f"}},{uri:XUe,descriptors:{unicodeRange:"U+4e08,U+4e18,U+4e1b,U+4e22,U+4e27,U+4e32,U+4e52,U+4e73,U+4ead,U+4ed4,U+4ed9,U+4ef0,U+4fa6,U+5076,U+5179,U+51bb,U+51c9,U+51ef,U+51fd,U+524a,U+526a,U+529d,U+52ab,U+5306,U+5339,U+53d9,U+540a,U+5410,U+541e,U+5439,U+54b1,U+54ed,U+5564,U+558a,U+55b7,U+5634,U+574a,U+5751,U+57a6,U+57cb,U+57d4,U+5824,U+582a,U+5835,U+5858,U+5893,U+58e4,U+5951,U+5986,U+59da,U+59fb,U+59ff,U+5a03,U+5a46,U+5ac1,U+5b5d,U+5bfa,U+5c18,U+5c3a,U+5c48,U+5c4f,U+5c61,U+5cb3,U+5d1b,U+5e15,U+5e3d,U+5e99,U+5e9e,U+5eca,U+5f0a,U+5f17-5f18,U+5f25,U+5f7c,U+5fcd,U+6028,U+60a0,U+60ac,U+60d1,U+614e,U+6155,U+6168,U+61c8,U+6208,U+6212,U+6251,U+629a-629b,U+62ab-62ac,U+62fc,U+6323,U+632a,U+63d2,U+643a,U+6491-6492,U+649e,U+64b0,U+64c5,U+659c,U+6614,U+662d,U+6664,U+6670,U+6676,U+6746,U+67cf,U+67d4,U+682a,U+6843,U+6846,U+68da,U+6b3a,U+6b67,U+6c27,U+6c5b,U+6c64,U+6c70,U+6caa,U+6cca,U+6ce1,U+6d12,U+6d45,U+6dd1,U+6dd8,U+6e34,U+6e7f,U+6ee5,U+6f02,U+7092,U+70c2,U+70e6,U+7115,U+7237,U+7272,U+727a,U+72c2,U+739b,U+73b2,U+743c,U+751c,U+758f,U+75b2,U+7686,U+76c6,U+76d2,U+76fc,U+775b,U+77a9,U+7816,U+788e,U+7897,U+78b0,U+79bd,U+7a0d,U+7a91,U+7a9d,U+7ae3,U+7bad,U+7cca,U+7d2b,U+7eb1,U+7f06,U+7f14,U+7f1d,U+7f50,U+7ffc,U+8036,U+80bf,U+80c1,U+80ce,U+80f8,U+8109,U+810f,U+8170,U+8179,U+819c,U+821f,U+8230,U+8236,U+8273,U+829d,U+82f9,U+8305,U+8350,U+83b2,U+83cc,U+8404,U+840d,U+8427,U+8482,U+8679,U+8854,U+886b,U+8bbc,U+8be6,U+8c31,U+8c6b,U+8d4b,U+8dcc,U+8e2a,U+8e48,U+8f90,U+8fb0,U+9022,U+903c,U+903e,U+9065,U+916c,U+917f,U+94a9,U+94c3,U+94dd,U+94ed,U+9510,U+953b,U+96c7,U+970d,U+9738,U+9877,U+987d,U+989c,U+98d8,U+9a70,U+9a91,U+9aa4,U+9b42,U+9b4f,U+9e2d,U+9e3f,U+9e7f,U+9f20"}},{uri:$me,descriptors:{unicodeRange:"U+4e59,U+4ed3,U+4f0f,U+4f38,U+4f69,U+4fa7,U+4faf,U+4ff1,U+5077,U+5085,U+5144,U+5151,U+51af,U+51b6,U+51cc,U+523a,U+5251,U+5269,U+5272,U+52d8,U+5353,U+5389,U+53f9,U+5401,U+5415,U+541b,U+54f2,U+5524,U+554a,U+559d,U+5609,U+5740,U+575d,U+5806,U+5821,U+586b,U+5915,U+594f,U+5960,U+5999,U+59a5,U+59b9,U+59c6,U+59d1,U+59dc,U+5b5f,U+5b64,U+5b87,U+5bb4,U+5bbf,U+5c16,U+5c1d,U+5c3e,U+5c9a,U+5ca9,U+5cad,U+5cfb,U+5de1,U+5de7,U+5de9,U+5ef7,U+5f04,U+5f70,U+5f79,U+5fc6,U+602a,U+6050,U+6052,U+6070,U+6084,U+60b2,U+60dc,U+60e9,U+6167,U+6170,U+61c2,U+6270,U+6291,U+62b1,U+62bc,U+62dc,U+62df,U+62f3,U+6324,U+633a,U+6377,U+6398,U+63cf,U+640f,U+642c-642d,U+6458,U+6478,U+6500,U+654c,U+6566,U+658c,U+65c1,U+65cb,U+65e8,U+65ec,U+6696-6697,U+6734,U+679a,U+679d,U+67dc,U+67f3-67f4,U+680f,U+683d,U+684c,U+68af,U+699c,U+6bc1,U+6c0f,U+6c1b,U+6c57,U+6c6a,U+6d3d,U+6d6e,U+6d82,U+6db5,U+6dee,U+6e58,U+6eaa,U+6ecb,U+6ede,U+6ee9,U+6f0f,U+6f20,U+6f58,U+704c,U+7070,U+70b8,U+718a,U+7238,U+7262,U+7275,U+72b9,U+72d7,U+72e0,U+741b,U+7434,U+7483,U+74f6-74f7,U+75ab,U+764c,U+7761,U+7855,U+7891,U+78c1,U+79d2,U+7a00,U+7a3b,U+7c97,U+7ea4,U+7eb2,U+7ed2,U+7eea,U+7ef8,U+7f18,U+7fbd,U+8000,U+8010,U+8096,U+809d,U+80a9,U+817f,U+81e3,U+8206,U+8212,U+82ac,U+8302,U+8361,U+8377,U+83f2,U+8461,U+848b,U+84ec,U+8521,U+85aa,U+8870,U+8877,U+8881,U+888b,U+88ad,U+88c2,U+8986,U+8bd1,U+8bf1,U+8d24,U+8d2a,U+8d3e-8d3f,U+8d41,U+8d56,U+8d64,U+8d6b,U+8e0f,U+8f70,U+8f85,U+8f88,U+8fa9,U+9003,U+901d,U+90b9,U+90ce,U+94a6,U+94f8,U+9505,U+95ea,U+95ef,U+95f2,U+95f9,U+9601,U+9605,U+9634,U+966a,U+9677,U+9690,U+9694,U+96d5,U+971e,U+9896-9897,U+9972,U+9a71,U+9a76,U+9a7e,U+9e1f,U+9e23"}},{uri:jUe,descriptors:{unicodeRange:"U+4e01,U+4e43,U+4ea6,U+4ef2,U+4eff,U+4f26,U+4f2a,U+4f2f,U+4f5b,U+4fa8,U+4fca,U+4fd7,U+5021,U+504f,U+5141,U+51c0,U+51dd,U+51e4,U+51ed,U+5200,U+5237,U+5427,U+5448,U+54a8,U+5706,U+5708,U+5723,U+575b,U+57c3,U+5899,U+58a8,U+58c1,U+5976,U+5988,U+59bb,U+59d0,U+59d3,U+5a18,U+5a31,U+5a92,U+5b54,U+5b85,U+5baa-5bab,U+5bc4,U+5bd2,U+5be8,U+5bff,U+5c65,U+5d07,U+5e1d,U+5e78,U+5e7c,U+5f03,U+5f1f,U+5f39,U+5f6d,U+5f92,U+5faa,U+5fbd,U+5fe7,U+5ffd,U+60a8,U+60ef,U+6108,U+6162,U+622a,U+6234,U+626b,U+626d,U+62c6,U+62d2,U+62d4,U+62d6,U+62e8,U+6316,U+6355,U+63ed,U+6447,U+64a4,U+65f1,U+6606,U+6628,U+664b,U+6668,U+6682,U+66f9,U+66fc,U+66ff,U+6717,U+6740,U+676d,U+67aa,U+67ec,U+67f1,U+6842,U+6851,U+695a,U+6982,U+6a2a,U+6b20,U+6b23,U+6b32,U+6b96,U+6bc5,U+6beb,U+6c60,U+6c9f,U+6cea,U+6cf3,U+6d1e,U+6d53,U+6d66,U+6d69,U+6d8c,U+6d9b,U+6db2,U+6de1,U+6dfb,U+6e14,U+6ed1,U+6eda,U+6ee8,U+6f2b,U+706d,U+7089,U+708e,U+70ad-70ae,U+70e7,U+7126,U+714c,U+71c3,U+71d5,U+7206,U+7259,U+731b,U+73a9,U+73bb,U+74dc,U+7532,U+7545,U+755c,U+75c7,U+7687,U+76d7,U+76f2,U+788d,U+78e8,U+79e6,U+79e9,U+7a3f,U+7a46,U+7a97,U+7af9,U+7bee,U+7c4d,U+7c89,U+7cd6,U+7eb5,U+7ebd,U+7ed8,U+8017,U+8033,U+80c0,U+80de,U+80f6,U+8138,U+817e,U+81a8,U+820d,U+827e,U+82b3,U+82d7,U+83b1,U+84c4,U+84dd,U+8584,U+864e,U+865a,U+866b,U+86cb,U+88d5,U+89e6,U+8bca,U+8bde,U+8bfa,U+8c0a,U+8c37,U+8c46,U+8c6a,U+8c8c,U+8d1d,U+8d29,U+8d4f,U+8d54,U+8d5a,U+8d60,U+8d62,U+8f7f,U+8f96,U+8f9e-8f9f,U+8fc1,U+8fdf,U+8fea,U+8ff7,U+9012,U+906d,U+9075,U+90a6,U+90bb,U+90ca,U+9178,U+9192,U+91ca,U+94bb,U+94dc,U+94fa,U+9501,U+950b,U+9521,U+955c,U+963b,U+9655,U+9675-9676,U+9887,U+9891,U+9971,U+9a97,U+9ece,U+9ed8"}},{uri:YUe,descriptors:{unicodeRange:"U+4e1d,U+4e39,U+4e4c,U+4e4f,U+4e54,U+4e58,U+4e95,U+4ea1,U+4eab,U+4eae,U+4ec1,U+4f10,U+4f19,U+4f30,U+4f34,U+4fb5,U+503e,U+518c,U+5192,U+51a0,U+51ac,U+51b0,U+51e1,U+5211,U+5242,U+52a3,U+52b2,U+52c3,U+52c7,U+52d2,U+52e4,U+5377,U+539a,U+53a6,U+53e5,U+5417,U+5510,U+552f,U+5531,U+574f-5750,U+5761,U+5851,U+5854,U+58ee,U+593a,U+5949,U+5954,U+5a5a,U+5b8b,U+5bbd,U+5c04,U+5c0a,U+5c4b,U+5ce1,U+5cf0,U+5e10,U+5e8a,U+5e9f,U+5ec9,U+5f31,U+5f84,U+5fd8-5fd9,U+5fe0,U+6015,U+6062,U+6069,U+6076,U+6089,U+60a3,U+60ca,U+620f,U+624e,U+6263,U+6298,U+62a2,U+62bd,U+6311,U+6350,U+6389,U+638c,U+63f4,U+6446,U+644a,U+6469,U+64cd,U+654f,U+6562,U+656c,U+65d7,U+65e6,U+65fa,U+660c,U+6653,U+66b4,U+670b,U+672b,U+676f-6770,U+6881,U+6885,U+68a6,U+68cb,U+68ee,U+6b8a,U+6c88-6c89,U+6cc9,U+6ce5,U+6d01,U+6d17,U+6d1b,U+6d59,U+6d6a,U+6da8,U+6df7,U+6e10,U+6e20-6e21,U+6f5c,U+706f,U+70bc,U+719f,U+7267,U+732a,U+73cd,U+7518,U+756a,U+7586,U+7591,U+75db,U+76c8,U+76d0,U+76d6,U+76d8,U+76df,U+76fe,U+77db,U+7801,U+786c,U+795d,U+7965,U+79cb,U+7a77,U+7a7f,U+7aef,U+7b11,U+7bb1,U+7bc7,U+7ea0,U+7eaf,U+7ed5,U+7edc,U+7f13,U+7f29,U+7f34,U+7f8a,U+7ffb,U+8015,U+8058,U+805a,U+8083,U+80af,U+80c6,U+80cc,U+811a,U+8150,U+82e5,U+8336,U+8352,U+83ab,U+8428,U+8463,U+852c,U+8861,U+89c8,U+8bcd,U+8bd7,U+8bda,U+8be2,U+8bef,U+8bf8,U+8c0b,U+8c13,U+8d34,U+8d3a,U+8d74,U+8d76,U+8da3,U+8dd1,U+8ddd,U+8ddf,U+8df3,U+8f68,U+8f6f,U+8f7d,U+8f91,U+8f9b,U+8fbd,U+8fc8,U+8fd4,U+8feb,U+8ff9,U+900f,U+9057,U+907f-9080,U+90d1,U+90ed,U+91ce,U+9519,U+9526,U+95ed,U+9614,U+9635,U+9644,U+9686,U+96c5,U+96ea,U+9707,U+9732,U+9759,U+978b,U+9876,U+9881,U+9910,U+996e,U+9970,U+9c81,U+9e21,U+9ebb,U+9f84"}},{uri:WUe,descriptors:{unicodeRange:"U+4e3d,U+4e4e,U+4e71,U+4e8f,U+4ed8,U+4eea,U+4f0a,U+4f0d,U+4f11,U+4f1f,U+4f24,U+4f3c,U+4f73,U+4fc4,U+500d,U+5012,U+501f,U+503a,U+505c,U+507f,U+50a8,U+514d,U+5178,U+517c,U+51b2,U+51b7,U+520a,U+5238,U+523b,U+52b1,U+535a,U+5371,U+5385,U+53eb-53ec,U+53f3,U+53f6,U+5409,U+542b,U+542f,U+5434,U+5462,U+5473,U+547c,U+54c8,U+54ea,U+56fa,U+5733,U+5757,U+5766,U+5802,U+585e,U+590f,U+591c,U+591f,U+5947,U+594b,U+5987,U+5a01,U+5b59,U+5b63,U+5b88,U+5b97,U+5b9c,U+5bbe,U+5bfb,U+5c01,U+5c1a,U+5c24,U+5c3c,U+5c97,U+5c9b,U+5cb8,U+5de6,U+5e01,U+5e2e,U+5e45,U+5e55,U+5e84,U+5ef6,U+5f02,U+5f52,U+5f69,U+5f7b,U+5f90,U+5fae,U+6000,U+600e,U+6025,U+60e0,U+6276,U+6297,U+62b5,U+62cd,U+62d3,U+62e5,U+62e9,U+62ff,U+6302,U+632f,U+63e1,U+6444,U+64ad,U+653b,U+6551,U+6563,U+65a4,U+65e7,U+6620,U+667a,U+66f2,U+671d,U+6731,U+6742,U+675f,U+6768,U+677e-677f,U+6790,U+67b6,U+67d3,U+6863,U+68b0,U+68c9,U+690d,U+6b8b,U+6bcd,U+6bd2,U+6bd5,U+6c38,U+6c61,U+6cbf,U+6cdb,U+6cf0,U+6d2a,U+6d89,U+6da6,U+6f6e,U+6fb3,U+7075,U+707e,U+70df,U+7164,U+7236,U+725b,U+7389,U+73e0,U+745e,U+74e6,U+751a,U+7537,U+75be,U+76ae,U+76db,U+793c,U+7956,U+7981,U+79d8,U+79df,U+79fb,U+7adf,U+7ae5,U+7b14,U+7b26,U+7b54,U+7b79,U+7d2f,U+7eb8,U+7eba,U+7ec6,U+7ee9,U+7eff,U+7f5a,U+7f6a,U+7f72,U+8089,U+80a5,U+80e1,U+8111,U+8131,U+821e,U+822c,U+8270,U+8499,U+8651,U+867d,U+8840,U+8857,U+8863,U+88c1,U+89c9,U+89d2,U+8a89,U+8bed,U+8bfe,U+8c01,U+8c22,U+8d21,U+8d25,U+8d2f,U+8d5e,U+8d75,U+8d8b,U+8dc3,U+8de8,U+8df5,U+8f6e,U+8f86,U+8f89,U+8fc5,U+8ff0,U+8ffd,U+9014,U+904d,U+90ae,U+9274,U+949f,U+952e,U+969c,U+96c4,U+96e8,U+96f6-96f7,U+97e9,U+987f,U+996d,U+9a7b,U+9aa8,U+9c7c,U+9c9c,U+9e4f,U+9f13,U+9f50"}},{uri:ZUe,descriptors:{unicodeRange:"U+4e13,U+4e16,U+4e1c,U+4e24,U+4e3e,U+4e49,U+4e61,U+4e66,U+4e89,U+4e8c,U+4e94,U+4e9b,U+4ea4,U+4eac,U+4ebf,U+4eca,U+4ef6-4ef7,U+4efb,U+4f18,U+4f20,U+4f46,U+4f7f,U+4fe1,U+503c,U+505a,U+5146,U+5148,U+515a,U+5171,U+5177,U+519b,U+51b3,U+51c6,U+51e0,U+5212,U+521b,U+522b,U+529e,U+52bf,U+534e-534f,U+5355,U+5357,U+5382,U+539f,U+53bb,U+53bf,U+53c2,U+53c8,U+53ca,U+53d6-53d8,U+53e3,U+53ea,U+53f0,U+540d,U+5411,U+56db,U+56de,U+56e0,U+56e2,U+578b,U+57ce,U+57fa,U+589e,U+5904,U+5934,U+5982,U+5b89,U+5b8c,U+5bfc,U+5c06,U+5c11,U+5c40,U+5c71,U+5e38,U+5e72,U+5e76,U+5e7f,U+5e94,U+5e9c,U+5f0f,U+5f15,U+5f20,U+5f3a,U+5f62,U+5f88,U+5fc5,U+5fd7,U+5feb,U+601d,U+6027,U+60c5,U+60f3,U+610f,U+6216,U+6218,U+624b,U+624d,U+6279,U+628a,U+6295,U+6301,U+6307,U+636e,U+63a5,U+63a8,U+652f,U+6536,U+653e,U+6548,U+6559,U+6570,U+65bd,U+65e0,U+6602,U+660e,U+6613,U+66f4,U+6700,U+670d,U+671f,U+672f,U+6743,U+674e,U+6751,U+6761,U+6784,U+6797,U+679c,U+67e5,U+6807,U+6837,U+683c,U+6b21,U+6b63-6b65,U+6bcf,U+6bd4,U+6c42,U+6c5f,U+6ca1,U+6cbb,U+6d3b,U+6d41,U+6d88,U+6df1,U+70b9,U+7136,U+7269,U+7279,U+7531,U+754c,U+767e,U+76ca,U+76f8,U+770b,U+7740,U+7814,U+79ef,U+7a0b,U+7a0e,U+7a76,U+7b80,U+7cbe,U+7cfb,U+7e41,U+7ea7,U+7ec4,U+7ec7,U+7ed3,U+7ed9,U+7edf,U+7f8e,U+8001,U+804c,U+8054,U+80b2,U+81f3,U+8425,U+8868,U+88ab,U+897f,U+89c1-89c2,U+89c4,U+89c6,U+89e3,U+8ba1,U+8ba4,U+8bae,U+8bb0,U+8bba,U+8bc1,U+8c03,U+8d28,U+8d39,U+8def,U+8f66,U+8f6c,U+8fd0-8fd1,U+9020,U+9053,U+90a3,U+90fd,U+91cc,U+9500,U+9547,U+95e8,U+95f4,U+961f,U+9645,U+9662,U+96be,U+96c6,U+9700,U+9769,U+97e6,U+9875,U+9879,U+9886,U+9898,U+98ce,U+9996,U+2b5af,U+2cc56,U+2e9f5,U+30edd-30ede"}},{uri:qUe,descriptors:{unicodeRange:"U+4e03,U+4e30,U+4e34,U+4e45,U+4e60,U+4e70,U+4e88,U+4e91-4e92,U+4ea9,U+4eb2,U+4ec0,U+4ecb,U+4ecd,U+4ee4,U+4fee,U+5019,U+5047,U+50cf,U+5145,U+516d,U+5170,U+5175,U+5199,U+51cf,U+51fb,U+521a,U+5224,U+5267,U+52aa,U+5347-5348,U+534a,U+5356,U+5361,U+536b,U+5370,U+538b,U+53e4,U+53e6,U+5403,U+5426,U+5428,U+542c,U+5438,U+5668,U+56ed,U+56f4,U+56fe,U+57df,U+592a,U+5957,U+5b69,U+5b81,U+5b8f,U+5b98,U+5b9d,U+5ba1,U+5ba4,U+5bb3,U+5bc6,U+5bdf,U+5c3d,U+5c5e,U+5c81,U+5ddd,U+5de8,U+5dee,U+5e0c,U+5e86,U+5e8f,U+5e93,U+5e95,U+5e97,U+5ea7,U+5ead,U+5eb7,U+5f55,U+5f81,U+5f85,U+5ff5,U+6001,U+613f,U+6258,U+6267,U+6269,U+626c,U+627e,U+62db,U+62ec,U+6325,U+635f,U+6362,U+6388,U+6392,U+63a2,U+63a7,U+63aa,U+641e,U+6545,U+6597,U+65e2,U+65e9,U+661f,U+665a,U+666e-666f,U+66fe,U+6728,U+67d0,U+6811,U+6838,U+6865,U+697c,U+6b22,U+6b27,U+6b4c,U+6b62,U+6b66,U+6b7b,U+6bdb,U+6c47,U+6c49,U+6c7d,U+6c99,U+6cfd,U+6d0b,U+6d25,U+6d32,U+6d3e,U+6d4b,U+6e29,U+6e56,U+6e7e,U+6f14,U+6fc0,U+706b,U+70c8,U+7247,U+72af,U+72b6,U+72ec,U+732e,U+73ed,U+7403,U+7533,U+753b,U+7559,U+7565,U+7597,U+767b,U+773c,U+7763,U+77ed,U+77ff,U+7968,U+798f,U+79bb,U+79c0-79c1,U+7ad9,U+7ae0,U+7b51,U+7b7e,U+7cae,U+7d22,U+7ea2,U+7eb3,U+7eb7,U+7ec3,U+7ec8,U+7ecd,U+7edd,U+7efc,U+7f16,U+7f3a,U+7f51,U+7f57,U+7f6e,U+80dc,U+822a,U+8239,U+826f,U+82cf,U+82e6,U+8349,U+8363,U+83dc,U+8457,U+85cf,U+878d,U+8865,U+8a00,U+8b66,U+8ba2,U+8ba8,U+8bad,U+8bb2,U+8bc9,U+8bd5,U+8bfb,U+8d2b,U+8d35,U+8d37,U+8f7b,U+8f93,U+8fce,U+8fdd,U+9000-9002,U+9010,U+9047,U+9093,U+9152,U+9488,U+94a2,U+9633,U+9636,U+963f,U+9646,U+9648,U+964d,U+9664,U+9669,U+9760,U+97f3,U+987a,U+987e,U+9884,U+98de,U+9986,U+9ed1"}},{uri:QUe,descriptors:{unicodeRange:"U+4e14,U+4e25,U+4e48,U+4e50,U+4e5d,U+4e9a,U+4ec5,U+4efd,U+4f17,U+4f4e-4f4f,U+4f55,U+4f59,U+4f60,U+4f8b,U+4f9b,U+4f9d,U+4fbf,U+4fc3,U+5065,U+513f,U+5149,U+514b,U+516b,U+5174,U+517b,U+518d,U+51b5,U+5207,U+5217-5219,U+521d,U+526f,U+529f,U+52a9,U+52b3,U+5305,U+533b,U+5343,U+5360,U+5373-5374,U+5386,U+53cb-53cd,U+53f2,U+53f7,U+544a,U+5468,U+547d,U+54cd,U+552e,U+5584,U+56f0,U+571f,U+5747,U+575a,U+57f9,U+5883,U+58eb,U+58f0,U+5907,U+590d,U+592e,U+5931,U+5956,U+5965,U+5973,U+5979,U+59cb,U+5b57-5b58,U+5b83,U+5ba2-5ba3,U+5bb9,U+5bcc,U+5c42,U+5c45,U+5c4a,U+5dde,U+5df1,U+5df4,U+5e03,U+5e08,U+5e26,U+5e2d,U+5f71,U+5f80,U+5f8b,U+5fb7,U+606f,U+611f,U+6237,U+623f,U+6253,U+627f,U+6293,U+62a4,U+62c5,U+62c9,U+6309,U+6574,U+6599,U+65ad,U+65af,U+65c5,U+65cf,U+6625,U+663e,U+671b,U+672a,U+6750,U+6781,U+6821,U+6839,U+6848,U+68c0,U+6a21,U+6b3e,U+6bb5,U+6c14,U+6cb3,U+6cb9,U+6ce8,U+6e05,U+6e2f,U+6e38,U+6e90,U+6ee1,U+70ed,U+7167,U+7231,U+7248,U+724c,U+7387,U+738b,U+73af,U+7530,U+75c5,U+767d,U+76d1,U+76f4,U+771f,U+77e5,U+77f3,U+7834,U+7840,U+786e,U+793a,U+795e,U+79f0,U+7a33,U+7a7a,U+7a81,U+7ade,U+7b56,U+7b97,U+7c73,U+7c7b,U+7d20,U+7d27,U+7ea6,U+7eaa,U+7ebf,U+7ee7,U+7eed,U+7ef4,U+7fa4,U+8003,U+80a1,U+81f4,U+8272,U+827a,U+8282,U+82b1,U+82f1,U+8303,U+836f,U+83b7,U+843d,U+88c5,U+8ba9,U+8baf,U+8bb8,U+8bbf,U+8bc4,U+8bc6,U+8bdd,U+8be5,U+8bf7,U+8c08,U+8c61,U+8d1f,U+8d22-8d23,U+8d27,U+8d2d,U+8d38,U+8d5b,U+8d70,U+8d85,U+8d8a,U+8db3,U+8eab,U+8f83,U+8fb9,U+8fdc,U+8fde,U+9009,U+901f,U+914d,U+91c7,U+94b1,U+94c1,U+94f6,U+95fb,U+9632,U+9650,U+968f,U+9752,U+975e,U+987b,U+989d,U+98df,U+9999,U+9a6c,U+9a8c,U+9ec4,U+9feb-9fec"}},{uri:JUe,descriptors:{unicodeRange:"U+98fb-990c,U+990e-990f,U+9911-992d,U+992f-9953,U+9956-9962,U+9964,U+9966,U+9973,U+9978-9979,U+997b,U+997e,U+9982-9983,U+9989,U+998c,U+998e,U+999a-99a4,U+99a6-99a7,U+99a9-99c8"}},{uri:e2e,descriptors:{unicodeRange:"U+8e4c-8e50,U+8e53-8e58,U+8e5a-8e65,U+8e67-8e68,U+8e6a-8e6b,U+8e6e,U+8e71,U+8e73,U+8e75,U+8e77-8e7b,U+8e7d-8e7e,U+8e80,U+8e82-8e84,U+8e86,U+8e88-8e8e,U+8e91-8e93,U+8e95-8e9b,U+8e9d,U+8e9f-8eaa,U+8ead-8eae,U+8eb0-8eb1,U+8eb3-8eb9,U+8ebb-8ecd,U+8ecf-8f02"}},{uri:t2e,descriptors:{unicodeRange:"U+2e3a,U+3001-3002,U+3008-3011,U+3014-3017,U+301d-301f,U+4dae,U+4e00,U+4e07,U+4e09-4e0b,U+4e0d-4e0e,U+4e1a,U+4e2a,U+4e2d,U+4e3a-4e3b,U+4e4b,U+4e5f,U+4e86,U+4e8b,U+4e8e,U+4ea7,U+4eba,U+4ece,U+4ed1,U+4ed6,U+4ee3,U+4ee5,U+4eec,U+4f01,U+4f1a,U+4f4d,U+4f53,U+4f5c,U+4fdd,U+5143,U+5165,U+5168,U+516c,U+5173,U+5176,U+5185,U+519c,U+51fa,U+5206,U+5229,U+5230,U+5236,U+524d,U+529b,U+52a0-52a1,U+52a8,U+5316-5317,U+533a,U+5341,U+5362,U+53d1,U+53ef,U+53f8,U+5404,U+5408,U+540c,U+540e,U+5458,U+548c,U+54c1,U+54e5,U+5546,U+559c,U+56fd,U+5728,U+5730,U+573a,U+5916,U+591a,U+5927,U+5929,U+592b,U+597d,U+59d4,U+5b50,U+5b66,U+5b9a,U+5b9e,U+5bb6,U+5bf9,U+5c0f,U+5c14,U+5c31,U+5c55,U+5de5,U+5df2,U+5e02,U+5e73-5e74,U+5ea6,U+5efa,U+5f00,U+5f53,U+5f97,U+5fc3,U+603b,U+6210-6211,U+6240,U+6280,U+62a5,U+63d0,U+6539,U+653f,U+6587,U+65b0,U+65b9,U+65e5,U+65f6,U+662f,U+6708-6709,U+672c,U+673a,U+675c,U+6765,U+6c11,U+6c34,U+6cd5,U+6ce2,U+6d4e,U+6d77,U+73b0,U+7406,U+751f,U+7528,U+7535,U+7684,U+76ee,U+793e,U+79cd,U+79d1,U+7acb,U+7b2c,U+7b49,U+7ba1,U+7ecf,U+8005,U+800c,U+80fd,U+81ea,U+884c,U+8981,U+8bbe,U+8bf4,U+8d44,U+8d77,U+8fbe,U+8fc7,U+8fd8-8fd9,U+8fdb,U+901a,U+90e8,U+91cd,U+91cf,U+91d1,U+9485,U+957f,U+95ee,U+9762,U+9ad8,U+9ea6,U+9f99,U+9fcf,U+9fd4,U+9fed,U+fe10-fe19,U+fe30-fe31,U+fe33-fe44,U+ff01,U+ff0c,U+ff1f,U+2b4e7,U+2b7f7,U+2b7fc,U+2cb2d,U+2cb3b,U+2cb4a,U+2cb5b,U+2cb73"}},{uri:n2e,descriptors:{unicodeRange:"U+6490,U+6493-6494,U+6497-6498,U+649a-649d,U+649f-64a3,U+64a5-64a8,U+64aa-64ab,U+64af,U+64b1-64b4,U+64b6,U+64b9,U+64bb,U+64bd-64bf,U+64c1,U+64c3-64c4,U+64c6-64cc,U+64cf,U+64d1,U+64d3-64d6,U+64d9-64dd,U+64df-64e1,U+64e3,U+64e5,U+64e7-64ff,U+6501-6508,U+650a-6511,U+6513-6517,U+6519-6524,U+6526-652a,U+652c-652d,U+6530-6533,U+6537,U+653a,U+653c-653d,U+6540-6544,U+6546-6547,U+654a-654b,U+654d-654e,U+6550,U+6552-6554,U+6557-6558,U+655a,U+655c,U+655f-6561,U+6564-6565,U+6567-6568"}},{uri:i2e,descriptors:{unicodeRange:"U+9695-9696,U+969a-969b,U+969d-96a6,U+96a8-96af,U+96b1-96b2,U+96b4-96b5,U+96b7-96b8,U+96ba-96bb,U+96bf,U+96c2-96c3,U+96c8,U+96ca-96cb,U+96d0-96d1,U+96d3-96d4,U+96d6-96df,U+96e1-96e7,U+96eb-96ee,U+96f0-96f2,U+96f4-96f5,U+96f8,U+96fa-96fd,U+96ff,U+9702-9703,U+9705,U+970a-970c,U+9710-9712,U+9714-9715,U+9717-971b,U+971d,U+971f-9729,U+972b-972c,U+972e-972f,U+9731,U+9733-9737,U+973a-973d,U+973f-9751,U+9754-9755,U+9757-9758,U+975a,U+975c-975d,U+975f,U+9763-9764,U+9766-9768,U+976a-9770"}},{uri:s2e,descriptors:{unicodeRange:"U+6af0-6b1f,U+6b25-6b26,U+6b28-6b31,U+6b33-6b36,U+6b38,U+6b3b-6b3d,U+6b3f-6b42,U+6b44-6b45,U+6b48,U+6b4a-6b4b,U+6b4d-6b58,U+6b5a-6b61,U+6b68-6b69,U+6b6b-6b78,U+6b7a,U+6b7d-6b80,U+6b85,U+6b88,U+6b8c,U+6b8e-6b91,U+6b94-6b95,U+6b97-6b99,U+6b9c-6ba0,U+6ba2-6ba9,U+6bab-6bb2,U+6bb6,U+6bb8-6bba"}},{uri:r2e,descriptors:{unicodeRange:"U+430e-439a,U+29e8a,U+29ec4,U+29edb,U+29ee9,U+29f7e,U+29f83,U+29f8c,U+29fce,U+2a01a,U+2a02f,U+2a082,U+2a0f9,U+2a190,U+2a38c"}},{uri:o2e,descriptors:{unicodeRange:"U+92ef-933d,U+933f-9369,U+936b-9388"}},{uri:a2e,descriptors:{unicodeRange:"U+4512-458d,U+2b300,U+2b363,U+2b36f,U+2b372,U+2b37d,U+2b404,U+2b410,U+2b413,U+2b461,U+2b4ef,U+2b4f6,U+2b4f9,U+2b50d-2b50e,U+2b536,U+2b5ae,U+2b5b3,U+2b5e7,U+2b5f4,U+2b61c-2b61d,U+2b626-2b628,U+2b62a,U+2b62c,U+2b695-2b696,U+2b6ad,U+2b6ed"}},{uri:l2e,descriptors:{unicodeRange:"U+88bd-88c0,U+88c3-88c4,U+88c7-88c8,U+88ca-88cd,U+88cf-88d1,U+88d3,U+88d6-88d7,U+88da-88de,U+88e0-88e1,U+88e6-88e7,U+88e9-88ef,U+88f2,U+88f5-88f7,U+88fa-88fb,U+88fd,U+88ff-8901,U+8903-8909,U+890b-890f,U+8911,U+8914-8918,U+891c-8920,U+8922-8924,U+8926-8929,U+892c-892f,U+8931-8933,U+8935,U+8937-8940,U+8942-8943,U+8945-895d,U+8960-8965,U+8967-897a,U+897c-897e,U+8980,U+8982,U+8984-8985"}},{uri:jme,descriptors:{unicodeRange:"U+4b0b-4ba0"}},{uri:c2e,descriptors:{unicodeRange:"U+7179,U+717b-717c,U+717e-7183,U+7185-7189,U+718b-718e,U+7190-7193,U+7195-7197,U+719a-719e,U+71a1-71a7,U+71a9-71ab,U+71ad-71b2,U+71b4,U+71b6-71b8,U+71ba-71c2,U+71c4-71cd,U+71cf-71d3,U+71d6-71df,U+71e1-71e4,U+71e6,U+71e8-71ed,U+71ef-71f8,U+71fa-7205,U+7207-721c,U+721e-7227,U+7229,U+722b,U+722d"}},{uri:d2e,descriptors:{unicodeRange:"U+982e-9874,U+988b,U+988e,U+9892,U+9895,U+9899,U+98a3,U+98a8-98cd,U+98cf-98d0,U+98d4,U+98d6-98d7,U+98db-98dd,U+98e0-98e6,U+98e9-98fa"}},{uri:u2e,descriptors:{unicodeRange:"U+7c14-7c15,U+7c17-7c1e,U+7c20-7c25,U+7c28-7c29,U+7c2b-7c37,U+7c39-7c3e,U+7c42-7c4c,U+7c4e-7c72,U+7c75-7c7a,U+7c7e-7c88,U+7c8a-7c90,U+7c93-7c94,U+7c96,U+7c99-7c9b,U+7ca0-7ca1,U+7ca3,U+7ca6-7ca9,U+7cab-7cad,U+7caf-7cb0,U+7cb4-7cb8,U+7cba-7cbb,U+7cbf-7cc0,U+7cc2-7cc4,U+7cc6,U+7cc9,U+7ccb,U+7cce-7cd4"}},{uri:f2e,descriptors:{unicodeRange:"U+7d95-7da5,U+7da7-7dad,U+7daf-7e2a"}},{uri:h2e,descriptors:{unicodeRange:"U+4a78-4b0a"}},{uri:g2e,descriptors:{unicodeRange:"U+9b30-9b31,U+9b33-9b3a,U+9b3d-9b40,U+9b46,U+9b4a-9b4c,U+9b4e,U+9b50,U+9b52-9b53,U+9b55-9bcf"}},{uri:m2e,descriptors:{unicodeRange:"U+6a4b-6a4f,U+6a51-6a57,U+6a5a,U+6a5c-6a60,U+6a62-6a64,U+6a66-6a70,U+6a72-6a78,U+6a7a-6a7b,U+6a7d-6a7f,U+6a81-6a83,U+6a85-6a8d,U+6a8f,U+6a92-6a96,U+6a98-6a9f,U+6aa1-6aa8,U+6aaa,U+6aad-6aef"}},{uri:p2e,descriptors:{unicodeRange:"U+99c9-9a53"}},{uri:U2e,descriptors:{unicodeRange:"U+8550-8555,U+8557-8558,U+855a-855d,U+855f-8563,U+8565-8567,U+8569-8571,U+8573,U+8575-8578,U+857c-857d,U+857f-8583,U+8586,U+8588-858e,U+8590-859a,U+859d-85a3,U+85a5-85a7,U+85a9,U+85ab-85ad,U+85b1-85b6,U+85b8,U+85ba-85c0,U+85c2-85c8,U+85ca-85ce,U+85d1-85d2,U+85d4,U+85d6-85db,U+85dd-85e3,U+85e5-85e8,U+85ea-85fa,U+85fc-85fe,U+8600-8603"}},{uri:b2e,descriptors:{unicodeRange:"U+6fb2,U+6fb4-6fb5,U+6fb7-6fb8,U+6fba-6fbf,U+6fc1,U+6fc3-6fc8,U+6fca-6fd0,U+6fd3-6fdd,U+6fdf,U+6fe2-6fed,U+6ff0-7010,U+7012-7019,U+701c-7022,U+7024-7034,U+7036-7038,U+703a-704b,U+704d-704e,U+7050-7053"}},{uri:y2e,descriptors:{unicodeRange:"U+4ba1-4c2c"}},{uri:E2e,descriptors:{unicodeRange:"U+9a54-9a6b,U+9a72,U+9a83,U+9a89,U+9a8d-9a8e,U+9a94-9a95,U+9a99,U+9aa6,U+9aa9-9aaf,U+9ab2-9ab5,U+9ab9,U+9abb,U+9abd-9abf,U+9ac3-9ac4,U+9ac6-9aca,U+9acd-9ad0,U+9ad2,U+9ad4-9ad7,U+9ad9-9ade,U+9ae0,U+9ae2-9ae5,U+9ae7-9aea,U+9aec,U+9aee,U+9af0-9af8,U+9afa,U+9afc-9b02,U+9b04-9b07,U+9b09-9b0e,U+9b10-9b12,U+9b14-9b1e,U+9b20-9b22,U+9b24-9b2e"}},{uri:v2e,descriptors:{unicodeRange:"U+9d1a-9da1"}},{uri:_2e,descriptors:{unicodeRange:"U+9e13-9e1e,U+9e24,U+9e27,U+9e2e,U+9e30,U+9e34,U+9e3b-9e3c,U+9e40,U+9e4d,U+9e50,U+9e52-9e54,U+9e56,U+9e59,U+9e5d,U+9e5f-9e62,U+9e65,U+9e6e-9e6f,U+9e72,U+9e74-9e7d,U+9e80-9e81,U+9e83-9e86,U+9e89-9e8a,U+9e8c-9e91,U+9e94-9e9c,U+9e9e,U+9ea0-9ea5,U+9ea7-9eb3,U+9eb5-9eb7,U+9eb9-9eba,U+9ebc,U+9ebf-9ec3,U+9ec5-9ec8,U+9eca-9ecc,U+9ed0,U+9ed2-9ed3,U+9ed5-9ed7,U+9ed9-9eda,U+9ede,U+9ee1,U+9ee3-9ee4,U+9ee6,U+9ee8,U+9eeb-9eee,U+9ef0-9ef8"}},{uri:w2e,descriptors:{unicodeRange:"U+8b1c-8b25,U+8b27-8b65,U+8b67-8b6b,U+8b6d-8b9f,U+8bac,U+8bb1,U+8bbb,U+8bc7,U+8bd0"}},{uri:T2e,descriptors:{unicodeRange:"U+4cad-4d2f"}},{uri:I2e,descriptors:{unicodeRange:"U+9c4b-9c7b,U+9c7d-9c7e,U+9c80,U+9c83-9c84,U+9c89-9c8a,U+9c8c,U+9c8f,U+9c93,U+9c96-9c99,U+9c9d,U+9caa,U+9cac,U+9caf,U+9cb9,U+9cbe-9cc2,U+9cc8-9cc9,U+9cd1-9cd2,U+9cda-9cdb,U+9ce0-9ce1,U+9ce3-9d19"}},{uri:S2e,descriptors:{unicodeRange:"U+9389-938e,U+9390-93c9,U+93cb-93d5,U+93d7-9410"}},{uri:KUe,descriptors:{unicodeRange:"U+20a0-20b5,U+20b9-20ba,U+20bc-20bd,U+4e2c,U+5107,U+5216,U+5293,U+54f3,U+5523,U+5819,U+5adc,U+5c88,U+5e3b,U+5fee,U+62f6,U+63be,U+6484,U+6499,U+67d9,U+67dd,U+6d5e,U+6f46,U+717a,U+71e0,U+72c1,U+73e7,U+75b0,U+7603,U+7722,U+7809,U+7811,U+7946,U+7967,U+799a,U+7b45,U+7ba2,U+8014,U+80d9,U+8159,U+817d,U+81a3,U+81aa,U+8201,U+833c,U+836e,U+83e5,U+8459,U+84f0,U+8729,U+8753,U+87d3,U+89dc,U+8bf6,U+8c2e,U+8e2c,U+8e9c,U+8e9e,U+8ece,U+8fee,U+9139,U+914f,U+9174,U+9191,U+960c,U+9622,U+9a98,U+9b48,U+9ca6,U+9cb0,U+9da2-9e12,U+9e88,U+9f44,U+9f86"}},{uri:x2e,descriptors:{unicodeRange:"U+9bd0-9c4a"}},{uri:C2e,descriptors:{unicodeRange:"U+4c2d-4cac"}},{uri:A2e,descriptors:{unicodeRange:"U+4d30-4dab"}},{uri:M2e,descriptors:{unicodeRange:"U+9411-943d,U+943f-946a,U+946c-9484"}},{uri:k2e,descriptors:{unicodeRange:"U+9efa,U+9efd,U+9eff-9f0a,U+9f0c,U+9f0f,U+9f11-9f12,U+9f14-9f16,U+9f18,U+9f1a-9f1f,U+9f21,U+9f23-9f2b,U+9f2d-9f2e,U+9f30-9f36,U+9f38,U+9f3a,U+9f3c,U+9f3f-9f43,U+9f45-9f4f,U+9f52-9f7e,U+9f81-9f82,U+9f8d-9f94"}},{uri:R2e,descriptors:{unicodeRange:"U+7e2b-7e3a,U+7e3c-7e40,U+7e42-7e46,U+7e48-7e81,U+7e83-7e9a,U+7e9c-7e9e,U+7eae,U+7eb4,U+7ebb-7ebc,U+7ed6,U+7ee4,U+7eec,U+7ef9,U+7f0a,U+7f10,U+7f1e,U+7f37,U+7f39,U+7f3b"}}],nt=class nt{constructor(t){F(this,"scene");F(this,"getSceneFamilies",()=>nt.getUniqueFamilies(this.scene.getNonDeletedElements()));F(this,"onLoaded",t=>{let n=!0;for(const r of t){const o=`${r.family}-${r.style}-${r.weight}-${r.unicodeRange}`;nt.loadedFontsCache.has(o)||(nt.loadedFontsCache.add(o),n=!1)}if(n)return;let i=!1;const s=this.scene.getNonDeletedElementsMap();for(const r of this.scene.getNonDeletedElements())if(fe(r)){i=!0,sn.delete(r),Rp.clearCache(bt(r));const o=Bn(r,s);o&&sn.delete(o)}i&&this.scene.triggerUpdate()});F(this,"loadSceneFonts",async()=>{const t=this.getSceneFamilies(),n=nt.getCharsPerFamily(this.scene.getNonDeletedElements());return nt.loadFontFaces(t,n)});this.scene=t}static get registered(){return nt._registered?nt._initialized||(nt._registered=new Map([...nt.init().entries(),...nt._registered.entries()])):nt._registered=nt.init(),nt._registered}get registered(){return nt.registered}static async generateFontFaceDeclarations(t){const n=nt.getUniqueFamilies(t),i=nt.getCharsPerFamily(t),s=n.find(l=>MF(l).includes(Gf));if(s){const l=nt.getCharacters(i,s);if(rie(l)){const c=Xf[Gf];i[c]=new Set(l),n.unshift(Xf[Gf])}}const r=nt.fontFacesStylesGenerator(n,i),o=3,a=await new NC(r,o).all();return Array.from(new Set(a))}static async loadFontFaces(t,n){for(const{fontFaces:o,metadata:a}of nt.registered.values())if(!a.local)for(const{fontFace:l}of o)window.document.fonts.has(l)||window.document.fonts.add(l);const i=nt.fontFacesLoader(t,n),s=10;return(await new NC(i,s).all()).flat().filter(Boolean)}static*fontFacesLoader(t,n){for(const[i,s]of t.entries()){const r=bt({fontFamily:s,fontSize:16}),o=nt.getCharacters(n,s);window.document.fonts.check(r,o)||(yield Hc(async()=>{var a;try{const l=await window.document.fonts.load(r,o);return[i,l]}catch(l){console.error(`Failed to load font "${r}" from urls "${(a=nt.registered.get(s))==null?void 0:a.fontFaces.map(c=>c.urls)}"`,l)}}))}}static*fontFacesStylesGenerator(t,n){for(const[i,s]of t.entries()){const{fontFaces:r,metadata:o}=nt.registered.get(s)??{};if(!Array.isArray(r)){console.error(`Couldn't find registered fonts for font-family "${s}"`,nt.registered);continue}if(!(o!=null&&o.local))for(const[a,l]of r.entries())yield Hc(async()=>{try{const c=nt.getCharacters(n,s),d=await l.toCSS(c);return d?[i*1e4+a,d]:void 0}catch(c){console.error(`Couldn't transform font-face to css for family "${l.fontFace.family}"`,c)}})}}static register(t,n,...i){const s=rt[t]??Xf[t];return this.registered.get(s)||this.registered.set(s,{metadata:n,fontFaces:i.map(({uri:o,descriptors:a})=>new bv(t,o,a))}),this.registered}static init(){const t={registered:new Map},n=(i,...s)=>{const r=rt[i]??Xf[i],o=Fh[r]??Fh[rt.Excalifont];nt.register.call(t,i,o,...s)};return n("Cascadia",...ome),n("Comic Shanns",...ume),n("Excalifont",...Ime),n("Helvetica",...Sme),n("Liberation Sans",...Cme),n("Lilita One",...kme),n("Nunito",...Ome),n("Virgil",...Bme),n(Gf,...L2e),n(m0,...fme),nt._initialized=!0,t.registered}static getUniqueFamilies(t){return Array.from(t.reduce((n,i)=>(fe(i)&&n.add(i.fontFamily),n),new Set))}static getCharsPerFamily(t){const n={};for(const i of t)if(fe(i))for(const s of i.originalText)n[i.fontFamily]||(n[i.fontFamily]=new Set),n[i.fontFamily].add(s);return n}static getCharacters(t,n){return t[n]?Array.from(t[n]).join(""):""}static getAllFamilies(){return Array.from(nt.registered.keys())}};F(nt,"loadedFontsCache",new Set),F(nt,"_registered"),F(nt,"_initialized",!1),F(nt,"loadElementsFonts",async t=>{const n=nt.getUniqueFamilies(t),i=nt.getCharsPerFamily(t);return nt.loadFontFaces(n,i)});let rl=nt;const Z$=de.forwardRef(({className:e,placeholder:t,onChange:n},i)=>N("div",{className:le("QuickSearch__wrapper",e),children:[wu,g("input",{ref:i,className:"QuickSearch__input",type:"text",placeholder:t,onChange:s=>n(s.target.value.trim().toLowerCase())})]})),q$=({className:e,placeholder:t,children:n})=>{const i=!L.Children.count(n);return g("div",{className:le("ScrollableList__wrapper",e),role:"menu",children:i?g("div",{className:"empty",children:t}):n})},H6=({children:e,className:t="",style:n,title:i})=>N("div",{className:`dropdown-menu-group ${t}`,style:n,children:[i&&g("p",{className:"dropdown-menu-group-title",children:i}),e]});H6.displayName="DropdownMenuGroup";const Q$=({children:e,...t})=>g("span",{...t,style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",...t.style},children:e}),J$=({textStyle:e,icon:t,shortcut:n,children:i})=>{const s=Hn();return N(he,{children:[t&&g("div",{className:"dropdown-menu-item__icon",children:t}),g("div",{style:e,className:"dropdown-menu-item__text",children:g(Q$,{children:i})}),n&&s.formFactor!=="phone"&&g("div",{className:"dropdown-menu-item__shortcut",children:n})]})},eG=de.createContext({}),tG=(e="",t=!1,n=!1)=>`dropdown-menu-item dropdown-menu-item-base ${e}
  ${t?"dropdown-menu-item--selected":""} ${n?"dropdown-menu-item--hovered":""}`.trim(),nG=(e,t)=>{const n=L.useContext(eG);return Z5(e,i=>{var r;const s=new CustomEvent(te.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});t==null||t(s),s.defaultPrevented||(r=n.onSelect)==null||r.call(n,s)})},Os=({icon:e,value:t,order:n,children:i,shortcut:s,className:r,hovered:o,selected:a,textStyle:l,onSelect:c,onClick:d,...u})=>{const f=nG(d,c),h=L.useRef(null);return L.useEffect(()=>{var m,p;o&&(n===0?(m=h.current)==null||m.scrollIntoView({block:"end"}):(p=h.current)==null||p.scrollIntoView({block:"nearest"}))},[o,n]),g("button",{...u,ref:h,value:t,onClick:f,className:tG(r,a,o),title:u.title??u["aria-label"],children:g(J$,{textStyle:l,icon:e,shortcut:s,children:i})})};Os.displayName="DropdownMenuItem";const Z1={GREEN:"green",RED:"red",BLUE:"blue"},ET=({type:e=Z1.BLUE,children:t})=>{const{theme:n}=qp(),i={display:"inline-flex",marginLeft:"auto",padding:"2px 4px",borderRadius:6,fontSize:9,fontFamily:"Cascadia, monospace",border:n===Se.LIGHT?"1.5px solid white":"none"};switch(e){case Z1.GREEN:Object.assign(i,{backgroundColor:"var(--background-color-badge)",color:"var(--color-badge)"});break;case Z1.RED:Object.assign(i,{backgroundColor:"pink",color:"darkred"});break;case Z1.BLUE:default:Object.assign(i,{background:"var(--color-promo)",color:"var(--color-surface-lowest)"})}return g("div",{className:"DropDownMenuItemBadge",style:i,children:t})};ET.displayName="DropdownMenuItemBadge";Os.Badge=ET;const D2e=({event:e,inputRef:t,hoveredFont:n,filteredFonts:i,onClose:s,onSelect:r,onHover:o})=>{var a,l,c;if(!e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key.toLowerCase()===$.F)return(a=t.current)==null||a.focus(),!0;if(e.key===$.ESCAPE)return s(),!0;if(e.key===$.ENTER)return n!=null&&n.value&&r(n.value),!0;if(e.key===$.ARROW_DOWN)return n!=null&&n.next?o(n.next.value):(l=i[0])!=null&&l.value&&o(i[0].value),!0;if(e.key===$.ARROW_UP)return n!=null&&n.prev?o(n.prev.value):(c=i[i.length-1])!=null&&c.value&&o(i[i.length-1].value),!0},P2e=e=>{switch(e){case rt.Excalifont:case rt.Virgil:return Hp;case rt.Nunito:case rt.Helvetica:return av;case rt["Lilita One"]:return hfe;case rt["Comic Shanns"]:case rt.Cascadia:return BV;default:return av}},N2e=de.memo(({selectedFontFamily:e,hoveredFontFamily:t,onSelect:n,onHover:i,onLeave:s,onOpen:r,onClose:o})=>{const{container:a}=Fs(),l=So(),{fonts:c}=l,{showDeprecatedFonts:d}=Zp(),u=Ua(),[f,h]=L.useState(""),m=L.useRef(null),p=L.useMemo(()=>Array.from(rl.registered.entries()).filter(([k,{metadata:P}])=>!P.private&&!P.fallback).map(([k,{metadata:P,fontFaces:D}])=>{var G,V;const j={value:k,icon:P2e(k),text:((V=(G=D[0])==null?void 0:G.fontFace)==null?void 0:V.family)??"Unknown"};return P.deprecated&&Object.assign(j,{deprecated:P.deprecated,badge:{type:Z1.RED,placeholder:M("fontList.badge.old")}}),j}).sort((k,P)=>k.text.toLowerCase()>P.text.toLowerCase()?1:-1),[]),U=L.useMemo(()=>new Set(c.getSceneFamilies()),[e]),b=L.useMemo(()=>p.filter(k=>U.has(k.value)),[p,U]),y=L.useMemo(()=>p.filter(k=>!U.has(k.value)&&(d||!k.deprecated)),[p,U,d]),v=L.useMemo(()=>Ate([...b,...y].filter(k=>{var P;return(P=k.text)==null?void 0:P.toLowerCase().includes(f)})),[b,y,f]),_=L.useMemo(()=>{var P;let k;return t?k=v.find(D=>D.value===t):e&&(k=v.find(D=>D.value===e)),!k&&f&&((P=v[0])!=null&&P.value?i(v[0].value):s()),k},[t,e,f,v,i,s]),I=L.useCallback(k=>{let P=null;if(l.state.editingTextElement){const D=document.querySelector(".excalidraw-wysiwyg");D&&(P={start:D.selectionStart,end:D.selectionEnd})}n(k),l.state.editingTextElement&&P&&setTimeout(()=>{const D=document.querySelector(".excalidraw-wysiwyg");D&&P&&(D.focus(),D.selectionStart=P.start,D.selectionEnd=P.end)},0)},[n,l.state.editingTextElement]),R=L.useCallback(k=>{D2e({event:k,inputRef:m,hoveredFont:_,filteredFonts:v,onSelect:I,onHover:i,onClose:o})&&(k.preventDefault(),k.stopPropagation())},[_,v,I,i,o]);L.useEffect(()=>(r(),()=>{o()}),[]);const T=L.useMemo(()=>v.filter(k=>U.has(k.value)),[v,U]),w=L.useMemo(()=>v.filter(k=>!U.has(k.value)),[v,U]),S=(k,P)=>N(Os,{icon:k.icon,value:k.value,order:P,textStyle:{fontFamily:wp({fontFamily:k.value})},hovered:k.value===(_==null?void 0:_.value),selected:k.value===e,tabIndex:k.value===e?0:-1,onClick:D=>{I(Number(D.currentTarget.value))},onMouseMove:()=>{(_==null?void 0:_.value)!==k.value&&i(k.value)},children:[k.text,k.badge&&g(ET,{type:k.badge.type,children:k.badge.placeholder})]},k.value),x=[];return T.length&&x.push(g(H6,{title:M("fontList.sceneFonts"),children:T.map(S)},"group_1")),w.length&&x.push(g(H6,{title:M("fontList.availableFonts"),children:w.map((k,P)=>S(k,P+T.length))},"group_2")),N(Pg,{className:"properties-content",container:a,style:{width:"15rem"},onClose:()=>{o(),l.state.editingTextElement&&setTimeout(()=>{const k=document.querySelector(".excalidraw-wysiwyg");k&&k.focus()},0)},onPointerLeave:s,onKeyDown:R,preventAutoFocusOnTouch:!!l.state.editingTextElement,children:[u==="full"&&g(Z$,{ref:m,placeholder:M("quickSearch.placeholder"),onChange:ul(h,20)}),g(q$,{className:"dropdown-menu fonts manual-hover",placeholder:M("fontList.empty"),children:x.length?x:null})]})},(e,t)=>e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),O2e=({selectedFontFamily:e,isOpened:t=!1,compactMode:n=!1})=>{const i=kn(),s=n?{...vp,width:"2rem",height:"2rem"}:{};return g(Ml,{asChild:!0,children:g("div",{"data-openpopup":"fontFamily",className:"properties-trigger",children:g(eT,{standalone:!0,icon:Eh,title:M("labels.showFonts"),className:"properties-trigger",testId:"font-family-show-fonts",active:t,onClick:()=>{i(r=>({openPopup:r.openPopup==="fontFamily"?null:r.openPopup}))},style:{border:"none",...s}})})})},iG=[{value:rt.Excalifont,icon:Hp,text:M("labels.handDrawn"),testId:"font-family-hand-drawn"},{value:rt.Nunito,icon:av,text:M("labels.normal"),testId:"font-family-normal"},{value:rt["Comic Shanns"],icon:BV,text:M("labels.code"),testId:"font-family-code"}];new Set(iG.map(e=>e.value));const F2e=de.memo(({isOpened:e,selectedFontFamily:t,hoveredFontFamily:n,onSelect:i,onHover:s,onLeave:r,onPopupChange:o,compactMode:a=!1})=>{const l=L.useMemo(()=>iG,[]),c=L.useCallback(d=>{d&&i(d)},[i]);return N("div",{role:"dialog","aria-modal":"true",className:le("FontPicker__container",{"FontPicker__container--compact":a}),children:[!a&&g("div",{className:"buttonList",children:g(ma,{type:"button",options:l,value:t,onClick:c})}),!a&&g(j$,{}),N(Al,{open:e,onOpenChange:o,children:[g(O2e,{selectedFontFamily:t,isOpened:e,compactMode:a}),e&&g(N2e,{selectedFontFamily:t,hoveredFontFamily:n,onSelect:c,onHover:s,onLeave:r,onOpen:()=>o(!0),onClose:()=>o(!1)})]})]})},(e,t)=>e.isOpened===t.isOpened&&e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),Ly=({className:e,icon:t,size:n="1em"})=>g("span",{className:e,style:{width:n,height:"100%",margin:"0 0.5ex 0 0.5ex",display:"inline-flex",lineHeight:0,verticalAlign:"middle",flex:"0 0 auto"},children:t}),yv=({label:e,open:t,openTrigger:n,children:i,className:s,showCollapsedIcon:r=!0})=>N(he,{children:[N("div",{style:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},className:s,onClick:n,children:[e,r&&g(Ly,{icon:t?jfe:XV})]}),t&&g("div",{style:{display:"flex",flexDirection:"column"},children:i})]}),B2e=Wt(!1);function z2e({options:e,value:t,label:n,onChange:i,onClose:s,numberOfOptionsToAlwaysShow:r=e.length}){const o=Hn(),{container:a}=Fs(),l=p=>{const U=e.find(b=>b.keyBinding===p.key.toLowerCase());if(!(p.metaKey||p.altKey||p.ctrlKey)&&U)i(U.value),p.preventDefault();else if(p.key===$.TAB){const b=e.findIndex(v=>v.value===t),y=p.shiftKey?(e.length+b-1)%e.length:(b+1)%e.length;i(e[y].value)}else if(X1(p.key)){const b=x0().rtl,y=e.findIndex(v=>v.value===t);if(y!==-1){const v=e.length;let _=y;switch(p.key){case(b?$.ARROW_LEFT:$.ARROW_RIGHT):_=(y+1)%v;break;case(b?$.ARROW_RIGHT:$.ARROW_LEFT):_=(v+y-1)%v;break;case $.ARROW_DOWN:{_=(y+(r??1))%v;break}case $.ARROW_UP:{_=(v+y-(r??1))%v;break}}i(e[_].value)}p.preventDefault()}else(p.key===$.ESCAPE||p.key===$.ENTER)&&(p.preventDefault(),s());p.nativeEvent.stopImmediatePropagation(),p.stopPropagation()},[c,d]=gn(B2e),u=de.useMemo(()=>e.slice(0,r),[e,r]),f=de.useMemo(()=>e.slice(r),[e,r]);L.useEffect(()=>{u.some(p=>p.value===t)||d(!0)},[t,u,d]);const h=p=>g("div",{className:"picker-content",children:p.map((U,b)=>N("button",{type:"button",className:le("picker-option",{active:t===U.value}),onClick:y=>{i(U.value)},title:`${U.text} ${U.keyBinding&&` ${U.keyBinding.toUpperCase()}`}`,"aria-label":U.text||"none","aria-keyshortcuts":U.keyBinding||void 0,ref:y=>{t===U.value&&setTimeout(()=>{y==null||y.focus()},0)},children:[U.icon,U.keyBinding&&g("span",{className:"picker-keybinding",children:U.keyBinding})]},U.text))}),m=o.formFactor==="phone";return g(xy,{side:m?"right":"bottom",align:"start",sideOffset:m?8:12,style:{zIndex:"var(--zIndex-ui-styles-popup)"},onKeyDown:l,collisionBoundary:a??void 0,children:N("div",{className:"picker",role:"dialog","aria-modal":"true","aria-label":n,children:[h(u),f.length>0&&g(yv,{label:M("labels.more_options"),open:c,openTrigger:()=>{d(p=>!p)},className:"picker-collapsible",children:h(f)})]})})}function Pk({value:e,label:t,options:n,onChange:i,group:s="",numberOfOptionsToAlwaysShow:r}){var c;const[o,a]=de.useState(!1),l=de.useRef(null);return g("div",{children:N(Al,{open:o,onOpenChange:d=>a(d),children:[g(Ml,{name:s,type:"button","aria-label":t,onClick:()=>a(!o),ref:l,className:o?"active":"",children:(c=n.find(d=>d.value===e))==null?void 0:c.icon}),o&&g(z2e,{options:n,value:e,label:t,onChange:i,onClose:()=>{a(!1)},numberOfOptionsToAlwaysShow:r})]})})}const H2e=({updateData:e,app:t,testId:n})=>{const i=de.useRef(null),s=de.useRef(null),r=t.scene.getSelectedElements(t.state);let o=!0;const a=r.at(0),c=r.reduce((d,u)=>(d!=null&&d!==u.opacity&&(o=!1),d==null||d>u.opacity?u.opacity:d),(a==null?void 0:a.opacity)??null)??t.state.currentItemOpacity;return L.useEffect(()=>{if(i.current&&s.current){const d=i.current,u=s.current,f=d.offsetWidth,h=15,m=c/100*(f-h)+h/2;u.style.left=`${m}px`,d.style.background=`linear-gradient(to right, var(--color-slider-track) 0%, var(--color-slider-track) ${c}%, var(--button-bg) ${c}%, var(--button-bg) 100%)`}},[c]),N("label",{className:"control-label",children:[M("labels.opacity"),N("div",{className:"range-wrapper",children:[g("input",{style:{"--color-slider-track":o?void 0:"var(--button-bg)"},ref:i,type:"range",min:"0",max:"100",step:"10",onChange:d=>{e(+d.target.value)},value:c,className:"range-input","data-testid":n}),g("div",{className:"value-bubble",ref:s,children:c!==0?c:null}),g("div",{className:"zero-label",children:"0"})]})]})},sG=.1,Og=e=>{const t=Sm(e.editorInterface);return{stylesPanelMode:t,isCompact:t!=="full",isMobile:t==="mobile"}},Es=(e,t,n,i=!1)=>{const s=be(Ye(e,t,{includeBoundTextElement:i}));return e.map(r=>{var o;return s.get(r.id)||r.id===((o=t.editingTextElement)==null?void 0:o.id)?n(r):r})},vs=function(e,t,n,i,s){const r=t.state.editingTextElement,o=Yt(e);let a=null;if(r&&(a=n(r)),!a)if(Qn(o,t.state)){const c=t.scene.getSelectedElements(t.state),d=i===!0?c:c.filter(u=>i(u));a=dB(d,n)??(typeof s=="function"?s(!0):s)}else a=typeof s=="function"?s(!1):s;return a},V2e=(e,t,n)=>Nt(t)||!t.autoResize?t:n.mutateElement(t,{x:e.textAlign==="left"?e.x:e.x+(e.width-t.width)/(e.textAlign==="center"?2:1),y:e.y+(e.height-t.height)/2}),vT=(e,t,n,i,s)=>{const r=new Set,o=Es(e,t,a=>{if(fe(a)){const l=i(a);r.add(l);let c=Te(a,{fontSize:l});return ns(c,n.scene.getContainerElement(a),n.scene),c=V2e(a,c,n.scene),c}return a},!0);return Ye(e,t,{includeBoundTextElement:!0}).forEach(a=>{fe(a)&&ps(a,n.scene)}),{elements:o,appState:{...t,currentItemFontSize:r.size===1?[...r][0]:s??t.currentItemFontSize},captureUpdate:q.IMMEDIATELY}};ue({name:"changeStrokeColor",label:"labels.stroke",trackEvent:!1,perform:(e,t,n)=>({...(n==null?void 0:n.currentItemStrokeColor)&&{elements:Es(e,t,i=>w4(i.type)?Te(i,{strokeColor:n.currentItemStrokeColor}):i,!0)},appState:{...t,...n},captureUpdate:n!=null&&n.currentItemStrokeColor?q.IMMEDIATELY:q.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{stylesPanelMode:r}=Og(i);return N(he,{children:[r==="full"&&g("h3",{"aria-hidden":"true",children:M("labels.stroke")}),g(bT,{topPicks:wF,palette:nee,type:"elementStroke",label:M("labels.stroke"),color:vs(e,i,o=>o.strokeColor,!0,o=>o?null:t.currentItemStrokeColor),onChange:o=>n({currentItemStrokeColor:o}),elements:e,appState:t,updateData:n})]})}});ue({name:"changeBackgroundColor",label:"labels.changeBackground",trackEvent:!1,perform:(e,t,n,i)=>{if(!(n!=null&&n.currentItemBackgroundColor))return{appState:{...t,...n},captureUpdate:q.EVENTUALLY};let s;const r=i.scene.getSelectedElements(t);if(!ms(n.currentItemBackgroundColor)&&r.every(a=>nn(a)&&CB(a.points))){const a=be(r);s=e.map(l=>a.has(l.id)&&nn(l)?Te(l,{backgroundColor:n.currentItemBackgroundColor,...aw(l,!0)}):l)}else s=Es(e,t,a=>Te(a,{backgroundColor:n.currentItemBackgroundColor}));return{elements:s,appState:{...t,...n},captureUpdate:q.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{stylesPanelMode:r}=Og(i);return N(he,{children:[r==="full"&&g("h3",{"aria-hidden":"true",children:M("labels.background")}),g(bT,{topPicks:TF,palette:iee,type:"elementBackground",label:M("labels.background"),color:vs(e,i,o=>o.backgroundColor,!0,o=>o?null:t.currentItemBackgroundColor),onChange:o=>n({currentItemBackgroundColor:o}),elements:e,appState:t,updateData:n})]})}});ue({name:"changeFillStyle",label:"labels.fill",trackEvent:!1,perform:(e,t,n,i)=>(it("element","changeFillStyle",`${n} (${i.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),{elements:Es(e,t,s=>Te(s,{fillStyle:n})),appState:{...t,currentItemFillStyle:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Ye(e,t),r=s.length>0&&s.every(o=>o.fillStyle==="zigzag");return N("fieldset",{children:[g("legend",{children:M("labels.fill")}),g("div",{className:"buttonList",children:g(ma,{type:"button",options:[{value:"hachure",text:`${M(r?"labels.zigzag":"labels.hachure")} (${Q("Alt-Click")})`,icon:r?Bue:zue,active:r?!0:void 0,testId:"fill-hachure"},{value:"cross-hatch",text:M("labels.crossHatch"),icon:Hue,testId:"fill-cross-hatch"},{value:"solid",text:M("labels.solid"),icon:Vue,testId:"fill-solid"}],value:vs(e,i,o=>o.fillStyle,o=>o.hasOwnProperty("fillStyle"),o=>o?null:t.currentItemFillStyle),onClick:(o,a)=>{const l=a.altKey&&o==="hachure"&&s.every(c=>c.fillStyle==="hachure")?"zigzag":o;n(l)}})})]})}});ue({name:"changeStrokeWidth",label:"labels.strokeWidth",trackEvent:!1,perform:(e,t,n)=>({elements:Es(e,t,i=>Te(i,{strokeWidth:n})),appState:{...t,currentItemStrokeWidth:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.strokeWidth")}),g("div",{className:"buttonList",children:g(ma,{group:"stroke-width",options:[{value:v8.thin,text:M("labels.thin"),icon:FV,testId:"strokeWidth-thin"},{value:v8.bold,text:M("labels.bold"),icon:$ue,testId:"strokeWidth-bold"},{value:v8.extraBold,text:M("labels.extraBold"),icon:Gue,testId:"strokeWidth-extraBold"}],value:vs(e,i,r=>r.strokeWidth,r=>r.hasOwnProperty("strokeWidth"),r=>r?null:t.currentItemStrokeWidth),onChange:r=>n(r)})})]})});ue({name:"changeSloppiness",label:"labels.sloppiness",trackEvent:!1,perform:(e,t,n)=>({elements:Es(e,t,i=>Te(i,{seed:Hr(),roughness:n})),appState:{...t,currentItemRoughness:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.sloppiness")}),g("div",{className:"buttonList",children:g(ma,{group:"sloppiness",options:[{value:0,text:M("labels.architect"),icon:Yue},{value:1,text:M("labels.artist"),icon:Wue},{value:2,text:M("labels.cartoonist"),icon:Kue}],value:vs(e,i,r=>r.roughness,r=>r.hasOwnProperty("roughness"),r=>r?null:t.currentItemRoughness),onChange:r=>n(r)})})]})});ue({name:"changeStrokeStyle",label:"labels.strokeStyle",trackEvent:!1,perform:(e,t,n)=>({elements:Es(e,t,i=>Te(i,{strokeStyle:n})),appState:{...t,currentItemStrokeStyle:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.strokeStyle")}),g("div",{className:"buttonList",children:g(ma,{group:"strokeStyle",options:[{value:"solid",text:M("labels.strokeStyle_solid"),icon:FV},{value:"dashed",text:M("labels.strokeStyle_dashed"),icon:Xue},{value:"dotted",text:M("labels.strokeStyle_dotted"),icon:jue}],value:vs(e,i,r=>r.strokeStyle,r=>r.hasOwnProperty("strokeStyle"),r=>r?null:t.currentItemStrokeStyle),onChange:r=>n(r)})})]})});ue({name:"changeOpacity",label:"labels.opacity",trackEvent:!1,perform:(e,t,n)=>({elements:Es(e,t,i=>Te(i,{opacity:n}),!0),appState:{...t,currentItemOpacity:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({app:e,updateData:t})=>g(H2e,{updateData:t,app:e,testId:"opacity"})});ue({name:"changeFontSize",label:"labels.fontSize",trackEvent:!1,perform:(e,t,n,i)=>vT(e,t,i,()=>(xe(n,"actionChangeFontSize: Expected a font size value"),n),n),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{isCompact:r}=Og(i);return N("fieldset",{children:[g("legend",{children:M("labels.fontSize")}),g("div",{className:"buttonList",children:g(ma,{group:"font-size",options:[{value:16,text:M("labels.small"),icon:cfe,testId:"fontSize-small"},{value:20,text:M("labels.medium"),icon:dfe,testId:"fontSize-medium"},{value:28,text:M("labels.large"),icon:ufe,testId:"fontSize-large"},{value:36,text:M("labels.veryLarge"),icon:ffe,testId:"fontSize-veryLarge"}],value:vs(e,i,o=>{if(fe(o))return o.fontSize;const a=Re(o,i.scene.getNonDeletedElementsMap());return a?a.fontSize:null},o=>fe(o)||Re(o,i.scene.getNonDeletedElementsMap())!==null,o=>o?null:t.currentItemFontSize||Cl),onChange:o=>{ky(()=>n(o),r,!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})]})}});const Nk=ue({name:"decreaseFontSize",label:"labels.decreaseFontSize",icon:vy,trackEvent:!1,perform:(e,t,n,i)=>vT(e,t,i,s=>Math.round(1/(1+sG)*s.fontSize)),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&(e.key===$.CHEVRON_LEFT||e.key===$.COMMA)}),Ok=ue({name:"increaseFontSize",label:"labels.increaseFontSize",icon:vy,trackEvent:!1,perform:(e,t,n,i)=>vT(e,t,i,s=>Math.round(s.fontSize*(1+sG))),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&(e.key===$.CHEVRON_RIGHT||e.key===$.PERIOD)});ue({name:"changeFontFamily",label:"labels.fontFamily",trackEvent:!1,perform:(e,t,n,i)=>{var m;const{cachedElements:s,resetAll:r,resetContainers:o,...a}=n;if(r)return{elements:Es(e,t,U=>{const b=s==null?void 0:s.get(U.id);return b?Te(U,{...b}):U},!0),appState:{...t,...a},captureUpdate:q.NEVER};xe(n,"actionChangeFontFamily: value must be defined");const{currentItemFontFamily:l,currentHoveredFontFamily:c}=n;let d=q.EVENTUALLY,u,f=!1;if(l)u=l,d=q.IMMEDIATELY;else if(c){u=c,d=q.EVENTUALLY;const p=Ye(e,t,{includeBoundTextElement:!0}).filter(U=>fe(U));if(p.length>200)f=!0;else{let U=0,b=0;for(;U<p.length&&b<5e3;){const y=p[U];b+=(y==null?void 0:y.originalText.length)||0,U++}b>5e3&&(f=!0)}}const h={appState:{...t,...a},captureUpdate:d};if(u&&!f){const p=new Map;let U=new Set,b=!1;const y=Array.from(rl.loadedFontsCache.values()),v=(m=Object.entries(rt).find(([R,T])=>T===u))==null?void 0:m[0];c&&v&&y.some(R=>R.startsWith(v))&&(b=!0),Object.assign(h,{elements:Es(e,t,R=>{if(fe(R)&&(R.fontFamily!==u||l)){const T=Te(R,{fontFamily:u,lineHeight:zc(u)}),w=(s==null?void 0:s.get(R.containerId||""))||{},S=i.scene.getContainerElement(R);return o&&S&&w&&i.scene.mutateElement(S,{...w}),b||(U=new Set([...U,...Array.from(T.originalText)])),p.set(T,S),T}return R},!0)});const _=`10px ${wp({fontFamily:u})}`,I=Array.from(U.values()).join();if(b||window.document.fonts.check(_,I))for(const[R,T]of p)ns(R,T,i.scene);else window.document.fonts.load(_,I).then(R=>{for(const[T,w]of p){const S=i.scene.getElement(T.id),x=w?i.scene.getElement(w.id):null;S&&ns(S,x,i.scene)}i.fonts.onLoaded(R)})}return h},PanelComponent:({elements:e,appState:t,app:n,updateData:i})=>{const s=L.useRef(new Map),r=L.useRef(null),[o,a]=L.useState({}),l=L.useRef(!0),{stylesPanelMode:c,isCompact:d}=Og(n),u=L.useMemo(()=>{var h;const f=(m,p)=>vs(m,n,U=>{if(fe(U))return U.fontFamily;const b=Re(U,p);return b?b.fontFamily:null},U=>fe(U)||Re(U,p)!==null,U=>U?null:t.currentItemFontFamily||ad);return o.openPopup==="fontFamily"&&t.openPopup==="fontFamily"?f(Array.from(((h=s.current)==null?void 0:h.values())??[]),s.current):!o.openPopup&&t.openPopup!=="fontFamily"?f(e,n.scene.getNonDeletedElementsMap()):r.current},[o.openPopup,t,e,n]);return L.useEffect(()=>{r.current=u},[u]),L.useEffect(()=>{Object.keys(o).length&&(i(o),a({}))},[o]),L.useEffect(()=>(l.current=!1,()=>{l.current=!0}),[]),N(he,{children:[c==="full"&&g("legend",{children:M("labels.fontFamily")}),g(F2e,{isOpened:t.openPopup==="fontFamily",selectedFontFamily:u,hoveredFontFamily:t.currentHoveredFontFamily,compactMode:c!=="full",onSelect:f=>{ky(()=>{a({openPopup:null,currentHoveredFontFamily:null,currentItemFontFamily:f}),s.current.clear()},d,!!t.editingTextElement)},onHover:f=>{a({currentHoveredFontFamily:f,cachedElements:new Map(s.current),resetContainers:!0})},onLeave:()=>{a({currentHoveredFontFamily:null,cachedElements:new Map(s.current),resetAll:!0})},onPopupChange:f=>{if(f){s.current.clear();const{editingTextElement:h}=t;if((h==null?void 0:h.type)==="text"){const m=n.scene.getElement(h.id);s.current.set(h.id,Te(m||h,{},!0))}else{const m=Ye(e,t,{includeBoundTextElement:!0});for(const p of m)s.current.set(p.id,Te(p,{},!0))}a({...o,openPopup:"fontFamily"})}else{const h={currentHoveredFontFamily:null,cachedElements:new Map(s.current),resetAll:!0};a({...h}),s.current.clear(),d&&t.editingTextElement&&pT(null)}}})]})}});ue({name:"changeTextAlign",label:"Change text alignment",trackEvent:!1,perform:(e,t,n,i)=>({elements:Es(e,t,s=>{if(fe(s)){const r=Te(s,{textAlign:n});return ns(r,i.scene.getContainerElement(s),i.scene),r}return s},!0),appState:{...t,currentItemTextAlign:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const r=i.scene.getNonDeletedElementsMap(),{isCompact:o}=Og(i);return N("fieldset",{children:[g("legend",{children:M("labels.textAlign")}),g("div",{className:"buttonList",children:g(ma,{group:"text-align",options:[{value:"left",text:M("labels.left"),icon:gfe,testId:"align-left"},{value:"center",text:M("labels.center"),icon:mfe,testId:"align-horizontal-center"},{value:"right",text:M("labels.right"),icon:pfe,testId:"align-right"}],value:vs(e,i,a=>{if(fe(a))return a.textAlign;const l=Re(a,r);return l?l.textAlign:null},a=>fe(a)||Re(a,r)!==null,a=>a?null:t.currentItemTextAlign),onChange:a=>{ky(()=>n(a),o,!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})]})}});ue({name:"changeVerticalAlign",label:"Change vertical alignment",trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Es(e,t,s=>{if(fe(s)){const r=Te(s,{verticalAlign:n});return ns(r,i.scene.getContainerElement(s),i.scene),r}return s},!0),appState:{...t},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const{isCompact:r}=Og(i);return g("fieldset",{children:g("div",{className:"buttonList",children:g(ma,{group:"text-align",options:[{value:qs.TOP,text:M("labels.alignTop"),icon:g(Ufe,{theme:t.theme}),testId:"align-top"},{value:qs.MIDDLE,text:M("labels.centerVertically"),icon:g(yfe,{theme:t.theme}),testId:"align-middle"},{value:qs.BOTTOM,text:M("labels.alignBottom"),icon:g(bfe,{theme:t.theme}),testId:"align-bottom"}],value:vs(e,i,o=>{if(fe(o)&&o.containerId)return o.verticalAlign;const a=Re(o,i.scene.getNonDeletedElementsMap());return a?a.verticalAlign:null},o=>fe(o)||Re(o,i.scene.getNonDeletedElementsMap())!==null,o=>o?null:qs.MIDDLE),onChange:o=>{ky(()=>n(o),r,!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})})}});ue({name:"changeRoundness",label:"Change edge roundness",trackEvent:!1,perform:(e,t,n)=>({elements:Es(e,t,i=>ye(i)?i:Te(i,{roundness:n==="round"?{type:$u(i.type)?En.ADAPTIVE_RADIUS:En.PROPORTIONAL_RADIUS}:null})),appState:{...t,currentItemRoundness:n},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:s})=>{const o=iy(Yt(e),t).some(a=>{var l;return((l=a.roundness)==null?void 0:l.type)===En.LEGACY});return N("fieldset",{children:[g("legend",{children:M("labels.edges")}),N("div",{className:"buttonList",children:[g(ma,{group:"edges",options:[{value:"sharp",text:M("labels.sharp"),icon:Zue},{value:"round",text:M("labels.round"),icon:que}],value:vs(e,i,a=>o?null:a.roundness?"round":"sharp",a=>!_e(a)&&a.hasOwnProperty("roundness"),a=>a?null:t.currentItemRoundness),onChange:a=>n(a)}),s("togglePolygon")]})]})}});const Fk=e=>[{value:null,text:M("labels.arrowhead_none"),keyBinding:"q",icon:Que},{value:"arrow",text:M("labels.arrowhead_arrow"),keyBinding:"w",icon:g(ov,{flip:e})},{value:"triangle",text:M("labels.arrowhead_triangle"),icon:g(nfe,{flip:e}),keyBinding:"e"},{value:"triangle_outline",text:M("labels.arrowhead_triangle_outline"),icon:g(ife,{flip:e}),keyBinding:"r"},{value:"circle",text:M("labels.arrowhead_circle"),keyBinding:"a",icon:g(Jue,{flip:e})},{value:"circle_outline",text:M("labels.arrowhead_circle_outline"),keyBinding:"s",icon:g(efe,{flip:e})},{value:"diamond",text:M("labels.arrowhead_diamond"),icon:g(sfe,{flip:e}),keyBinding:"d"},{value:"diamond_outline",text:M("labels.arrowhead_diamond_outline"),icon:g(rfe,{flip:e}),keyBinding:"f"},{value:"bar",text:M("labels.arrowhead_bar"),keyBinding:"z",icon:g(tfe,{flip:e})},{value:"crowfoot_one",text:M("labels.arrowhead_crowfoot_one"),icon:g(afe,{flip:e}),keyBinding:"x"},{value:"crowfoot_many",text:M("labels.arrowhead_crowfoot_many"),icon:g(ofe,{flip:e}),keyBinding:"c"},{value:"crowfoot_one_or_many",text:M("labels.arrowhead_crowfoot_one_or_many"),icon:g(lfe,{flip:e}),keyBinding:"v"}];ue({name:"changeArrowhead",label:"Change arrowheads",trackEvent:!1,perform:(e,t,n)=>(xe(n,"actionChangeArrowhead: value must be defined"),{elements:Es(e,t,i=>{if(Ce(i)){const{position:s,type:r}=n;if(s==="start")return Te(i,{startArrowhead:r});if(s==="end")return Te(i,{endArrowhead:r})}return i}),appState:{...t,[n.position==="start"?"currentItemStartArrowhead":"currentItemEndArrowhead"]:n.type},captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=x0().rtl;return N("fieldset",{children:[g("legend",{children:M("labels.arrowheads")}),N("div",{className:"iconSelectList buttonList",children:[g(Pk,{label:"arrowhead_start",options:Fk(!s),value:vs(e,i,r=>Ce(r)&&E6(r.type)?r.startArrowhead:t.currentItemStartArrowhead,!0,t.currentItemStartArrowhead),onChange:r=>n({position:"start",type:r}),numberOfOptionsToAlwaysShow:4}),g(Pk,{label:"arrowhead_end",group:"arrowheads",options:Fk(!!s),value:vs(e,i,r=>Ce(r)&&E6(r.type)?r.endArrowhead:t.currentItemEndArrowhead,!0,t.currentItemEndArrowhead),onChange:r=>n({position:"end",type:r}),numberOfOptionsToAlwaysShow:4})]})]})}});ue({name:"changeArrowProperties",label:"Change arrow properties",trackEvent:!1,perform:(e,t,n,i)=>!1,PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:s})=>N("div",{className:"selected-shape-actions",children:[s("changeArrowhead"),s("changeArrowType")]})});ue({name:"changeArrowType",label:"Change arrow types",trackEvent:!1,perform:(e,t,n,i)=>{var a;const s=Es(e,t,l=>{if(!_e(l))return l;const c=i.scene.getNonDeletedElementsMap(),d=re.getPointAtIndexGlobalCoordinates(l,0,c),u=re.getPointAtIndexGlobalCoordinates(l,-1,c);let f=Te(l,{x:n===Dn.elbow?d[0]:l.x,y:n===Dn.elbow?d[1]:l.y,roundness:n===Dn.round?{type:En.PROPORTIONAL_RADIUS}:null,elbowed:n===Dn.elbow,angle:n===Dn.elbow?0:l.angle,points:n===Dn.elbow||l.elbowed?[re.pointFromAbsoluteCoords({...l,x:d[0],y:d[1],angle:0},d,c),re.pointFromAbsoluteCoords({...l,x:d[0],y:d[1],angle:0},u,c)]:l.points});if(ye(f)){f.fixedSegments=null;const h=i.scene.getNonDeletedElementsMap();i.dismissLinearEditor();const m=re.getPointAtIndexGlobalCoordinates(f,0,h),p=re.getPointAtIndexGlobalCoordinates(f,-1,h),U=f.startBinding&&h.get(f.startBinding.elementId),b=f.endBinding&&h.get(f.endBinding.elementId),y=U&&f.startBinding?{...f.startBinding,...E4(f,U,"start",h)}:null,v=b&&f.endBinding?{...f.endBinding,...E4(f,b,"end",h)}:null;f={...f,startBinding:y,endBinding:v,...Cg(f,h,{points:[m,p].map(_=>C(_[0]-f.x,_[1]-f.y)),startBinding:y,endBinding:v,fixedSegments:null})}}else{const h=i.scene.getNonDeletedElementsMap();if(f.startBinding){const m=h.get(f.startBinding.elementId);m&&mu(f,m,t.bindMode==="inside"?"inside":"orbit","start",i.scene)}if(f.endBinding){const m=h.get(f.endBinding.elementId);m&&mu(f,m,t.bindMode==="inside"?"inside":"orbit","end",i.scene)}}return f}),r={...t,currentItemArrowType:n},o=(a=t.selectedLinearElement)==null?void 0:a.elementId;if(o){const l=s.find(c=>c.id===o);l&&(r.selectedLinearElement=new re(l,be(e)))}return{elements:s,appState:r,captureUpdate:q.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>N("fieldset",{children:[g("legend",{children:M("labels.arrowtypes")}),g("div",{className:"buttonList",children:g(ma,{group:"arrowtypes",options:[{value:Dn.sharp,text:M("labels.arrowtype_sharp"),icon:qw,testId:"sharp-arrow"},{value:Dn.round,text:M("labels.arrowtype_round"),icon:Jw,testId:"round-arrow"},{value:Dn.elbow,text:M("labels.arrowtype_elbowed"),icon:Qw,testId:"elbow-arrow"}],value:vs(e,i,s=>_e(s)?s.elbowed?Dn.elbow:s.roundness?Dn.round:Dn.sharp:null,s=>_e(s),s=>s?null:t.currentItemArrowType),onChange:s=>n(s)})})]})});const $2e=T_.includes(devicePixelRatio)?devicePixelRatio:1,da=()=>({showWelcomeScreen:!1,theme:Se.LIGHT,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:Un.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:Un.fillStyle,currentItemFontFamily:ad,currentItemFontSize:Cl,currentItemOpacity:Un.opacity,currentItemRoughness:Un.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:Un.strokeColor,currentItemRoundness:"round",currentItemArrowType:Dn.round,currentItemStrokeStyle:Un.strokeStyle,currentItemStrokeWidth:Un.strokeWidth,currentItemTextAlign:Ep,currentHoveredFontFamily:null,cursorButton:"up",activeEmbeddable:null,newElement:null,editingTextElement:null,editingGroupId:null,activeTool:{type:"selection",customType:null,locked:Un.locked,fromSelection:!1,lastActiveTool:null},preferredSelectionTool:{type:"selection",initialized:!1},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:$2e,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:Zb,gridStep:RF,gridModeEnabled:!1,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:null,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},hoveredElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,stats:{open:!1,panels:jf.generalStats|jf.elementProperties},startBoundElement:null,suggestedBinding:null,frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:Ke.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set,isCropping:!1,croppingElementId:null,searchMatches:null,lockedMultiSelections:{},activeLockedId:null,bindMode:"orbit"}),G2e=(e=>e)({showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemArrowType:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},currentHoveredFontFamily:{browser:!1,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},newElement:{browser:!1,export:!1,server:!1},editingTextElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},preferredSelectionTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},gridStep:{browser:!0,export:!0,server:!0},gridModeEnabled:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},hoveredElementIds:{browser:!1,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},stats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBinding:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1},isCropping:{browser:!1,export:!1,server:!1},croppingElementId:{browser:!1,export:!1,server:!1},searchMatches:{browser:!1,export:!1,server:!1},lockedMultiSelections:{browser:!0,export:!0,server:!0},activeLockedId:{browser:!1,export:!1,server:!1},bindMode:{browser:!0,export:!1,server:!1}}),_T=(e,t)=>{const n={};for(const i of Object.keys(e)){const s=G2e[i];if(s!=null&&s[t]){const r=e[i];n[i]=r}}return n},rG=e=>_T(e,"browser"),oG=e=>_T(e,"export"),X2e=e=>_T(e,"server"),Oo=({activeTool:e})=>e.type==="eraser",rg=({activeTool:e})=>e.type==="hand",Om=()=>{const e=document.querySelector(".excalidraw-tooltip");if(e)return e;const t=document.createElement("div");return document.body.appendChild(t),t.classList.add("excalidraw-tooltip"),t},aG=(e,t,n="bottom")=>{const i=e.getBoundingClientRect(),s=window.innerWidth,r=window.innerHeight,o=5;let a=t.left+t.width/2-i.width/2;a<0?a=o:a+i.width>=s&&(a=s-i.width-o);let l;n==="bottom"?(l=t.top+t.height+o,l+i.height>=r&&(l=t.top-i.height-o)):(l=t.top-i.height-o,l<0&&(l=t.top+t.height+o)),Object.assign(e.style,{top:`${l}px`,left:`${a}px`})},j2e=(e,t,n,i)=>{t.classList.add("excalidraw-tooltip--visible"),t.style.minWidth=i?"50ch":"10ch",t.style.maxWidth=i?"50ch":"15ch",t.textContent=n;const s=e.getBoundingClientRect();aG(t,s)},vl=({children:e,label:t,long:n=!1,style:i,disabled:s})=>(L.useEffect(()=>()=>Om().classList.remove("excalidraw-tooltip--visible"),[]),s?null:g("div",{className:"excalidraw-tooltip-wrapper",onPointerEnter:r=>j2e(r.currentTarget,Om(),t,n),onPointerLeave:()=>Om().classList.remove("excalidraw-tooltip--visible"),style:i,children:e})),lG='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',Y2e='<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>',cG='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',W2e=`data:${ve.svg},${encodeURIComponent(`${lG}${cG}</svg>`)}`,K2e=`data:${ve.svg},${encodeURIComponent(`${lG}${Y2e}${cG}</svg>`)}`,Kr=e=>{e&&(e.style.cursor="")},Ft=(e,t)=>{e&&(e.style.cursor=t)};let Ao,Bk;const dG=(e,t)=>{const i=()=>{const s=t===Se.DARK;Ao=document.createElement("canvas"),Ao.theme=t,Ao.height=20,Ao.width=20;const r=Ao.getContext("2d");r.lineWidth=1,r.beginPath(),r.arc(Ao.width/2,Ao.height/2,5,0,2*Math.PI),r.fillStyle=s?Ei.black:Ei.white,r.fill(),r.strokeStyle=s?Ei.white:Ei.black,r.stroke(),Bk=Ao.toDataURL(ve.svg)};(!Ao||Ao.theme!==t)&&i(),Ft(e,`url(${Bk}) ${20/2} ${20/2}, auto`)},Ro=(e,t)=>{if(e)if(t.activeTool.type==="selection")Kr(e);else if(rg(t))e.style.cursor=Rt.GRAB;else if(Oo(t))dG(e,t.theme);else if(t.activeTool.type==="laser"){const n=t.theme===Se.LIGHT?W2e:K2e;e.style.cursor=`url(${n}), auto`}else["image","custom"].includes(t.activeTool.type)?t.activeTool.type!=="image"&&(e.style.cursor=Rt.AUTO):e.style.cursor=Rt.CROSSHAIR},Hd=({viewportX:e,viewportY:t,nextZoom:n},i)=>{const s=e-i.offsetLeft,r=t-i.offsetTop,o=i.zoom.value,a=i.scrollX+(s-s/o),l=i.scrollY+(r-r/o),c=-(s-s/n),d=-(r-r/n);return{scrollX:a+c,scrollY:l+d,zoom:{value:n}}};ue({name:"changeViewBackgroundColor",label:"labels.canvasBackground",trackEvent:!1,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.changeViewBackgroundColor&&!t.viewModeEnabled,perform:(e,t,n)=>({appState:{...t,...n},captureUpdate:n!=null&&n.viewBackgroundColor?q.IMMEDIATELY:q.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i,data:s})=>g(bT,{palette:null,topPicks:IF,label:M("labels.canvasBackground"),type:"canvasBackground",color:t.viewBackgroundColor,onChange:r=>n({viewBackgroundColor:r}),"data-testid":"canvas-background-picker",elements:e,appState:t,updateData:n})});const Fm=ue({name:"clearCanvas",label:"labels.clearCanvas",icon:Yc,trackEvent:{category:"canvas"},predicate:(e,t,n,i)=>{var s;return!!i.props.UIOptions.canvasActions.clearCanvas&&!t.viewModeEnabled&&((s=t.openDialog)==null?void 0:s.name)!=="elementLinkSelector"},perform:(e,t,n,i)=>(i.imageCache.clear(),{elements:e.map(s=>Te(s,{isDeleted:!0})),appState:{...da(),files:{},theme:t.theme,penMode:t.penMode,penDetected:t.penDetected,exportBackground:t.exportBackground,exportEmbedScene:t.exportEmbedScene,gridSize:t.gridSize,gridStep:t.gridStep,gridModeEnabled:t.gridModeEnabled,stats:t.stats,pasteDialog:t.pasteDialog,activeTool:t.activeTool.type==="image"?{...t.activeTool,type:i.state.preferredSelectionTool.type}:t.activeTool},captureUpdate:q.IMMEDIATELY})}),zk=ue({name:"zoomIn",label:"buttons.zoomIn",viewMode:!0,icon:XM,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Hd({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Ka(t.zoom.value+X5)},t),userToFollow:null},captureUpdate:q.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(We,{type:"button",className:"zoom-in-button zoom-button",icon:XM,title:`${M("buttons.zoomIn")}  ${Q("CtrlOrCmd++")}`,"aria-label":M("buttons.zoomIn"),disabled:t.zoom.value>=__,onClick:()=>{e(null)}}),keyTest:e=>(e.code===ot.EQUAL||e.code===ot.NUM_ADD)&&(e[$.CTRL_OR_CMD]||e.shiftKey)}),Hk=ue({name:"zoomOut",label:"buttons.zoomOut",icon:jM,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Hd({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Ka(t.zoom.value-X5)},t),userToFollow:null},captureUpdate:q.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(We,{type:"button",className:"zoom-out-button zoom-button",icon:jM,title:`${M("buttons.zoomOut")}  ${Q("CtrlOrCmd+-")}`,"aria-label":M("buttons.zoomOut"),disabled:t.zoom.value<=v_,onClick:()=>{e(null)}}),keyTest:e=>(e.code===ot.MINUS||e.code===ot.NUM_SUBTRACT)&&(e[$.CTRL_OR_CMD]||e.shiftKey)}),Vk=ue({name:"resetZoom",label:"buttons.resetZoom",icon:_ue,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Hd({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Ka(1)},t),userToFollow:null},captureUpdate:q.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(vl,{label:M("buttons.resetZoom"),style:{height:"100%"},children:N(We,{type:"button",className:"reset-zoom-button zoom-button",title:M("buttons.resetZoom"),"aria-label":M("buttons.resetZoom"),onClick:()=>{e(null)},children:[(t.zoom.value*100).toFixed(0),"%"]})}),keyTest:e=>(e.code===ot.ZERO||e.code===ot.NUM_ZERO)&&(e[$.CTRL_OR_CMD]||e.shiftKey)}),Z2e=(e,t,n=1)=>{const[i,s,r,o]=e,a=r-i,l=t.width/a,c=o-s,d=t.height/c,f=Math.min(l,d)*Ze(n,.1,1);return Math.min(f,1)},uG=({bounds:e,appState:t,canvasOffsets:n,fitToViewport:i=!1,viewportZoomFactor:s=1,minZoom:r=-1/0,maxZoom:o=1/0})=>{s=Ze(s,v_,__);const[a,l,c,d]=e,u=(a+c)/2,f=(l+d)/2,h=(n==null?void 0:n.left)??0,m=(n==null?void 0:n.top)??0,p=(n==null?void 0:n.right)??0,U=(n==null?void 0:n.bottom)??0,b=t.width-h-p,y=t.height-m-U;let v;if(i){const R=c-a,T=d-l;v=Math.min(b/R,y/T)*s}else v=Z2e(e,{width:b,height:y},s);const _=Ka(Ze(qee(v,X5,"floor"),r,o)),I=xV({scenePoint:{x:u,y:f},viewportDimensions:{width:t.width,height:t.height},offsets:n,zoom:{value:_}});return{appState:{...t,scrollX:I.scrollX,scrollY:I.scrollY,zoom:{value:_}},captureUpdate:q.EVENTUALLY}},Dy=({canvasOffsets:e,targetElements:t,appState:n,fitToViewport:i,viewportZoomFactor:s,minZoom:r,maxZoom:o})=>{const a=pt(Yt(t));return uG({canvasOffsets:e,bounds:a,appState:n,fitToViewport:i,viewportZoomFactor:s,minZoom:r,maxZoom:o})};ue({name:"zoomToFitSelectionInViewport",label:"labels.zoomToFitViewport",icon:Zw,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return Dy({targetElements:s.length?s:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===ot.TWO&&e.shiftKey&&!e.altKey&&!e[$.CTRL_OR_CMD]});ue({name:"zoomToFitSelection",label:"helpDialog.zoomToSelection",icon:Zw,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return Dy({targetElements:s.length?s:e,appState:{...t,userToFollow:null},fitToViewport:!0,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===ot.THREE&&e.shiftKey&&!e.altKey&&!e[$.CTRL_OR_CMD]});ue({name:"zoomToFit",label:"helpDialog.zoomToFit",icon:Zw,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>Dy({targetElements:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()}),keyTest:e=>e.code===ot.ONE&&e.shiftKey&&!e.altKey&&!e[$.CTRL_OR_CMD]});const V6=ue({name:"toggleTheme",label:(e,t)=>t.theme===Se.DARK?"buttons.lightMode":"buttons.darkMode",keywords:["toggle","dark","light","mode","theme"],icon:(e,t)=>e.theme===Se.LIGHT?sv:rv,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n)=>({appState:{...t,theme:n||(t.theme===Se.LIGHT?Se.DARK:Se.LIGHT)},captureUpdate:q.EVENTUALLY}),keyTest:e=>e.altKey&&e.shiftKey&&e.code===ot.D,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.toggleTheme});ue({name:"toggleEraserTool",label:"toolBar.eraser",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let s;return Oo(t)?s=qt(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):s=qt(t,{type:"eraser",lastActiveToolBeforeEraser:t.activeTool}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:q.IMMEDIATELY}},keyTest:e=>e.key===$.E});ue({name:"toggleLassoTool",label:"toolBar.lasso",icon:Nm,trackEvent:{category:"toolbar"},predicate:(e,t,n,i)=>i.state.preferredSelectionTool.type!=="lasso",perform:(e,t,n,i)=>{let s;return t.activeTool.type!=="lasso"?(s=qt(t,{type:"lasso",fromSelection:!1}),Ft(i.interactiveCanvas,Rt.CROSSHAIR)):s=qt(t,{type:"selection"}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:q.NEVER}}});const q2e=ue({name:"toggleHandTool",label:"toolBar.hand",trackEvent:{category:"toolbar"},icon:HV,viewMode:!1,perform:(e,t,n,i)=>{let s;return rg(t)?s=qt(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):(s=qt(t,{type:"hand",lastActiveToolBeforeEraser:t.activeTool}),Ft(i.interactiveCanvas,Rt.GRAB)),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:q.IMMEDIATELY}},keyTest:e=>!e.altKey&&!e[$.CTRL_OR_CMD]&&e.key===$.H});ue({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},target:"Tool",label:"toolBar.embeddable",perform:(e,t,n,i)=>{const s=qt(t,{type:"embeddable"});return Ro(i.canvas,{...t,activeTool:s}),{elements:e,appState:{...t,activeTool:qt(t,{type:"embeddable"})},captureUpdate:q.EVENTUALLY}}});const Vs=ue({name:"finalize",label:"",trackEvent:!1,perform:(e,t,n,i)=>{var f,h,m;let s=e;const{interactiveCanvas:r,focusContainer:o,scene:a}=i,l=a.getNonDeletedElementsMap();if(n&&t.selectedLinearElement){const{event:p,sceneCoords:U}=n,b=re.getElement(t.selectedLinearElement.elementId,l);xe(b,"Arrow element should exist if selectedLinearElement is set"),xe(U,"sceneCoords should be defined if actionFinalize is called with event");const y=re.handlePointerUp(p,t.selectedLinearElement,t,i.scene);if(dn(b)){const v=!!t.newElement,I=(v||!t.selectedLinearElement.selectedPointsIndices?[b.points.length-1]:t.selectedLinearElement.selectedPointsIndices).reduce((R,T)=>(R.set(T,{point:re.pointFromAbsoluteCoords(b,C(U.x,U.y),l)}),R),new Map)??new Map;ty(b,I,a,t,{newArrow:v,altKey:p.altKey,angleLocked:ic(p)})}else nn(b)&&(f=t.selectedLinearElement)!=null&&f.isEditing&&!t.newElement&&!b4(b.points)&&a.mutateElement(b,{polygon:!1});if(y!==t.selectedLinearElement){b&&nl(b)&&(s=s.map(_=>_.id===b.id?Te(_,{isDeleted:!0}):_));const v=(h=t.activeTool)==null?void 0:h.locked;return{elements:b.points.length<2||nl(b)?e.map(_=>_.id===b.id?Te(_,{isDeleted:!0}):_):s,appState:{...t,cursorButton:"up",selectedLinearElement:v?null:{...y,selectedPointsIndices:null,isEditing:!1,initialState:{...y.initialState,lastClickedPoint:-1}},selectionElement:null,suggestedBinding:null,newElement:null,multiElement:null},captureUpdate:q.IMMEDIATELY}}}window.document.activeElement instanceof HTMLElement&&o();let c=null;if(t.multiElement)c=t.multiElement;else if(((m=t.newElement)==null?void 0:m.type)==="freedraw"||dn(t.newElement))c=t.newElement;else if(Object.keys(t.selectedElementIds).length===1){const p=l.get(Object.keys(t.selectedElementIds)[0]);p&&(c=p)}if(c){if(t.selectedLinearElement&&t.multiElement&&c.type!=="freedraw"&&t.lastPointerDownWith!=="touch"){const{points:p}=c,{lastCommittedPoint:U}=t.selectedLinearElement;(!U||p[p.length-1]!==U)&&a.mutateElement(c,{points:c.points.slice(0,-1)})}if(c&&nl(c)&&(s=s.map(p=>p.id===(c==null?void 0:c.id)?Te(p,{isDeleted:!0}):p)),Ce(c)||ts(c)){if(sa(c.points,t.zoom.value)&&(nn(c)||ts(c))){const U=c.points,b=U[0],y=U.map((v,_)=>_===U.length-1?C(b[0],b[1]):v);nn(c)?a.mutateElement(c,{points:y,polygon:!0}):a.mutateElement(c,{points:y})}nn(c)&&!b4(c.points)&&a.mutateElement(c,{polygon:!1})}}(!t.activeTool.locked&&t.activeTool.type!=="freedraw"||!c)&&Kr(r);let d;t.activeTool.type==="eraser"?d=qt(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):d=qt(t,{type:i.state.preferredSelectionTool.type});let u=c&&Ce(c)?new re(c,be(s)):t.selectedLinearElement;return u=u&&{...u,isEditing:t.newElement?!1:u.isEditing,initialState:{...u.initialState,lastClickedPoint:-1,origin:null}},{elements:s,appState:{...t,cursorButton:"up",activeTool:(t.activeTool.locked||t.activeTool.type==="freedraw")&&c?t.activeTool:d,activeEmbeddable:null,newElement:null,selectionElement:null,multiElement:null,editingTextElement:null,startBoundElement:null,suggestedBinding:null,selectedElementIds:c&&!t.activeTool.locked&&t.activeTool.type!=="freedraw"?{...t.selectedElementIds,[c.id]:!0}:t.selectedElementIds,selectedLinearElement:u},captureUpdate:q.IMMEDIATELY}},keyTest:(e,t)=>{var n;return e.key===$.ESCAPE&&(((n=t.selectedLinearElement)==null?void 0:n.isEditing)||!t.newElement&&t.multiElement===null)||(e.key===$.ESCAPE||e.key===$.ENTER)&&t.multiElement!==null},PanelComponent:({appState:e,updateData:t,data:n})=>g(We,{type:"button",icon:Mue,title:M("buttons.done"),"aria-label":M("buttons.done"),onClick:t,visible:e.multiElement!=null,size:(n==null?void 0:n.size)||"medium",style:{pointerEvents:"all"}})}),wT=({children:e,checked:t,onChange:n,className:i})=>N("div",{className:le("Checkbox",i,{"is-checked":t}),onClick:s=>{n(!t,s),s.currentTarget.querySelector(".Checkbox-box").focus()},children:[g("button",{type:"button",className:"Checkbox-box",role:"checkbox","aria-checked":t,children:Iue}),g("div",{className:"Checkbox-label",children:e})]}),Q2e=e=>{const t=e.title||(e.value===Se.DARK?M("buttons.lightMode"):M("buttons.darkMode"));return g(We,{type:"icon",icon:e.value===Se.LIGHT?$k.MOON:$k.SUN,title:t,"aria-label":t,onClick:()=>e.onChange(e.value===Se.DARK?Se.LIGHT:Se.DARK),"data-testid":"toggle-dark-mode"})},$k={SUN:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"})}),MOON:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})},J2e=e=>{const{id:t}=Fs(),[n,i]=L.useState(e.value),s=o=>{e.ignoreFocus||xte(o.target);const a=o.target.value;a!==e.value&&e.onChange(a)},r=o=>{if(o.key===$.ENTER){if(o.preventDefault(),o.nativeEvent.isComposing||o.keyCode===229)return;o.currentTarget.blur()}};return N("div",{className:"ProjectName",children:[g("label",{className:"ProjectName-label",htmlFor:"filename",children:`${e.label}:`}),g("input",{type:"text",className:"TextInput",onBlur:s,onKeyDown:r,id:`${t}-filename`,value:n,onChange:o=>i(o.target.value)})]})};/*! pako 2.0.3 https://github.com/nodeca/pako @license (MIT AND Zlib) */const ebe=4,Gk=0,Xk=1,tbe=2;function Fg(e){let t=e.length;for(;--t>=0;)e[t]=0}const nbe=0,fG=1,ibe=2,sbe=3,rbe=258,TT=29,jp=256,L0=jp+1+TT,wh=30,IT=19,hG=2*L0+1,Vd=15,f3=16,obe=7,ST=256,gG=16,mG=17,pG=18,Ev=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ib=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),abe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),UG=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lbe=512,Ra=new Array((L0+2)*2);Fg(Ra);const Bm=new Array(wh*2);Fg(Bm);const D0=new Array(lbe);Fg(D0);const P0=new Array(rbe-sbe+1);Fg(P0);const xT=new Array(TT);Fg(xT);const $6=new Array(wh);Fg($6);function h3(e,t,n,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}let bG,yG,EG;function g3(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const vG=e=>e<256?D0[e]:D0[256+(e>>>7)],N0=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},ks=(e,t,n)=>{e.bi_valid>f3-n?(e.bi_buf|=t<<e.bi_valid&65535,N0(e,e.bi_buf),e.bi_buf=t>>f3-e.bi_valid,e.bi_valid+=n-f3):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Vo=(e,t,n)=>{ks(e,n[t*2],n[t*2+1])},_G=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},cbe=e=>{e.bi_valid===16?(N0(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},dbe=(e,t)=>{const n=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,d,u,f,h,m,p=0;for(f=0;f<=Vd;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<hG;c++)d=e.heap[c],f=n[n[d*2+1]*2+1]+1,f>l&&(f=l,p++),n[d*2+1]=f,!(d>i)&&(e.bl_count[f]++,h=0,d>=a&&(h=o[d-a]),m=n[d*2],e.opt_len+=m*(f+h),r&&(e.static_len+=m*(s[d*2+1]+h)));if(p!==0){do{for(f=l-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,p-=2}while(p>0);for(f=l;f!==0;f--)for(d=e.bl_count[f];d!==0;)u=e.heap[--c],!(u>i)&&(n[u*2+1]!==f&&(e.opt_len+=(f-n[u*2+1])*n[u*2],n[u*2+1]=f),d--)}},wG=(e,t,n)=>{const i=new Array(Vd+1);let s=0,r,o;for(r=1;r<=Vd;r++)i[r]=s=s+n[r-1]<<1;for(o=0;o<=t;o++){let a=e[o*2+1];a!==0&&(e[o*2]=_G(i[a]++,a))}},ube=()=>{let e,t,n,i,s;const r=new Array(Vd+1);for(n=0,i=0;i<TT-1;i++)for(xT[i]=n,e=0;e<1<<Ev[i];e++)P0[n++]=i;for(P0[n-1]=i,s=0,i=0;i<16;i++)for($6[i]=s,e=0;e<1<<ib[i];e++)D0[s++]=i;for(s>>=7;i<wh;i++)for($6[i]=s<<7,e=0;e<1<<ib[i]-7;e++)D0[256+s++]=i;for(t=0;t<=Vd;t++)r[t]=0;for(e=0;e<=143;)Ra[e*2+1]=8,e++,r[8]++;for(;e<=255;)Ra[e*2+1]=9,e++,r[9]++;for(;e<=279;)Ra[e*2+1]=7,e++,r[7]++;for(;e<=287;)Ra[e*2+1]=8,e++,r[8]++;for(wG(Ra,L0+1,r),e=0;e<wh;e++)Bm[e*2+1]=5,Bm[e*2]=_G(e,5);bG=new h3(Ra,Ev,jp+1,L0,Vd),yG=new h3(Bm,ib,0,wh,Vd),EG=new h3(new Array(0),abe,0,IT,obe)},TG=e=>{let t;for(t=0;t<L0;t++)e.dyn_ltree[t*2]=0;for(t=0;t<wh;t++)e.dyn_dtree[t*2]=0;for(t=0;t<IT;t++)e.bl_tree[t*2]=0;e.dyn_ltree[ST*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},IG=e=>{e.bi_valid>8?N0(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},fbe=(e,t,n,i)=>{IG(e),N0(e,n),N0(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},jk=(e,t,n,i)=>{const s=t*2,r=n*2;return e[s]<e[r]||e[s]===e[r]&&i[t]<=i[n]},m3=(e,t,n)=>{const i=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&jk(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!jk(t,i,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=i},Yk=(e,t,n)=>{let i,s,r=0,o,a;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+r*2]<<8|e.pending_buf[e.d_buf+r*2+1],s=e.pending_buf[e.l_buf+r],r++,i===0?Vo(e,s,t):(o=P0[s],Vo(e,o+jp+1,t),a=Ev[o],a!==0&&(s-=xT[o],ks(e,s,a)),i--,o=vG(i),Vo(e,o,n),a=ib[o],a!==0&&(i-=$6[o],ks(e,i,a)));while(r<e.last_lit);Vo(e,ST,t)},vv=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,l=-1,c;for(e.heap_len=0,e.heap_max=hG,o=0;o<r;o++)n[o*2]!==0?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[c*2]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=i[c*2+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)m3(e,n,o);c=r;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],m3(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[c*2]=n[o*2]+n[a*2],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[o*2+1]=n[a*2+1]=c,e.heap[1]=c++,m3(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],dbe(e,t),wG(n,l,e.bl_count)},Wk=(e,t,n)=>{let i,s=-1,r,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),t[(n+1)*2+1]=65535,i=0;i<=n;i++)r=o,o=t[(i+1)*2+1],!(++a<l&&r===o)&&(a<c?e.bl_tree[r*2]+=a:r!==0?(r!==s&&e.bl_tree[r*2]++,e.bl_tree[gG*2]++):a<=10?e.bl_tree[mG*2]++:e.bl_tree[pG*2]++,a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},Kk=(e,t,n)=>{let i,s=-1,r,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[(i+1)*2+1],!(++a<l&&r===o)){if(a<c)do Vo(e,r,e.bl_tree);while(--a!==0);else r!==0?(r!==s&&(Vo(e,r,e.bl_tree),a--),Vo(e,gG,e.bl_tree),ks(e,a-3,2)):a<=10?(Vo(e,mG,e.bl_tree),ks(e,a-3,3)):(Vo(e,pG,e.bl_tree),ks(e,a-11,7));a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}},hbe=e=>{let t;for(Wk(e,e.dyn_ltree,e.l_desc.max_code),Wk(e,e.dyn_dtree,e.d_desc.max_code),vv(e,e.bl_desc),t=IT-1;t>=3&&e.bl_tree[UG[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},gbe=(e,t,n,i)=>{let s;for(ks(e,t-257,5),ks(e,n-1,5),ks(e,i-4,4),s=0;s<i;s++)ks(e,e.bl_tree[UG[s]*2+1],3);Kk(e,e.dyn_ltree,t-1),Kk(e,e.dyn_dtree,n-1)},mbe=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return Gk;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Xk;for(n=32;n<jp;n++)if(e.dyn_ltree[n*2]!==0)return Xk;return Gk};let Zk=!1;const pbe=e=>{Zk||(ube(),Zk=!0),e.l_desc=new g3(e.dyn_ltree,bG),e.d_desc=new g3(e.dyn_dtree,yG),e.bl_desc=new g3(e.bl_tree,EG),e.bi_buf=0,e.bi_valid=0,TG(e)},SG=(e,t,n,i)=>{ks(e,(nbe<<1)+(i?1:0),3),fbe(e,t,n)},Ube=e=>{ks(e,fG<<1,3),Vo(e,ST,Ra),cbe(e)},bbe=(e,t,n,i)=>{let s,r,o=0;e.level>0?(e.strm.data_type===tbe&&(e.strm.data_type=mbe(e)),vv(e,e.l_desc),vv(e,e.d_desc),o=hbe(e),s=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=s&&(s=r)):s=r=n+5,n+4<=s&&t!==-1?SG(e,t,n,i):e.strategy===ebe||r===s?(ks(e,(fG<<1)+(i?1:0),3),Yk(e,Ra,Bm)):(ks(e,(ibe<<1)+(i?1:0),3),gbe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Yk(e,e.dyn_ltree,e.dyn_dtree)),TG(e),i&&IG(e)},ybe=(e,t,n)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(P0[n]+jp+1)*2]++,e.dyn_dtree[vG(t)*2]++),e.last_lit===e.lit_bufsize-1);var Ebe=pbe,vbe=SG,_be=bbe,wbe=ybe,Tbe=Ube,Ibe={_tr_init:Ebe,_tr_stored_block:vbe,_tr_flush_block:_be,_tr_tally:wbe,_tr_align:Tbe};const Sbe=(e,t,n,i)=>{let s=e&65535|0,r=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do s=s+t[i++]|0,r=r+s|0;while(--o);s%=65521,r%=65521}return s|r<<16|0};var O0=Sbe;const xbe=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Cbe=new Uint32Array(xbe()),Abe=(e,t,n,i)=>{const s=Cbe,r=i+n;e^=-1;for(let o=i;o<r;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var gi=Abe,Su={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Py={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Mbe,_tr_stored_block:kbe,_tr_flush_block:Rbe,_tr_tally:xc,_tr_align:Lbe}=Ibe,{Z_NO_FLUSH:Ku,Z_PARTIAL_FLUSH:Dbe,Z_FULL_FLUSH:Pbe,Z_FINISH:Cc,Z_BLOCK:qk,Z_OK:$o,Z_STREAM_END:Qk,Z_STREAM_ERROR:Nr,Z_DATA_ERROR:Nbe,Z_BUF_ERROR:p3,Z_DEFAULT_COMPRESSION:Obe,Z_FILTERED:Fbe,Z_HUFFMAN_ONLY:o2,Z_RLE:Bbe,Z_FIXED:zbe,Z_DEFAULT_STRATEGY:Hbe,Z_UNKNOWN:Vbe,Z_DEFLATED:Ny}=Py,$be=9,Gbe=15,Xbe=8,jbe=29,Ybe=256,_v=Ybe+1+jbe,Wbe=30,Kbe=19,Zbe=2*_v+1,qbe=15,ut=3,uc=258,go=uc+ut+1,Qbe=32,Oy=42,wv=69,sb=73,rb=91,ob=103,$d=113,q1=666,oi=1,Yp=2,xu=3,Bg=4,Jbe=3,fc=(e,t)=>(e.msg=Su[t],t),Jk=e=>(e<<1)-(e>4?9:0),rc=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let e6e=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,Ac=e6e;const Gl=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},Ni=(e,t)=>{Rbe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Gl(e.strm)},xt=(e,t)=>{e.pending_buf[e.pending++]=t},I1=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},t6e=(e,t,n,i)=>{let s=e.avail_in;return s>i&&(s=i),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),e.state.wrap===1?e.adler=O0(e.adler,t,s,n):e.state.wrap===2&&(e.adler=gi(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},xG=(e,t)=>{let n=e.max_chain_length,i=e.strstart,s,r,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-go?e.strstart-(e.w_size-go):0,c=e.window,d=e.w_mask,u=e.prev,f=e.strstart+uc;let h=c[i+o-1],m=c[i+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(s=t,!(c[s+o]!==m||c[s+o-1]!==h||c[s]!==c[i]||c[++s]!==c[i+1])){i+=2,s++;do;while(c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&i<f);if(r=uc-(f-i),i=f-uc,r>o){if(e.match_start=t,o=r,r>=a)break;h=c[i+o-1],m=c[i+o]}}while((t=u[t&d])>l&&--n!==0);return o<=e.lookahead?o:e.lookahead},Cu=e=>{const t=e.w_size;let n,i,s,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-go)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do s=e.head[--n],e.head[n]=s>=t?s-t:0;while(--i);i=t,n=i;do s=e.prev[--n],e.prev[n]=s>=t?s-t:0;while(--i);r+=t}if(e.strm.avail_in===0)break;if(i=t6e(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,e.lookahead+e.insert>=ut)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Ac(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Ac(e,e.ins_h,e.window[o+ut-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<ut)););}while(e.lookahead<go&&e.strm.avail_in!==0)},n6e=(e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Cu(e),e.lookahead===0&&t===Ku)return oi;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,Ni(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-go&&(Ni(e,!1),e.strm.avail_out===0))return oi}return e.insert=0,t===Cc?(Ni(e,!0),e.strm.avail_out===0?xu:Bg):(e.strstart>e.block_start&&(Ni(e,!1),e.strm.avail_out===0),oi)},U3=(e,t)=>{let n,i;for(;;){if(e.lookahead<go){if(Cu(e),e.lookahead<go&&t===Ku)return oi;if(e.lookahead===0)break}if(n=0,e.lookahead>=ut&&(e.ins_h=Ac(e,e.ins_h,e.window[e.strstart+ut-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-go&&(e.match_length=xG(e,n)),e.match_length>=ut)if(i=xc(e,e.strstart-e.match_start,e.match_length-ut),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ut){e.match_length--;do e.strstart++,e.ins_h=Ac(e,e.ins_h,e.window[e.strstart+ut-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ac(e,e.ins_h,e.window[e.strstart+1]);else i=xc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Ni(e,!1),e.strm.avail_out===0))return oi}return e.insert=e.strstart<ut-1?e.strstart:ut-1,t===Cc?(Ni(e,!0),e.strm.avail_out===0?xu:Bg):e.last_lit&&(Ni(e,!1),e.strm.avail_out===0)?oi:Yp},gf=(e,t)=>{let n,i,s;for(;;){if(e.lookahead<go){if(Cu(e),e.lookahead<go&&t===Ku)return oi;if(e.lookahead===0)break}if(n=0,e.lookahead>=ut&&(e.ins_h=Ac(e,e.ins_h,e.window[e.strstart+ut-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ut-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-go&&(e.match_length=xG(e,n),e.match_length<=5&&(e.strategy===Fbe||e.match_length===ut&&e.strstart-e.match_start>4096)&&(e.match_length=ut-1)),e.prev_length>=ut&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-ut,i=xc(e,e.strstart-1-e.prev_match,e.prev_length-ut),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=Ac(e,e.ins_h,e.window[e.strstart+ut-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ut-1,e.strstart++,i&&(Ni(e,!1),e.strm.avail_out===0))return oi}else if(e.match_available){if(i=xc(e,0,e.window[e.strstart-1]),i&&Ni(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return oi}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=xc(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ut-1?e.strstart:ut-1,t===Cc?(Ni(e,!0),e.strm.avail_out===0?xu:Bg):e.last_lit&&(Ni(e,!1),e.strm.avail_out===0)?oi:Yp},i6e=(e,t)=>{let n,i,s,r;const o=e.window;for(;;){if(e.lookahead<=uc){if(Cu(e),e.lookahead<=uc&&t===Ku)return oi;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ut&&e.strstart>0&&(s=e.strstart-1,i=o[s],i===o[++s]&&i===o[++s]&&i===o[++s])){r=e.strstart+uc;do;while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<r);e.match_length=uc-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ut?(n=xc(e,1,e.match_length-ut),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=xc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ni(e,!1),e.strm.avail_out===0))return oi}return e.insert=0,t===Cc?(Ni(e,!0),e.strm.avail_out===0?xu:Bg):e.last_lit&&(Ni(e,!1),e.strm.avail_out===0)?oi:Yp},s6e=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(Cu(e),e.lookahead===0)){if(t===Ku)return oi;break}if(e.match_length=0,n=xc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ni(e,!1),e.strm.avail_out===0))return oi}return e.insert=0,t===Cc?(Ni(e,!0),e.strm.avail_out===0?xu:Bg):e.last_lit&&(Ni(e,!1),e.strm.avail_out===0)?oi:Yp};function Mo(e,t,n,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=s}const Q1=[new Mo(0,0,0,0,n6e),new Mo(4,4,8,4,U3),new Mo(4,5,16,8,U3),new Mo(4,6,32,32,U3),new Mo(4,4,16,16,gf),new Mo(8,16,32,32,gf),new Mo(8,16,128,128,gf),new Mo(8,32,128,256,gf),new Mo(32,128,258,1024,gf),new Mo(32,258,258,4096,gf)],r6e=e=>{e.window_size=2*e.w_size,rc(e.head),e.max_lazy_match=Q1[e.level].max_lazy,e.good_match=Q1[e.level].good_length,e.nice_match=Q1[e.level].nice_length,e.max_chain_length=Q1[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ut-1,e.match_available=0,e.ins_h=0};function o6e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ny,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Zbe*2),this.dyn_dtree=new Uint16Array((2*Wbe+1)*2),this.bl_tree=new Uint16Array((2*Kbe+1)*2),rc(this.dyn_ltree),rc(this.dyn_dtree),rc(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(qbe+1),this.heap=new Uint16Array(2*_v+1),rc(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*_v+1),rc(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const CG=e=>{if(!e||!e.state)return fc(e,Nr);e.total_in=e.total_out=0,e.data_type=Vbe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Oy:$d,e.adler=t.wrap===2?0:1,t.last_flush=Ku,Mbe(t),$o},AG=e=>{const t=CG(e);return t===$o&&r6e(e.state),t},a6e=(e,t)=>!e||!e.state||e.state.wrap!==2?Nr:(e.state.gzhead=t,$o),MG=(e,t,n,i,s,r)=>{if(!e)return Nr;let o=1;if(t===Obe&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>$be||n!==Ny||i<8||i>15||t<0||t>9||r<0||r>zbe)return fc(e,Nr);i===8&&(i=9);const a=new o6e;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+ut-1)/ut),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=r,a.method=n,AG(e)},l6e=(e,t)=>MG(e,t,Ny,Gbe,Xbe,Hbe),c6e=(e,t)=>{let n,i;if(!e||!e.state||t>qk||t<0)return e?fc(e,Nr):Nr;const s=e.state;if(!e.output||!e.input&&e.avail_in!==0||s.status===q1&&t!==Cc)return fc(e,e.avail_out===0?p3:Nr);s.strm=e;const r=s.last_flush;if(s.last_flush=t,s.status===Oy)if(s.wrap===2)e.adler=0,xt(s,31),xt(s,139),xt(s,8),s.gzhead?(xt(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),xt(s,s.gzhead.time&255),xt(s,s.gzhead.time>>8&255),xt(s,s.gzhead.time>>16&255),xt(s,s.gzhead.time>>24&255),xt(s,s.level===9?2:s.strategy>=o2||s.level<2?4:0),xt(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length&&(xt(s,s.gzhead.extra.length&255),xt(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=gi(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=wv):(xt(s,0),xt(s,0),xt(s,0),xt(s,0),xt(s,0),xt(s,s.level===9?2:s.strategy>=o2||s.level<2?4:0),xt(s,Jbe),s.status=$d);else{let o=Ny+(s.w_bits-8<<4)<<8,a=-1;s.strategy>=o2||s.level<2?a=0:s.level<6?a=1:s.level===6?a=2:a=3,o|=a<<6,s.strstart!==0&&(o|=Qbe),o+=31-o%31,s.status=$d,I1(s,o),s.strstart!==0&&(I1(s,e.adler>>>16),I1(s,e.adler&65535)),e.adler=1}if(s.status===wv)if(s.gzhead.extra){for(n=s.pending;s.gzindex<(s.gzhead.extra.length&65535)&&!(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=gi(e.adler,s.pending_buf,s.pending-n,n)),Gl(e),n=s.pending,s.pending===s.pending_buf_size));)xt(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++;s.gzhead.hcrc&&s.pending>n&&(e.adler=gi(e.adler,s.pending_buf,s.pending-n,n)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=sb)}else s.status=sb;if(s.status===sb)if(s.gzhead.name){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=gi(e.adler,s.pending_buf,s.pending-n,n)),Gl(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}s.gzindex<s.gzhead.name.length?i=s.gzhead.name.charCodeAt(s.gzindex++)&255:i=0,xt(s,i)}while(i!==0);s.gzhead.hcrc&&s.pending>n&&(e.adler=gi(e.adler,s.pending_buf,s.pending-n,n)),i===0&&(s.gzindex=0,s.status=rb)}else s.status=rb;if(s.status===rb)if(s.gzhead.comment){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=gi(e.adler,s.pending_buf,s.pending-n,n)),Gl(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}s.gzindex<s.gzhead.comment.length?i=s.gzhead.comment.charCodeAt(s.gzindex++)&255:i=0,xt(s,i)}while(i!==0);s.gzhead.hcrc&&s.pending>n&&(e.adler=gi(e.adler,s.pending_buf,s.pending-n,n)),i===0&&(s.status=ob)}else s.status=ob;if(s.status===ob&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&Gl(e),s.pending+2<=s.pending_buf_size&&(xt(s,e.adler&255),xt(s,e.adler>>8&255),e.adler=0,s.status=$d)):s.status=$d),s.pending!==0){if(Gl(e),e.avail_out===0)return s.last_flush=-1,$o}else if(e.avail_in===0&&Jk(t)<=Jk(r)&&t!==Cc)return fc(e,p3);if(s.status===q1&&e.avail_in!==0)return fc(e,p3);if(e.avail_in!==0||s.lookahead!==0||t!==Ku&&s.status!==q1){let o=s.strategy===o2?s6e(s,t):s.strategy===Bbe?i6e(s,t):Q1[s.level].func(s,t);if((o===xu||o===Bg)&&(s.status=q1),o===oi||o===xu)return e.avail_out===0&&(s.last_flush=-1),$o;if(o===Yp&&(t===Dbe?Lbe(s):t!==qk&&(kbe(s,0,0,!1),t===Pbe&&(rc(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),Gl(e),e.avail_out===0))return s.last_flush=-1,$o}return t!==Cc?$o:s.wrap<=0?Qk:(s.wrap===2?(xt(s,e.adler&255),xt(s,e.adler>>8&255),xt(s,e.adler>>16&255),xt(s,e.adler>>24&255),xt(s,e.total_in&255),xt(s,e.total_in>>8&255),xt(s,e.total_in>>16&255),xt(s,e.total_in>>24&255)):(I1(s,e.adler>>>16),I1(s,e.adler&65535)),Gl(e),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?$o:Qk)},d6e=e=>{if(!e||!e.state)return Nr;const t=e.state.status;return t!==Oy&&t!==wv&&t!==sb&&t!==rb&&t!==ob&&t!==$d&&t!==q1?fc(e,Nr):(e.state=null,t===$d?fc(e,Nbe):$o)},u6e=(e,t)=>{let n=t.length;if(!e||!e.state)return Nr;const i=e.state,s=i.wrap;if(s===2||s===1&&i.status!==Oy||i.lookahead)return Nr;if(s===1&&(e.adler=O0(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){s===0&&(rc(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(t.subarray(n-i.w_size,n),0),t=l,n=i.w_size}const r=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Cu(i);i.lookahead>=ut;){let l=i.strstart,c=i.lookahead-(ut-1);do i.ins_h=Ac(i,i.ins_h,i.window[l+ut-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=ut-1,Cu(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=ut-1,i.match_available=0,e.next_in=o,e.input=a,e.avail_in=r,i.wrap=s,$o};var f6e=l6e,h6e=MG,g6e=AG,m6e=CG,p6e=a6e,U6e=c6e,b6e=d6e,y6e=u6e,E6e="pako deflate (from Nodeca project)",zm={deflateInit:f6e,deflateInit2:h6e,deflateReset:g6e,deflateResetKeep:m6e,deflateSetHeader:p6e,deflate:U6e,deflateEnd:b6e,deflateSetDictionary:y6e,deflateInfo:E6e};const v6e=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var _6e=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)v6e(n,i)&&(e[i]=n[i])}}return e},w6e=e=>{let t=0;for(let i=0,s=e.length;i<s;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,s=0,r=e.length;i<r;i++){let o=e[i];n.set(o,s),s+=o.length}return n},Fy={assign:_6e,flattenChunks:w6e};let kG=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{kG=!1}const F0=new Uint8Array(256);for(let e=0;e<256;e++)F0[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;F0[254]=F0[254]=1;var T6e=e=>{let t,n,i,s,r,o=e.length,a=0;for(s=0;s<o;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),r=0,s=0;r<a;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),s++)),n<128?t[r++]=n:n<2048?(t[r++]=192|n>>>6,t[r++]=128|n&63):n<65536?(t[r++]=224|n>>>12,t[r++]=128|n>>>6&63,t[r++]=128|n&63):(t[r++]=240|n>>>18,t[r++]=128|n>>>12&63,t[r++]=128|n>>>6&63,t[r++]=128|n&63);return t};const I6e=(e,t)=>{if(t<65534&&e.subarray&&kG)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var S6e=(e,t)=>{let n,i;const s=t||e.length,r=new Array(s*2);for(i=0,n=0;n<s;){let o=e[n++];if(o<128){r[i++]=o;continue}let a=F0[o];if(a>4){r[i++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<s;)o=o<<6|e[n++]&63,a--;if(a>1){r[i++]=65533;continue}o<65536?r[i++]=o:(o-=65536,r[i++]=55296|o>>10&1023,r[i++]=56320|o&1023)}return I6e(r,i)},x6e=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+F0[e[n]]>t?n:t},B0={string2buf:T6e,buf2string:S6e,utf8border:x6e};function C6e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var RG=C6e;const LG=Object.prototype.toString,{Z_NO_FLUSH:A6e,Z_SYNC_FLUSH:M6e,Z_FULL_FLUSH:k6e,Z_FINISH:R6e,Z_OK:G6,Z_STREAM_END:L6e,Z_DEFAULT_COMPRESSION:D6e,Z_DEFAULT_STRATEGY:P6e,Z_DEFLATED:N6e}=Py;function By(e){this.options=Fy.assign({level:D6e,method:N6e,chunkSize:16384,windowBits:15,memLevel:8,strategy:P6e},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new RG,this.strm.avail_out=0;let n=zm.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==G6)throw new Error(Su[n]);if(t.header&&zm.deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(typeof t.dictionary=="string"?i=B0.string2buf(t.dictionary):LG.call(t.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(t.dictionary):i=t.dictionary,n=zm.deflateSetDictionary(this.strm,i),n!==G6)throw new Error(Su[n]);this._dict_set=!0}}By.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let s,r;if(this.ended)return!1;for(t===~~t?r=t:r=t===!0?R6e:A6e,typeof e=="string"?n.input=B0.string2buf(e):LG.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(r===M6e||r===k6e)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(s=zm.deflate(n,r),s===L6e)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=zm.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===G6;if(n.avail_out===0){this.onData(n.output);continue}if(r>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};By.prototype.onData=function(e){this.chunks.push(e)};By.prototype.onEnd=function(e){e===G6&&(this.result=Fy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function O6e(e,t){const n=new By(t);if(n.push(e,!0),n.err)throw n.msg||Su[n.err];return n.result}var F6e=O6e,B6e={deflate:F6e};const a2=30,z6e=12;var H6e=function(t,n){let i,s,r,o,a,l,c,d,u,f,h,m,p,U,b,y,v,_,I,R,T,w,S,x;const k=t.state;i=t.next_in,S=t.input,s=i+(t.avail_in-5),r=t.next_out,x=t.output,o=r-(n-t.avail_out),a=r+(t.avail_out-257),l=k.dmax,c=k.wsize,d=k.whave,u=k.wnext,f=k.window,h=k.hold,m=k.bits,p=k.lencode,U=k.distcode,b=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=S[i++]<<m,m+=8,h+=S[i++]<<m,m+=8),v=p[h&b];t:for(;;){if(_=v>>>24,h>>>=_,m-=_,_=v>>>16&255,_===0)x[r++]=v&65535;else if(_&16){I=v&65535,_&=15,_&&(m<_&&(h+=S[i++]<<m,m+=8),I+=h&(1<<_)-1,h>>>=_,m-=_),m<15&&(h+=S[i++]<<m,m+=8,h+=S[i++]<<m,m+=8),v=U[h&y];n:for(;;){if(_=v>>>24,h>>>=_,m-=_,_=v>>>16&255,_&16){if(R=v&65535,_&=15,m<_&&(h+=S[i++]<<m,m+=8,m<_&&(h+=S[i++]<<m,m+=8)),R+=h&(1<<_)-1,R>l){t.msg="invalid distance too far back",k.mode=a2;break e}if(h>>>=_,m-=_,_=r-o,R>_){if(_=R-_,_>d&&k.sane){t.msg="invalid distance too far back",k.mode=a2;break e}if(T=0,w=f,u===0){if(T+=c-_,_<I){I-=_;do x[r++]=f[T++];while(--_);T=r-R,w=x}}else if(u<_){if(T+=c+u-_,_-=u,_<I){I-=_;do x[r++]=f[T++];while(--_);if(T=0,u<I){_=u,I-=_;do x[r++]=f[T++];while(--_);T=r-R,w=x}}}else if(T+=u-_,_<I){I-=_;do x[r++]=f[T++];while(--_);T=r-R,w=x}for(;I>2;)x[r++]=w[T++],x[r++]=w[T++],x[r++]=w[T++],I-=3;I&&(x[r++]=w[T++],I>1&&(x[r++]=w[T++]))}else{T=r-R;do x[r++]=x[T++],x[r++]=x[T++],x[r++]=x[T++],I-=3;while(I>2);I&&(x[r++]=x[T++],I>1&&(x[r++]=x[T++]))}}else if(_&64){t.msg="invalid distance code",k.mode=a2;break e}else{v=U[(v&65535)+(h&(1<<_)-1)];continue n}break}}else if(_&64)if(_&32){k.mode=z6e;break e}else{t.msg="invalid literal/length code",k.mode=a2;break e}else{v=p[(v&65535)+(h&(1<<_)-1)];continue t}break}}while(i<s&&r<a);I=m>>3,i-=I,m-=I<<3,h&=(1<<m)-1,t.next_in=i,t.next_out=r,t.avail_in=i<s?5+(s-i):5-(i-s),t.avail_out=r<a?257+(a-r):257-(r-a),k.hold=h,k.bits=m};const mf=15,eR=852,tR=592,nR=0,b3=1,iR=2,V6e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),$6e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),G6e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),X6e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),j6e=(e,t,n,i,s,r,o,a)=>{const l=a.bits;let c=0,d=0,u=0,f=0,h=0,m=0,p=0,U=0,b=0,y=0,v,_,I,R,T,w=null,S=0,x;const k=new Uint16Array(mf+1),P=new Uint16Array(mf+1);let D=null,j=0,G,V,B;for(c=0;c<=mf;c++)k[c]=0;for(d=0;d<i;d++)k[t[n+d]]++;for(h=l,f=mf;f>=1&&k[f]===0;f--);if(h>f&&(h=f),f===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,a.bits=1,0;for(u=1;u<f&&k[u]===0;u++);for(h<u&&(h=u),U=1,c=1;c<=mf;c++)if(U<<=1,U-=k[c],U<0)return-1;if(U>0&&(e===nR||f!==1))return-1;for(P[1]=0,c=1;c<mf;c++)P[c+1]=P[c]+k[c];for(d=0;d<i;d++)t[n+d]!==0&&(o[P[t[n+d]]++]=d);if(e===nR?(w=D=o,x=19):e===b3?(w=V6e,S-=257,D=$6e,j-=257,x=256):(w=G6e,D=X6e,x=-1),y=0,d=0,c=u,T=r,m=h,p=0,I=-1,b=1<<h,R=b-1,e===b3&&b>eR||e===iR&&b>tR)return 1;for(;;){G=c-p,o[d]<x?(V=0,B=o[d]):o[d]>x?(V=D[j+o[d]],B=w[S+o[d]]):(V=96,B=0),v=1<<c-p,_=1<<m,u=_;do _-=v,s[T+(y>>p)+_]=G<<24|V<<16|B|0;while(_!==0);for(v=1<<c-1;y&v;)v>>=1;if(v!==0?(y&=v-1,y+=v):y=0,d++,--k[c]===0){if(c===f)break;c=t[n+o[d]]}if(c>h&&(y&R)!==I){for(p===0&&(p=h),T+=u,m=c-p,U=1<<m;m+p<f&&(U-=k[m+p],!(U<=0));)m++,U<<=1;if(b+=1<<m,e===b3&&b>eR||e===iR&&b>tR)return 1;I=y&R,s[I]=h<<24|m<<16|T-r|0}}return y!==0&&(s[T+y]=c-p<<24|64<<16|0),a.bits=h,0};var Hm=j6e;const Y6e=0,DG=1,PG=2,{Z_FINISH:sR,Z_BLOCK:W6e,Z_TREES:l2,Z_OK:Au,Z_STREAM_END:K6e,Z_NEED_DICT:Z6e,Z_STREAM_ERROR:$r,Z_DATA_ERROR:NG,Z_MEM_ERROR:OG,Z_BUF_ERROR:q6e,Z_DEFLATED:rR}=Py,FG=1,oR=2,aR=3,lR=4,cR=5,dR=6,uR=7,fR=8,hR=9,gR=10,X6=11,xa=12,y3=13,mR=14,E3=15,pR=16,UR=17,bR=18,yR=19,c2=20,d2=21,ER=22,vR=23,_R=24,wR=25,TR=26,v3=27,IR=28,SR=29,an=30,BG=31,Q6e=32,J6e=852,e5e=592,t5e=15,n5e=t5e,xR=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function i5e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const zG=e=>{if(!e||!e.state)return $r;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=FG,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(J6e),t.distcode=t.distdyn=new Int32Array(e5e),t.sane=1,t.back=-1,Au},HG=e=>{if(!e||!e.state)return $r;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,zG(e)},VG=(e,t)=>{let n;if(!e||!e.state)return $r;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?$r:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,HG(e))},$G=(e,t)=>{if(!e)return $r;const n=new i5e;e.state=n,n.window=null;const i=VG(e,t);return i!==Au&&(e.state=null),i},s5e=e=>$G(e,n5e);let CR=!0,_3,w3;const r5e=e=>{if(CR){_3=new Int32Array(512),w3=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Hm(DG,e.lens,0,288,_3,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Hm(PG,e.lens,0,32,w3,0,e.work,{bits:5}),CR=!1}e.lencode=_3,e.lenbits=9,e.distcode=w3,e.distbits=5},GG=(e,t,n,i)=>{let s;const r=e.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(t.subarray(n-r.wsize,n),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>i&&(s=i),r.window.set(t.subarray(n-i,n-i+s),r.wnext),i-=s,i?(r.window.set(t.subarray(n-i,n),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},o5e=(e,t)=>{let n,i,s,r,o,a,l,c,d,u,f,h,m,p,U=0,b,y,v,_,I,R,T,w;const S=new Uint8Array(4);let x,k;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return $r;n=e.state,n.mode===xa&&(n.mode=y3),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,i=e.input,a=e.avail_in,c=n.hold,d=n.bits,u=a,f=l,w=Au;e:for(;;)switch(n.mode){case FG:if(n.wrap===0){n.mode=y3;break}for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(n.wrap&2&&c===35615){n.check=0,S[0]=c&255,S[1]=c>>>8&255,n.check=gi(n.check,S,2,0),c=0,d=0,n.mode=oR;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=an;break}if((c&15)!==rR){e.msg="unknown compression method",n.mode=an;break}if(c>>>=4,d-=4,T=(c&15)+8,n.wbits===0)n.wbits=T;else if(T>n.wbits){e.msg="invalid window size",n.mode=an;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=c&512?gR:xa,c=0,d=0;break;case oR:for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(n.flags=c,(n.flags&255)!==rR){e.msg="unknown compression method",n.mode=an;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=an;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(S[0]=c&255,S[1]=c>>>8&255,n.check=gi(n.check,S,2,0)),c=0,d=0,n.mode=aR;case aR:for(;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.head&&(n.head.time=c),n.flags&512&&(S[0]=c&255,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,n.check=gi(n.check,S,4,0)),c=0,d=0,n.mode=lR;case lR:for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(S[0]=c&255,S[1]=c>>>8&255,n.check=gi(n.check,S,2,0)),c=0,d=0,n.mode=cR;case cR:if(n.flags&1024){for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(S[0]=c&255,S[1]=c>>>8&255,n.check=gi(n.check,S,2,0)),c=0,d=0}else n.head&&(n.head.extra=null);n.mode=dR;case dR:if(n.flags&1024&&(h=n.length,h>a&&(h=a),h&&(n.head&&(T=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(r,r+h),T)),n.flags&512&&(n.check=gi(n.check,i,h,r)),a-=h,r+=h,n.length-=h),n.length))break e;n.length=0,n.mode=uR;case uR:if(n.flags&2048){if(a===0)break e;h=0;do T=i[r+h++],n.head&&T&&n.length<65536&&(n.head.name+=String.fromCharCode(T));while(T&&h<a);if(n.flags&512&&(n.check=gi(n.check,i,h,r)),a-=h,r+=h,T)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=fR;case fR:if(n.flags&4096){if(a===0)break e;h=0;do T=i[r+h++],n.head&&T&&n.length<65536&&(n.head.comment+=String.fromCharCode(T));while(T&&h<a);if(n.flags&512&&(n.check=gi(n.check,i,h,r)),a-=h,r+=h,T)break e}else n.head&&(n.head.comment=null);n.mode=hR;case hR:if(n.flags&512){for(;d<16;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(c!==(n.check&65535)){e.msg="header crc mismatch",n.mode=an;break}c=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=xa;break;case gR:for(;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}e.adler=n.check=xR(c),c=0,d=0,n.mode=X6;case X6:if(n.havedict===0)return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=d,Z6e;e.adler=n.check=1,n.mode=xa;case xa:if(t===W6e||t===l2)break e;case y3:if(n.last){c>>>=d&7,d-=d&7,n.mode=v3;break}for(;d<3;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}switch(n.last=c&1,c>>>=1,d-=1,c&3){case 0:n.mode=mR;break;case 1:if(r5e(n),n.mode=c2,t===l2){c>>>=2,d-=2;break e}break;case 2:n.mode=UR;break;case 3:e.msg="invalid block type",n.mode=an}c>>>=2,d-=2;break;case mR:for(c>>>=d&7,d-=d&7;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=an;break}if(n.length=c&65535,c=0,d=0,n.mode=E3,t===l2)break e;case E3:n.mode=pR;case pR:if(h=n.length,h){if(h>a&&(h=a),h>l&&(h=l),h===0)break e;s.set(i.subarray(r,r+h),o),a-=h,r+=h,l-=h,o+=h,n.length-=h;break}n.mode=xa;break;case UR:for(;d<14;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(n.nlen=(c&31)+257,c>>>=5,d-=5,n.ndist=(c&31)+1,c>>>=5,d-=5,n.ncode=(c&15)+4,c>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=an;break}n.have=0,n.mode=bR;case bR:for(;n.have<n.ncode;){for(;d<3;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.lens[P[n.have++]]=c&7,c>>>=3,d-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,x={bits:n.lenbits},w=Hm(Y6e,n.lens,0,19,n.lencode,0,n.work,x),n.lenbits=x.bits,w){e.msg="invalid code lengths set",n.mode=an;break}n.have=0,n.mode=yR;case yR:for(;n.have<n.nlen+n.ndist;){for(;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,v=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(v<16)c>>>=b,d-=b,n.lens[n.have++]=v;else{if(v===16){for(k=b+2;d<k;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(c>>>=b,d-=b,n.have===0){e.msg="invalid bit length repeat",n.mode=an;break}T=n.lens[n.have-1],h=3+(c&3),c>>>=2,d-=2}else if(v===17){for(k=b+3;d<k;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=b,d-=b,T=0,h=3+(c&7),c>>>=3,d-=3}else{for(k=b+7;d<k;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=b,d-=b,T=0,h=11+(c&127),c>>>=7,d-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=an;break}for(;h--;)n.lens[n.have++]=T}}if(n.mode===an)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=an;break}if(n.lenbits=9,x={bits:n.lenbits},w=Hm(DG,n.lens,0,n.nlen,n.lencode,0,n.work,x),n.lenbits=x.bits,w){e.msg="invalid literal/lengths set",n.mode=an;break}if(n.distbits=6,n.distcode=n.distdyn,x={bits:n.distbits},w=Hm(PG,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,x),n.distbits=x.bits,w){e.msg="invalid distances set",n.mode=an;break}if(n.mode=c2,t===l2)break e;case c2:n.mode=d2;case d2:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=d,H6e(e,f),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,i=e.input,a=e.avail_in,c=n.hold,d=n.bits,n.mode===xa&&(n.back=-1);break}for(n.back=0;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,v=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(y&&!(y&240)){for(_=b,I=y,R=v;U=n.lencode[R+((c&(1<<_+I)-1)>>_)],b=U>>>24,y=U>>>16&255,v=U&65535,!(_+b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=_,d-=_,n.back+=_}if(c>>>=b,d-=b,n.back+=b,n.length=v,y===0){n.mode=TR;break}if(y&32){n.back=-1,n.mode=xa;break}if(y&64){e.msg="invalid literal/length code",n.mode=an;break}n.extra=y&15,n.mode=ER;case ER:if(n.extra){for(k=n.extra;d<k;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=vR;case vR:for(;U=n.distcode[c&(1<<n.distbits)-1],b=U>>>24,y=U>>>16&255,v=U&65535,!(b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(!(y&240)){for(_=b,I=y,R=v;U=n.distcode[R+((c&(1<<_+I)-1)>>_)],b=U>>>24,y=U>>>16&255,v=U&65535,!(_+b<=d);){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}c>>>=_,d-=_,n.back+=_}if(c>>>=b,d-=b,n.back+=b,y&64){e.msg="invalid distance code",n.mode=an;break}n.offset=v,n.extra=y&15,n.mode=_R;case _R:if(n.extra){for(k=n.extra;d<k;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=an;break}n.mode=wR;case wR:if(l===0)break e;if(h=f-l,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=an;break}h>n.wnext?(h-=n.wnext,m=n.wsize-h):m=n.wnext-h,h>n.length&&(h=n.length),p=n.window}else p=s,m=o-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do s[o++]=p[m++];while(--h);n.length===0&&(n.mode=d2);break;case TR:if(l===0)break e;s[o++]=n.length,l--,n.mode=d2;break;case v3:if(n.wrap){for(;d<32;){if(a===0)break e;a--,c|=i[r++]<<d,d+=8}if(f-=l,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?gi(n.check,s,f,o-f):O0(n.check,s,f,o-f)),f=l,(n.flags?c:xR(c))!==n.check){e.msg="incorrect data check",n.mode=an;break}c=0,d=0}n.mode=IR;case IR:if(n.wrap&&n.flags){for(;d<32;){if(a===0)break e;a--,c+=i[r++]<<d,d+=8}if(c!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=an;break}c=0,d=0}n.mode=SR;case SR:w=K6e;break e;case an:w=NG;break e;case BG:return OG;case Q6e:default:return $r}return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=d,(n.wsize||f!==e.avail_out&&n.mode<an&&(n.mode<v3||t!==sR))&&GG(e,e.output,e.next_out,f-e.avail_out),u-=e.avail_in,f-=e.avail_out,e.total_in+=u,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?gi(n.check,s,f,e.next_out-f):O0(n.check,s,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===xa?128:0)+(n.mode===c2||n.mode===E3?256:0),(u===0&&f===0||t===sR)&&w===Au&&(w=q6e),w},a5e=e=>{if(!e||!e.state)return $r;let t=e.state;return t.window&&(t.window=null),e.state=null,Au},l5e=(e,t)=>{if(!e||!e.state)return $r;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,Au):$r},c5e=(e,t)=>{const n=t.length;let i,s,r;return!e||!e.state||(i=e.state,i.wrap!==0&&i.mode!==X6)?$r:i.mode===X6&&(s=1,s=O0(s,t,n,0),s!==i.check)?NG:(r=GG(e,t,n,n),r?(i.mode=BG,OG):(i.havedict=1,Au))};var d5e=HG,u5e=VG,f5e=zG,h5e=s5e,g5e=$G,m5e=o5e,p5e=a5e,U5e=l5e,b5e=c5e,y5e="pako inflate (from Nodeca project)",La={inflateReset:d5e,inflateReset2:u5e,inflateResetKeep:f5e,inflateInit:h5e,inflateInit2:g5e,inflate:m5e,inflateEnd:p5e,inflateGetHeader:U5e,inflateSetDictionary:b5e,inflateInfo:y5e};function E5e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var v5e=E5e;const XG=Object.prototype.toString,{Z_NO_FLUSH:_5e,Z_FINISH:w5e,Z_OK:z0,Z_STREAM_END:T3,Z_NEED_DICT:I3,Z_STREAM_ERROR:T5e,Z_DATA_ERROR:AR,Z_MEM_ERROR:I5e}=Py;function zy(e){this.options=Fy.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new RG,this.strm.avail_out=0;let n=La.inflateInit2(this.strm,t.windowBits);if(n!==z0)throw new Error(Su[n]);if(this.header=new v5e,La.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=B0.string2buf(t.dictionary):XG.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=La.inflateSetDictionary(this.strm,t.dictionary),n!==z0)))throw new Error(Su[n])}zy.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?w5e:_5e,XG.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),r=La.inflate(n,o),r===I3&&s&&(r=La.inflateSetDictionary(n,s),r===z0?r=La.inflate(n,o):r===AR&&(r=I3));n.avail_in>0&&r===T3&&n.state.wrap>0&&e[n.next_in]!==0;)La.inflateReset(n),r=La.inflate(n,o);switch(r){case T5e:case AR:case I3:case I5e:return this.onEnd(r),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||r===T3))if(this.options.to==="string"){let l=B0.utf8border(n.output,n.next_out),c=n.next_out-l,d=B0.buf2string(n.output,l);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(r===z0&&a===0)){if(r===T3)return r=La.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};zy.prototype.onData=function(e){this.chunks.push(e)};zy.prototype.onEnd=function(e){e===z0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Fy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function S5e(e,t){const n=new zy(t);if(n.push(e),n.err)throw n.msg||Su[n.err];return n.result}var x5e=S5e,C5e={inflate:x5e};const{deflate:A5e}=B6e,{inflate:M5e}=C5e;var jG=A5e,YG=M5e;const ab=12,k5e=()=>{const e=new Uint8Array(ab);return window.crypto.getRandomValues(e)},CT=async e=>{const t=await window.crypto.subtle.generateKey({name:"AES-GCM",length:LF},!0,["encrypt","decrypt"]);return e==="cryptoKey"?t:(await window.crypto.subtle.exportKey("jwk",t)).k},WG=(e,t)=>window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:e,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:LF},!1,[t]),Hy=async(e,t)=>{const n=typeof e=="string"?await WG(e,"encrypt"):e,i=k5e(),s=typeof t=="string"?new TextEncoder().encode(t):t instanceof Uint8Array?t:t instanceof Blob?await Wp(t):t;return{encryptedBuffer:await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,s),iv:i}},H0=async(e,t,n)=>{const i=await WG(n,"decrypt");return window.crypto.subtle.decrypt({name:"AES-GCM",iv:e},i,t)},j6=e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e instanceof Uint8Array?e:new Uint8Array(e);let n="";for(const i of t)n+=String.fromCharCode(i);return n},KG=e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let i=0,s=e.length;i<s;i++)n[i]=e.charCodeAt(i);return t},ZG=e=>new TextDecoder("utf-8").decode(KG(e)),qG=(e,t=!1)=>t?window.btoa(e):window.btoa(j6(e)),QG=(e,t=!1)=>t?window.atob(e):ZG(window.atob(e)),MR=e=>window.atob(e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=")),JG=({text:e,compress:t})=>{let n;if(t!==!1)try{n=j6(jG(e))}catch(i){console.error("encode: cannot deflate",i)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||j6(e)}},eX=e=>{let t;switch(e.encoding){case"bstring":t=e.compressed?e.encoded:ZG(e.encoded);break;default:throw new Error(`decode: unknown encoding "${e.encoding}"`)}return e.compressed?YG(new Uint8Array(KG(t)),{to:"string"}):t},tX=1,lb=4,Th=4,S3={1:8,2:16,4:32};function Y6(e,t,n,i){if(i!=null){if(i>Math.pow(2,S3[t])-1)throw new Error(`attempting to set value higher than the allocated bytes (value: ${i}, bytes: ${t})`);const r=`setUint${S3[t]}`;return new DataView(e.buffer)[r](n,i),e}const s=`getUint${S3[t]}`;return new DataView(e.buffer)[s](n)}const kR=(...e)=>{const t=new Uint8Array(lb+Th*e.length+e.reduce((i,s)=>i+s.byteLength,0));let n=0;Y6(t,lb,n,tX),n+=lb;for(const i of e)Y6(t,Th,n,i.byteLength),n+=Th,t.set(i,n),n+=i.byteLength;return t},RR=e=>{const t=[];let n=0;const i=Y6(e,Th,n);if(i>tX)throw new Error(`invalid version ${i}`);for(n+=lb;;){const s=Y6(e,Th,n);if(n+=Th,t.push(e.slice(n,n+s)),n+=s,n>=e.byteLength)break}return t},R5e=async(e,t)=>{const{encryptedBuffer:n,iv:i}=await Hy(t,jG(e));return{iv:i,buffer:new Uint8Array(n)}},nX=async(e,t)=>{const n={version:2,compression:"pako@1",encryption:"AES-GCM"},i=new TextEncoder().encode(JSON.stringify(n)),s=new TextEncoder().encode(JSON.stringify(t.metadata||null)),{iv:r,buffer:o}=await R5e(kR(s,e),t.encryptionKey);return kR(i,r,o)},L5e=async(e,t,n,i)=>(t=new Uint8Array(await H0(e,t,n)),i?YG(t):t),iX=async(e,t)=>{const[n,i,s]=RR(e),r=JSON.parse(new TextDecoder().decode(n));try{const[o,a]=RR(await L5e(i,s,t.decryptionKey,!!r.compression));return{metadata:JSON.parse(new TextDecoder().decode(o)),data:a}}catch(o){throw console.error("Error during decompressing and decrypting the file.",r),o}},Zu=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),D5e=pe(Zu?()=>import("./file-open-002ab408-DIuFHtCF.js"):()=>import("./file-open-7c801643-684qeFg4.js"),__vite__mapDeps([]));async function P5e(...e){return(await D5e).default(...e)}pe(Zu?()=>import("./directory-open-4ed118d0-BzWybGaI.js"):()=>import("./directory-open-01563666-DWU9wJ6I.js"),__vite__mapDeps([]));const N5e=pe(Zu?()=>import("./file-save-745eba88-Bb9F9Kg7.js"):()=>import("./file-save-3189631c-x92wctJd.js"),__vite__mapDeps([]));async function O5e(...e){return(await N5e).default(...e)}const LR=5e3,AT=async e=>{var s,r;const t=(s=e.extensions)==null?void 0:s.reduce((o,a)=>(o.push(ve[a]),o),[]),n=(r=e.extensions)==null?void 0:r.reduce((o,a)=>a==="jpg"?o.concat(".jpg",".jpeg"):o.concat(`.${a}`),[]),i=await P5e({description:e.description,extensions:n,mimeTypes:t,multiple:e.multiple??!1,legacySetup:(o,a,l)=>{const c=ul(a,LR),d=()=>{u(),document.addEventListener(te.KEYUP,c),document.addEventListener(te.POINTER_UP,c),c()},u=()=>{var h;if((h=l.files)!=null&&h.length){const m=e.multiple?[...l.files]:l.files[0];o(m)}};requestAnimationFrame(()=>{window.addEventListener(te.FOCUS,d)});const f=window.setInterval(()=>{u()},LR);return h=>{clearInterval(f),c.cancel(),window.removeEventListener(te.FOCUS,d),document.removeEventListener(te.KEYUP,c),document.removeEventListener(te.POINTER_UP,c),h&&(console.warn("Opening the file was canceled (legacy-fs)."),h(new ng))}}});return Array.isArray(i)?await Promise.all(i.map(o=>G0(o))):await G0(i)},W6=(e,t)=>O5e(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`],mimeTypes:t.mimeTypes},t.fileHandle),F5e=(e,t)=>{const n={};for(const i of e)!i.isDeleted&&"fileId"in i&&i.fileId&&t[i.fileId]&&(n[i.fileId]=t[i.fileId]);return n},zg=(e,t,n,i)=>{const s={type:kr.excalidraw,version:j5.excalidraw,source:E_(),elements:e,appState:i==="local"?oG(t):X2e(t),files:i==="local"?F5e(e,n):void 0};return JSON.stringify(s,null,2)},sX=async(e,t,n,i=t.name||NF)=>{const s=zg(e,t,n,"local"),r=new Blob([s],{type:ve.excalidraw});return{fileHandle:await W6(r,{name:i,extension:"excalidraw",description:"Excalidraw file",fileHandle:DT(t.fileHandle)?null:t.fileHandle})}},B5e=async(e,t)=>{const n=await AT({description:"Excalidraw files"});return PT(n,e,t,n.handle)},z5e=e=>(e==null?void 0:e.type)===kr.excalidraw&&(!e.elements||Array.isArray(e.elements)&&(!e.appState||typeof e.appState=="object")),rX=e=>typeof e=="object"&&e&&e.type===kr.excalidrawLibrary&&(e.version===1||e.version===2),H5e=e=>{const t={type:kr.excalidrawLibrary,version:j5.excalidrawLibrary,source:E_(),libraryItems:e};return JSON.stringify(t,null,2)},V5e=async e=>{const t=H5e(e);await W6(new Blob([t],{type:ve.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})},$5e=12,oX=document.createElement("img");oX.src=`data:${ve.svg}, ${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>')}`;const aX=document.createElement("img");aX.src=`data:${ve.svg}, ${encodeURIComponent('<svg  xmlns="http://www.w3.org/2000/svg"  width="16"  height="16"  viewBox="0 0 24 24"  fill="none"  stroke="#1971c2"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-big-right-line"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v-3.586a1 1 0 0 1 1.707 -.707l6.586 6.586a1 1 0 0 1 0 1.414l-6.586 6.586a1 1 0 0 1 -1.707 -.707v-3.586h-6v-6h6z" /><path d="M3 9v6" /></svg>')}`;const MT=([e,t,n,i],s,r)=>{const o=$5e,a=r.zoom.value>1?r.zoom.value:1,l=o/a,c=o/a,d=o/a,u=(e+n)/2,f=(t+i)/2,h=(o-8)/(2*a),m=4/a,p=n+m-h,U=t-m-d+h,[b,y]=Z(C(p+l/2,U+c/2),C(u,f),s);return[b-l/2,y-c/2,l,c]},lX=(e,t,n,[i,s])=>{const r=4/n.zoom.value,[o,a,l,c]=$e(e,t),[d,u,f,h]=MT([o,a,l,c],e.angle,n);return i>d-r&&i<d+r+f&&s>u-r&&s<u+h+r},x3=(e,t,n,[i,s],r)=>!e.link||n.selectedElementIds[e.id]?!1:!r&&n.viewModeEnabled&&ey(C(i,s),e,t)?!0:lX(e,t,n,C(i,s)),kT=(e,t,n,i,s,r=!0)=>{e.beginPath(),e.arc(t,n,i,0,Math.PI*2),r&&e.fill(),s&&e.stroke()},Vy=(e,t)=>[e.width/t,e.height/t],$y=({canvas:e,scale:t,normalizedWidth:n,normalizedHeight:i,theme:s,isExporting:r,viewBackgroundColor:o})=>{const a=e.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(t,t),r&&s===Se.DARK&&(a.filter=w_),typeof o=="string"?((o==="transparent"||o.length===5||o.length===9||/(hsla|rgba)\(/.test(o))&&a.clearRect(0,0,n,i),a.save(),a.fillStyle=o,a.fillRect(0,0,n,i),a.restore()):a.clearRect(0,0,n,i),a},Gy=(e,t,n,i,s,r,o,a,l=!1,c=0)=>{e.save(),e.translate(r,o),e.rotate(a),l&&e.fillRect(t-r,n-o,i,s),c&&e.roundRect?(e.beginPath(),e.roundRect(t-r,n-o,i,s,c),e.stroke(),e.closePath()):e.strokeRect(t-r,n-o,i,s),e.restore()},u2={Bold:"#dddddd",Regular:"#e5e5e5"},G5e=(e,t,n,i,s,r,o,a)=>{const l=i%t-t,c=s%t-t,d=t*r.value,u=1/r.value;e.save(),r.value===1&&e.translate(l%1?0:.5,c%1?0:.5);for(let f=l;f<l+o+t*2;f+=t){const h=n>1&&Math.round(f-i)%(n*t)===0;if(!h&&d<10)continue;const m=Math.min(1/r.value,h?4:1);e.lineWidth=m;const p=[m*3,u+(m+u)];e.beginPath(),e.setLineDash(h?[]:p),e.strokeStyle=h?u2.Bold:u2.Regular,e.moveTo(f,c-t),e.lineTo(f,Math.ceil(c+a+t*2)),e.stroke()}for(let f=c;f<c+a+t*2;f+=t){const h=n>1&&Math.round(f-s)%(n*t)===0;if(!h&&d<10)continue;const m=Math.min(1/r.value,h?4:1);e.lineWidth=m;const p=[m*3,u+(m+u)];e.beginPath(),e.setLineDash(h?[]:p),e.strokeStyle=h?u2.Bold:u2.Regular,e.moveTo(l-t,f),e.lineTo(Math.ceil(l+o+t*2),f),e.stroke()}e.restore()},Tv=(e,t,n,i)=>{t.translate(e.x+i.scrollX,e.y+i.scrollY),t.beginPath(),t.roundRect?t.roundRect(0,0,e.width,e.height,mt.radius/i.zoom.value):t.rect(0,0,e.width,e.height),t.clip(),t.translate(-(e.x+i.scrollX),-(e.y+i.scrollY))},DR={regularLink:null,elementLink:null},PR=(e,t,n,i)=>{if(e.link&&!n.selectedElementIds[e.id]){const[s,r,o,a]=$e(e,i),[l,c,d,u]=MT([s,r,o,a],e.angle,n),f=l+d/2,h=c+u/2;t.save(),t.translate(n.scrollX+f,n.scrollY+h),t.rotate(e.angle);const m=mh(e.link)?"elementLink":"regularLink";let p=DR[m];if(!p||p.zoom!==n.zoom.value){p=Object.assign(document.createElement("canvas"),{zoom:n.zoom.value}),p.width=d*window.devicePixelRatio*n.zoom.value,p.height=u*window.devicePixelRatio*n.zoom.value,DR[m]=p;const U=p.getContext("2d");U.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),U.fillStyle=n.viewBackgroundColor||"#fff",U.fillRect(0,0,d,u),m==="elementLink"?U.drawImage(aX,0,0,d,u):U.drawImage(oX,0,0,d,u),U.restore()}t.drawImage(p,l-f,c-h,d,u),t.restore()}},cX=({canvas:e,rc:t,elementsMap:n,allElementsMap:i,visibleElements:s,scale:r,appState:o,renderConfig:a})=>{var p;if(e===null)return;const{renderGrid:l=!0,isExporting:c}=a,[d,u]=Vy(e,r),f=$y({canvas:e,scale:r,normalizedWidth:d,normalizedHeight:u,theme:o.theme,isExporting:c,viewBackgroundColor:o.viewBackgroundColor});f.scale(o.zoom.value,o.zoom.value),l&&G5e(f,o.gridSize,o.gridStep,o.scrollX,o.scrollY,o.zoom,d/o.zoom.value,u/o.zoom.value);const h=new Set;s.forEach(U=>{U.groupIds.length>0&&o.frameToHighlight&&o.selectedElementIds[U.id]&&(Vc(U,o.frameToHighlight,n)||U.groupIds.find(b=>h.has(b)))&&U.groupIds.forEach(b=>h.add(b))});const m=new Map;s.filter(U=>!wr(U)).forEach(U=>{var b;try{const y=U.frameId||((b=o.frameToHighlight)==null?void 0:b.id);if(fe(U)&&U.containerId&&n.has(U.containerId))return;if(f.save(),y&&o.frameRendering.enabled&&o.frameRendering.clip){const _=m6(U,n,o);_&&v4(U,_,o,n,m)&&Tv(_,f,a,o),Cd(U,n,i,t,f,a,o)}else Cd(U,n,i,t,f,a,o);const v=Re(U,n);v&&Cd(v,n,i,t,f,a,o),f.restore(),c||PR(U,f,o,n)}catch(y){console.error(y,U.id,U.x,U.y,U.width,U.height)}}),s.filter(U=>wr(U)).forEach(U=>{var b;try{const y=()=>{if(Cd(U,n,i,t,f,a,o),wr(U)&&(c||ds(U)&&a.embedsValidationStatus.get(U.id)!==!0)&&U.width&&U.height){const _=Mz(U);Cd(_,n,i,t,f,a,o)}c||PR(U,f,o,n)};if((U.frameId||((b=o.frameToHighlight)==null?void 0:b.id))&&o.frameRendering.enabled&&o.frameRendering.clip){f.save();const _=m6(U,n,o);_&&v4(U,_,o,n,m)&&Tv(_,f,a,o),y(),f.restore()}else y()}catch(y){console.error(y)}}),(p=a.pendingFlowchartNodes)==null||p.forEach(U=>{try{Cd(U,n,i,t,f,a,o)}catch(b){console.error(b)}})},dX=Tp(e=>{cX(e)},{trailing:!0}),uX=(e,t)=>{if(t){dX(e);return}cX(e)},S1=(e,t,n)=>{const i={sets:t.sets,shape:t.shape,options:{...t.options,fixedDecimalPlaceDigits:n}};return e.draw(i)},x1=(e,t,n,i,s)=>{if(!i.enabled||!i.clip)return null;const r=Ls(e,s);if(r){const o=t.ownerDocument.createElementNS(lt,"g");return o.setAttributeNS(lt,"clip-path",`url(#${r.id})`),n.forEach(a=>o.appendChild(a)),o}return null},cb=(e,t,n,i,s,r,o,a)=>{var v;const l={x:r,y:o},[c,d,u,f]=$e(e,t);let h=(u-c)/2-(e.x-c),m=(f-d)/2-(e.y-d);if(fe(e)){const _=Bn(e,t);if(_e(_)){const[I,R,T,w]=$e(_,t),S=re.getBoundTextElementPosition(_,e,t);h=(T-I)/2-(S.x-I),m=(w-R)/2-(S.y-R),r=r+S.x-e.x,o=o+S.y-e.y}}const p=180*e.angle/Math.PI;let U=i;if(e.link){const _=i.ownerDocument.createElementNS(lt,"a");_.setAttribute("href",rr(e.link)),U.appendChild(_),U=_}const b=(_,I)=>{U.appendChild(_)},y=(((v=Ls(e,t))==null?void 0:v.opacity)??100)*e.opacity/1e4;switch(e.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{const _=sn.generateElementShape(e,null),I=S1(n,_,g1);y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);const R=x1(e,U,[I],a.frameRendering,t);b(R||I);break}case"iframe":case"embeddable":{const _=sn.generateElementShape(e,a),I=S1(n,_,g1),R=e.opacity/100;R!==1&&(I.setAttribute("stroke-opacity",`${R}`),I.setAttribute("fill-opacity",`${R}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),b(I);const T=Mz(e);cb(T,t,n,U,s,T.x+l.x-e.x,T.y+l.y-e.y,a);const w=S1(n,_,g1);for(w.setAttribute("stroke-linecap","round"),w.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);w.firstChild;)w.removeChild(w.firstChild);const S=qo(Math.min(e.width,e.height),e),x=Jf(L_(e.link||""));if(a.renderEmbeddables===!1||(x==null?void 0:x.type)==="document"){const k=i.ownerDocument.createElementNS(lt,"a");k.setAttribute("href",rr(e.link||"")),k.setAttribute("target","_blank"),k.setAttribute("rel","noopener noreferrer"),k.style.borderRadius=`${S}px`,w.appendChild(k)}else{const k=i.ownerDocument.createElementNS(lt,"foreignObject");k.style.width=`${e.width}px`,k.style.height=`${e.height}px`,k.style.border="none";const P=k.ownerDocument.createElementNS(lt,"div");P.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),P.style.width="100%",P.style.height="100%";const D=P.ownerDocument.createElement("iframe");D.src=(x==null?void 0:x.link)??"",D.style.width="100%",D.style.height="100%",D.style.border="none",D.style.borderRadius=`${S}px`,D.style.top="0",D.style.left="0",D.allowFullscreen=!0,P.appendChild(D),k.appendChild(P),w.appendChild(k)}b(w);break}case"line":case"arrow":{const _=Re(e,t),I=i.ownerDocument.createElementNS(lt,"mask");if(_){I.setAttribute("id",`mask-${e.id}`);const S=i.ownerDocument.createElementNS(lt,"rect");r=r||0,o=o||0,S.setAttribute("x","0"),S.setAttribute("y","0"),S.setAttribute("fill","#fff"),S.setAttribute("width",`${e.width+100+r}`),S.setAttribute("height",`${e.height+100+o}`),I.appendChild(S);const x=i.ownerDocument.createElementNS(lt,"rect"),k=re.getBoundTextElementPosition(e,_,t),P=r+k.x-e.x,D=o+k.y-e.y;x.setAttribute("x",P.toString()),x.setAttribute("y",D.toString()),x.setAttribute("fill","#000"),x.setAttribute("width",`${_.width}`),x.setAttribute("height",`${_.height}`),x.setAttribute("opacity","1"),I.appendChild(x)}const R=i.ownerDocument.createElementNS(lt,"g");_&&R.setAttribute("mask",`url(#mask-${e.id})`),R.setAttribute("stroke-linecap","round"),sn.generateElementShape(e,a).forEach(S=>{const x=S1(n,S,g1);y!==1&&(x.setAttribute("stroke-opacity",`${y}`),x.setAttribute("fill-opacity",`${y}`)),x.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),e.type==="line"&&sa(e.points)&&e.backgroundColor!=="transparent"&&x.setAttribute("fill-rule","evenodd"),R.appendChild(x)});const w=x1(e,U,[R,I],a.frameRendering,t);w?(b(w),U.appendChild(w)):(b(R),U.append(I));break}case"freedraw":{const _=sn.generateElementShape(e,a),I=_?S1(n,_,g1):i.ownerDocument.createElementNS(lt,"g");y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),I.setAttribute("stroke","none");const R=i.ownerDocument.createElementNS(lt,"path");R.setAttribute("fill",e.strokeColor),R.setAttribute("d",fz(e)),I.appendChild(R);const T=x1(e,U,[I],a.frameRendering,t);b(T||I);break}case"image":{const _=Math.round(e.width),I=Math.round(e.height),R=On(e)&&s[e.fileId];if(R){const{reuseImages:T=!0}=a;let w=`image-${R.id}`,S=e.width,x=e.height;e.crop&&({width:S,height:x}=gl(e),w=`image-crop-${R.id}-${Ew(`${S}x${x}`)}`),T||(w=`image-${e.id}`);let k=i.querySelector(`#${w}`);if(!k){k=i.ownerDocument.createElementNS(lt,"symbol"),k.id=w;const X=i.ownerDocument.createElementNS(lt,"image");X.setAttribute("href",R.dataURL),X.setAttribute("preserveAspectRatio","none"),e.crop||!T?(X.setAttribute("width",`${S}`),X.setAttribute("height",`${x}`)):(X.setAttribute("width","100%"),X.setAttribute("height","100%")),k.appendChild(X),(U.querySelector("defs")||U).prepend(k)}const P=i.ownerDocument.createElementNS(lt,"use");P.setAttribute("href",`#${w}`),a.exportWithDarkMode&&R.mimeType!==ve.svg&&P.setAttribute("filter",sz);let D=0,j=0;if(e.crop){const{width:X,height:Y}=gl(e);D=e.crop.x/(e.crop.naturalWidth/X),j=e.crop.y/(e.crop.naturalHeight/Y)}const G=h+D,V=m+j;P.setAttribute("width",`${_+D}`),P.setAttribute("height",`${I+j}`),P.setAttribute("opacity",`${y}`),(e.scale[0]!==1||e.scale[1]!==1)&&P.setAttribute("transform",`translate(${G} ${V}) scale(${e.scale[0]} ${e.scale[1]}) translate(${-G} ${-V})`);const B=i.ownerDocument.createElementNS(lt,"g");if(e.crop){const X=i.ownerDocument.createElementNS(lt,"mask");X.setAttribute("id",`mask-image-crop-${e.id}`),X.setAttribute("fill","#fff");const Y=i.ownerDocument.createElementNS(lt,"rect");Y.setAttribute("x",`${D}`),Y.setAttribute("y",`${j}`),Y.setAttribute("width",`${_}`),Y.setAttribute("height",`${I}`),X.appendChild(Y),U.appendChild(X),B.setAttribute("mask",`url(#${X.id})`)}if(B.appendChild(P),B.setAttribute("transform",`translate(${r-D} ${o-j}) rotate(${p} ${G} ${V})`),e.roundness){const X=i.ownerDocument.createElementNS(lt,"clipPath");X.id=`image-clipPath-${e.id}`,X.setAttribute("clipPathUnits","userSpaceOnUse");const Y=i.ownerDocument.createElementNS(lt,"rect"),ee=qo(Math.min(e.width,e.height),e),se=e.crop?D:0,oe=e.crop?j:0;Y.setAttribute("x",`${se}`),Y.setAttribute("y",`${oe}`),Y.setAttribute("width",`${e.width}`),Y.setAttribute("height",`${e.height}`),Y.setAttribute("rx",`${ee}`),Y.setAttribute("ry",`${ee}`),X.appendChild(Y),b(X),B.setAttributeNS(lt,"clip-path",`url(#${X.id})`)}const z=x1(e,U,[B],a.frameRendering,t);b(z||B)}break}case"frame":case"magicframe":{if(a.frameRendering.enabled&&a.frameRendering.outline){const _=document.createElementNS(lt,"rect");_.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),_.setAttribute("width",`${e.width}px`),_.setAttribute("height",`${e.height}px`),_.setAttribute("rx",mt.radius.toString()),_.setAttribute("ry",mt.radius.toString()),_.setAttribute("fill","none"),_.setAttribute("stroke",mt.strokeColor),_.setAttribute("stroke-width",mt.strokeWidth.toString()),b(_)}break}default:if(fe(e)){const _=i.ownerDocument.createElementNS(lt,"g");y!==1&&(_.setAttribute("stroke-opacity",`${y}`),_.setAttribute("fill-opacity",`${y}`)),_.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);const I=e.text.replace(/\r\n?/g,`
`).split(`
`),R=kp(e.fontSize,e.lineHeight),T=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,w=FF(e.fontFamily,e.fontSize,R),S=nB(e.text)?"rtl":"ltr",x=e.textAlign==="center"?"middle":e.textAlign==="right"||S==="rtl"?"end":"start";for(let P=0;P<I.length;P++){const D=i.ownerDocument.createElementNS(lt,"text");D.textContent=I[P],D.setAttribute("x",`${T}`),D.setAttribute("y",`${P*R+w}`),D.setAttribute("font-family",wp(e)),D.setAttribute("font-size",`${e.fontSize}px`),D.setAttribute("fill",e.strokeColor),D.setAttribute("text-anchor",x),D.setAttribute("style","white-space: pre;"),D.setAttribute("direction",S),D.setAttribute("dominant-baseline","alphabetic"),_.appendChild(D)}const k=x1(e,U,[_],a.frameRendering,t);b(k||_)}else throw new Error(`Unimplemented type ${e.type}`)}},X5e=(e,t,n,i,s,r)=>{i&&(e.filter(o=>!wr(o)).forEach(o=>{if(!o.isDeleted){if(fe(o)&&o.containerId&&t.has(o.containerId))return;try{cb(o,t,n,i,s,o.x+r.offsetX,o.y+r.offsetY,r);const a=Re(o,t);a&&cb(a,t,n,i,s,a.x+r.offsetX,a.y+r.offsetY,r)}catch(a){console.error(a)}}}),e.filter(o=>wr(o)).forEach(o=>{if(!o.isDeleted)try{cb(o,t,n,i,s,o.x+r.offsetX,o.y+r.offsetY,r)}catch(a){console.error(a)}}))},j5e=(e,t)=>{if(e.width<=t)return e;const i=document.createElement("canvas").getContext("2d");i.font=bt({fontFamily:e.fontFamily,fontSize:e.fontSize});let s=e.text;if(i.measureText(s).width>t)for(let o=s.length;o>0;o--){const a=`${s.slice(0,o)}...`;if(i.measureText(a).width<=t){s=a;break}}return Te(e,{text:s,width:t})},Y5e=(e,t)=>{const n=[];for(const i of e){if(Ue(i)){let s=cr({x:i.x,y:i.y-mt.nameOffsetY,fontFamily:rt.Helvetica,fontSize:mt.nameFontSize,lineHeight:mt.nameLineHeight,strokeColor:t.exportWithDarkMode?mt.nameColorDarkTheme:mt.nameColorLightTheme,text:nz(i)});s.y-=s.height,s=j5e(s,i.width),n.push(s)}n.push(i)}return n},fX=(e,t)=>(t=t||da().frameRendering,{enabled:e?!0:t.enabled,outline:e?!1:t.outline,name:e?!1:t.name,clip:e?!0:t.clip}),hX=({elements:e,exportingFrame:t,frameRendering:n,exportWithDarkMode:i})=>{let s;return t?s=ow(e,t):n.enabled&&n.name?s=Y5e(e,{exportWithDarkMode:i}):s=e,s},gX=async(e,t,n,{exportBackground:i,exportPadding:s=Sg,viewBackgroundColor:r,exportingFrame:o},a=(c,d)=>{const u=document.createElement("canvas");return u.width=c*t.exportScale,u.height=d*t.exportScale,{canvas:u,scale:t.exportScale}},l=async()=>{await rl.loadElementsFonts(e)})=>{await l();const c=fX(o??null,t.frameRendering??null);o&&(c.clip=!1);const d=hX({elements:e,exportingFrame:o,exportWithDarkMode:t.exportWithDarkMode,frameRendering:c});o&&(s=0);const[u,f,h,m]=LT(o?[o]:sw(d),s),{canvas:p,scale:U=1}=a(h,m),b=da(),{imageCache:y}=await Lz({imageCache:new Map,fileIds:Dz(d).map(v=>v.fileId),files:n});return uX({canvas:p,rc:ld.canvas(p),elementsMap:ia(be(d)),allElementsMap:ia(be(fd(e))),visibleElements:d,scale:U,appState:{...t,frameRendering:c,viewBackgroundColor:i?r:null,scrollX:-u+s,scrollY:-f+s,zoom:b.zoom,shouldCacheIgnoreZoom:!1,theme:t.exportWithDarkMode?Se.DARK:Se.LIGHT},renderConfig:{canvasBackgroundColor:r,imageCache:y,renderGrid:!1,isExporting:!0,embedsValidationStatus:new Map,elementsPendingErasure:new Set,pendingFlowchartNodes:null}}),p},J1=e=>document.createComment(` ${e} `),RT=async(e,t,n,i)=>{const s=fX((i==null?void 0:i.exportingFrame)??null,t.frameRendering??null);let{exportPadding:r=Sg,exportWithDarkMode:o=!1,viewBackgroundColor:a,exportScale:l=1,exportEmbedScene:c}=t;const{exportingFrame:d=null}=i||{},u=hX({elements:e,exportingFrame:d,exportWithDarkMode:o,frameRendering:s});d&&(r=0);const[f,h,m,p]=LT(d?[d]:sw(u),r),U=-f+r,b=-h+r,y=document.createElementNS(lt,"svg");y.setAttribute("version","1.1"),y.setAttribute("xmlns",lt),y.setAttribute("viewBox",`0 0 ${m} ${p}`),y.setAttribute("width",`${m*l}`),y.setAttribute("height",`${p*l}`),o&&y.setAttribute("filter",w_);const v=y.ownerDocument.createElementNS(lt,"defs"),_=y.ownerDocument.createElementNS(lt,"metadata");if(y.appendChild(J1("svg-source:excalidraw")),y.appendChild(_),y.appendChild(v),c)try{W5e({metadataElement:_,payload:zg(e,t,n||{},"local")})}catch(k){console.error(k)}const I=iw(e);if(I.length){const k=be(e);for(const P of I){const D=y.ownerDocument.createElementNS(lt,"clipPath");D.setAttribute("id",P.id);const[j,G,V,B]=$e(P,k),z=(V-j)/2-(P.x-j),X=(B-G)/2-(P.y-G),Y=y.ownerDocument.createElementNS(lt,"rect");Y.setAttribute("transform",`translate(${P.x+U} ${P.y+b}) rotate(${P.angle} ${z} ${X})`),Y.setAttribute("width",`${P.width}`),Y.setAttribute("height",`${P.height}`),d||(Y.setAttribute("rx",`${mt.radius}`),Y.setAttribute("ry",`${mt.radius}`)),D.appendChild(Y),v.appendChild(D)}}const R=i!=null&&i.skipInliningFonts?[]:await rl.generateFontFaceDeclarations(e),T=`
      `,w=y.ownerDocument.createElementNS(lt,"style");if(w.classList.add("style-fonts"),w.appendChild(document.createTextNode(`${T}${R.join(T)}`)),v.appendChild(w),t.exportBackground&&a){const k=y.ownerDocument.createElementNS(lt,"rect");k.setAttribute("x","0"),k.setAttribute("y","0"),k.setAttribute("width",`${m}`),k.setAttribute("height",`${p}`),k.setAttribute("fill",a),y.appendChild(k)}const S=ld.svg(y),x=(i==null?void 0:i.renderEmbeddables)??!1;return X5e(u,ia(be(u)),S,y,n||{},{offsetX:U,offsetY:b,isExporting:!0,exportWithDarkMode:o,renderEmbeddables:x,frameRendering:s,canvasBackgroundColor:a,embedsValidationStatus:x?new Map(u.filter(k=>Ue(k)).map(k=>[k.id,!0])):new Map,reuseImages:(i==null?void 0:i.reuseImages)??!0}),y},W5e=({payload:e,metadataElement:t})=>{const n=qG(JSON.stringify(JG({text:e})),!0);t.appendChild(J1(`payload-type:${ve.excalidraw}`)),t.appendChild(J1("payload-version:2")),t.appendChild(J1("payload-start")),t.appendChild(document.createTextNode(n)),t.appendChild(J1("payload-end"))},K5e=({svg:e})=>{if(e.includes(`payload-type:${ve.excalidraw}`)){const t=e.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!t)throw new Error("INVALID");const n=e.match(/<!-- payload-version:(\d+) -->/),s=((n==null?void 0:n[1])||"1")!=="1";try{const r=QG(t[1],s),o=JSON.parse(r);if(!("encoded"in o)){if("type"in o&&o.type===kr.excalidraw)return r;throw new Error("FAILED")}return eX(o)}catch(r){throw console.error(r),new Error("FAILED")}}throw new Error("INVALID")},LT=(e,t)=>{const[n,i,s,r]=pt(e),o=Ki(n,s)+t*2,a=Ki(i,r)+t*2;return[n,i,o,a]},Z5e=(e,t,n)=>{const[,,i,s]=LT(e,t).map(r=>Math.trunc(r*n));return[i,s]},q5e={selection:!0,lasso:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},Q5e=e=>Object.keys(rt).includes(e)?rt[e]:ad,NR=(e,t,n,i)=>{if(!t)return null;if(ye(e))return{...t,fixedPoint:jh(t.fixedPoint??[0,0]),mode:t.mode||"orbit"};const s=n.get(t.elementId)||void 0;if(s){if(t.mode)return{elementId:t.elementId,mode:t.mode||"orbit",fixedPoint:jh(t.fixedPoint||[.5,.5])};const r=re.getPointAtIndexGlobalCoordinates(e,i==="start"?0:e.points.length-1,n),o=ml(r,s,n)?"inside":"orbit",a=o==="inside"?r:E0(e,r,s,i,n)||r,{fixedPoint:l}=Xh(e,s,i,n,a);return{mode:o,elementId:t.elementId,fixedPoint:l}}return null},Bl=(e,t)=>{const n={type:t.type||e.type,version:e.version||1,versionNonce:e.versionNonce??0,index:e.index??null,isDeleted:e.isDeleted??!1,id:e.id||ys(),fillStyle:e.fillStyle||Un.fillStyle,strokeWidth:e.strokeWidth||Un.strokeWidth,strokeStyle:e.strokeStyle??Un.strokeStyle,roughness:e.roughness??Un.roughness,opacity:e.opacity==null?Un.opacity:e.opacity,angle:e.angle||0,x:t.x??e.x??0,y:t.y??e.y??0,strokeColor:e.strokeColor||Un.strokeColor,backgroundColor:e.backgroundColor||Un.backgroundColor,width:e.width||0,height:e.height||0,seed:e.seed??1,groupIds:e.groupIds??[],frameId:e.frameId??null,roundness:e.roundness?e.roundness:e.strokeSharpness==="round"?{type:$u(e.type)?En.LEGACY:En.PROPORTIONAL_RADIUS}:null,boundElements:e.boundElementIds?e.boundElementIds.map(s=>({type:"arrow",id:s})):e.boundElements??[],updated:e.updated??xg(),link:e.link?rr(e.link):null,locked:e.locked??!1};("customData"in e||"customData"in t)&&(n.customData="customData"in t?t.customData:e.customData);const i={...e,...n,...Uz(n),...t};return delete i.strokeSharpness,delete i.boundElementIds,i},J5e=(e,t,n)=>{var i;switch(e={...e},e.type){case"text":delete e.rawText;let s=e.fontSize,r=e.fontFamily;if("font"in e){const[h,m]=e.font.split(" ");s=parseFloat(h),r=Q5e(m)}const o=typeof e.text=="string"&&e.text||"",a=e.lineHeight||(e.height?tie(e):zc(e.fontFamily));return e=Bl(e,{fontSize:s,fontFamily:r,text:o,textAlign:e.textAlign||Ep,verticalAlign:e.verticalAlign||Wb,containerId:e.containerId??null,originalText:e.originalText||o,autoResize:e.autoResize??!0,lineHeight:a}),n!=null&&n.deleteInvisibleElements&&!o&&!e.isDeleted&&(e={...e,originalText:o,isDeleted:!0},e=Ha(e)),e;case"freedraw":return Bl(e,{points:e.points,simulatePressure:e.simulatePressure,pressures:e.pressures});case"image":return Bl(e,{status:e.status||"pending",fileId:e.fileId,scale:e.scale||[1,1],crop:e.crop??null});case"line":case"draw":const{startArrowhead:l=null,endArrowhead:c=null}=e;let d=e.x,u=e.y,f=!Array.isArray(e.points)||e.points.length<2?[C(0,0),C(e.width,e.height)]:e.points;return(f[0][0]!==0||f[0][1]!==0)&&({points:f,x:d,y:u}=re.getNormalizeElementPointsAndCoords(e)),Bl(e,{type:"line",startBinding:null,endBinding:null,startArrowhead:l,endArrowhead:c,points:f,x:d,y:u,...nn(e)?{polygon:b4(e.points)?e.polygon??!1:!1}:{},...zh(f)});case"arrow":{const{startArrowhead:h=null,endArrowhead:m="arrow"}=e,p=e.x,U=e.y,b=!Array.isArray(e.points)||e.points.length<2?[C(0,0),C(e.width,e.height)]:e.points,y={type:e.type,startBinding:NR(e,e.startBinding,t,"start"),endBinding:NR(e,e.endBinding,t,"end"),startArrowhead:h,endArrowhead:m,points:b,x:p,y:U,elbowed:e.elbowed,...zh(b)},v=ye(e)?Bl(e,{...y,elbowed:!0,fixedSegments:(i=e.fixedSegments)!=null&&i.length&&y.points.length>=4?e.fixedSegments:null,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}):Bl(e,y);return{...v,...re.getNormalizeElementPointsAndCoords(v)}}case"ellipse":case"rectangle":case"diamond":case"iframe":case"embeddable":return Bl(e,{});case"magicframe":case"frame":return Bl(e,{name:e.name??null})}return null},eye=(e,t)=>{if(e.boundElements){const n=e.boundElements.slice(),i=new Set;e.boundElements=n.reduce((s,r)=>{const o=t.get(r.id);if(o&&!i.has(r.id)){if(i.add(r.id),o.isDeleted)return s;s.push(r),fe(o)&&!o.containerId&&(o.containerId=e.id)}return s},[])}},tye=(e,t)=>{const n=e.containerId?t.get(e.containerId):null;if(e.angle=_e(n)?0:(n==null?void 0:n.angle)??0,!n){e.containerId=null;return}if(!e.isDeleted&&n.boundElements&&!n.boundElements.find(i=>i.id===e.id)){const i=(n.boundElements||(n.boundElements=[])).slice();i.push({type:"text",id:e.id}),n.boundElements=i}},nye=(e,t)=>{e.frameId&&(t.get(e.frameId)||(e.frameId=null))},Mu=(e,t,n)=>{const i=new Set,s=be(e||[]),r=t?be(t):null,o=fd((e||[]).reduce((l,c)=>{if(c.type==="selection")return l;let d=J5e(c,s,{deleteInvisibleElements:n==null?void 0:n.deleteInvisibleElements});if(d){const u=r==null?void 0:r.get(c.id),f=(n==null?void 0:n.deleteInvisibleElements)&&nl(c);(f||u&&u.version>d.version)&&(d=Ha(d,u==null?void 0:u.version)),f&&(d={...d,isDeleted:!0}),i.has(d.id)&&(d={...d,id:ys()}),i.add(d.id),l.push(d)}return l},[]));if(!(n!=null&&n.repairBindings))return o;const a=be(o);for(const l of o)l.frameId&&nye(l,a),fe(l)&&l.containerId?tye(l,a):l.boundElements&&eye(l,a),n.refreshDimensions&&fe(l)&&Object.assign(l,Cz(l,Bn(l,a),a)),Ce(l)&&(l.startBinding&&(!a.has(l.startBinding.elementId)||!_e(l))&&(l.startBinding=null),l.endBinding&&(!a.has(l.endBinding.elementId)||!_e(l))&&(l.endBinding=null));return o.map(l=>{if(ye(l)&&!SB(l)&&!VB(l.points))return{...l,...Cg(l,a,{points:[C(0,0),l.points[l.points.length-1]]}),index:l.index};if(ye(l)&&l.startBinding&&l.endBinding&&l.startBinding.elementId===l.endBinding.elementId&&l.points.length>1&&l.points.some(([c,d])=>Math.abs(c)>1e6||Math.abs(d)>1e6)){console.error("Fixing self-bound elbow arrow",l.id);const c=a.get(l.startBinding.elementId);return c?{...l,x:c.x+c.width/2,y:c.y-5,width:c.width,height:c.height,points:[C(0,0),C(0,-10),C(c.width/2+5,-10),C(c.width/2+5,c.height/2+5)]}:(console.error("Bound element not found",l.startBinding.elementId),l)}return l})},iye=(e,t,n)=>{const i=t[e];return i!==void 0?i:n[e]},OR={isSidebarDocked:(e,t)=>["defaultSidebarDockedPreference",e.isSidebarDocked??iye("defaultSidebarDockedPreference",e,t)]},mX=(e,t)=>{var s;e=e||{};const n=da(),i={};for(const r of Object.keys(OR))if(r in e){const[o,a]=OR[r](e,n);i[o]=a}for(const[r,o]of Object.entries(n)){const a=e[r],l=t?t[r]:void 0;i[r]=a!==void 0?a:l!==void 0?l:o}return{...i,cursorButton:(t==null?void 0:t.cursorButton)||"up",penDetected:(t==null?void 0:t.penDetected)??(e.penMode?e.penDetected??!1:!1),activeTool:{...qt(n,i.activeTool.type&&q5e[i.activeTool.type]?i.activeTool:{type:"selection"}),lastActiveTool:null,locked:i.activeTool.locked??!1},zoom:{value:Ka(xm(e.zoom)?e.zoom:((s=e.zoom)==null?void 0:s.value)??n.zoom.value)},openSidebar:typeof e.openSidebar=="string"?{name:Rr.name}:i.openSidebar,gridSize:uue(xm(e.gridSize)?e.gridSize:Zb),gridStep:CV(xm(e.gridStep)?e.gridStep:RF),editingFrame:null}},ku=(e,t,n,i)=>({elements:Mu(e==null?void 0:e.elements,n,i),appState:mX(e==null?void 0:e.appState,t||null),files:(e==null?void 0:e.files)||{}}),FR=e=>{const t=Mu(Yt(e.elements),null);return t.length?{...e,elements:t}:null},Xy=(e=[],t)=>{const n=[];for(const i of e)if(Array.isArray(i)){const s=FR({status:t,elements:i,id:ys(),created:Date.now()});s&&n.push(s)}else{const s=i,r=FR({...s,id:s.id||ys(),status:s.status||t,created:s.created||Date.now()});r&&n.push(r)}return n},pX=async e=>{let t;if(e.type===ve.png)try{return await(await pe(()=>Promise.resolve().then(()=>YX),void 0)).decodePngMetadata(e)}catch(n){throw n.message==="INVALID"?new zd("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new zd("Error: cannot restore image")}else if("text"in Blob?t=await e.text():t=await new Promise(n=>{const i=new FileReader;i.readAsText(e,"utf8"),i.onloadend=()=>{i.readyState===FileReader.DONE&&n(i.result)}}),e.type===ve.svg)try{return K5e({svg:t})}catch(n){throw n.message==="INVALID"?new zd("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new zd("Error: cannot restore image")}return t},UX=e=>{var t;return e&&((t=e.name.match(/\.(json|excalidraw|png|svg)$/))==null?void 0:t[1])||null},sye=e=>e==="png"||e==="svg",DT=e=>{const t=UX(e);return t==="png"||t==="svg"},bX=e=>!!e&&Object.values(Oh).includes(e),V0=e=>{const{type:t}=e||{};return bX(t)},yX=async(e,t,n,i)=>{const s=await pX(e);let r;try{try{r=JSON.parse(s)}catch(o){throw V0(e)?new zd("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):o}if(z5e(r))return{type:ve.excalidraw,data:ku({elements:r.elements||[],appState:{theme:t==null?void 0:t.theme,fileHandle:i||e.handle||null,...oG(r.appState||{}),...t?C0(r.elements||[],t):{}},files:r.files},t,n,{repairBindings:!0,refreshDimensions:!1,deleteInvisibleElements:!0})};if(rX(r))return{type:ve.excalidrawlib,data:r};throw new Error("Error: invalid file")}catch(o){throw o instanceof zd?o:new Error("Error: invalid file")}},PT=async(e,t,n,i)=>{const s=await yX(e,t,n,i);if(s.type!==ve.excalidraw)throw new Error("Error: invalid file");return s.data},EX=(e,t="unpublished")=>{const n=JSON.parse(e);if(!rX(n))throw new Error("Invalid library");const i=n.libraryItems||n.library;return Xy(i,t)},rye=async(e,t="unpublished")=>EX(await pX(e),t),$0=async e=>new Promise(async(t,n)=>{try{Sp(e)&&(e=await e),e.toBlob(i=>{if(!i)return n(new ehe("Error: Canvas too big","CANVAS_POSSIBLY_TOO_BIG"));t(i)})}catch(i){n(i)}}),oye=async e=>{try{const t=await window.crypto.subtle.digest("SHA-1",await Wp(e));return rB(new Uint8Array(t))}catch(t){return console.error(t),MH(40)}},vX=async e=>new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const s=i.result;t(s)},i.onerror=s=>n(s),i.readAsDataURL(e)}),aye=(e,t)=>`data:${t};base64,${qG(j6(e),!0)}`,lye=e=>QG(e.slice(e.indexOf(",")+1)),_X=async(e,t)=>{if(e.type===ve.svg)return e;const[n,i]=await Promise.all([pe(()=>import("./pica-W-nGnTwG.js").then(r=>r.p),__vite__mapDeps([2,3])).then(r=>r.default),pe(()=>import("./image-blob-reduce.esm-B6b2_-a4.js"),__vite__mapDeps([])).then(r=>r.default)]),s=i({pica:n({features:["js","wasm"]})});if(t.outputType){const{outputType:r}=t;s._create_blob=function(o){return this.pica.toBlob(o.out_canvas,r,.8).then(a=>(o.out_blob=a,o))}}if(!V0(e))throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"});return new File([await s.toBlob(e,{max:t.maxWidthOrHeight,alpha:!0})],e.name,{type:t.outputType||e.type})},BR=(e,t="")=>new File([new TextEncoder().encode(e)],t,{type:ve.svg}),cye=async(e,t="")=>{let n;try{n=await fetch(e)}catch{throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"})}if(!n.ok)throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"});const i=await n.blob();if(i.type&&V0(i)){const s=t||i.name||"";return new File([i],s,{type:i.type})}throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"})},dye=async e=>{var t,n;if(Zu)try{return await(e instanceof DataTransferItem?e:(n=(t=e.dataTransfer)==null?void 0:t.items)==null?void 0:n[0]).getAsFileSystemHandle()||null}catch(i){return console.warn(i.name,i.message),null}return null},uye=async e=>{let t=null;const n=[...new Uint8Array(await Wp(e.slice(0,15)))].join(" "),i={png:/^137 80 78 71 13 10 26 10\b/,jpg:/^255 216 255\b/,gif:/^71 73 70 56 57 97\b/,webp:/^82 73 70 70 \d+ \d+ \d+ \d+ 87 69 66 80 86 80 56\b/};for(const s of Object.keys(i))if(n.match(i[s])){t=ve[s];break}return t||e.type||null},db=(e,t,n)=>new File([e],n||"",{type:t}),zR=Symbol("fileNormalized"),G0=async e=>{var t,n,i;if(e[zR])return e;if((t=e==null?void 0:e.name)!=null&&t.endsWith(".excalidrawlib"))e=db(e,ve.excalidrawlib,e.name);else if((n=e==null?void 0:e.name)!=null&&n.endsWith(".excalidraw"))e=db(e,ve.excalidraw,e.name);else if(!e.type||(i=e.type)!=null&&i.startsWith("image/")){const s=await uye(e);s&&s!==e.type&&(e=db(e,s,e.name))}return e[zR]=!0,e},Wp=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,n)=>{const i=new FileReader;i.onload=s=>{var r;if(!((r=s.target)!=null&&r.result))return n(new Error("Couldn't convert blob to ArrayBuffer"));t(s.target.result)},i.readAsArrayBuffer(e)}),so=32,zt=12,Mc=256,wX=50,Dd="NOT_SPREADSHEET",X0="VALID_SPREADSHEET",em=e=>{const t=/^([-+]?)[$]?([-+]?)([\d.,]+)[%]?$/.exec(e);return t?parseFloat(`${(t[1]||t[2])+t[3]}`.replace(/,/g,"")):null},C3=(e,t)=>e.slice(1).every(n=>em(n[t])!==null),HR=e=>{const t=e[0].length;if(t>2)return{type:Dd,reason:"More than 2 columns"};if(t===1){if(!C3(e,0))return{type:Dd,reason:"Value is not numeric"};const l=em(e[0][0])===null,c=(l?e.slice(1):e).map(d=>em(d[0]));return c.length<2?{type:Dd,reason:"Less than two rows"}:{type:X0,spreadsheet:{title:l?e[0][0]:null,labels:null,values:c}}}const n=C3(e,0),i=C3(e,1);if(!n&&!i)return{type:Dd,reason:"Value is not numeric"};const[s,r]=i?[0,1]:[1,0],o=em(e[0][r])===null,a=o?e.slice(1):e;return a.length<2?{type:Dd,reason:"Less than 2 rows"}:{type:X0,spreadsheet:{title:o?e[0][r]:null,labels:a.map(l=>l[s]),values:a.map(l=>em(l[r]))}}},fye=e=>{const t=[];for(let n=0;n<e[0].length;n++){const i=[];for(let s=0;s<e.length;s++)i.push(e[s][n]);t.push(i)}return t},hye=e=>{let t=e.trim().split(`
`).map(r=>r.trim().split("	"));if(t.length&&t[0].length!==2&&(t=e.trim().split(`
`).map(r=>r.trim().split(","))),t.length===0)return{type:Dd,reason:"No values"};const n=t[0].length;if(!t.every(r=>r.length===n))return{type:Dd,reason:"All rows don't have same number of columns"};const s=HR(t);if(s.type!==X0){const r=HR(fye(t));if(r.type===X0)return r}return s},K6=see(tee),mo={fillStyle:"hachure",fontFamily:ad,fontSize:Cl,opacity:100,roughness:1,strokeColor:Ke.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:qs.MIDDLE,locked:!1},TX=e=>{const t=(so+zt)*e.values.length+zt,n=Mc+zt*2;return{chartWidth:t,chartHeight:n}},gye=(e,t,n,i,s)=>{var r;return((r=e.labels)==null?void 0:r.map((o,a)=>cr({groupIds:[i],backgroundColor:s,...mo,text:o.length>8?`${o.slice(0,5)}...`:o,x:t+a*(so+zt)+zt*2,y:n+zt/2,width:so,angle:5.87,fontSize:16,textAlign:"center",verticalAlign:"top"})))||[]},mye=(e,t,n,i,s)=>{const r=cr({groupIds:[i],backgroundColor:s,...mo,x:t-zt,y:n-zt,text:"0",textAlign:"right"}),o=cr({groupIds:[i],backgroundColor:s,...mo,x:t-zt,y:n-Mc-r.height/2,text:Math.max(...e.values).toLocaleString(),textAlign:"right"});return[r,o]},pye=(e,t,n,i,s)=>{const{chartWidth:r,chartHeight:o}=TX(e),a=Sc({backgroundColor:s,groupIds:[i],...mo,type:"line",x:t,y:n,width:r,points:[C(0,0),C(r,0)]}),l=Sc({backgroundColor:s,groupIds:[i],...mo,type:"line",x:t,y:n,height:o,points:[C(0,0),C(0,-280)]}),c=Sc({backgroundColor:s,groupIds:[i],...mo,type:"line",x:t,y:n-Mc-zt,strokeStyle:"dotted",width:r,opacity:wX,points:[C(0,0),C(r,0)]});return[a,l,c]},IX=(e,t,n,i,s,r)=>{const{chartWidth:o}=TX(e),a=e.title?cr({backgroundColor:s,groupIds:[i],...mo,text:e.title,x:t+o/2,y:n-Mc-zt*2-Cl,roundness:null,textAlign:"center"}):null;return[...a?[a]:[],...gye(e,t,n,i,s),...mye(e,t,n,i,s),...pye(e,t,n,i,s)]},Uye=(e,t,n)=>{const i=Math.max(...e.values),s=ys(),r=K6[Math.floor(Math.random()*K6.length)];return[...e.values.map((a,l)=>{const c=a/i*Mc;return aa({backgroundColor:r,groupIds:[s],...mo,type:"rectangle",x:t+l*(so+zt)+zt,y:n-c-zt,width:so,height:c})}),...IX(e,t,n,s,r)]},bye=(e,t,n)=>{const i=Math.max(...e.values),s=ys(),r=K6[Math.floor(Math.random()*K6.length)];let o=0;const a=[];for(const p of e.values){const U=o*(so+zt),b=-(p/i)*Mc;a.push([U,b]),o++}const l=Math.max(...a.map(p=>p[0])),c=Math.max(...a.map(p=>p[1])),d=Math.min(...a.map(p=>p[0])),u=Math.min(...a.map(p=>p[1])),f=Sc({backgroundColor:r,groupIds:[s],...mo,type:"line",x:t+zt+so/2,y:n-zt,height:c-u,width:l-d,strokeWidth:2,points:a}),h=e.values.map((p,U)=>{const b=U*(so+zt)+zt/2,y=-(p/i)*Mc+zt/2;return aa({backgroundColor:r,groupIds:[s],...mo,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:t+b+so/2,y:n+y-zt*2,width:zt,height:zt})}),m=e.values.map((p,U)=>{const b=U*(so+zt)+zt/2,y=p/i*Mc+zt/2+zt;return Sc({backgroundColor:r,groupIds:[s],...mo,type:"line",x:t+b+so/2+zt/2,y:n-y,height:y,strokeStyle:"dotted",opacity:wX,points:[C(0,0),C(0,y)]})});return[...IX(e,t,n,s,r),f,...m,...h]},yye=(e,t,n,i)=>e==="line"?bye(t,n,i):Uye(t,n,i),NT="clipboard"in navigator&&"writeText"in navigator.clipboard,OT="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,Eye=e=>!!([kr.excalidraw,kr.excalidrawClipboard,kr.excalidrawClipboardWithAPI].includes(e==null?void 0:e.type)&&Array.isArray(e.elements)),vye=({types:e,files:t})=>{var i,s,r,o,a;!e&&!t&&console.warn("createPasteEvent: no types or files provided");const n=new ClipboardEvent(te.PASTE,{clipboardData:new DataTransfer});if(e)for(const[l,c]of Object.entries(e)){if(typeof c!="string"){t=t||[],t.push(c),(i=n.clipboardData)==null||i.items.add(c);continue}try{if((s=n.clipboardData)==null||s.items.add(c,l),((r=n.clipboardData)==null?void 0:r.getData(l))!==c)throw new Error(`Failed to set "${l}" as clipboardData item`)}catch(d){throw new Error(d.message)}}if(t){let l=-1;for(const c of t){l++;try{if((o=n.clipboardData)==null||o.items.add(c),((a=n.clipboardData)==null?void 0:a.files[l])!==c)throw new Error(`Failed to set file "${c.name}" as clipboardData item`)}catch(d){throw new Error(d.message)}}}return n},_ye=({elements:e,files:t})=>{const n=be(e),i=new Set(e.filter(a=>Ue(a)));let s=!1;const r=e.reduce((a,l)=>(On(l)&&(s=!0,t&&t[l.fileId]&&(a[l.fileId]=t[l.fileId])),a),{});s&&!t&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object.");const o={type:kr.excalidrawClipboard,elements:e.map(a=>{if(Ls(a,n)&&!i.has(Ls(a,n))){const l=Gc(a);return Cn(l,n,{frameId:null}),l}return a}),files:t?r:void 0};return JSON.stringify(o)},wye=async(e,t,n)=>{await gd(_ye({elements:e,files:t}),n)},Tye=e=>{const t=hye(e);return t.type===X0?{spreadsheet:t.spreadsheet}:null};function SX(e){var n;let t=[];for(const i of e.childNodes)if(i.nodeType===3){const s=(n=i.textContent)==null?void 0:n.trim();s&&t.push({type:"text",value:s})}else if(i instanceof HTMLImageElement){const s=i.getAttribute("src");s&&s.startsWith("http")&&t.push({type:"imageUrl",value:s})}else t=t.concat(SX(i));return t}const Iye=e=>{const t=e.value;try{const n=new DOMParser().parseFromString(t,ve.html),i=SX(n.body);if(i.length)return{type:"mixedContent",value:i}}catch(n){console.error(`error in parseHTMLFromPaste: ${n.message}`)}return null},Sye=async()=>{var n,i,s,r;const e={};let t;try{t=await((n=navigator.clipboard)==null?void 0:n.read())}catch(o){try{if((i=navigator.clipboard)!=null&&i.readText){console.warn(`navigator.clipboard.readText() failed (${o.message}). Failling back to navigator.clipboard.read()`);const a=await((s=navigator.clipboard)==null?void 0:s.readText());if(a)return{[ve.text]:a}}}catch(a){if((r=navigator.clipboard)!=null&&r.read)console.warn(`navigator.clipboard.readText() failed (${a.message}). Failling back to navigator.clipboard.read()`);else{if(a.name==="DataError")return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${a.message}`),e;throw a}}throw o}for(const o of t)for(const a of o.types)if(aB(Uee,a))try{if(a===ve.text||a===ve.html)e[a]=await(await o.getType(a)).text();else if(bX(a)){const l=await o.getType(a),c=db(l,a,void 0);e[a]=c}else throw new ao(`Unsupported clipboard type: ${a}`)}catch(l){console.warn(l instanceof ao?l.message:`Cannot retrieve ${a} from clipboardItem: ${l.message}`)}return Object.keys(e).length===0&&console.warn("No clipboard data found from clipboard.read()."),e},xye=async(e,t=!1)=>{try{const n=e.findByType(ve.html),i=!t&&n&&Iye(n);return i?i.value.every(s=>s.type==="text")?{type:"text",value:e.getData(ve.text)??i.value.map(s=>s.value).join(`
`).trim()}:i:{type:"text",value:(e.getData(ve.text)||"").trim()}}catch{return{type:"text",value:""}}},Cye=function(e){return this.find(t=>t.type===e)||null},Aye=function(e){const t=this.find(n=>n.type===e);return(t==null?void 0:t.value)??null},Mye=function(){return this.filter(e=>e.kind==="file")},Iv=async e=>{var i,s;let t;Dye(e)?t=(i=e.clipboardData)==null?void 0:i.items:t=(s=e.dataTransfer)==null?void 0:s.items;const n=(await Promise.all(Array.from(t||[]).map(async r=>{var o;if(r.kind==="file"){let a=r.getAsFile();if(a){const l=await dye(r);return a=await G0(a),{type:a.type,kind:"file",file:a,fileHandle:l}}}else if(r.kind==="string"){const{type:a}=r;let l;return"clipboardData"in e&&e.clipboardData?l=(o=e.clipboardData)==null?void 0:o.getData(a):l=await new Promise(c=>{r.getAsString(d=>c(d))}),{type:a,kind:"string",value:l}}return null}))).filter(r=>r!=null);return Object.assign(n,{findByType:Cye,getData:Aye,getFiles:Mye})},kye=async(e,t=!1)=>{const n=await xye(e,t);if(n.type==="mixedContent")return{mixedContent:n.value};try{const i=!t&&Tye(n.value);if(i)return i}catch(i){console.error(i)}try{const i=JSON.parse(n.value),s=i.type===kr.excalidrawClipboardWithAPI;if(Eye(i))return{elements:i.elements,files:i.files,text:t?JSON.stringify(i.elements,null,2):void 0,programmaticAPI:s}}catch{}return{text:n.value}},Rye=async e=>{try{await navigator.clipboard.write([new window.ClipboardItem({[ve.png]:e})])}catch(t){if(Sp(e))await navigator.clipboard.write([new window.ClipboardItem({[ve.png]:await e})]);else throw t}},gd=async(e,t)=>{var n,i;if(NT)try{await navigator.clipboard.writeText(e||"");return}catch(s){console.error(s)}try{if(t){if((n=t.clipboardData)==null||n.setData(ve.text,e||""),((i=t.clipboardData)==null?void 0:i.getData(ve.text))!==e)throw new Error("Failed to setData on clipboardEvent");return}}catch(s){console.error(s)}if(!Lye(e))throw new Error("Error copying to clipboard.")},Lye=e=>{e||(e=" ");const t=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";const i=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${i}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);let s=!1;try{n.select(),n.setSelectionRange(0,n.value.length),s=document.execCommand("copy")}catch(r){console.error(r)}return n.remove(),s},Dye=e=>e.type===te.PASTE||e.type===te.COPY||e.type===te.CUT,jy=(e,{selectedElementIds:t},n)=>{e=Yt(e);const i=n&&Qn(e,{selectedElementIds:t});let s=null,r=i?Ye(e,{selectedElementIds:t},{includeBoundTextElement:!0}):e;return i&&(r.length===1&&Ue(r[0])?(s=r[0],r=ow(e,s)):r.length>1&&(r=Ye(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}))),{exportingFrame:s,exportedElements:Ja(r)}},Yy=async(e,t,n,i,{exportBackground:s,exportPadding:r=Sg,viewBackgroundColor:o,name:a=n.name||NF,fileHandle:l=null,exportingFrame:c=null})=>{if(t.length===0)throw new Error(M("alerts.cannotExportEmptyCanvas"));if(e==="svg"||e==="clipboard-svg"){const u=RT(t,{exportBackground:s,exportWithDarkMode:n.exportWithDarkMode,viewBackgroundColor:o,exportPadding:r,exportScale:n.exportScale,exportEmbedScene:n.exportEmbedScene&&e==="svg"},i,{exportingFrame:c});if(e==="svg")return W6(u.then(f=>new Blob([Iee+f.outerHTML],{type:ve.svg})),{description:"Export to SVG",name:a,extension:n.exportEmbedScene?"excalidraw.svg":"svg",mimeTypes:[Oh.svg],fileHandle:l});if(e==="clipboard-svg"){const f=await u.then(h=>h.outerHTML);try{await gd(f)}catch{throw new Error(M("errors.copyToSystemClipboardFailed"))}return}}const d=gX(t,n,i,{exportBackground:s,viewBackgroundColor:o,exportPadding:r,exportingFrame:c});if(e==="png"){let u=$0(d);return n.exportEmbedScene&&(u=u.then(f=>pe(()=>Promise.resolve().then(()=>YX),void 0).then(({encodePngMetadata:h})=>h({blob:f,metadata:zg(t,n,i,"local")})))),W6(u,{description:"Export to PNG",name:a,extension:n.exportEmbedScene?"excalidraw.png":"png",mimeTypes:[Oh.png],fileHandle:l})}else if(e==="clipboard")try{const u=$0(d);await Rye(u)}catch(u){throw console.warn(u),u.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):U0&&u.name==="TypeError"?new Error(`${M("alerts.couldNotCopyToClipboard")}

${M("hints.firefox_clipboard_write")}`):new Error(M("alerts.couldNotCopyToClipboard"))}else throw new Error("Unsupported export type")},Pye=async(e,t,n,i)=>{const{exportBackground:s,viewBackgroundColor:r,fileHandle:o}=t,a=UX(o);if(!o||!sye(a))throw new Error("fileHandle should exist and should be of type svg or png when resaving");t={...t,exportEmbedScene:!0};const{exportedElements:l,exportingFrame:c}=jy(e,t,!1);return await Yy(a,l,t,n,{exportBackground:s,viewBackgroundColor:r,name:i,fileHandle:o,exportingFrame:c}),{fileHandle:o}},Nye=ue({name:"changeProjectName",label:"labels.fileTitle",trackEvent:!1,perform:(e,t,n)=>({appState:{...t,name:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t,appProps:n,data:i,app:s})=>g(J2e,{label:M("labels.fileTitle"),value:s.getName(),onChange:r=>t(r),ignoreFocus:(i==null?void 0:i.ignoreFocus)??!1})}),Oye=ue({name:"changeExportScale",label:"imageExportDialog.scale",trackEvent:{category:"export",action:"scale"},perform:(e,t,n)=>({appState:{...t,exportScale:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=Yt(e),r=Qn(i,t)?Ye(i,t):i;return g(he,{children:T_.map(o=>{const[a,l]=Z5e(r,Sg,o),c=`${M("imageExportDialog.label.scale")} ${o}x (${a}x${l})`;return g(We,{size:"small",type:"radio",icon:`${o}x`,name:"export-canvas-scale",title:c,"aria-label":c,id:"export-canvas-scale",checked:o===t.exportScale,onChange:()=>n(o)},o)})})}}),Fye=ue({name:"changeExportBackground",label:"imageExportDialog.label.withBackground",trackEvent:{category:"export",action:"toggleBackground"},perform:(e,t,n)=>({appState:{...t,exportBackground:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g(wT,{checked:e.exportBackground,onChange:n=>t(n),children:M("imageExportDialog.label.withBackground")})}),xX=ue({name:"changeExportEmbedScene",label:"imageExportDialog.tooltip.embedScene",trackEvent:{category:"export",action:"embedScene"},perform:(e,t,n)=>({appState:{...t,exportEmbedScene:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>N(wT,{checked:e.exportEmbedScene,onChange:n=>t(n),children:[M("imageExportDialog.label.embedScene"),g(vl,{label:M("imageExportDialog.tooltip.embedScene"),long:!0,children:g("div",{className:"excalidraw-tooltip-icon",children:kue})})]})}),Z6=ue({name:"saveToActiveFile",label:"buttons.save",icon:Ey,trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.saveToActiveFile&&!!t.fileHandle&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{const s=!!t.fileHandle;try{const{fileHandle:r}=DT(t.fileHandle)?await Pye(e,t,i.files,i.getName()):await sX(e,t,i.files,i.getName());return{captureUpdate:q.EVENTUALLY,appState:{...t,fileHandle:r,toast:s?{message:r!=null&&r.name?M("toast.fileSavedToFilename").replace("{filename}",`"${r.name}"`):M("toast.fileSaved")}:null}}}catch(r){return(r==null?void 0:r.name)!=="AbortError"?console.error(r):console.warn(r),{captureUpdate:q.EVENTUALLY}}},keyTest:e=>e.key===$.S&&e[$.CTRL_OR_CMD]&&!e.shiftKey}),CX=ue({name:"saveFileToDisk",label:"exportDialog.disk_title",icon:Ey,viewMode:!0,trackEvent:{category:"export"},perform:async(e,t,n,i)=>{try{const{fileHandle:s}=await sX(e,{...t,fileHandle:null},i.files,i.getName());return{captureUpdate:q.EVENTUALLY,appState:{...t,openDialog:null,fileHandle:s,toast:{message:M("toast.fileSaved")}}}}catch(s){return(s==null?void 0:s.name)!=="AbortError"?console.error(s):console.warn(s),{captureUpdate:q.EVENTUALLY}}},keyTest:e=>e.key===$.S&&e.shiftKey&&e[$.CTRL_OR_CMD],PanelComponent:({updateData:e})=>g(We,{type:"button",icon:xue,title:M("buttons.saveAs"),"aria-label":M("buttons.saveAs"),showAriaLabel:Hn().formFactor==="phone",hidden:!Zu,onClick:()=>e(null),"data-testid":"save-as-button"})}),Sv=ue({name:"loadScene",label:"buttons.load",trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.loadScene&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{try{const{elements:s,appState:r,files:o}=await B5e(t,e);return{elements:s,appState:r,files:o,captureUpdate:q.IMMEDIATELY}}catch(s){return(s==null?void 0:s.name)==="AbortError"?(console.warn(s),!1):{elements:e,appState:{...t,errorMessage:s.message},files:i.files,captureUpdate:q.EVENTUALLY}}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.O}),Bye=ue({name:"exportWithDarkMode",label:"imageExportDialog.label.darkMode",trackEvent:{category:"export",action:"toggleTheme"},perform:(e,t,n)=>({appState:{...t,exportWithDarkMode:n},captureUpdate:q.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"-45px",marginBottom:"10px"},children:g(Q2e,{value:e.exportWithDarkMode?Se.DARK:Se.LIGHT,onChange:n=>{t(n===Se.DARK)},title:M("imageExportDialog.label.darkMode")})})});let AX="{}";const zye=ue({name:"copyStyles",label:"labels.copyStyles",icon:VV,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=[],r=e.find(o=>t.selectedElementIds[o.id]);if(s.push(r),r&&Fi(r)){const o=Re(r,i.scene.getNonDeletedElementsMap());s.push(o)}return r&&(AX=JSON.stringify(s)),{appState:{...t,toast:{message:M("toast.copyStyles")}},captureUpdate:q.EVENTUALLY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.C}),Hye=ue({name:"pasteStyles",label:"labels.pasteStyles",icon:VV,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=JSON.parse(AX),r=s[0],o=s[1];if(!IB(r))return{elements:e,captureUpdate:q.EVENTUALLY};const a=Ye(e,t,{includeBoundTextElement:!0}),l=a.map(c=>c.id);return{elements:e.map(c=>{if(l.includes(c.id)){let d=r;if(fe(c)&&c.containerId&&(d=o),!d)return c;let u=Te(c,{backgroundColor:d==null?void 0:d.backgroundColor,strokeWidth:d==null?void 0:d.strokeWidth,strokeColor:d==null?void 0:d.strokeColor,strokeStyle:d==null?void 0:d.strokeStyle,fillStyle:d==null?void 0:d.fillStyle,opacity:d==null?void 0:d.opacity,roughness:d==null?void 0:d.roughness,roundness:d.roundness?Zne(d.roundness.type,c)?d.roundness:qne(c):null});if(fe(u)){const f=d.fontSize||Cl,h=d.fontFamily||ad;u=Te(u,{fontSize:f,fontFamily:h,textAlign:d.textAlign||Ep,lineHeight:d.lineHeight||zc(h)});let m=null;u.containerId&&(m=a.find(p=>fe(u)&&p.id===u.containerId)||null),ns(u,m,i.scene)}return u.type==="arrow"&&_e(d)&&(u=Te(u,{startArrowhead:d.startArrowhead,endArrowhead:d.endArrowhead})),Ue(c)&&(u=Te(u,{roundness:null,backgroundColor:"transparent"})),u}return c}),captureUpdate:q.IMMEDIATELY}},keyTest:e=>e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.V}),FT=ue({name:"toggleShortcuts",label:"welcomeScreen.defaults.helpHint",icon:Tue,viewMode:!0,trackEvent:{category:"menu",action:"toggleHelpDialog"},perform:(e,t,n,{focusContainer:i})=>{var s,r;return((s=t.openDialog)==null?void 0:s.name)==="help"&&i(),{appState:{...t,openDialog:((r=t.openDialog)==null?void 0:r.name)==="help"?null:{name:"help"},openMenu:null,openPopup:null},captureUpdate:q.EVENTUALLY}},keyTest:e=>e.key===$.QUESTION_MARK}),Vye=e=>{if(e.length>=2){const t=e[0].groupIds;for(const n of t)if(e.reduce((i,s)=>i&&w0(s,n),!0))return!0}return!1},VR=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});return i.length>=2&&!Vye(i)&&!iz(i)},$ye=ue({name:"group",label:"labels.group",icon:e=>g(ok,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=sw(i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}));if(s.length<2)return{appState:t,elements:e,captureUpdate:q.EVENTUALLY};const r=Ic(t);if(r.length===1){const U=r[0],b=new Set(Lt(e,U).map(_=>_.id)),y=new Set(s.map(_=>_.id));if(new Set([...Array.from(b),...Array.from(y)]).size===b.size)return{appState:t,elements:e,captureUpdate:q.EVENTUALLY}}let o=[...e];new Set(s.map(U=>U.frameId)).size>1&&Use(s).forEach((b,y)=>{sy(b,i.scene.getNonDeletedElementsMap())});const l=ys(),c=be(s);o=o.map(U=>c.get(U.id)?Te(U,{groupIds:use(U.groupIds,l,t.editingGroupId)}):U);const d=Lt(o,l),u=d[d.length-1],f=o.lastIndexOf(u),h=o.slice(f+1),m=o.slice(0,f).filter(U=>!w0(U,l)),p=bo([...m,...d,...h],be(d));return{appState:{...t,...WB(l,{...t,selectedGroupIds:{}},Yt(o))},elements:p,captureUpdate:q.IMMEDIATELY}},predicate:(e,t,n,i)=>VR(e,t,i),keyTest:e=>!e.shiftKey&&e[$.CTRL_OR_CMD]&&e.key===$.G,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!VR(e,t,i),type:"button",icon:g(ok,{theme:t.theme}),onClick:()=>n(null),title:`${M("labels.group")}  ${Q("CtrlOrCmd+G")}`,"aria-label":M("labels.group"),visible:Qn(Yt(e),t)})}),Gye=ue({name:"ungroup",label:"labels.ungroup",icon:e=>g(ak,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=Ic(t),r=be(e);if(s.length===0)return{appState:t,elements:e,captureUpdate:q.EVENTUALLY};let o=[...e];const a=[];o=o.map(f=>{Nt(f)&&a.push(f.id);const h=fse(f.groupIds,t.selectedGroupIds);return h.length===f.groupIds.length?f:Te(f,{groupIds:h})});const l=xi(t,Yt(o),t,null),c=i.scene.getSelectedElements(t),d=new Set(c.filter(f=>f.frameId).map(f=>f.frameId));return iw(e).filter(f=>d.has(f.id)).forEach(f=>{f&&(o=Ag(o,Qo(o,f,t,r),f,i))}),l.selectedElementIds=Object.entries(l.selectedElementIds).reduce((f,[h,m])=>(m&&!a.includes(h)&&(f[h]=!0),f),{}),{appState:{...t,...l},elements:o,captureUpdate:q.IMMEDIATELY}},keyTest:e=>e.shiftKey&&e[$.CTRL_OR_CMD]&&e.key===$.G.toUpperCase(),predicate:(e,t)=>Ic(t).length>0,PanelComponent:({elements:e,appState:t,updateData:n})=>g(We,{type:"button",hidden:Ic(t).length===0,icon:g(ak,{theme:t.theme}),onClick:()=>n(null),title:`${M("labels.ungroup")}  ${Q("CtrlOrCmd+Shift+G")}`,"aria-label":M("labels.ungroup"),visible:Qn(Yt(e),t)})}),MX=(e,t,n,i,s,r,o)=>{e.beginPath(),e.moveTo(t+r,n),e.lineTo(t+i-r,n),e.quadraticCurveTo(t+i,n,t+i,n+r),e.lineTo(t+i,n+s-r),e.quadraticCurveTo(t+i,n+s,t+i-r,n+s),e.lineTo(t+r,n+s),e.quadraticCurveTo(t,n+s,t,n+s-r),e.lineTo(t,n+r),e.quadraticCurveTo(t,n,t+r,n),e.closePath(),e.fill(),o&&(e.strokeStyle=o),e.stroke()};function Xye(e){let t=0;if(e.length===0)return t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)-t+i}return t}const Wy=(e,t)=>`hsl(${Math.abs(Xye((t==null?void 0:t.id)||e))%37*10}, 100%, 83%)`,jye=e=>{var n;const t=(n=e==null?void 0:e.trim())==null?void 0:n.codePointAt(0);return(t?String.fromCodePoint(t):"?").toUpperCase()},Yye=({context:e,renderConfig:t,appState:n,normalizedWidth:i,normalizedHeight:s})=>{for(const[r,o]of t.remotePointerViewportCoords){let{x:a,y:l}=o;const c=n.collaborators.get(r);a-=n.offsetLeft,l-=n.offsetTop;const d=11,u=14,f=a<0||a>i-d||l<0||l>s-u;a=Math.max(a,0),a=Math.min(a,i-d),l=Math.max(l,0),l=Math.min(l,s-u);const h=Wy(r,c);e.save(),e.strokeStyle=h,e.fillStyle=h;const m=t.remotePointerUserStates.get(r),p=f||m===Fd.IDLE||m===Fd.AWAY;p&&(e.globalAlpha=.3),t.remotePointerButton.get(r)==="down"&&(e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=3,e.strokeStyle="#ffffff88",e.stroke(),e.closePath(),e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=h,e.stroke(),e.closePath());const U=n.theme===Se.DARK?"#2f6330":mee,b=c==null?void 0:c.isSpeaking;b&&(e.fillStyle=U,e.strokeStyle=U,e.lineWidth=10,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill()),e.fillStyle=OU,e.strokeStyle=OU,e.lineWidth=6,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill(),e.fillStyle=h,e.strokeStyle=h,e.lineWidth=2,e.lineJoin="round",e.beginPath(),p?(e.moveTo(a-1,l-1),e.lineTo(a-1,l+15),e.lineTo(a+5,l+10),e.lineTo(a+12,l+9),e.closePath(),e.fill()):(e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.fill(),e.stroke());const y=t.remotePointerUsernames.get(r)||"";if(!f&&y){e.font="600 12px sans-serif";const v=(b?a+0:a)+d/2,_=(b?l+0:l)+u+2,I=5,R=3,T=e.measureText(y),w=T.actualBoundingBoxDescent+T.actualBoundingBoxAscent,S=Math.max(w,12),x=v-1,k=_-1,P=T.width+2+I*2+2,D=S+2+R*2+2;if(e.roundRect?(e.beginPath(),e.roundRect(x,k,P,D,8),e.fillStyle=h,e.fill(),e.strokeStyle=OU,e.stroke(),b&&(e.beginPath(),e.roundRect(x-2,k-2,P+4,D+4,8),e.strokeStyle=U,e.stroke())):MX(e,x,k,P,D,8,OU),e.fillStyle=gee,e.fillText(y,v+I+1,_+R+T.actualBoundingBoxAscent+Math.floor((S-w)/2)+2),b){e.fillStyle=U;const j=8,G=8,V=5;e.fillRect(x+P+G,k+(D/2-j/2),2,j),e.fillRect(x+P+G+V,k+(D/2-j*2/2),2,j*2),e.fillRect(x+P+G+V*2,k+(D/2-j/2),2,j)}}e.restore(),e.closePath()}},$R=({color:e,onClick:t,name:n,src:i,className:s})=>{const r=jye(n),[o,a]=L.useState(!1),l=!o&&i,c=l?void 0:{background:e};return g("div",{className:le("Avatar",s),style:c,onClick:t,children:l?g("img",{className:"Avatar-img",src:i,alt:r,referrerPolicy:"no-referrer",onError:()=>a(!0)}):r})};ue({name:"goToCollaborator",label:"Go to a collaborator",viewMode:!0,trackEvent:{category:"collab"},perform:(e,t,n)=>{var i;return xe(n,"actionGoToCollaborator: collaborator should be defined when actionGoToCollaborator is called"),!n.socketId||((i=t.userToFollow)==null?void 0:i.socketId)===n.socketId||n.isCurrentUser?{appState:{...t,userToFollow:null},captureUpdate:q.EVENTUALLY}:{appState:{...t,userToFollow:{socketId:n.socketId,username:n.username||""},openMenu:t.openMenu==="canvas"?null:t.openMenu},captureUpdate:q.EVENTUALLY}},PanelComponent:({updateData:e,data:t,appState:n})=>{const{socketId:i,collaborator:s,withName:r,isBeingFollowed:o}=t,a=Wy(i,s),l=le({"is-followed":o,"is-current-user":s.isCurrentUser===!0,"is-speaking":s.isSpeaking,"is-in-call":s.isInCall,"is-muted":s.isMuted}),c=s.isInCall?s.isSpeaking?N("div",{className:"UserList__collaborator-status-icon-speaking-indicator",title:M("userList.hint.isSpeaking"),children:[g("div",{}),g("div",{}),g("div",{})]}):s.isMuted?g("div",{className:"UserList__collaborator-status-icon-microphone-muted",title:M("userList.hint.micMuted"),children:Dfe}):g("div",{title:M("userList.hint.inCall"),children:Lfe}):null;return r?N("div",{className:`dropdown-menu-item dropdown-menu-item-base UserList__collaborator ${l}`,style:{"--avatar-size":"1.5rem"},onClick:()=>e(s),children:[g($R,{color:a,onClick:()=>{},name:s.username||"",src:s.avatarUrl,className:l}),g("div",{className:"UserList__collaborator-name",children:s.username}),N("div",{className:"UserList__collaborator-status-icons","aria-hidden":!0,children:[o&&g("div",{className:"UserList__collaborator-status-icon-is-followed",title:M("userList.hint.followStatus"),children:Kw}),c]})]}):N("div",{className:`UserList__collaborator UserList__collaborator--avatar-only ${l}`,children:[g($R,{color:a,onClick:()=>{e(s)},name:s.username||"",src:s.avatarUrl,className:l}),c&&g("div",{className:"UserList__collaborator-status-icon",children:c})]})}});const Wye=ue({name:"addToLibrary",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});for(const r of PF)if(s.some(o=>o.type===r))return{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:M(`errors.libraryElementTypeError.${r}`)}};return i.library.getLatestLibrary().then(r=>i.library.setLibrary([{id:ys(),status:"unpublished",elements:s.map(Gc),created:Date.now()},...r])).then(()=>({captureUpdate:q.EVENTUALLY,appState:{...t,toast:{message:M("toast.addedToLibrary")}}})).catch(r=>({captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:r.message}}))},label:"labels.addToLibrary"}),Ps=(e,t)=>{const n=t.scene.getSelectedElements(e);return ny(n,t.scene.getNonDeletedElementsMap(),e).length>1&&!n.some(i=>Ue(i))},Hg=(e,t,n,i)=>{const s=n.scene.getSelectedElements(t),r=jse(s,i,n.scene,t),o=be(r);return Wh(e.map(a=>o.get(a.id)||a),t,n)};ue({name:"alignTop",label:"labels.alignTop",icon:ek,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Ps(t,i),perform:(e,t,n,i)=>({appState:t,elements:Hg(e,t,i,{position:"start",axis:"y"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_UP,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!Ps(t,i),type:"button",icon:ek,onClick:()=>n(null),title:`${M("labels.alignTop")}  ${Q("CtrlOrCmd+Shift+Up")}`,"aria-label":M("labels.alignTop"),visible:Qn(Yt(e),t)})});ue({name:"alignBottom",label:"labels.alignBottom",icon:tk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Ps(t,i),perform:(e,t,n,i)=>({appState:t,elements:Hg(e,t,i,{position:"end",axis:"y"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_DOWN,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!Ps(t,i),type:"button",icon:tk,onClick:()=>n(null),title:`${M("labels.alignBottom")}  ${Q("CtrlOrCmd+Shift+Down")}`,"aria-label":M("labels.alignBottom"),visible:Qn(Yt(e),t)})});ue({name:"alignLeft",label:"labels.alignLeft",icon:nk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Ps(t,i),perform:(e,t,n,i)=>({appState:t,elements:Hg(e,t,i,{position:"start",axis:"x"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_LEFT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!Ps(t,i),type:"button",icon:nk,onClick:()=>n(null),title:`${M("labels.alignLeft")}  ${Q("CtrlOrCmd+Shift+Left")}`,"aria-label":M("labels.alignLeft"),visible:Qn(Yt(e),t)})});ue({name:"alignRight",label:"labels.alignRight",icon:ik,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Ps(t,i),perform:(e,t,n,i)=>({appState:t,elements:Hg(e,t,i,{position:"end",axis:"x"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>e[$.CTRL_OR_CMD]&&e.shiftKey&&e.key===$.ARROW_RIGHT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!Ps(t,i),type:"button",icon:ik,onClick:()=>n(null),title:`${M("labels.alignRight")}  ${Q("CtrlOrCmd+Shift+Right")}`,"aria-label":M("labels.alignRight"),visible:Qn(Yt(e),t)})});ue({name:"alignVerticallyCentered",label:"labels.centerVertically",icon:sk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Ps(t,i),perform:(e,t,n,i)=>({appState:t,elements:Hg(e,t,i,{position:"center",axis:"y"}),captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!Ps(t,i),type:"button",icon:sk,onClick:()=>n(null),title:M("labels.centerVertically"),"aria-label":M("labels.centerVertically"),visible:Qn(Yt(e),t)})});ue({name:"alignHorizontallyCentered",label:"labels.centerHorizontally",icon:rk,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Ps(t,i),perform:(e,t,n,i)=>({appState:t,elements:Hg(e,t,i,{position:"center",axis:"x"}),captureUpdate:q.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!Ps(t,i),type:"button",icon:rk,onClick:()=>n(null),title:M("labels.centerHorizontally"),"aria-label":M("labels.centerHorizontally"),visible:Qn(Yt(e),t)})});const kX=(e,t)=>{const n=t.scene.getSelectedElements(e);return ny(n,t.scene.getNonDeletedElementsMap(),e).length>2&&!n.some(i=>Ue(i))},RX=(e,t,n,i)=>{const s=n.scene.getSelectedElements(t),r=Sre(s,n.scene.getNonDeletedElementsMap(),i,t),o=be(r);return Wh(e.map(a=>o.get(a.id)||a),t,n)};ue({name:"distributeHorizontally",label:"labels.distributeHorizontally",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:RX(e,t,i,{axis:"x"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.H,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!kX(t,i),type:"button",icon:Nue,onClick:()=>n(null),title:`${M("labels.distributeHorizontally")}  ${Q("Alt+H")}`,"aria-label":M("labels.distributeHorizontally"),visible:Qn(Yt(e),t)})});ue({name:"distributeVertically",label:"labels.distributeVertically",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:RX(e,t,i,{axis:"y"}),captureUpdate:q.IMMEDIATELY}),keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.V,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g(We,{hidden:!kX(t,i),type:"button",icon:Oue,onClick:()=>n(null),title:`${M("labels.distributeVertically")}  ${Q("Alt+V")}`,"aria-label":M("labels.distributeVertically"),visible:Qn(Yt(e),t)})});const Kye=ue({name:"flipHorizontal",label:"labels.flipHorizontal",icon:Ffe,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Wh(LX(e,i.scene.getNonDeletedElementsMap(),t,"horizontal",i),t,i),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===ot.H}),Zye=ue({name:"flipVertical",label:"labels.flipVertical",icon:Ofe,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Wh(LX(e,i.scene.getNonDeletedElementsMap(),t,"vertical",i),t,i),appState:t,captureUpdate:q.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===ot.V&&!e[$.CTRL_OR_CMD]}),LX=(e,t,n,i,s)=>{const r=Ye(Yt(e),n,{includeBoundTextElement:!0,includeElementsInFrames:!0}),o=qye(r,t,i,s),a=be(o);return e.map(l=>a.get(l.id)||l)},qye=(e,t,n,i)=>{if(e.every(f=>_e(f)&&(f.startBinding||f.endBinding)))return e.map(f=>{const h=f;return Te(h,{startArrowhead:h.endArrowhead,endArrowhead:h.startArrowhead})});const{midX:s,midY:r}=Dr(e);Pz(e,t,"nw",i.scene,new Map(Array.from(t.values()).map(f=>[f.id,Gc(f)])),{flipByX:n==="horizontal",flipByY:n==="vertical",shouldResizeFromCenter:!0,shouldMaintainAspectRatio:!0}),y4(e.filter(_e),i.scene,i.state);const{elbowArrows:o,otherElements:a}=e.reduce((f,h)=>ye(h)?{...f,elbowArrows:f.elbowArrows.concat(h)}:{...f,otherElements:f.otherElements.concat(h)},{elbowArrows:[],otherElements:[]}),{midX:l,midY:c}=Dr(e),[d,u]=[s-l,r-c];return a.forEach(f=>i.scene.mutateElement(f,{x:f.x+d,y:f.y+u})),o.forEach(f=>i.scene.mutateElement(f,{x:f.x+d,y:f.y+u})),e},ub=ue({name:"copy",label:"labels.copy",icon:iv,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});try{await wye(s,i.files,n)}catch(r){return{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:r.message}}}return{captureUpdate:q.EVENTUALLY}},keyTest:void 0}),GR=ue({name:"paste",label:"labels.paste",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{let s;try{s=await Sye()}catch(r){return r.name==="AbortError"||r.name==="NotAllowedError"?!1:(console.error(`actionPaste ${r.name}: ${r.message}`),U0?{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:M("hints.firefox_clipboard_write")}}:{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:M("errors.asyncPasteFailedOnRead")}})}try{i.pasteFromClipboard(vye({types:s}))}catch(r){return console.error(r),{captureUpdate:q.EVENTUALLY,appState:{...t,errorMessage:M("errors.asyncPasteFailedOnParse")}}}return{captureUpdate:q.EVENTUALLY}},keyTest:void 0}),XR=ue({name:"cut",label:"labels.cut",icon:vfe,trackEvent:{category:"element"},perform:(e,t,n,i)=>(ub.perform(e,t,n,i),KV.perform(e,t,null,i)),keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.X}),jR=ue({name:"copyAsSvg",label:"labels.copyAsSvg",icon:Bfe,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:q.EVENTUALLY};const{exportedElements:s,exportingFrame:r}=jy(e,t,!0);try{await Yy("clipboard-svg",s,t,i.files,{...t,exportingFrame:r,name:i.getName()});const o=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});return{appState:{toast:{message:M("toast.copyToClipboardAsSvg",{exportSelection:o.length?M("toast.selection"):M("toast.canvas"),exportColorScheme:t.exportWithDarkMode?M("buttons.darkMode"):M("buttons.lightMode")})}},captureUpdate:q.EVENTUALLY}}catch(o){return console.error(o),{appState:{errorMessage:o.message},captureUpdate:q.EVENTUALLY}}},predicate:e=>NT&&e.length>0,keywords:["svg","clipboard","copy"]}),YR=ue({name:"copyAsPng",label:"labels.copyAsPng",icon:zfe,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:q.EVENTUALLY};const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}),{exportedElements:r,exportingFrame:o}=jy(e,t,!0);try{return await Yy("clipboard",r,t,i.files,{...t,exportingFrame:o,name:i.getName()}),{appState:{...t,toast:{message:M("toast.copyToClipboardAsPng",{exportSelection:s.length?M("toast.selection"):M("toast.canvas"),exportColorScheme:t.exportWithDarkMode?M("buttons.darkMode"):M("buttons.lightMode")})}},captureUpdate:q.EVENTUALLY}}catch(a){return console.error(a),{appState:{...t,errorMessage:a.message},captureUpdate:q.EVENTUALLY}}},predicate:e=>OT&&e.length>0,keyTest:e=>e.code===ot.C&&e.altKey&&e.shiftKey,keywords:["png","clipboard","copy"]}),WR=ue({name:"copyText",label:"labels.copyText",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});try{gd(PB(s))}catch{throw new Error(M("errors.copyToSystemClipboardFailed"))}return{captureUpdate:q.EVENTUALLY}},predicate:(e,t,n,i)=>NT&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}).some(fe),keywords:["text","clipboard","copy"]}),KR=ue({name:"gridMode",icon:Gfe,keywords:["snap"],label:"labels.toggleGrid",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>e.gridModeEnabled},perform(e,t){return{appState:{...t,gridModeEnabled:!this.checked(t),objectsSnapModeEnabled:!1},captureUpdate:q.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[$.CTRL_OR_CMD]&&e.code===ot.QUOTE}),xv=ue({name:"zenMode",label:"buttons.zenMode",icon:Vfe,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.zenModeEnabled},perform(e,t){return{appState:{...t,zenModeEnabled:!this.checked(t)},captureUpdate:q.EVENTUALLY}},checked:e=>e.zenModeEnabled,predicate:(e,t,n,i)=>i.editorInterface.formFactor!=="phone"&&typeof n.zenModeEnabled>"u",keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.Z}),Qye=ue({name:"objectsSnapMode",label:"buttons.objectsSnapMode",icon:Hfe,viewMode:!1,trackEvent:{category:"canvas",predicate:e=>!e.objectsSnapModeEnabled},perform(e,t){return{appState:{...t,objectsSnapModeEnabled:!this.checked(t),gridModeEnabled:!1},captureUpdate:q.EVENTUALLY}},checked:e=>e.objectsSnapModeEnabled,predicate:(e,t,n)=>typeof n.objectsSnapModeEnabled>"u",keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.S}),Cv=ue({name:"stats",label:"stats.fullTitle",icon:Nfe,viewMode:!0,trackEvent:{category:"menu"},keywords:["edit","attributes","customize"],perform(e,t){return{appState:{...t,stats:{...t.stats,open:!this.checked(t)}},captureUpdate:q.EVENTUALLY}},checked:e=>e.stats.open,keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.SLASH}),Jye=ue({name:"unbindText",label:"labels.unbindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>i.scene.getSelectedElements(t).some(r=>Fi(r)),perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t),r=i.scene.getNonDeletedElementsMap();return s.forEach(o=>{var l;const a=Re(o,r);if(a){const{width:c,height:d}=qn(a.originalText,bt(a),a.lineHeight),u=Jne(o.id);AB(o.id);const{x:f,y:h}=dd(o,a,r);i.scene.mutateElement(a,{containerId:null,width:c,height:d,text:a.originalText,x:f,y:h}),i.scene.mutateElement(o,{boundElements:(l=o.boundElements)==null?void 0:l.filter(m=>m.id!==a.id),height:u||o.height})}}),{elements:e,appState:t,captureUpdate:q.IMMEDIATELY}}}),eEe=ue({name:"bindText",label:"labels.bindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);if(s.length===2){const r=fe(s[0])||fe(s[1]);let o;if(tu(s[0])?o=s[0]:tu(s[1])&&(o=s[1]),r&&o&&Re(o,i.scene.getNonDeletedElementsMap())===null)return!0}return!1},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);let r,o;fe(s[0])&&tu(s[1])?(r=s[0],o=s[1]):(r=s[1],o=s[0]),i.scene.mutateElement(r,{containerId:o.id,verticalAlign:qs.MIDDLE,textAlign:p0.CENTER,autoResize:!0,angle:_e(o)?0:(o==null?void 0:o.angle)??0}),i.scene.mutateElement(o,{boundElements:(o.boundElements||[]).concat({type:"text",id:r.id})});const a=o.height;return ns(r,o,i.scene),d6(o.id,a),{elements:tEe(e,o,r),appState:{...t,selectedElementIds:{[o.id]:!0}},captureUpdate:q.IMMEDIATELY}}}),tEe=(e,t,n)=>{const i=e.slice(),s=i.findIndex(o=>o.id===n.id);i.splice(s,1);const r=i.findIndex(o=>o.id===t.id);return i.splice(r+1,0,n),bo(i,be([t,n])),i},nEe=(e,t,n)=>{const i=e.slice(),s=i.findIndex(o=>o.id===t.id);i.splice(s,1);const r=i.findIndex(o=>o.id===n.id);return i.splice(r,0,t),bo(i,be([t,n])),i},iEe=ue({name:"wrapTextInContainer",label:"labels.createContainerFromText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t),r=s.some(o=>fe(o)&&!Nt(o));return s.length>0&&r},perform:(e,t,n,i)=>{var a;const s=i.scene.getSelectedElements(t);let r=e.slice();const o={};for(const l of s)if(fe(l)&&!Nt(l)){const c=aa({type:"rectangle",backgroundColor:t.currentItemBackgroundColor,boundElements:[...l.boundElements||[],{id:l.id,type:"text"}],angle:l.angle,fillStyle:t.currentItemFillStyle,strokeColor:t.currentItemStrokeColor,roughness:t.currentItemRoughness,strokeWidth:t.currentItemStrokeWidth,strokeStyle:t.currentItemStrokeStyle,roundness:t.currentItemRoundness==="round"?{type:$u("rectangle")?En.ADAPTIVE_RADIUS:En.PROPORTIONAL_RADIUS}:null,opacity:100,locked:!1,x:l.x-Wn,y:l.y-Wn,width:gu(l.width,"rectangle"),height:gu(l.height,"rectangle"),groupIds:l.groupIds,frameId:l.frameId});if((a=l.boundElements)!=null&&a.length){const d=l.boundElements.filter(f=>f.type==="arrow").map(f=>f.id);r.filter(f=>d.includes(f.id)).forEach(f=>{let h=f.startBinding,m=f.endBinding;(h==null?void 0:h.elementId)===l.id&&(h={...h,elementId:c.id}),(m==null?void 0:m.elementId)===l.id&&(m={...m,elementId:c.id}),(h||m)&&i.scene.mutateElement(f,{startBinding:h,endBinding:m})})}i.scene.mutateElement(l,{containerId:c.id,verticalAlign:qs.MIDDLE,boundElements:null,textAlign:p0.CENTER,autoResize:!0}),ns(l,c,i.scene),r=nEe([...r,c],c,l),o[c.id]=!0}return{elements:r,appState:{...t,selectedElementIds:o},captureUpdate:q.IMMEDIATELY}}}),BT=380,sEe=42,Av=5,DX=85,rEe=500;let Mv=!1;const f2=new Map,oEe=({element:e,scene:t,setAppState:n,onLinkOpen:i,setToast:s,updateEmbedValidationStatus:r})=>{const o=t.getNonDeletedElementsMap(),a=qp(),l=Zp(),c=Hn(),d=e.link||"",[u,f]=L.useState(d),h=L.useRef(null),m=a.showHyperlinkPopup==="editor",p=L.useCallback(()=>{var I;if(!h.current)return;const _=rr(h.current.value)||null;if(!e.link&&_&&it("hyperlink","create"),ds(e)){if(((I=a.activeEmbeddable)==null?void 0:I.element)===e&&n({activeEmbeddable:null}),!_){t.mutateElement(e,{link:null}),r(e,!1);return}if(!Y2(_,l.validateEmbeddable))_&&s({message:M("toast.unableToEmbed"),closable:!0}),e.link&&f2.set(e.id,e.link),t.mutateElement(e,{link:_}),r(e,!1);else{const{width:R,height:T}=e,w=Jf(_);(w==null?void 0:w.error)instanceof URIError&&s({message:M("toast.unrecognizedLinkFormat"),closable:!0});const S=w?w.intrinsicSize.w/w.intrinsicSize.h:1,x=f2.get(e.id)!==e.link;t.mutateElement(e,{...x?{width:(w==null?void 0:w.type)==="video"?R>T?R:T*S:R,height:(w==null?void 0:w.type)==="video"&&R>T?R/S:T}:{},link:_}),r(e,!0),f2.has(e.id)&&f2.delete(e.id)}}else t.mutateElement(e,{link:_})},[e,t,s,l.validateEmbeddable,a.activeEmbeddable,n,r]);L.useLayoutEffect(()=>()=>{p()},[p]),L.useEffect(()=>{m&&(h!=null&&h.current)&&!(c.formFactor==="phone"||c.isTouchScreen)&&h.current.select()},[m,c.formFactor,c.isTouchScreen]),L.useEffect(()=>{let _=null;const I=R=>{if(m)return;_&&clearTimeout(_),cEe(e,o,a,C(R.clientX,R.clientY))&&(_=window.setTimeout(()=>{n({showHyperlinkPopup:!1})},rEe))};return window.addEventListener(te.POINTER_MOVE,I,!1),()=>{window.removeEventListener(te.POINTER_MOVE,I,!1),_&&clearTimeout(_)}},[a,e,m,n,o]);const U=L.useCallback(()=>{it("hyperlink","delete"),t.mutateElement(e,{link:null}),n({showHyperlinkPopup:!1})},[n,e,t]),b=()=>{it("hyperlink","edit","popup-ui"),n({showHyperlinkPopup:"editor"})},{x:y,y:v}=PX(e,a,o);return a.contextMenu||a.selectedElementsAreBeingDragged||a.resizingElement||a.isRotating||a.openMenu||a.viewModeEnabled?null:N("div",{className:"excalidraw-hyperlinkContainer",style:{top:`${v}px`,left:`${y}px`,width:BT,padding:Av},children:[m?g("input",{className:le("excalidraw-hyperlinkContainer-input"),placeholder:M("labels.link.hint"),ref:h,value:u,onChange:_=>f(_.target.value),autoFocus:!0,onKeyDown:_=>{_.stopPropagation(),_[$.CTRL_OR_CMD]&&_.key===$.K&&_.preventDefault(),(_.key===$.ENTER||_.key===$.ESCAPE)&&(p(),n({showHyperlinkPopup:"info"}))}}):e.link?g("a",{href:rr(e.link||""),className:"excalidraw-hyperlinkContainer-link",target:fB(e.link)?"_self":"_blank",onClick:_=>{if(e.link&&i){const I=oB(te.EXCALIDRAW_LINK,_.nativeEvent);i({...e,link:rr(e.link)},I),I.defaultPrevented&&_.preventDefault()}},rel:"noopener noreferrer",children:e.link}):g("div",{className:"excalidraw-hyperlinkContainer-link",children:M("labels.link.empty")}),N("div",{className:"excalidraw-hyperlinkContainer__buttons",children:[!m&&g(We,{type:"button",title:M("buttons.edit"),"aria-label":M("buttons.edit"),label:M("buttons.edit"),onClick:b,className:"excalidraw-hyperlinkContainer--edit",icon:Hp}),g(We,{type:"button",title:M("labels.linkToElement"),"aria-label":M("labels.linkToElement"),label:M("labels.linkToElement"),onClick:()=>{n({openDialog:{name:"elementLinkSelector",sourceElementId:e.id}})},icon:jV}),d&&!ds(e)&&g(We,{type:"button",title:M("buttons.remove"),"aria-label":M("buttons.remove"),label:M("buttons.remove"),onClick:U,className:"excalidraw-hyperlinkContainer--remove",icon:Yc})]})]})},PX=(e,t,n)=>{const[i,s]=$e(e,n),{x:r,y:o}=Qs({sceneX:i+e.width/2,sceneY:s},t),a=r-t.offsetLeft-BT/2,l=o-t.offsetTop-DX;return{x:a,y:l}},ZR=(e,t)=>{var s;const n=Ye(e,t);return ds(n[0])?"labels.link.editEmbed":(s=n[0])!=null&&s.link?"labels.link.edit":"labels.link.create"};let Vm=null;const aEe=(e,t,n)=>{Vm&&clearTimeout(Vm),Vm=window.setTimeout(()=>lEe(e,t,n),wee)},lEe=(e,t,n)=>{if(!e.link)return;const i=Om();i.classList.add("excalidraw-tooltip--visible"),i.style.maxWidth="20rem",i.textContent=mh(e.link)?M("labels.link.goToElement"):e.link;const[s,r,o,a]=$e(e,n),[l,c,d,u]=MT([s,r,o,a],e.angle,t),f=Qs({sceneX:l,sceneY:c},t);aG(i,{left:f.x,top:f.y,width:d,height:u},"top"),it("hyperlink","tooltip","link-icon"),Mv=!0},qR=()=>{Vm&&clearTimeout(Vm),Mv&&(Mv=!1,Om().classList.remove("excalidraw-tooltip--visible"))},cEe=(e,t,n,[i,s])=>{const{x:r,y:o}=Dt({clientX:i,clientY:s},n),a=15/n.zoom.value;if(ey(C(r,o),e,t))return!1;const[l,c,d]=$e(e,t);if(r>=l&&r<=d&&o>=c-DX&&o<=c)return!1;const{x:u,y:f}=PX(e,n,t);return!(i>=u-a&&i<=u+BT+Av*2+a&&s>=f-a&&s<=f+a+Av*2+sEe)},NX=ue({name:"hyperlink",label:(e,t)=>ZR(e,t),icon:D6,perform:(e,t)=>t.showHyperlinkPopup==="editor"?!1:{elements:e,appState:{...t,showHyperlinkPopup:"editor",openMenu:null},captureUpdate:q.IMMEDIATELY},trackEvent:{category:"hyperlink",action:"click"},keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.K,predicate:(e,t)=>Ye(e,t).length===1,PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=Ye(e,t);return g(We,{type:"button",icon:D6,"aria-label":M(ZR(e,t)),title:`${ds(e[0])?M("labels.link.labelEmbed"):M("labels.link.label")} - ${Q("CtrlOrCmd+K")}`,onClick:()=>n(null),selected:i.length===1&&!!i[0].link})}}),A3=e=>e.every(t=>!t.locked),OX=ue({name:"toggleElementLock",label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1});return A3(i)?"labels.elementLock.lock":"labels.elementLock.unlock"},icon:(e,t)=>{const n=Ye(t,e);return A3(n)?Fw:by},trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return s.length>0&&!s.some(r=>r.locked&&r.frameId)},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});if(!s.length)return!1;const r=A3(s),o=be(s),a=s.length>1&&Q_(s),c=s.length===1||a?null:ys();let d={...t.lockedMultiSelections};if(r)d={...t.lockedMultiSelections,...c?{[c]:!0}:{}};else if(a){const b=s[0].groupIds.at(-1);delete d[b]}const u=e.map(b=>{if(!o.has(b.id))return b;let y=b.groupIds;return r?c&&(y=[...y,c]):y=y.filter(v=>!t.lockedMultiSelections[v]),Te(b,{locked:r,groupIds:y.length!==b.groupIds.length?y:b.groupIds})}),f=be(u),h=r?{}:Object.fromEntries(s.map(b=>[b.id,!0])),m=s.map(b=>f.get(b.id)||b),p=r?{}:Pp(m,t),U=r?c||(a?s[0].groupIds.at(-1):s[0].id):null;return{elements:u,appState:{...t,selectedElementIds:h,selectedGroupIds:p,selectedLinearElement:r?null:t.selectedLinearElement,lockedMultiSelections:d,activeLockedId:U},captureUpdate:q.IMMEDIATELY}},keyTest:(e,t,n,i)=>e.key.toLocaleLowerCase()===$.L&&e[$.CTRL_OR_CMD]&&e.shiftKey&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}).length>0}),dEe=ue({name:"unlockAllElements",trackEvent:{category:"canvas"},viewMode:!1,icon:by,predicate:(e,t)=>Ye(e,t).length===0&&e.some(i=>i.locked),perform:(e,t)=>{const n=e.filter(o=>o.locked),i=e.map(o=>{if(o.locked){const a=o.groupIds.filter(l=>!t.lockedMultiSelections[l]);return Te(o,{locked:!1,groupIds:o.groupIds.length!==a.length?a:o.groupIds})}return o}),s=be(i),r=n.map(o=>s.get(o.id)||o);return{elements:i,appState:{...t,selectedElementIds:Object.fromEntries(n.map(o=>[o.id,!0])),selectedGroupIds:Pp(r,t),lockedMultiSelections:{},activeLockedId:null},captureUpdate:q.IMMEDIATELY}},label:"labels.elementLock.unlockAll"});var FX={exports:{}};(function(e,t){(function(){var n={};e.exports=n,n.simpleFilter=function(i,s){return s.filter(function(r){return n.test(i,r)})},n.test=function(i,s){return n.match(i,s)!==null},n.match=function(i,s,r){r=r||{};var o=0,a=[],l=s.length,c=0,d=0,u=r.pre||"",f=r.post||"",h=r.caseSensitive&&s||s.toLowerCase(),m;i=r.caseSensitive&&i||i.toLowerCase();for(var p=0;p<l;p++)m=s[p],h[p]===i[o]?(m=u+m+f,o+=1,d+=1+d):d=0,c+=d,a[a.length]=m;return o===i.length?(c=h===i?1/0:c,{rendered:a.join(""),score:c}):null},n.filter=function(i,s,r){return!s||s.length===0?[]:typeof i!="string"?s:(r=r||{},s.reduce(function(o,a,l,c){var d=a;r.extract&&(d=r.extract(a));var u=n.match(i,d,r);return u!=null&&(o[o.length]={string:u.rendered,score:u.score,index:l,original:a}),o},[]).sort(function(o,a){var l=a.score-o.score;return l||o.index-a.index}))}})()})(FX);var uEe=FX.exports;const fEe=Sl(uEe),hEe=8,gEe=10,tm=["rectangle","diamond","ellipse"],nm=["line","sharpArrow","curvedArrow","elbowArrow"],mEe=new Set(tm),pEe=new Set(nm),og=e=>mEe.has(e),q6=e=>e==="arrow"||pEe.has(e),Da=Wt(null),j0=new Map,Y0=new Map,UEe=({app:e})=>{const t=e.scene.getSelectedElements(e.state),n=L.useRef(null);return L.useEffect(()=>{if(t.length===0){e.updateEditorAtom(Da,null);return}const i=Ky(t);i&&!n.current?n.current=i:(n.current&&!i||n.current&&i!==n.current)&&(e.updateEditorAtom(Da,null),n.current=null)},[t,e]),L.useEffect(()=>()=>{j0.clear(),Y0.clear()},[]),g(bEe,{app:e,elements:t})},bEe=({app:e,elements:t})=>{const n=Ky(t),i=L.useMemo(()=>n==="generic"?HX(t):[],[n,t]),s=L.useMemo(()=>n==="linear"?Rv(t):[],[n,t]),r=n==="generic"?i.every(u=>u.type===i[0].type):n==="linear"?s.every(u=>fh(u)===fh(s[0])):!1,[o,a]=L.useState({x:0,y:0}),l=L.useRef(""),c=L.useRef(null);L.useEffect(()=>{const u=[...i,...s].sort((U,b)=>U.id.localeCompare(b.id)),f=`
      ${e.state.scrollX}${e.state.scrollY}${e.state.offsetTop}${e.state.offsetLeft}${e.state.zoom.value}${u.map(U=>U.id).join(",")}`;if(f===l.current)return;l.current=f;let h;if(u.length===1){const[U,,,b,y,v]=$e(u[0],e.scene.getNonDeletedElementsMap());h=Z(C(U,b),C(y,v),u[0].angle)}else{const{minX:U,maxY:b}=Dr(u);h=C(U,b)}const{x:m,y:p}=Qs({sceneX:h[0],sceneY:h[1]},e.state);a({x:m,y:p})},[i,s,e.scene,e.state]),L.useEffect(()=>{for(const u of s){const f=kv(u.id,wEe(u));Y0.has(f)||Y0.set(f,u)}},[s]),L.useEffect(()=>{for(const u of i)if(!j0.has(u.id)){const f=Re(u,e.scene.getNonDeletedElementsMap());f&&j0.set(u.id,{fontSize:f.fontSize})}},[i,e.scene]);const d=n==="linear"?[["line",Vw],["sharpArrow",qw],["curvedArrow",Jw],["elbowArrow",Qw]]:n==="generic"?[["rectangle",Bw],["diamond",zw],["ellipse",Hw]]:[];return g("div",{ref:c,tabIndex:-1,style:{position:"absolute",top:`${o.y+(gEe+8)*e.state.zoom.value-e.state.offsetTop}px`,left:`${o.x-e.state.offsetLeft-hEe}px`,zIndex:2},className:bs.CONVERT_ELEMENT_TYPE_POPUP,children:d.map(([u,f])=>{const h=r&&(n==="generic"&&i[0].type===u||n==="linear"&&fh(s[0])===u);return g(We,{className:"Shape",type:"radio",icon:f,checked:h,name:"convertElementType-option",title:u,keyBindingLabel:"","aria-label":u,"data-testid":`toolbar-${u}`,onChange:()=>{var m;e.state.activeTool.type!==u&&it("convertElementType",u,"ui"),BX(e,{conversionType:n,nextType:u}),(m=c.current)==null||m.focus()}},`${t[0].id}${t[0].version}_${u}`)})})},yEe=(e,t,n)=>{const i=oa(e,t),s=Dp(e,t),r=cd(t.text,bt(t),i);let o=qn(r,bt(t),t.lineHeight),a=t.fontSize;for(;(o.width>i||o.height>s)&&a>0;){a-=1;const l={...t,fontSize:a};o=qn(t.text,bt(l),t.lineHeight)}Cn(t,n.getNonDeletedElementsMap(),{fontSize:a,width:o.width,height:o.height}),ns(t,e,n)},BX=(e,{conversionType:t,nextType:n,direction:i="right"})=>{var a;if(!t)return!1;const s=e.scene.getSelectedElements(e.state),r=s.reduce((l,c)=>({...l,[c.id]:!0}),{}),o=i==="right"?1:-1;if(t==="generic"){const l=HX(s),d=l.every(u=>u.type===l[0].type)?tm.indexOf(l[0].type):-1;if(n=n??tm[(d+tm.length+o)%tm.length],n&&og(n)){const u={};for(const h of l){const m=JR(h,n,e);u[m.id]=m}const f=[];for(const h of e.scene.getElementsIncludingDeleted())u[h.id]?f.push(u[h.id]):f.push(h);e.scene.replaceAllElements(f);for(const h of Object.values(u)){const m=Re(h,e.scene.getNonDeletedElementsMap());m&&(j0.get(h.id)&&Cn(m,e.scene.getNonDeletedElementsMap(),{fontSize:((a=j0.get(h.id))==null?void 0:a.fontSize)??m.fontSize}),yEe(h,m,e.scene))}e.setState(h=>({selectedElementIds:r,activeTool:qt(h,{type:"selection"})}))}}if(t==="linear"){const l=Rv(s);if(!n){const d=dB(l,fh),u=d?nm.indexOf(d):-1;n=nm[(u+nm.length+o)%nm.length]}if(q6(n)){const d=[],u=e.scene.getElementsMapIncludingDeleted();for(const f of l){const h=Y0.get(kv(f.id,n));if(h&&fh(h)===n)u.set(h.id,h),d.push(h);else{const m=JR(f,n,e);u.set(m.id,m),d.push(m)}}e.scene.replaceAllElements(u);for(const f of d)if(Ce(f))if(ye(f)){const h=EEe(f);if(h.length<2)continue;const m=[];for(let U=1;U<h.length-2;U++)m.push({start:h[U],end:h[U+1],index:U+1});const p=Cg(f,e.scene.getNonDeletedElementsMap(),{points:h,fixedSegments:m});Cn(f,e.scene.getNonDeletedElementsMap(),{...p,endArrowhead:"arrow"})}else{const h=Ite(["line","sharpArrow","curvedArrow"],m=>Y0.get(kv(f.id,m)));if(h){const m=h.points;e.scene.mutateElement(f,{points:m})}}}const c=Rv(e.scene.getSelectedElements(e.state));e.setState(d=>({selectedElementIds:r,selectedLinearElement:c.length===1?new re(c[0],e.scene.getNonDeletedElementsMap()):null,activeTool:qt(d,{type:"selection"})}))}return!0},Ky=e=>{if(e.length===0)return null;let t=!1;for(const n of e){if(og(n.type))return"generic";zX(n)&&(t=!0)}return t?"linear":null},zX=e=>Ce(e)&&(!_e(e)||!SB(e)&&!Fi(e)),kv=(e,t)=>`${e}:${t}`,HX=e=>e.filter(t=>og(t.type)),Rv=e=>e.filter(t=>zX(t)),h2=20,xf=(e,t)=>e[0]===t[0],M3=(e,t)=>e[1]===t[1],QR=(e,t)=>xf(e,t)?Math.abs(e[1]-t[1]):Math.abs(e[0]-t[0]),EEe=e=>{const t=[e.points[0]],n=vEe(e.points);for(let r=1;r<n.length;++r){const o=t[t.length-1],a=[...n[r]];Math.abs(a[0]-o[0])<h2?a[0]=o[0]:Math.abs(a[1]-o[1])<h2&&(a[1]=o[1]),xf(o,a)||M3(o,a)||t.push(C(o[0],a[1])),t.push(a)}const i=[t[0]];for(let r=1;r<t.length-1;++r)xf(t[r-1],t[r])&&xf(t[r],t[r+1])||M3(t[r-1],t[r])&&M3(t[r],t[r+1])||i.push(t[r]);i.push(t[t.length-1]);const s=[i[0]];for(let r=1;r<i.length-1;++r){const o=s[s.length-1],a=i[r],l=i[r+1],c=xf(o,a),d=xf(a,l);if(c!==d){const u=QR(o,a),f=QR(a,l);if(u<h2||f<h2){if(f<u)c?l[0]=o[0]:l[1]=o[1];else if(d)for(let h=s.length-1;h>=0&&s[h][0]===o[0];--h)s[h][0]=a[0];else for(let h=s.length-1;h>=0&&s[h][1]===o[1];--h)s[h][1]=a[1];continue}}s.push(a)}return s.push(i[i.length-1]),s},vEe=e=>{if(e.length===0)return[];const t=[e[0]];for(let n=1;n<e.length;n++){const[i,s]=t[t.length-1],[r,o]=e[n];(i!==r||s!==o)&&t.push(e[n])}return t},JR=(e,t,n)=>{if(!_Ee(e.type,t)||e.type===t)return e;if(sn.delete(e),og(t)){const i=Ha(aa({...e,type:t,roundness:t==="diamond"&&e.roundness?{type:$u(t)?En.ADAPTIVE_RADIUS:En.PROPORTIONAL_RADIUS}:e.roundness}));return v0(i,n.scene,n.state),i}if(q6(t))switch(t){case"line":return Ha(Sc({...e,type:"line"}));case"sharpArrow":return Ha(ph({...e,type:"arrow",elbowed:!1,roundness:null,startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"curvedArrow":return Ha(ph({...e,type:"arrow",elbowed:!1,roundness:{type:En.PROPORTIONAL_RADIUS},startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"elbowArrow":return Ha(ph({...e,type:"arrow",elbowed:!0,fixedSegments:null,roundness:null}))}return na(t,`unhandled conversion type: ${t}`),e},_Ee=(e,t)=>!!(og(e)&&og(t)||q6(e)&&q6(t)),wEe=e=>Ce(e)?fh(e):e.type,TEe=ue({name:"toggleShapeSwitch",label:"labels.shapeSwitch",icon:()=>null,viewMode:!0,trackEvent:{category:"shape_switch",action:"toggle"},keywords:["change","switch","swap"],perform(e,t,n,i){return Zs.set(Da,{type:"panel"}),{captureUpdate:q.NEVER}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>Ky(e)!==null}),VX=ue({name:"copyElementLink",label:"labels.copyElementLink",icon:Vp,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const s=Ye(e,t);try{if(window.location){const r=Sz(s,t);return r?(await gd(i.props.generateLinkForSelection?i.props.generateLinkForSelection(r.id,r.type):Iz(r.id,r.type)),{appState:{toast:{message:M("toast.elementLinkCopied"),closable:!0}},captureUpdate:q.EVENTUALLY}):{appState:t,elements:e,app:i,captureUpdate:q.EVENTUALLY}}}catch(r){console.error(r)}return{appState:t,elements:e,app:i,captureUpdate:q.EVENTUALLY}},predicate:(e,t)=>I6(Ye(e,t))}),IEe=ue({name:"linkToElement",label:"labels.linkToElement",icon:jV,perform:(e,t,n,i)=>{const s=Ye(e,t);return s.length!==1||!I6(s)?{elements:e,appState:t,app:i,captureUpdate:q.EVENTUALLY}:{appState:{...t,openDialog:{name:"elementLinkSelector",sourceElementId:Ye(e,t)[0].id}},captureUpdate:q.IMMEDIATELY}},predicate:(e,t,n,i)=>{var r;const s=Ye(e,t);return((r=t.openDialog)==null?void 0:r.name)!=="elementLinkSelector"&&s.length===1&&I6(s)},trackEvent:!1}),SEe={toggleTheme:[Q("Shift+Alt+D")],saveScene:[Q("CtrlOrCmd+S")],loadScene:[Q("CtrlOrCmd+O")],clearCanvas:[Q("CtrlOrCmd+Delete")],imageExport:[Q("CtrlOrCmd+Shift+E")],commandPalette:[Q("CtrlOrCmd+/"),Q("CtrlOrCmd+Shift+P")],cut:[Q("CtrlOrCmd+X")],copy:[Q("CtrlOrCmd+C")],paste:[Q("CtrlOrCmd+V")],copyStyles:[Q("CtrlOrCmd+Alt+C")],pasteStyles:[Q("CtrlOrCmd+Alt+V")],selectAll:[Q("CtrlOrCmd+A")],deleteSelectedElements:[Q("Delete")],duplicateSelection:[Q("CtrlOrCmd+D"),Q(`Alt+${M("helpDialog.drag")}`)],sendBackward:[Q("CtrlOrCmd+[")],bringForward:[Q("CtrlOrCmd+]")],sendToBack:[Q(po?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")],bringToFront:[Q(po?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")],copyAsPng:[Q("Shift+Alt+C")],group:[Q("CtrlOrCmd+G")],ungroup:[Q("CtrlOrCmd+Shift+G")],gridMode:[Q("CtrlOrCmd+'")],zenMode:[Q("Alt+Z")],objectsSnapMode:[Q("Alt+S")],stats:[Q("Alt+/")],addToLibrary:[],flipHorizontal:[Q("Shift+H")],flipVertical:[Q("Shift+V")],viewMode:[Q("Alt+R")],hyperlink:[Q("CtrlOrCmd+K")],toggleElementLock:[Q("CtrlOrCmd+Shift+L")],resetZoom:[Q("CtrlOrCmd+0")],zoomOut:[Q("CtrlOrCmd+-")],zoomIn:[Q("CtrlOrCmd++")],zoomToFitSelection:[Q("Shift+3")],zoomToFit:[Q("Shift+1")],zoomToFitSelectionInViewport:[Q("Shift+2")],toggleEraserTool:[Q("E")],toggleHandTool:[Q("H")],setFrameAsActiveTool:[Q("F")],saveFileToDisk:[Q("CtrlOrCmd+S")],saveToActiveFile:[Q("CtrlOrCmd+S")],toggleShortcuts:[Q("?")],searchMenu:[Q("CtrlOrCmd+F")],wrapSelectionInFrame:[]},es=(e,t=0)=>{const n=SEe[e];return n&&n.length>0?n[t]||n[0]:""},xEe="\\u0300-\\u036f",CEe="\\ufe20-\\ufe2f",AEe="\\u20d0-\\u20ff",MEe=xEe+CEe+AEe,kEe=`[${MEe}]`,REe=RegExp(kEe,"g"),LEe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,DEe={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"E",:"e",:"T",:"t",:"s",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"I",:"i",:"E",:"e",:"n",:"s"},$m=e=>e.replace(LEe,t=>DEe[t]||t).replace(REe,""),$X=()=>{const[e,t]=L.useState(null),n=L.useCallback(i=>t(i),[]);return[e,n]};var Zy={},PEe=NEe;function NEe(e,t){if(e=String(e),t=String(t),!/^[\x00-\xFF]+$/.test(e)||!/^[\x00-\xFF]+$/.test(t))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(e.length>=80)throw new Error('Keyword "'+e+'" is longer than the 79-character limit imposed by the PNG specification');for(var n=e.length+t.length+1,i=new Uint8Array(n),s=0,r,o=0;o<e.length;o++){if(!(r=e.charCodeAt(o)))throw new Error("0x00 character is not permitted in tEXt keywords");i[s++]=r}i[s++]=0;for(var a=0;a<t.length;a++){if(!(r=t.charCodeAt(a)))throw new Error("0x00 character is not permitted in tEXt content");i[s++]=r}return{name:"tEXt",data:i}}var OEe=FEe;function FEe(e){e.data&&e.name&&(e=e.data);for(var t=!0,n="",i="",s=0;s<e.length;s++){var r=e[s];if(t)r?i+=String.fromCharCode(r):t=!1;else if(r)n+=String.fromCharCode(r);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:i,text:n}}Zy.encode=PEe;Zy.decode=OEe;var BEe=function(e,t,n){var i=[],s=e.length;if(s===0)return i;var r=t<0?Math.max(0,t+s):t||0;for(n!==void 0&&(s=n<0?n+s:n);s-- >r;)i[s-r]=e[s];return i},zT={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="0.3.0";function n(){for(var c=0,d=new Array(256),u=0;u!=256;++u)c=u,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,d[u]=c;return typeof Int32Array<"u"?new Int32Array(d):d}var i=n(),s=typeof Buffer<"u";function r(c){if(c.length>32768&&s)return a(new Buffer(c));for(var d=-1,u=c.length-1,f=0;f<u;)d=i[(d^c.charCodeAt(f++))&255]^d>>>8,d=i[(d^c.charCodeAt(f++))&255]^d>>>8;return f===u&&(d=d>>>8^i[(d^c.charCodeAt(f))&255]),d^-1}function o(c){if(c.length>1e4)return a(c);for(var d=-1,u=0,f=c.length-3;u<f;)d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255];for(;u<f+3;)d=d>>>8^i[(d^c[u++])&255];return d^-1}function a(c){for(var d=-1,u=0,f=c.length-7;u<f;)d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255],d=d>>>8^i[(d^c[u++])&255];for(;u<f+7;)d=d>>>8^i[(d^c[u++])&255];return d^-1}function l(c){for(var d=-1,u=0,f=c.length,h,m;u<f;)h=c.charCodeAt(u++),h<128?d=d>>>8^i[(d^h)&255]:h<2048?(d=d>>>8^i[(d^(192|h>>6&31))&255],d=d>>>8^i[(d^(128|h&63))&255]):h>=55296&&h<57344?(h=(h&1023)+64,m=c.charCodeAt(u++)&1023,d=d>>>8^i[(d^(240|h>>8&7))&255],d=d>>>8^i[(d^(128|h>>2&63))&255],d=d>>>8^i[(d^(128|m>>6&15|h&3))&255],d=d>>>8^i[(d^(128|m&63))&255]):(d=d>>>8^i[(d^(224|h>>12&15))&255],d=d>>>8^i[(d^(128|h>>6&63))&255],d=d>>>8^i[(d^(128|h&63))&255]);return d^-1}t.table=i,t.bstr=r,t.buf=o,t.str=l})})(zT);var zEe=BEe,HEe=zT,VEe=XEe,Lo=new Uint8Array(4),$Ee=new Int32Array(Lo.buffer),GEe=new Uint32Array(Lo.buffer);function XEe(e){var t=8,n=t,i;for(i=0;i<e.length;i++)t+=e[i].data.length,t+=12;var s=new Uint8Array(t);for(s[0]=137,s[1]=80,s[2]=78,s[3]=71,s[4]=13,s[5]=10,s[6]=26,s[7]=10,i=0;i<e.length;i++){var r=e[i],o=r.name,a=r.data,l=a.length,c=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)];GEe[0]=l,s[n++]=Lo[3],s[n++]=Lo[2],s[n++]=Lo[1],s[n++]=Lo[0],s[n++]=c[0],s[n++]=c[1],s[n++]=c[2],s[n++]=c[3];for(var d=0;d<l;)s[n++]=a[d++];var u=c.concat(zEe(a)),f=HEe.buf(u);$Ee[0]=f,s[n++]=Lo[3],s[n++]=Lo[2],s[n++]=Lo[1],s[n++]=Lo[0]}return s}const jEe=Sl(VEe);var YEe=zT,WEe=qEe,Do=new Uint8Array(4),KEe=new Int32Array(Do.buffer),ZEe=new Uint32Array(Do.buffer);function qEe(e){if(e[0]!==137)throw new Error("Invalid .png file header");if(e[1]!==80)throw new Error("Invalid .png file header");if(e[2]!==78)throw new Error("Invalid .png file header");if(e[3]!==71)throw new Error("Invalid .png file header");if(e[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[6]!==26)throw new Error("Invalid .png file header");if(e[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var t=!1,n=[],i=8;i<e.length;){Do[3]=e[i++],Do[2]=e[i++],Do[1]=e[i++],Do[0]=e[i++];var s=ZEe[0]+4,r=new Uint8Array(s);r[0]=e[i++],r[1]=e[i++],r[2]=e[i++],r[3]=e[i++];var o=String.fromCharCode(r[0])+String.fromCharCode(r[1])+String.fromCharCode(r[2])+String.fromCharCode(r[3]);if(!n.length&&o!=="IHDR")throw new Error("IHDR header missing");if(o==="IEND"){t=!0,n.push({name:o,data:new Uint8Array(0)});break}for(var a=4;a<s;a++)r[a]=e[i++];Do[3]=e[i++],Do[2]=e[i++],Do[1]=e[i++],Do[0]=e[i++];var l=KEe[0],c=YEe.buf(r);if(c!==l)throw new Error("CRC values for "+o+" header do not match, PNG file is likely corrupted");var d=new Uint8Array(r.buffer.slice(4));n.push({name:o,data:d})}if(!t)throw new Error(".png file ended prematurely: no IEND header was found");return n}const GX=Sl(WEe),XX=async e=>{const n=GX(new Uint8Array(await Wp(e))).find(i=>i.name==="tEXt");return n?Zy.decode(n.data):null},jX=async({blob:e,metadata:t})=>{const n=GX(new Uint8Array(await Wp(e))),i=Zy.encode(ve.excalidraw,JSON.stringify(JG({text:t,compress:!0})));return n.splice(-1,0,i),new Blob([jEe(n)],{type:ve.png})},QEe=async e=>{const t=await XX(e);if((t==null?void 0:t.keyword)===ve.excalidraw)try{const n=JSON.parse(t.text);if(!("encoded"in n)){if("type"in n&&n.type===kr.excalidraw)return t.text;throw new Error("FAILED")}return eX(n)}catch(n){throw console.error(n),new Error("FAILED")}throw new Error("INVALID")},YX=Object.freeze(Object.defineProperty({__proto__:null,decodePngMetadata:QEe,encodePngMetadata:jX,getTEXtChunk:XX},Symbol.toStringTag,{value:"Module"})),qy=({elements:e,appState:t,files:n,maxWidthOrHeight:i,getDimensions:s,exportPadding:r,exportingFrame:o})=>{const{elements:a,appState:l}=ku({elements:e,appState:t},null,null,{deleteInvisibleElements:!0}),{exportBackground:c,viewBackgroundColor:d}=l;return gX(a,{...l,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:c,exportPadding:r,viewBackgroundColor:d,exportingFrame:o},(u,f)=>{const h=document.createElement("canvas");if(i){typeof s=="function"&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");const p=Math.max(u,f),U=i<p?i/p:(t==null?void 0:t.exportScale)??1;return h.width=u*U,h.height=f*U,{canvas:h,scale:U}}const m=(s==null?void 0:s(u,f))||{width:u,height:f};return h.width=m.width,h.height=m.height,{canvas:h,scale:m.scale??1}})},JEe=async e=>{var s;let{mimeType:t=ve.png,quality:n}=e;t===ve.png&&typeof n=="number"&&console.warn(`"quality" will be ignored for "${ve.png}" mimeType`),t==="image/jpg"&&(t=ve.jpg),t===ve.jpg&&!((s=e.appState)!=null&&s.exportBackground)&&(console.warn(`Defaulting "exportBackground" to "true" for "${ve.jpg}" mimeType`),e={...e,appState:{...e.appState,exportBackground:!0}});const i=await qy(e);return n=n||(/image\/jpe?g/.test(t)?.92:.8),new Promise((r,o)=>{i.toBlob(async a=>{var l;if(!a)return o(new Error("couldn't export to blob"));a&&t===ve.png&&((l=e.appState)!=null&&l.exportEmbedScene)&&(a=await jX({blob:a,metadata:zg(e.elements,e.appState,e.files||{},"local")})),r(a)},t,n)})},WX=async({elements:e,appState:t=da(),files:n={},exportPadding:i,renderEmbeddables:s,exportingFrame:r,skipInliningFonts:o,reuseImages:a})=>{const{elements:l,appState:c}=ku({elements:e,appState:t},null,null,{deleteInvisibleElements:!0}),d={...c,exportPadding:i};return RT(l,d,n,{exportingFrame:r,renderEmbeddables:s,skipInliningFonts:o,reuseImages:a})},KX=Wt(new Map),eL=async e=>await WX({elements:e,appState:{exportBackground:!1,viewBackgroundColor:Ke.white},files:null,renderEmbeddables:!1,skipInliningFonts:!0}),ZX=(e,t,n,i)=>{const[s,r]=L.useState();return L.useEffect(()=>{if(t)if(e){const o=n.get(e);o?r(o):(async()=>{var l;const a=await eL(t);(l=a.querySelector(".style-fonts"))==null||l.remove(),a&&(n.set(e,a),r(a))})()}else(async()=>{const o=await eL(t);r(o)})()},[e,t,n,r]),L.useEffect(()=>{const o=i.current;if(o)return s&&(o.innerHTML=s.outerHTML),()=>{o.innerHTML=""}},[s,i]),s},HT=()=>{const[e]=gn(KX);return{clearLibraryCache:()=>e.clear(),deleteItemsFromLibraryCache:i=>{i.forEach(s=>e.delete(s))},svgCache:e}},e8e=["excalidraw.com","raw.githubusercontent.com/excalidraw/excalidraw-libraries"],qX=new Jr,ag=Wt({status:"loaded",isInitialized:!1,libraryItems:[]}),C1=e=>Ja(e),t8e=(e,t)=>!e.find(n=>n.elements.length!==t.elements.length?!1:n.elements.every((i,s)=>i.id===t.elements[s].id&&i.versionNonce===t.elements[s].versionNonce)),n8e=(e,t)=>{const n=[];for(const i of t)t8e(e,i)&&n.push(i);return[...n,...e]},QX=(e,t)=>{const n=be(t),i={deletedItems:new Map,addedItems:new Map,updatedItems:new Map};for(const r of e)n.has(r.id)||i.deletedItems.set(r.id,r);const s=be(e);for(const r of t){const o=s.get(r.id);o?Dv(o)!==Dv(r)&&i.updatedItems.set(r.id,r):i.addedItems.set(r.id,r)}return i};class i8e{constructor(t){this.currLibraryItems=[],this.prevLibraryItems=C1(this.currLibraryItems),this.updateQueue=[],this.getLastUpdateTask=()=>this.updateQueue[this.updateQueue.length-1],this.notifyListeners=()=>{var n,i;if(this.updateQueue.length>0)Zs.set(ag,s=>({status:"loading",libraryItems:this.currLibraryItems,isInitialized:s.isInitialized}));else{Zs.set(ag,{status:"loaded",libraryItems:this.currLibraryItems,isInitialized:!0});try{const s=this.prevLibraryItems;this.prevLibraryItems=C1(this.currLibraryItems);const r=C1(this.currLibraryItems);(i=(n=this.app.props).onLibraryChange)==null||i.call(n,r),qX.trigger(QX(s,r),r)}catch(s){console.error(s)}}},this.destroy=()=>{this.updateQueue=[],this.currLibraryItems=[],Zs.set(KX,new Map)},this.resetLibrary=()=>this.setLibrary([]),this.getLatestLibrary=()=>new Promise(async n=>{try{const i=await(this.getLastUpdateTask()||this.currLibraryItems);this.updateQueue.length>0?n(this.getLatestLibrary()):n(C1(i))}catch{return n(this.currLibraryItems)}}),this.updateLibrary=async({libraryItems:n,prompt:i=!1,merge:s=!1,openLibraryMenu:r=!1,defaultStatus:o="unpublished"})=>(r&&this.app.setState({openSidebar:{name:Rr.name,tab:qb}}),this.setLibrary(()=>new Promise(async(a,l)=>{try{const c=await(typeof n=="function"&&!(n instanceof Blob)?n(this.currLibraryItems):n);let d;c instanceof Blob?d=await rye(c,o):d=Xy(c,o),!i||window.confirm(M("alerts.confirmAddLibrary",{numShapes:d.length}))?(i&&this.app.focusContainer(),a(s?n8e(this.currLibraryItems,d):d)):l(new ng)}catch(c){l(c)}}))),this.setLibrary=n=>{const i=new Promise(async(s,r)=>{try{await this.getLastUpdateTask(),typeof n=="function"&&(n=n(this.currLibraryItems)),this.currLibraryItems=C1(await n),s(this.currLibraryItems)}catch(o){r(o)}}).catch(s=>{if(s.name==="AbortError")return console.warn("Library update aborted by user"),this.currLibraryItems;throw s}).finally(()=>{this.updateQueue=this.updateQueue.filter(s=>s!==i),this.notifyListeners()});return this.updateQueue.push(i),this.notifyListeners(),i},this.app=t}}const VT=e=>{const n=Math.ceil(Math.sqrt(e.length)),i=[],s=h=>e.slice(h*n,h*n+n).reduce((p,U)=>{const{height:b}=Dr(U.elements);return Math.max(p,b)},0),r=h=>{let m=0,p=0,U=0;for(const b of e){if(m%n===0&&(p=0),p===h){const{width:y}=Dr(b.elements);U=Math.max(U,y)}m++,p++}return U};let o=0,a=0,l=0,c=0,d=0,u=0,f=0;for(const h of e){d&&d%n===0&&(a+=l+50,o=0,u=0,f++),u===0&&(l=s(f)),c=r(u);const{minX:m,minY:p,width:U,height:b}=Dr(h.elements),y=(c-U)/2,v=(l-b)/2;i.push(...h.elements.map(_=>({..._,x:_.x+o+y-m,y:_.y+a+v-p}))),o+=c+50,d++,u++}return i},s8e=(e,t=e8e)=>{if(typeof t=="function"?t(e):t.some(n=>{const i=new URL(`https://${n.replace(/^https?:\/\//,"")}`),{hostname:s,pathname:r}=new URL(e);return new RegExp(`(^|\\.)${i.hostname}$`).test(s)&&new RegExp(`^${i.pathname.replace(/\/+$/,"")}(/+|$)`).test(r)}))return!0;throw new Error(`Invalid or disallowed library URL: "${e}"`)},Lv=()=>{const e=new URLSearchParams(window.location.hash.slice(1)).get(a4.addLibrary)||new URLSearchParams(window.location.search).get(o4.addLibrary),t=e?new URLSearchParams(window.location.hash.slice(1)).get("token"):null;return e?{libraryUrl:e,idToken:t}:null},ql=class ql{static async getLibraryItems(t,n,i=!0){const s=()=>new Promise(async(r,o)=>{try{const a=await t.load({source:n});r(Xy((a==null?void 0:a.libraryItems)||[],"published"))}catch(a){o(a)}});return i?ql.queue.push(s):s()}constructor(t){this.adapter=t}getLibraryItems(t){return ql.getLibraryItems(this.adapter,t,!1)}};ql.queue=new Ree,ql.run=async(t,n)=>{const i=new ql(t);return ql.queue.push(()=>n(i))};let Ih=ql,Gm=0,Q6=0;const Dv=e=>`${e.id}:${e.name||""}:${Xz(e.elements)}`,Pv=e=>Ew(e.map(t=>Dv(t)).sort().join()),tL=async(e,t)=>{try{return Q6++,await Ih.run(e,async n=>{const i=be(await n.getLibraryItems("save"));for(const[a]of t.deletedItems)i.delete(a);const s=[];for(const[a,l]of t.addedItems)i.has(a)?i.set(a,l):s.push(l);if(t.updatedItems)for(const[a,l]of t.updatedItems)i.set(a,l);const r=s.concat(Array.from(i.values())),o=Pv(r);return o!==Gm&&await e.save({libraryItems:r}),Gm=o,r})}finally{Q6--}},r8e=e=>{const{excalidrawAPI:t}=e,n=L.useRef(e);n.current=e;const i=L.useRef(!1);L.useEffect(()=>{if(!t)return;i.current=!1;const s=async({libraryUrl:a,idToken:l})=>{const c=new Promise(async(u,f)=>{try{a=decodeURIComponent(a),a=L_(a),s8e(a,n.current.validateLibraryUrl);const m=await(await fetch(a)).blob();u(m)}catch(h){f(h)}}),d=l!==t.id;await(d&&document.hidden?new Promise(u=>{window.addEventListener("focus",()=>u(),{once:!0})}):null);try{await t.updateLibrary({libraryItems:c,prompt:d,merge:!0,defaultStatus:"published",openLibraryMenu:!0})}catch(u){throw t.updateScene({appState:{errorMessage:u.message}}),u}finally{if(window.location.hash.includes(a4.addLibrary)){const u=new URLSearchParams(window.location.hash.slice(1));u.delete(a4.addLibrary),window.history.replaceState({},Tc,`#${u.toString()}`)}else if(window.location.search.includes(o4.addLibrary)){const u=new URLSearchParams(window.location.search);u.delete(o4.addLibrary),window.history.replaceState({},Tc,`?${u.toString()}`)}}},r=a=>{a.preventDefault();const l=Lv();l&&(a.stopImmediatePropagation(),window.history.replaceState({},"",a.oldURL),s(l))},o=Lv();if(o&&s(o),"getInitialLibraryItems"in n.current&&n.current.getInitialLibraryItems&&(console.warn("useHandleLibrar `opts.getInitialLibraryItems` is deprecated. Use `opts.adapter` instead."),Promise.resolve(n.current.getInitialLibraryItems()).then(a=>{t.updateLibrary({libraryItems:a,merge:!0})}).catch(a=>{console.error(`UseHandeLibrary getInitialLibraryItems failed: ${a==null?void 0:a.message}`)})),"adapter"in n.current&&n.current.adapter){const a=n.current.adapter,l=n.current.migrationAdapter,c=K5();l?c.resolve(Hc(l.load).then(async d=>{let u=null;try{if(!d)return Ih.getLibraryItems(a,"load");u=Xy(d.libraryItems||[],"published");const f=await tL(a,QX([],u));try{await l.clear()}catch(h){console.error(`couldn't delete legacy library data: ${h.message}`)}return f}catch(f){return console.error(`couldn't migrate legacy library data: ${f.message}`),u}}).catch(d=>(console.error(`error during library migration: ${d.message}`),Ih.getLibraryItems(a,"load")))):c.resolve(Hc(Ih.getLibraryItems,a,"load")),t.updateLibrary({libraryItems:c.then(d=>{const u=d||[];return Gm=Pv(u),u}),merge:!0}).finally(()=>{i.current=!0})}return window.addEventListener(te.HASHCHANGE,r),()=>{window.removeEventListener(te.HASHCHANGE,r)}},[t]),L.useEffect(()=>{const s=qX.on(async(o,a)=>{const l=i.current,c="adapter"in n.current&&n.current.adapter||null;try{c&&Gm!==Pv(a)&&await tL(c,o)}catch(d){console.error(`couldn't persist library update: ${d.message}`,o),l&&n.current.excalidrawAPI&&n.current.excalidrawAPI.updateScene({appState:{errorMessage:M("errors.saveLibraryError")}})}}),r=o=>{Q6&&M_(o)};return window.addEventListener(te.BEFORE_UNLOAD,r),()=>{window.removeEventListener(te.BEFORE_UNLOAD,r),s(),Gm=0,Q6=0}},[])},o8e=({theme:e,id:t,libraryReturnUrl:n})=>{const i=n||window.location.origin+window.location.pathname;return g("a",{className:"library-menu-browse-button",href:`https://libraries.excalidraw.com?target=${window.name||"_blank"}&referrer=${i}&useHash=true&token=${t}&theme=${e}&version=${j5.excalidrawLibrary}`,target:"_excalidraw_libraries",children:M("labels.libraries")})},JX=({libraryReturnUrl:e,theme:t,id:n,style:i,children:s,className:r})=>N("div",{className:le("library-menu-control-buttons",r),style:i,children:[g(o8e,{id:n,libraryReturnUrl:e,theme:t}),s]}),a8e=Wt(0),l8e=e=>{const[t,n]=gn(a8e);return L.useEffect(()=>{const{current:i}=e;if(!i)return;const s=jo(()=>{const{scrollTop:r}=i;n(r)},200);return i.addEventListener("scroll",s),()=>{s.cancel(),i.removeEventListener("scroll",s)}},[e,n]),t},lg=({label:e,onClick:t,className:n,children:i,actionType:s,type:r="button",isLoading:o,...a})=>{const l=s?`Dialog__action-button--${s}`:"";return N("button",{className:le("Dialog__action-button",l,n),type:r,"aria-label":e,onClick:t,...a,children:[i&&g("div",{style:o?{visibility:"hidden"}:{},children:i}),g("div",{style:o?{visibility:"hidden"}:{},children:e}),o&&g("div",{style:{position:"absolute",inset:0},children:g(Ul,{})})]})},ej=e=>{const{onConfirm:t,onCancel:n,children:i,confirmText:s=M("buttons.confirm"),cancelText:r=M("buttons.cancel"),className:o="",...a}=e,l=kn(),c=py($T),{container:d}=Fs();return N(dr,{onCloseRequest:n,size:"small",...a,className:`confirm-dialog ${o}`,children:[i,N("div",{className:"confirm-dialog-buttons",children:[g(lg,{label:r,onClick:()=>{l({openMenu:null}),c(!1),cn.flushSync(()=>{n()}),d==null||d.focus()}}),g(lg,{label:s,onClick:()=>{l({openMenu:null}),c(!1),cn.flushSync(()=>{t()}),d==null||d.focus()},actionType:"danger"})]})]})};class ru{static has(t){try{return!!window.localStorage.getItem(t)}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),!1}}static get(t){try{const n=window.localStorage.getItem(t);return n?JSON.parse(n):null}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),null}}}F(ru,"set",(t,n)=>{try{return window.localStorage.setItem(t,JSON.stringify(n)),!0}catch(i){return console.warn(`localStorage.setItem error: ${i.message}`),!1}}),F(ru,"delete",t=>{try{window.localStorage.removeItem(t)}catch(n){console.warn(`localStorage.removeItem error: ${n.message}`)}});const c8e=/({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,d8e=/{{([\w-]+)}}/,u8e=/<([\w-]+)>/,f8e=/<\/([\w-]+)>/,h8e=(e,t)=>{const n=[{name:"",children:[]}];return e.split(c8e).filter(Boolean).forEach(i=>{const s=i.match(u8e),r=i.match(f8e),o=i.match(d8e);if(s!==null){const a=s[1];t.hasOwnProperty(a)?n.push({name:a,children:[]}):console.warn(`Trans: missed to pass in prop ${a} for interpolating ${e}`)}else if(r!==null)if(r[1]===n[n.length-1].name){const l=n.pop(),c=de.createElement(de.Fragment,{},...l.children),d=t[l.name];typeof d=="function"&&n[n.length-1].children.push(d(c))}else console.warn(`Trans: unexpected end tag ${i} for interpolating ${e}`);else if(o!==null){const a=o[1];t.hasOwnProperty(a)?n[n.length-1].children.push(t[a]):console.warn(`Trans: key ${a} not in props for interpolating ${e}`)}else n[n.length-1].children.push(i)}),n.length!==1&&console.warn(`Trans: stack not empty for interpolating ${e}`),n[0].children},Rs=({i18nKey:e,children:t,...n})=>{const{t:i}=mn();return de.createElement(de.Fragment,{},...h8e(i(e),n))},g8e=async e=>{const i=Math.round(8),s=Math.max(Math.round(128/64),2),r=vte(e,6),o=document.createElement("canvas");o.width=r[0].length*128+(r[0].length+1)*(i*2)-i*2,o.height=r.length*128+(r.length+1)*(i*2)-i*2;const a=o.getContext("2d");a.fillStyle=Ei.white,a.fillRect(0,0,o.width,o.height);for(const[l,c]of e.entries()){const d=await qy({elements:c.elements,files:null,maxWidthOrHeight:128}),{width:u,height:f}=d,h=Math.floor(l/6)*(128+i*2),m=l%6*(128+i*2);a.drawImage(d,m+(128-u)/2+i,h+(128-f)/2+i),a.lineWidth=s,a.strokeStyle=Ei.gray[4],a.strokeRect(m+i/2,h+i/2,128+i,128+i)}return await _X(new File([await $0(o)],"preview",{type:ve.png}),{outputType:ve.jpg,maxWidthOrHeight:5e3})},m8e=({libItem:e,appState:t,index:n,onChange:i,onRemove:s})=>{const r=L.useRef(null),o=L.useRef(null);return L.useEffect(()=>{const a=r.current;a&&(async()=>{const l=await WX({elements:e.elements,appState:{...t,viewBackgroundColor:Ei.white,exportBackground:!0},files:null,skipInliningFonts:!0});a.innerHTML=l.outerHTML})()},[e.elements,t]),N("div",{className:"single-library-item",children:[e.status==="published"&&g("span",{className:"single-library-item-status",children:M("labels.statusPublished")}),g("div",{ref:r,className:"single-library-item__svg"}),g(We,{"aria-label":M("buttons.remove"),type:"button",icon:Wu,className:"single-library-item--remove",onClick:s.bind(null,e.id),title:M("buttons.remove")}),N("div",{style:{display:"flex",margin:"0.8rem 0",width:"100%",fontSize:"14px",fontWeight:500,flexDirection:"column"},children:[N("label",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[N("div",{style:{padding:"0.5em 0"},children:[g("span",{style:{fontWeight:500,color:Ei.gray[6]},children:M("publishDialog.itemName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",ref:o,style:{width:"80%",padding:"0.2rem"},defaultValue:e.name,placeholder:"Item name",onChange:a=>{i(a.target.value,n)}})]}),g("span",{className:"error",children:e.error})]})]})},p8e=({onClose:e,libraryItems:t,appState:n,onSuccess:i,onError:s,updateItemsInStorage:r,onRemove:o})=>{const[a,l]=L.useState({authorName:"",githubHandle:"",name:"",description:"",twitterHandle:"",website:""}),[c,d]=L.useState(!1);L.useEffect(()=>{const v=ru.get(Im.PUBLISH_LIBRARY);v&&l(v)},[]);const[u,f]=L.useState(t.slice());L.useEffect(()=>{f(t.slice())},[t]);const h=v=>{l({...a,[v.target.name]:v.target.value})},m=async v=>{v.preventDefault(),d(!0);const _=[];let I=!1;if(u.forEach(k=>{let P="";k.name||(P=M("publishDialog.errors.required"),I=!0),_.push({...k,error:P})}),I){f(_),d(!1);return}const R=await g8e(u),T={type:kr.excalidrawLibrary,version:j5.excalidrawLibrary,source:E_(),libraryItems:u},w=JSON.stringify(T,null,2),S=new Blob([w],{type:"application/json"}),x=new FormData;x.append("excalidrawLib",S),x.append("previewImage",R),x.append("previewImageType",R.type),x.append("title",a.name),x.append("authorName",a.authorName),x.append("githubHandle",a.githubHandle),x.append("name",a.name),x.append("description",a.description),x.append("twitterHandle",a.twitterHandle),x.append("website",a.website),fetch("https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries/submit",{method:"post",body:x}).then(k=>k.ok?k.json().then(({url:P})=>{ru.delete(Im.PUBLISH_LIBRARY),i({url:P,authorName:a.authorName,items:u})}):k.json().catch(()=>{throw new Error(k.statusText||"something went wrong")}).then(P=>{throw new Error(P.message||k.statusText||"something went wrong")}),k=>{console.error(k),s(k),d(!1)}).catch(k=>{console.error(k),s(k),d(!1)})},p=()=>{const v=[];return u.forEach((_,I)=>{v.push(g("div",{className:"single-library-item-wrapper",children:g(m8e,{libItem:_,appState:n,index:I,onChange:(R,T)=>{const w=u.slice();w[T].name=R,f(w)},onRemove:o})},I))}),g("div",{className:"selected-library-items",children:v})},U=L.useCallback(()=>{r(u),ru.set(Im.PUBLISH_LIBRARY,a),e()},[u,e,r,a]),b=!!t.length,y=t.some(v=>v.status==="published");return g(dr,{onCloseRequest:U,title:M("publishDialog.title"),className:"publish-library",children:b?N("form",{onSubmit:m,children:[g("div",{className:"publish-library-note",children:g(Rs,{i18nKey:"publishDialog.noteDescription",link:v=>g("a",{href:"https://libraries.excalidraw.com",target:"_blank",rel:"noopener",children:v})})}),g("span",{className:"publish-library-note",children:g(Rs,{i18nKey:"publishDialog.noteGuidelines",link:v=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries#guidelines",target:"_blank",rel:"noopener noreferrer",children:v})})}),g("div",{className:"publish-library-note",children:M("publishDialog.noteItems")}),y&&g("span",{className:"publish-library-note publish-library-warning",children:M("publishDialog.republishWarning")}),p(),N("div",{className:"publish-library__fields",children:[N("label",{children:[N("div",{children:[g("span",{children:M("publishDialog.libraryName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"name",required:!0,value:a.name,onChange:h,placeholder:M("publishDialog.placeholder.libraryName")})]}),N("label",{style:{alignItems:"flex-start"},children:[N("div",{children:[g("span",{children:M("publishDialog.libraryDesc")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("textarea",{name:"description",rows:4,required:!0,value:a.description,onChange:h,placeholder:M("publishDialog.placeholder.libraryDesc")})]}),N("label",{children:[N("div",{children:[g("span",{children:M("publishDialog.authorName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"authorName",required:!0,value:a.authorName,onChange:h,placeholder:M("publishDialog.placeholder.authorName")})]}),N("label",{children:[g("span",{children:M("publishDialog.githubUsername")}),g("input",{type:"text",name:"githubHandle",value:a.githubHandle,onChange:h,placeholder:M("publishDialog.placeholder.githubHandle")})]}),N("label",{children:[g("span",{children:M("publishDialog.twitterUsername")}),g("input",{type:"text",name:"twitterHandle",value:a.twitterHandle,onChange:h,placeholder:M("publishDialog.placeholder.twitterHandle")})]}),N("label",{children:[g("span",{children:M("publishDialog.website")}),g("input",{type:"text",name:"website",pattern:"https?://.+",title:M("publishDialog.errors.website"),value:a.website,onChange:h,placeholder:M("publishDialog.placeholder.website")})]}),g("span",{className:"publish-library-note",children:g(Rs,{i18nKey:"publishDialog.noteLicense",link:v=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer",children:v})})})]}),N("div",{className:"publish-library__buttons",children:[g(lg,{label:M("buttons.saveLibNames"),onClick:U,"data-testid":"cancel-clear-canvas-button"}),g(lg,{type:"submit",label:M("buttons.submit"),actionType:"primary",isLoading:c})]})]}):g("p",{style:{padding:"1em",textAlign:"center",fontWeight:500},children:M("publishDialog.atleastOneLibItem")})})},U8e=L.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:s,style:r},o)=>g("div",{className:le("Stack Stack_horizontal",s),style:{"--gap":t,alignItems:n,justifyContent:i,...r},ref:o,children:e})),b8e=L.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:s,style:r},o)=>g("div",{className:le("Stack Stack_vertical",s),style:{"--gap":t,justifyItems:n,justifyContent:i,...r},ref:o,children:e})),Za={Row:U8e,Col:b8e},tj=({children:e,onClickOutside:t,className:n="",onSelect:i,style:s,placement:r="bottom"})=>{const o=Hn(),a=L.useRef(null),l=Cy({onClickOutside:t});gT(a,d=>{var u,f,h;(f=(u=a.current)==null?void 0:u.closest(".dropdown-menu-container"))!=null&&f.contains(d.target)||(h=l.onClickOutside)==null||h.call(l)}),L.useEffect(()=>{const d=f=>{var h;f.key===$.ESCAPE&&(f.stopImmediatePropagation(),(h=l.onClickOutside)==null||h.call(l))},u={capture:!0};return document.addEventListener(te.KEYDOWN,d,u),()=>{document.removeEventListener(te.KEYDOWN,d,u)}},[l]);const c=le(`dropdown-menu ${n}`,{"dropdown-menu--mobile":o.formFactor==="phone","dropdown-menu--placement-top":r==="top"}).trim();return g(eG.Provider,{value:{onSelect:i},children:g("div",{ref:a,className:c,style:s,"data-testid":"dropdown-menu",children:o.formFactor==="phone"?g(Za.Col,{className:"dropdown-menu-container",children:e}):g(Ar,{className:"dropdown-menu-container",padding:2,style:{zIndex:2},children:e})})})};tj.displayName="DropdownMenuContent";const y8e=({children:e,className:t="",selected:n,...i})=>g("div",{...i,className:`dropdown-menu-item-base dropdown-menu-item-custom ${t} ${n?"dropdown-menu-item--selected":""}`.trim(),children:e}),Xm=({icon:e,shortcut:t,href:n,children:i,onSelect:s,className:r="",selected:o,rel:a="noopener",...l})=>{const c=nG(l.onClick,s);return g("a",{...l,href:n,target:"_blank",rel:a||"noopener",className:tG(r,o),title:l.title??l["aria-label"],onClick:c,children:g(J$,{icon:e,shortcut:t,children:i})})};Xm.displayName="DropdownMenuItemLink";const nj=()=>g("div",{style:{height:"1px",backgroundColor:"var(--default-border-color)",margin:".5rem 0",flex:"0 0 auto"}});nj.displayName="DropdownMenuSeparator";const ij=({className:e="",children:t,onToggle:n,title:i,...s})=>{const r=Hn(),o=le(`dropdown-menu-button ${e}`,"zen-mode-transition",{"dropdown-menu-button--mobile":r.formFactor==="phone"}).trim();return g("button",{className:o,onClick:n,type:"button","data-testid":"dropdown-menu-button",title:i,...s,children:t})};ij.displayName="DropdownMenuTrigger";const E8e=e=>{const t=de.Children.toArray(e).find(n=>de.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuTrigger");return t||null},v8e=e=>{const t=de.Children.toArray(e).find(n=>de.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuContent");return t||null},Ve=({children:e,open:t,placement:n})=>{const i=E8e(e),s=v8e(e),r=s&&de.isValidElement(s)?de.cloneElement(s,{placement:n}):s;return N("div",{className:"dropdown-menu-container",style:{display:"contents"},children:[i,t&&r]})};Ve.Trigger=ij;Ve.Content=tj;Ve.Item=Os;Ve.ItemLink=Xm;Ve.ItemCustom=y8e;Ve.Group=H6;Ve.Separator=nj;Ve.displayName="DropdownMenu";const _8e=(e,t)=>e.filter(n=>t.includes(n.id)),w8e=({setAppState:e,selectedItems:t,library:n,onRemoveFromLibrary:i,resetLibrary:s,onSelectItems:r,appState:o,className:a})=>{const[l]=gn(ag),[c,d]=gn($T),u=()=>{const x=t.length?M("alerts.removeItemsFromsLibrary",{count:t.length}):M("alerts.resetLibrary"),k=t.length?M("confirmDialog.removeItemsFromLib"):M("confirmDialog.resetLibrary");return g(ej,{onConfirm:()=>{t.length?i():s(),h(!1)},onCancel:()=>{h(!1)},title:k,children:g("p",{children:x})})},[f,h]=L.useState(!1),m=!!t.length,p=m?l.libraryItems.filter(x=>t.includes(x.id)):l.libraryItems,U=M(m?"buttons.remove":"buttons.resetLibrary"),[b,y]=L.useState(!1),[v,_]=L.useState(null),I=L.useCallback(()=>N(dr,{onCloseRequest:()=>_(null),title:M("publishSuccessDialog.title"),className:"publish-library-success",size:"small",children:[g("p",{children:g(Rs,{i18nKey:"publishSuccessDialog.content",authorName:v.authorName,link:x=>g("a",{href:v==null?void 0:v.url,target:"_blank",rel:"noopener noreferrer",children:x})})}),g(We,{type:"button",title:M("buttons.close"),"aria-label":M("buttons.close"),label:M("buttons.close"),onClick:()=>_(null),"data-testid":"publish-library-success-close",className:"publish-library-success-close"})]}),[_,v]),R=(x,k)=>{y(!1),_({url:x.url,authorName:x.authorName});const P=k.slice();P.forEach(D=>{t.includes(D.id)&&(D.status="published")}),n.setLibrary(P)},T=async()=>{try{await n.updateLibrary({libraryItems:AT({description:"Excalidraw library files"}),merge:!0,openLibraryMenu:!0})}catch(x){if((x==null?void 0:x.name)==="AbortError"){console.warn(x);return}e({errorMessage:M("errors.importLibraryError")})}},w=async()=>{const x=m?p:await n.getLatestLibrary();V5e(x).catch(iB).catch(k=>{e({errorMessage:k.message})})},S=()=>N(Ve,{open:c,children:[g(Ve.Trigger,{onToggle:()=>d(!c),children:hue}),N(Ve.Content,{onClickOutside:()=>d(!1),onSelect:()=>d(!1),className:"library-menu",children:[!m&&g(Ve.Item,{onSelect:T,icon:Xw,"data-testid":"lib-dropdown--load",children:M("buttons.load")}),!!p.length&&g(Ve.Item,{onSelect:w,icon:Ey,"data-testid":"lib-dropdown--export",children:M("buttons.export")}),m&&g(Ve.Item,{icon:Efe,onSelect:()=>y(!0),"data-testid":"lib-dropdown--remove",children:M("buttons.publishLibrary")}),!!p.length&&g(Ve.Item,{onSelect:()=>h(!0),icon:Yc,children:U})]})]});return N("div",{className:le("library-menu-dropdown-container",a),children:[S(),t.length>0&&g("div",{className:"library-actions-counter",children:t.length}),f&&u(),b&&g(p8e,{onClose:()=>y(!1),libraryItems:_8e(l.libraryItems,t),appState:o,onSuccess:x=>R(x,l.libraryItems),onError:x=>window.alert(x),updateItemsInStorage:()=>n.setLibrary(l.libraryItems),onRemove:x=>r(t.filter(k=>k!==x))}),v&&I()]})},T8e=({selectedItems:e,onSelectItems:t,className:n})=>{const{library:i}=So(),{clearLibraryCache:s,deleteItemsFromLibraryCache:r}=HT(),o=di(),a=kn(),[l]=gn(ag),c=async u=>{const f=u.filter(h=>!e.includes(h.id));i.setLibrary(f).catch(()=>{a({errorMessage:M("alerts.errorRemovingFromLibrary")})}),r(e),t([])};return g(w8e,{appState:o,setAppState:a,selectedItems:e,onSelectItems:t,library:i,onRemoveFromLibrary:()=>c(l.libraryItems),resetLibrary:()=>{i.resetLibrary(),s()},className:n})};function I8e(){return[!1,L.useCallback(t=>t(),[])]}const S8e=de.useTransition||I8e,x8e=L.memo(({id:e,elements:t,isPending:n,onClick:i,selected:s,onToggle:r,onDrag:o,svgCache:a})=>{const l=L.useRef(null),c=ZX(e,t,a,l),[d,u]=L.useState(!1),f=Hn().formFactor==="phone",h=n&&g("div",{className:"library-unit__adder",children:fue});return N("div",{className:le("library-unit",{"library-unit__active":t,"library-unit--hover":t&&d,"library-unit--selected":s,"library-unit--skeleton":!c}),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[g("div",{className:le("library-unit__dragger",{"library-unit__pulse":!!n}),ref:l,draggable:!!t,onClick:t||n?m=>{e&&m.shiftKey?r(e,m):i(e)}:void 0,onDragStart:m=>{if(!e){m.preventDefault();return}u(!1),o(e,m)}}),h,e&&t&&(d||f||s)&&g(wT,{checked:s,onChange:(m,p)=>r(e,p),className:"library-unit__checkbox"})]})}),C8e=()=>g("div",{className:"library-unit library-unit--skeleton"}),k3=({children:e})=>g("div",{className:"library-menu-items-container__grid",children:e}),g2=L.memo(({items:e,onItemSelectToggle:t,onItemDrag:n,isItemSelected:i,onClick:s,svgCache:r,itemsRenderedPerBatch:o})=>{const[,a]=S8e(),[l,c]=L.useState(0);return L.useEffect(()=>{l<e.length&&a(()=>{c(l+o)})},[l,e.length,a,o]),g(he,{children:e.map((d,u)=>u<l?g(x8e,{elements:d==null?void 0:d.elements,isPending:!(d!=null&&d.id)&&!!(d!=null&&d.elements),onClick:s,svgCache:r,id:d==null?void 0:d.id,selected:i(d.id),onToggle:t,onDrag:n},(d==null?void 0:d.id)??u):g(C8e,{},u))})}),qc=({type:e="button",onSelect:t,selected:n,children:i,className:s="",...r})=>g("button",{onClick:Z5(r.onClick,o=>{t()}),type:e,className:le("excalidraw-button",s,{selected:n}),...r,children:i}),Ru=L.forwardRef(({onChange:e,label:t,fullWidth:n,placeholder:i,readonly:s,selectOnRender:r,onKeyDown:o,isRedacted:a=!1,icon:l,className:c,type:d,...u},f)=>{const h=L.useRef(null);L.useImperativeHandle(f,()=>h.current),L.useLayoutEffect(()=>{var U,b;r&&((U=h.current)==null||U.focus(),(b=h.current)==null||b.select())},[r]);const[m,p]=L.useState(!1);return N("div",{className:le("ExcTextField",c,{"ExcTextField--fullWidth":n,"ExcTextField--hasIcon":!!l}),onClick:()=>{var U;(U=h.current)==null||U.focus()},children:[l,t&&g("div",{className:"ExcTextField__label",children:t}),N("div",{className:le("ExcTextField__input",{"ExcTextField__input--readonly":s}),children:[g("input",{className:le({"is-redacted":"value"in u&&u.value&&a&&!m}),readOnly:s,value:"value"in u?u.value:void 0,defaultValue:"defaultValue"in u?u.defaultValue:void 0,placeholder:i,ref:h,onChange:U=>e==null?void 0:e(U.target.value),onKeyDown:o,type:d}),a&&g(qc,{onSelect:()=>p(!m),style:{border:0,userSelect:"none"},children:m?Afe:Kw})]})]})}),A8e=17,M8e=64;function k8e({isLoading:e,libraryItems:t,onAddToLibrary:n,onInsertLibraryItems:i,pendingElements:s,theme:r,id:o,libraryReturnUrl:a,onSelectItems:l,selectedItems:c}){const d=Hn(),u=L.useRef(null),f=l8e(u);L.useEffect(()=>{var B;f>0&&((B=u.current)==null||B.scrollTo(0,f))},[]);const{svgCache:h}=HT(),[m,p]=L.useState(null),[U,b]=L.useState(""),y=!t.length&&!s.length,v=!y&&!!U.trim(),_=L.useMemo(()=>{const B=$m(U.trim().toLowerCase());return B?t.filter(z=>{const X=z.name||"";return X.trim()&&$m(X.toLowerCase()).includes(B)}):[]},[t,U]),I=L.useMemo(()=>t.filter(B=>B.status!=="published"),[t]),R=L.useMemo(()=>t.filter(B=>B.status==="published"),[t]),T=L.useCallback((B,z)=>{const X=!c.includes(B),Y=[...I,...R];if(X){if(z.shiftKey&&m){const ee=Y.findIndex(Ne=>Ne.id===m),se=Y.findIndex(Ne=>Ne.id===B);if(ee===-1||se===-1){l([...c,B]);return}const oe=be(c),Fe=Math.min(ee,se),Ge=Math.max(ee,se),Me=Y.reduce((Ne,et,Ot)=>((Ot>=Fe&&Ot<=Ge||oe.has(et.id))&&Ne.push(et.id),Ne),[]);l(Me)}else l([...c,B]);p(B)}else p(null),l(c.filter(ee=>ee!==B))},[m,l,R,c,I]);L.useEffect(()=>{c.length||p(null)},[c]);const w=L.useCallback(B=>{let z;return c.includes(B)?z=t.filter(X=>c.includes(X.id)):z=t.filter(X=>X.id===B),z.map(X=>({...X,elements:Rm({type:"everything",elements:X.elements,randomizeSeed:!0}).duplicatedElements}))},[t,c]),S=L.useCallback((B,z)=>{const X={itemIds:c.includes(B)?c:[B]};z.dataTransfer.setData(ve.excalidrawlibIds,JSON.stringify(X))},[c]),x=L.useCallback(B=>B?c.includes(B):!1,[c]),k=L.useCallback(()=>{n(s)},[s,n]),P=L.useCallback(B=>{B&&i(w(B))},[w,i]),D=h.size>=(_.length?_:t).length?M8e:A8e,j=L.useRef(null);L.useEffect(()=>{yte(()=>{var B;(B=j.current)==null||B.focus()})},[]);const G=!v&&N(he,{children:[!y&&g("div",{className:"library-menu-items-container__header",children:M("labels.personalLib")}),!s.length&&!I.length?N("div",{className:"library-menu-items__no-items",children:[!R.length&&g("div",{className:"library-menu-items__no-items__label",children:M("library.noItems")}),g("div",{className:"library-menu-items__no-items__hint",children:R.length>0?M("library.hint_emptyPrivateLibrary"):M("library.hint_emptyLibrary")})]}):N(k3,{children:[s.length>0&&g(g2,{itemsRenderedPerBatch:D,items:[{id:null,elements:s}],onItemSelectToggle:T,onItemDrag:S,onClick:k,isItemSelected:x,svgCache:h}),g(g2,{itemsRenderedPerBatch:D,items:I,onItemSelectToggle:T,onItemDrag:S,onClick:P,isItemSelected:x,svgCache:h})]}),R.length>0&&g("div",{className:"library-menu-items-container__header",style:{marginTop:"0.75rem"},children:M("labels.excalidrawLib")}),R.length>0&&g(k3,{children:g(g2,{itemsRenderedPerBatch:D,items:R,onItemSelectToggle:T,onItemDrag:S,onClick:P,isItemSelected:x,svgCache:h})})]}),V=v&&N(he,{children:[N("div",{className:"library-menu-items-container__header",children:[M("library.search.heading"),!e&&N("div",{className:"library-menu-items-container__header__hint",style:{cursor:"pointer"},onPointerDown:B=>B.preventDefault(),onClick:B=>{b("")},children:[g("kbd",{children:"esc"})," to clear"]})]}),_.length>0?g(k3,{children:g(g2,{itemsRenderedPerBatch:D,items:_,onItemSelectToggle:T,onItemDrag:S,onClick:P,isItemSelected:x,svgCache:h})}):N("div",{className:"library-menu-items__no-items",children:[g("div",{className:"library-menu-items__no-items__hint",children:M("library.search.noResults")}),g(qc,{onPointerDown:B=>B.preventDefault(),onSelect:()=>{b("")},style:{width:"auto",marginTop:"1rem"},children:M("library.search.clearSearch")})]})]});return N("div",{className:"library-menu-items-container",style:s.length||I.length||R.length?{justifyContent:"flex-start"}:{borderBottom:0},children:[N("div",{className:"library-menu-items-header",children:[!y&&g(Ru,{ref:j,type:"search",className:le("library-menu-items-container__search",{hideCancelButton:d.formFactor!=="phone"}),placeholder:M("library.search.inputPlaceholder"),value:U,onChange:B=>b(B)}),g(T8e,{selectedItems:c,onSelectItems:l,className:"library-menu-dropdown-container--in-heading"})]}),N(Za.Col,{className:"library-menu-items-container__items",align:"start",gap:1,style:{flex:R.length>0?1:"0 1 auto",margin:y?"auto":0},ref:u,children:[e&&g("div",{style:{position:"absolute",top:"var(--container-padding-y)",right:"var(--container-padding-x)",transform:"translateY(50%)"},children:g(Ul,{})}),G,V,y&&g(JX,{style:{padding:"16px 0",width:"100%"},id:o,libraryReturnUrl:a,theme:r})]})]})}const $T=Wt(!1),nL=({children:e})=>g("div",{className:"layer-ui__library",children:e}),R8e=L.memo(({onInsertLibraryItems:e,pendingElements:t,onAddToLibrary:n,setAppState:i,libraryReturnUrl:s,library:r,id:o,theme:a,selectedItems:l,onSelectItems:c})=>{const[d]=gn(ag),u=L.useCallback(m=>{(async(U,b)=>{it("element","addToLibrary","ui");for(const v of PF)if(U.some(_=>_.type===v))return i({errorMessage:M(`errors.libraryElementTypeError.${v}`)});const y=[{status:"unpublished",elements:U,id:ys(),created:Date.now()},...b];n(),r.setLibrary(y).catch(()=>{i({errorMessage:M("alerts.errorAddingToLibrary")})})})(m,d.libraryItems)},[n,r,i,d.libraryItems]),f=L.useMemo(()=>d.libraryItems,[d]);if(d.status==="loading"&&!d.isInitialized)return g(nL,{children:g("div",{className:"layer-ui__library-message",children:N("div",{children:[g(Ul,{size:"2em"}),g("span",{children:M("labels.libraryLoadingMessage")})]})})});const h=d.libraryItems.length>0||t.length>0;return N(nL,{children:[g(k8e,{isLoading:d.status==="loading",libraryItems:f,onAddToLibrary:u,onInsertLibraryItems:e,pendingElements:t,id:o,libraryReturnUrl:s,theme:a,onSelectItems:c,selectedItems:l}),h&&g(JX,{className:"library-menu-control-buttons--at-bottom",style:{padding:"16px 12px 0 12px"},id:o,libraryReturnUrl:s,theme:a})]})}),R3=(e,t)=>({elements:e,pending:Ye(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}),selectedElementIds:t}),L8e=(e,t)=>{const n=sE(),[i,s]=L.useState(()=>R3(n,e.selectedElementIds)),r=L.useRef(new Map);return L.useEffect(()=>{for(const o of i.pending)r.current.set(o.id,o.version)},[i.pending]),L.useEffect(()=>{t.state.cursorButton==="up"&&t.state.activeTool.type==="selection"&&s(o=>{var l;if(!vi(o.selectedElementIds,e.selectedElementIds))return r.current.clear(),R3(n,e.selectedElementIds);const a=t.scene.getNonDeletedElementsMap();for(const c of Object.keys(e.selectedElementIds)){const d=(l=a.get(c))==null?void 0:l.version;if(d&&d!==r.current.get(c))return R3(n,e.selectedElementIds)}return o})},[t,t.state.cursorButton,t.state.activeTool.type,e.selectedElementIds,n]),i.pending},D8e=L.memo(()=>{const e=So(),{onInsertElements:t}=e,n=Zp(),i=di(),s=kn(),[r,o]=L.useState([]),a=L.useMemo(()=>e.library,[e.library]),l=L8e(i,e);L.useEffect(()=>tn(document,te.KEYDOWN,u=>{if(u.key===$.ESCAPE&&u.target instanceof HTMLElement){const f=u.target;if(f.closest(`.${bs.SIDEBAR}`))r.length>0?(u.stopPropagation(),o([])):Ba(f)&&f instanceof HTMLInputElement&&!f.value&&(u.stopPropagation(),s({openSidebar:null}),e.focusContainer());else if(r.length>0){const{x:h,y:m}=e.lastViewportPosition,p=document.elementFromPoint(h,m);p!=null&&p.closest(`.${bs.SIDEBAR}`)&&(u.stopPropagation(),o([]))}}},{capture:!0}),[r,s,e]);const c=L.useCallback(u=>{t(VT(u)),e.focusContainer()},[t,e]),d=L.useCallback(()=>{s({selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null})},[s]);return g(R8e,{pendingElements:l,onInsertLibraryItems:c,onAddToLibrary:d,setAppState:s,libraryReturnUrl:n.libraryReturnUrl,library:a,id:e.id,theme:i.theme,selectedItems:r,onSelectItems:o})}),P8e=e=>{const{closeOnClickOutside:t=!0}=e,n=W$({className:"excalidraw-modal-container"}),i=L.useRef(document.body.classList.contains("excalidraw-animations-disabled"));if(!n)return null;const s=r=>{r.key===$.ESCAPE&&(r.nativeEvent.stopImmediatePropagation(),r.stopPropagation(),e.onCloseRequest())};return cn.createPortal(N("div",{className:le("Modal",e.className,{"animations-disabled":i.current}),role:"dialog","aria-modal":"true",onKeyDown:s,"aria-labelledby":e.labelledBy,"data-prevent-outside-click":!0,children:[g("div",{className:"Modal__background",onClick:t?e.onCloseRequest:void 0}),g("div",{className:"Modal__content",style:{"--max-width":`${e.maxWidth}px`},tabIndex:0,children:e.children})]}),n)};function N8e(e){if(e&&typeof e=="number")return e;switch(e){case"small":return 550;case"wide":return 1024;case"regular":default:return 800}}const dr=e=>{const[t,n]=$X(),[i]=L.useState(document.activeElement),{id:s}=Fs(),r=Hn().formFactor==="phone";L.useEffect(()=>{if(!t)return;const c=f4(t);setTimeout(()=>{c.length>0&&e.autofocus!==!1&&(c[1]||c[0]).focus()});const d=u=>{if(u.key===$.TAB){const f=f4(t),{activeElement:h}=document,m=f.findIndex(p=>p===h);m===0&&u.shiftKey?(f[f.length-1].focus(),u.preventDefault()):m===f.length-1&&!u.shiftKey&&(f[0].focus(),u.preventDefault())}};return t.addEventListener("keydown",d),()=>t.removeEventListener("keydown",d)},[t,e.autofocus]);const o=kn(),a=py($T),l=()=>{o({openMenu:null}),a(!1),i.focus(),e.onCloseRequest()};return g(P8e,{className:le("Dialog",e.className,{"Dialog--fullscreen":r}),labelledBy:"dialog-title",maxWidth:N8e(e.size),onCloseRequest:l,closeOnClickOutside:e.closeOnClickOutside,children:N(Ar,{ref:n,children:[e.title&&g("h2",{id:`${s}-dialog-title`,className:"Dialog__title",children:g("span",{className:"Dialog__titleContent",children:e.title})}),r&&g("button",{className:"Dialog__close",onClick:l,title:M("buttons.close"),"aria-label":M("buttons.close"),type:"button",children:Wu}),g("div",{className:"Dialog__content",children:e.children})]})})},Nv=[{icon:yy,value:"selection",key:$.V,numericKey:$[1],fillable:!0},{icon:Bw,value:"rectangle",key:$.R,numericKey:$[2],fillable:!0},{icon:zw,value:"diamond",key:$.D,numericKey:$[3],fillable:!0},{icon:Hw,value:"ellipse",key:$.O,numericKey:$[4],fillable:!0},{icon:kV,value:"arrow",key:$.A,numericKey:$[5],fillable:!0},{icon:Vw,value:"line",key:$.L,numericKey:$[6],fillable:!0},{icon:Hp,value:"freedraw",key:[$.P,$.X],numericKey:$[7],fillable:!1},{icon:Eh,value:"text",key:$.T,numericKey:$[8],fillable:!1},{icon:q2,value:"image",key:null,numericKey:$[9],fillable:!1},{icon:RV,value:"eraser",key:$.E,numericKey:$[0],fillable:!1}],sj=e=>e.state.preferredSelectionTool.type==="lasso"?[{value:"lasso",icon:yy,key:$.V,numericKey:$[1],fillable:!0},...Nv.slice(1)]:Nv,O8e=(e,t)=>{const n=sj(t).find((i,s)=>i.numericKey!=null&&e===i.numericKey.toString()||i.key&&(typeof i.key=="string"?i.key===e:i.key.includes(e)));return(n==null?void 0:n.value)||null};var F8e={};const iL=e=>{let t;const n=new Set,i=(d,u)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const h=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(m=>m(t,h))}},s=()=>t,l={setState:i,getState:s,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(F8e?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(i,s,l);return l},B8e=e=>e?iL(e):iL;var rj={exports:{}},oj={},aj={exports:{}},lj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cg=L;function z8e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var H8e=typeof Object.is=="function"?Object.is:z8e,V8e=cg.useState,$8e=cg.useEffect,G8e=cg.useLayoutEffect,X8e=cg.useDebugValue;function j8e(e,t){var n=t(),i=V8e({inst:{value:n,getSnapshot:t}}),s=i[0].inst,r=i[1];return G8e(function(){s.value=n,s.getSnapshot=t,L3(s)&&r({inst:s})},[e,n,t]),$8e(function(){return L3(s)&&r({inst:s}),e(function(){L3(s)&&r({inst:s})})},[e]),X8e(n),n}function L3(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!H8e(e,n)}catch{return!0}}function Y8e(e,t){return t()}var W8e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Y8e:j8e;lj.useSyncExternalStore=cg.useSyncExternalStore!==void 0?cg.useSyncExternalStore:W8e;aj.exports=lj;var K8e=aj.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy=L,Z8e=K8e;function q8e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Q8e=typeof Object.is=="function"?Object.is:q8e,J8e=Z8e.useSyncExternalStore,e3e=Qy.useRef,t3e=Qy.useEffect,n3e=Qy.useMemo,i3e=Qy.useDebugValue;oj.useSyncExternalStoreWithSelector=function(e,t,n,i,s){var r=e3e(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=n3e(function(){function l(h){if(!c){if(c=!0,d=h,h=i(h),s!==void 0&&o.hasValue){var m=o.value;if(s(m,h))return u=m}return u=h}if(m=u,Q8e(d,h))return m;var p=i(h);return s!==void 0&&s(m,p)?(d=h,m):(d=h,u=p)}var c=!1,d,u,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,i,s]);var a=J8e(e,r[0],r[1]);return t3e(function(){o.hasValue=!0,o.value=a},[a]),i3e(a),a};rj.exports=oj;var s3e=rj.exports;const r3e=Sl(s3e);var cj={};const{useDebugValue:o3e}=de,{useSyncExternalStoreWithSelector:a3e}=r3e;let sL=!1;const l3e=e=>e;function c3e(e,t=l3e,n){(cj?"production":void 0)!=="production"&&n&&!sL&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sL=!0);const i=a3e(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return o3e(i),i}const rL=e=>{(cj?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?B8e(e):e,n=(i,s)=>c3e(t,i,s);return Object.assign(n,t),n},d3e=e=>e?rL(e):rL;var oL,aL;const lL=typeof window<"u"&&((oL=window.document)!=null&&oL.createElement||((aL=window.navigator)==null?void 0:aL.product)==="ReactNative")?de.useLayoutEffect:de.useEffect;function ko(){const e=d3e(t=>({current:new Array,version:0,set:t}));return{In:({children:t})=>{const n=e(s=>s.set),i=e(s=>s.version);return lL(()=>{n(s=>({version:s.version+1}))},[]),lL(()=>(n(({current:s})=>({current:[...s,t]})),()=>n(({current:s})=>({current:s.filter(r=>r!==t)}))),[t,i]),null},Out:()=>{const t=e(n=>n.current);return de.createElement(de.Fragment,null,t)}}}const dj=de.createContext(null),is=()=>de.useContext(dj),u3e=NH(),f3e=()=>de.useMemo(()=>({MainMenuTunnel:ko(),WelcomeScreenMenuHintTunnel:ko(),WelcomeScreenToolbarHintTunnel:ko(),WelcomeScreenHelpHintTunnel:ko(),WelcomeScreenCenterTunnel:ko(),FooterCenterTunnel:ko(),DefaultSidebarTriggerTunnel:ko(),DefaultSidebarTabTriggersTunnel:ko(),OverwriteConfirmDialogTunnel:ko(),TTDDialogTriggerTunnel:ko(),tunnelsJotai:u3e}),[]),Ov=ue({name:"viewMode",label:"labels.viewMode",icon:Kw,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.viewModeEnabled},perform(e,t){return{appState:{...t,viewModeEnabled:!this.checked(t)},captureUpdate:q.EVENTUALLY}},checked:e=>e.viewModeEnabled,predicate:(e,t,n)=>typeof n.viewModeEnabled>"u",keyTest:e=>!e[$.CTRL_OR_CMD]&&e.altKey&&e.code===ot.R}),fb=({app:e,options:t,activeTool:n,defaultOption:i,className:s="Shape",namePrefix:r,title:o,"data-testid":a,onToolChange:l,displayedOption:c,fillable:d=!1})=>{const[u,f]=L.useState(!1),h=n.type,m=c.type===h,p=32/2+10,{container:U}=Fs();return!t.some(b=>b.type===h)&&u&&f(!1),L.useEffect(()=>{const b=e.onPointerDownEmitter.on(()=>{f(!1)});return()=>b==null?void 0:b()},[e]),N(Al,{open:u,children:[g(Ml,{asChild:!0,children:g(We,{className:le(s,{fillable:d,active:t.some(b=>b.type===n.type)}),type:"radio",icon:c.icon,checked:m,name:"editor-current-shape",title:o,"aria-label":o,"data-testid":a,onPointerDown:()=>{f(b=>!b),l(i)}})}),g(xy,{className:"tool-popover-content",sideOffset:p,collisionBoundary:U??void 0,children:t.map(({type:b,icon:y,title:v})=>g(We,{className:le(s,{active:h===b}),type:"radio",icon:y,checked:h===b,name:`${r}-option`,title:v||Pt(b),keyBindingLabel:"","aria-label":v||Pt(b),"data-testid":`toolbar-${b}`,onChange:()=>{e.state.activeTool.type!==b&&it("toolbar",b,"ui"),e.setActiveTool({type:b}),l==null||l(b)}},b))})]})},GT=le([bs.SHAPE_ACTIONS_THEME_SCOPE,"properties-content"]),Jy=(e,t)=>{var i;let n=((i=t[0])==null?void 0:i.type)||null;for(const s of t)if(s.type!==n){n=null;break}return w4(e.activeTool.type)&&n!=="image"&&n!=="frame"&&n!=="magicframe"||t.some(s=>w4(s.type))},eE=(e,t)=>$c(e.activeTool.type)||t.some(n=>$c(n.type)),h3e=({appState:e,elementsMap:t,renderAction:n,app:i})=>{var m;const s=iy(t,e);let r=!1;s.length===2&&(Fi(s[0])||Fi(s[1]))&&(r=!0);const o=!!(e.editingTextElement||e.newElement),a=Hn(),l=document.documentElement.getAttribute("dir")==="rtl",c=$c(e.activeTool.type)&&!ms(e.currentItemBackgroundColor)||s.some(p=>$c(p.type)&&!ms(p.backgroundColor)),d=s.length===1||r,u=!((m=e.selectedLinearElement)!=null&&m.isEditing)&&s.length===1&&Ce(s[0])&&!ye(s[0]),f=!e.croppingElementId&&s.length===1&&wt(s[0]),h=!r&&Ps(e,i);return N("div",{className:"selected-shape-actions",children:[g("div",{children:Jy(e,s)&&n("changeStrokeColor")}),eE(e,s)&&g("div",{children:n("changeBackgroundColor")}),c&&n("changeFillStyle"),(U6(e.activeTool.type)||s.some(p=>U6(p.type)))&&n("changeStrokeWidth"),(e.activeTool.type==="freedraw"||s.some(p=>p.type==="freedraw"))&&n("changeStrokeShape"),(b6(e.activeTool.type)||s.some(p=>b6(p.type)))&&N(he,{children:[n("changeStrokeStyle"),n("changeSloppiness")]}),(T0(e.activeTool.type)||s.some(p=>T0(p.type)))&&g(he,{children:n("changeRoundness")}),(y6(e.activeTool.type)||s.some(p=>y6(p.type)))&&g(he,{children:n("changeArrowType")}),(e.activeTool.type==="text"||s.some(fe))&&N(he,{children:[n("changeFontFamily"),n("changeFontSize"),(e.activeTool.type==="text"||DB(s,t))&&n("changeTextAlign")]}),LB(s,t)&&n("changeVerticalAlign"),(E6(e.activeTool.type)||s.some(p=>E6(p.type)))&&g(he,{children:n("changeArrowhead")}),n("changeOpacity"),N("fieldset",{children:[g("legend",{children:M("labels.layers")}),N("div",{className:"buttonList",children:[n("sendToBack"),n("sendBackward"),n("bringForward"),n("bringToFront")]})]}),h&&!r&&N("fieldset",{children:[g("legend",{children:M("labels.align")}),N("div",{className:"buttonList",children:[l?N(he,{children:[n("alignRight"),n("alignHorizontallyCentered"),n("alignLeft")]}):N(he,{children:[n("alignLeft"),n("alignHorizontallyCentered"),n("alignRight")]}),s.length>2&&n("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),N("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[n("alignTop"),n("alignVerticallyCentered"),n("alignBottom"),s.length>2&&n("distributeVertically")]})]})]}),!o&&s.length>0&&N("fieldset",{children:[g("legend",{children:M("labels.actions")}),N("div",{className:"buttonList",children:[a.formFactor!=="phone"&&n("duplicateSelection"),a.formFactor!=="phone"&&n("deleteSelectedElements"),n("group"),n("ungroup"),d&&n("hyperlink"),f&&n("cropEditor"),u&&n("toggleLinearEditor")]})]})]})},uj=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s})=>{const r=$c(e.activeTool.type)&&!ms(e.currentItemBackgroundColor)||i.some(l=>$c(l.type)&&!ms(l.backgroundColor)),o=i.length>0||e.activeTool.type!=="selection"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser"&&e.activeTool.type!=="lasso",a=e.openPopup==="compactStrokeStyles";return o?g("div",{className:"compact-action-item",children:N(Al,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactStrokeStyles"}:{openPopup:null})},children:[g(Ml,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:a}),title:M("labels.stroke"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactStrokeStyles"})},children:Wfe})}),a&&g(Pg,{className:GT,container:s,style:{maxWidth:"13rem"},onClose:()=>{},children:N("div",{className:"selected-shape-actions",children:[r&&t("changeFillStyle"),(U6(e.activeTool.type)||i.some(l=>U6(l.type)))&&t("changeStrokeWidth"),(b6(e.activeTool.type)||i.some(l=>b6(l.type)))&&N(he,{children:[t("changeStrokeStyle"),t("changeSloppiness")]}),(T0(e.activeTool.type)||i.some(l=>T0(l.type)))&&t("changeRoundness"),t("changeOpacity")]})})]})}):null},fj=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s,app:r})=>{const o=y6(e.activeTool.type)||i.some(l=>y6(l.type)),a=e.openPopup==="compactArrowProperties";return o?g("div",{className:"compact-action-item",children:N(Al,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactArrowProperties"}:{openPopup:null})},children:[g(Ml,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:a}),title:M("labels.arrowtypes"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactArrowProperties"})},children:(()=>{const l=vs(i,r,c=>_e(c)?c.elbowed?"elbow":c.roundness?"round":"sharp":null,c=>_e(c),c=>c?null:e.currentItemArrowType);return l==="elbow"?Qw:l==="round"?Jw:qw})()})}),a&&g(Pg,{container:s,className:"properties-content",style:{maxWidth:"13rem"},onClose:()=>{},children:t("changeArrowProperties")})]})}):null},hj=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s,elementsMap:r})=>{const{saveCaretPosition:o,restoreCaretPosition:a}=X1e(),l=e.openPopup==="compactTextProperties";return g("div",{className:"compact-action-item",children:N(Al,{open:l,onOpenChange:c=>{c?(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"})):(n({openPopup:null}),e.editingTextElement&&a())},children:[g(Ml,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:l}),title:M("labels.textAlign"),onClick:c=>{c.preventDefault(),c.stopPropagation(),l?n({openPopup:null}):(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"}))},children:vue})}),e.openPopup==="compactTextProperties"&&g(Pg,{className:GT,container:s,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!e.editingTextElement,onClose:()=>{e.editingTextElement&&a()},children:N("div",{className:"selected-shape-actions",children:[(e.activeTool.type==="text"||i.some(fe))&&t("changeFontSize"),(e.activeTool.type==="text"||DB(i,r))&&t("changeTextAlign"),LB(i,r)&&t("changeVerticalAlign")]})})]})})},gj=({appState:e,renderAction:t,targetElements:n,setAppState:i,container:s,app:r,showDuplicate:o,showDelete:a})=>{const l=!!(e.editingTextElement||e.newElement),c=!e.croppingElementId&&n.length===1&&wt(n[0]),d=n.length===1,u=Ps(e,r);let f=!1;n.length===2&&(Fi(n[0])||Fi(n[1]))&&(f=!0);const h=document.documentElement.getAttribute("dir")==="rtl",m=e.openPopup==="compactOtherProperties";return l||n.length===0?null:g("div",{className:"compact-action-item",children:N(Al,{open:m,onOpenChange:p=>{i(p?{openPopup:"compactOtherProperties"}:{openPopup:null})},children:[g(Ml,{asChild:!0,children:g("button",{type:"button",className:le("compact-action-button properties-trigger",{active:m}),title:M("labels.actions"),onClick:p=>{p.preventDefault(),p.stopPropagation(),i({openPopup:m?null:"compactOtherProperties"})},children:gue})}),m&&g(Pg,{className:GT,container:s,style:{maxWidth:"12rem",justifyContent:"center",alignItems:"center"},onClose:()=>{},children:N("div",{className:"selected-shape-actions",children:[N("fieldset",{children:[g("legend",{children:M("labels.layers")}),N("div",{className:"buttonList",children:[t("sendToBack"),t("sendBackward"),t("bringForward"),t("bringToFront")]})]}),u&&!f&&N("fieldset",{children:[g("legend",{children:M("labels.align")}),N("div",{className:"buttonList",children:[h?N(he,{children:[t("alignRight"),t("alignHorizontallyCentered"),t("alignLeft")]}):N(he,{children:[t("alignLeft"),t("alignHorizontallyCentered"),t("alignRight")]}),n.length>2&&t("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),N("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[t("alignTop"),t("alignVerticallyCentered"),t("alignBottom"),n.length>2&&t("distributeVertically")]})]})]}),N("fieldset",{children:[g("legend",{children:M("labels.actions")}),N("div",{className:"buttonList",children:[t("group"),t("ungroup"),d&&t("hyperlink"),c&&t("cropEditor"),o&&t("duplicateSelection"),a&&t("deleteSelectedElements")]})]})]})})]})})},g3e=({appState:e,renderAction:t,targetElements:n})=>{var s;return!((s=e.selectedLinearElement)!=null&&s.isEditing)&&n.length===1&&Ce(n[0])&&!ye(n[0])?g("div",{className:"compact-action-item",children:t("toggleLinearEditor")}):null},m3e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:s})=>{var c;const r=iy(t,e),{container:o}=Fs(),a=!!(e.editingTextElement||e.newElement),l=!((c=e.selectedLinearElement)!=null&&c.isEditing)&&r.length===1&&Ce(r[0])&&!ye(r[0]);return N("div",{className:"compact-shape-actions",children:[Jy(e,r)&&g("div",{className:le("compact-action-item"),children:n("changeStrokeColor")}),eE(e,r)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(uj,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o}),g(fj,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,app:i}),l&&g("div",{className:"compact-action-item",children:n("toggleLinearEditor")}),(e.activeTool.type==="text"||r.some(fe))&&N(he,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(hj,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,elementsMap:t})]}),!a&&r.length>0&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),!a&&r.length>0&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")}),g(gj,{appState:e,renderAction:n,targetElements:r,setAppState:s,container:o,app:i})]})},p3e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:s})=>{var U,b;const r=iy(t,e),{container:o}=Fs(),a=L.useRef(null),l=((b=(U=a.current)==null?void 0:U.getBoundingClientRect())==null?void 0:b.width)??0,c=9,d=6,u=32,f=c*u+(c-1)*d,h=u+d,m=l>=f+h,p=l>=f+2*h;return N(Ar,{className:"compact-shape-actions mobile-shape-actions",style:{flexDirection:"row",boxShadow:"none",padding:0,zIndex:2,backgroundColor:"transparent",height:u*1.35,marginBottom:4,alignItems:"center",gap:d,pointerEvents:"none"},ref:a,children:[N("div",{style:{display:"flex",flexDirection:"row",gap:d,flex:1},children:[Jy(e,r)&&g("div",{className:le("compact-action-item"),children:n("changeStrokeColor")}),eE(e,r)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(uj,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o}),g(fj,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,app:i}),g(g3e,{appState:e,renderAction:n,targetElements:r}),(e.activeTool.type==="text"||r.some(fe))&&N(he,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(hj,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,elementsMap:t})]}),g(gj,{appState:e,renderAction:n,targetElements:r,setAppState:s,container:o,app:i,showDuplicate:!p,showDelete:!m})]}),N("div",{style:{display:"flex",flexDirection:"row",gap:d},children:[g("div",{className:"compact-action-item",children:n("undo")}),g("div",{className:"compact-action-item",children:n("redo")}),p&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),m&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")})]})]})},U3e=({activeTool:e,setAppState:t,app:n,UIOptions:i})=>{const[s,r]=L.useState(!1),o=Ua(),a=o==="full",l=o==="compact",c=[{type:"selection",icon:yy,title:Pt(M("toolBar.selection"))},{type:"lasso",icon:Nm,title:Pt(M("toolBar.lasso"))}],d=e.type==="frame",u=e.type==="laser",f=a&&e.type==="lasso"&&n.state.preferredSelectionTool.type!=="lasso",h=e.type==="embeddable",{TTDDialogTriggerTunnel:m}=is();return N(he,{children:[sj(n).map(({value:p,icon:U,key:b,numericKey:y,fillable:v},_)=>{var w;if(((w=i.tools)==null?void 0:w[p])===!1)return null;const I=M(`toolBar.${p}`),R=b&&Pt(typeof b=="string"?b:b[0]),T=R?`${R} ${M("helpDialog.or")} ${y}`:`${y}`;return(p==="selection"||p==="lasso")&&l?g(fb,{app:n,options:c,activeTool:e,defaultOption:n.state.preferredSelectionTool.type,namePrefix:"selectionType",title:Pt(M("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:S=>{(S==="selection"||S==="lasso")&&(n.setActiveTool({type:S}),t({preferredSelectionTool:{type:S,initialized:!0}}))},displayedOption:c.find(S=>S.type===n.state.preferredSelectionTool.type)||c[0],fillable:e.type==="selection"},"selection-popover"):g(We,{className:le("Shape",{fillable:v}),type:"radio",icon:U,checked:e.type===p,name:"editor-current-shape",title:`${Pt(I)}  ${T}`,keyBindingLabel:y||R,"aria-label":Pt(I),"aria-keyshortcuts":T,"data-testid":`toolbar-${p}`,onPointerDown:({pointerType:S})=>{!n.state.penDetected&&S==="pen"&&n.togglePenMode(!0),p==="selection"&&(n.state.activeTool.type==="selection"?n.setActiveTool({type:"lasso"}):n.setActiveTool({type:"selection"}))},onChange:({pointerType:S})=>{n.state.activeTool.type!==p&&it("toolbar",p,"ui"),p==="image"?n.setActiveTool({type:p}):n.setActiveTool({type:p})}},p)}),g("div",{className:"App-toolbar__divider"}),N(Ve,{open:s,children:[g(Ve.Trigger,{className:le("App-toolbar__extra-tools-trigger",{"App-toolbar__extra-tools-trigger--selected":d||h||f||u&&!n.props.isCollaborating}),onToggle:()=>{r(!s),t({openMenu:null,openPopup:null})},title:M("toolBar.extraTools"),children:d?su:h?L6:u&&!n.props.isCollaborating?A0:f?Nm:lv}),N(Ve.Content,{onClickOutside:()=>r(!1),onSelect:()=>r(!1),className:"App-toolbar__extra-tools-dropdown",children:[g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"frame"}),icon:su,shortcut:$.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:M("toolBar.frame")}),g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"embeddable"}),icon:L6,"data-testid":"toolbar-embeddable",selected:h,children:M("toolBar.embeddable")}),g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"laser"}),icon:A0,"data-testid":"toolbar-laser",selected:u,shortcut:$.K.toLocaleUpperCase(),children:M("toolBar.laser")}),a&&g(Ve.Item,{onSelect:()=>n.setActiveTool({type:"lasso"}),icon:Nm,"data-testid":"toolbar-lasso",selected:f,children:M("toolBar.lasso")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),n.props.aiEnabled!==!1&&g(m.Out,{}),g(Ve.Item,{onSelect:()=>n.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:Ww,"data-testid":"toolbar-embeddable",children:M("toolBar.mermaidToExcalidraw")}),n.props.aiEnabled!==!1&&n.plugins.diagramToCode&&N(Ve.Item,{onSelect:()=>n.onMagicframeToolSelect(),icon:P6,"data-testid":"toolbar-magicframe",children:[M("toolBar.magicframe"),g(Ve.Item.Badge,{children:"AI"})]})]})]})]})},b3e=({renderAction:e,zoom:t})=>g(Za.Col,{gap:1,className:bs.ZOOM_ACTIONS,children:N(Za.Row,{align:"center",children:[e("zoomOut"),e("resetZoom"),e("zoomIn")]})}),y3e=({renderAction:e,className:t})=>N("div",{className:`undo-redo-buttons ${t}`,children:[g("div",{className:"undo-button-container",children:g(vl,{label:M("buttons.undo"),children:e("undo")})}),g("div",{className:"redo-button-container",children:N(vl,{label:M("buttons.redo"),children:[" ",e("redo")]})})]}),E3e=({actionManager:e,showExitZenModeBtn:t})=>g("button",{type:"button",className:le("disable-zen-mode",{"disable-zen-mode--visible":t}),onClick:()=>e.executeAction(xv),children:M("buttons.exitZenMode")}),v3e=({actionManager:e})=>g("button",{type:"button",className:"disable-view-mode",onClick:()=>e.executeAction(Ov),children:Zfe}),cL=e=>{const t=L.useRef({userFn:e});return t.current.userFn=e,t.current.stableFn||(t.current.stableFn=(...n)=>t.current.userFn(...n)),t.current.stableFn},tE=Wt(null),_3e=()=>{const[e,t]=gn(tE),n=Bs();return e&&e==="clearCanvas"?g(ej,{onConfirm:()=>{n.executeAction(Fm),t(null)},onCancel:()=>t(null),title:M("clearCanvasDialog.title"),children:N("p",{className:"clear-canvas__content",children:[" ",M("alerts.clearReset")]})}):null},w3e={...V6,category:"App",label:"Toggle theme",perform:({actionManager:e})=>{e.executeAction(V6,"commandPalette")}},T3e=Object.freeze(Object.defineProperty({__proto__:null,toggleTheme:w3e},Symbol.toStringTag,{value:"Module"})),I3e=Wt(null),ct={app:"App",export:"Export",tools:"Tools",editor:"Editor",elements:"Elements",links:"Links"},dL=e=>{switch(e){case ct.app:return 1;case ct.export:return 2;case ct.editor:return 3;case ct.tools:return 4;case ct.elements:return 5;case ct.links:return 6;default:return 10}},hb=({shortcut:e,className:t,children:n})=>{const i=e.replace("++","+$").split("+");return N("div",{className:le("shortcut",t),children:[i.map((s,r)=>g("div",{className:"shortcut-wrapper",children:g("div",{className:"shortcut-key",children:s==="$"?"+":s})},s)),g("div",{className:"shortcut-desc",children:n})]})},mj=e=>!e.altKey&&e[$.CTRL_OR_CMD]&&(e.shiftKey&&e.key.toLowerCase()===$.P||e.key===$.SLASH),uL=Object.assign(e=>{var i;const t=di(),n=kn();return L.useEffect(()=>{const s=r=>{mj(r)&&(r.preventDefault(),r.stopPropagation(),n(o=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="commandPalette"?null:{name:"commandPalette"};return a&&it("command_palette","open","shortcut"),{openDialog:a}}))};return window.addEventListener(te.KEYDOWN,s,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,s,{capture:!0})},[n]),((i=t.openDialog)==null?void 0:i.name)!=="commandPalette"?null:g(S3e,{...e})},{defaultItems:T3e});function S3e({customCommandPaletteItems:e}){const t=So(),n=di(),i=kn(),s=Zp(),r=Bs(),[o,a]=gn(I3e),[l,c]=L.useState(null),d=L.useRef(null),u=Cy({uiAppState:n,customCommandPaletteItems:e,appProps:s}),[f]=gn(ag),h=L.useMemo(()=>{var w;return((w=f.libraryItems)==null?void 0:w.filter(S=>!!S.name).map(S=>({label:S.name,icon:g(x3e,{id:S.id,elements:S.elements}),category:"Library",order:dL("Library"),haystack:$m(S.name),perform:()=>{t.onInsertElements(VT([S]))}})))||[]},[t,f.libraryItems]);L.useEffect(()=>{const{uiAppState:w,customCommandPaletteItems:S,appProps:x}=u,k=G=>{let V="";return G.label&&(typeof G.label=="function"?V=M(G.label(t.scene.getNonDeletedElements(),w,t)):V=M(G.label)),V},P=G=>typeof G.icon=="function"?G.icon(w,t.scene.getNonDeletedElements()):G.icon;let D=[];const j=(G,V,B)=>{const z={label:k(G),icon:P(G),category:V,shortcut:es(G.name),keywords:G.keywords,predicate:G.predicate,viewMode:G.viewMode,perform:()=>{r.executeAction(G,"commandPalette")}};return B?B(z,G):z};if(w&&t.scene&&r){const G=[r.actions.group,r.actions.ungroup,r.actions.cut,r.actions.copy,r.actions.deleteSelectedElements,r.actions.wrapSelectionInFrame,r.actions.copyStyles,r.actions.pasteStyles,r.actions.bringToFront,r.actions.bringForward,r.actions.sendBackward,r.actions.sendToBack,r.actions.alignTop,r.actions.alignBottom,r.actions.alignLeft,r.actions.alignRight,r.actions.alignVerticallyCentered,r.actions.alignHorizontallyCentered,r.actions.duplicateSelection,r.actions.flipHorizontal,r.actions.flipVertical,r.actions.zoomToFitSelection,r.actions.zoomToFitSelectionInViewport,r.actions.increaseFontSize,r.actions.decreaseFontSize,r.actions.toggleLinearEditor,r.actions.cropEditor,r.actions.togglePolygon,NX,VX,IEe].map(ee=>j(ee,ct.elements,(se,oe)=>({...se,predicate:oe.predicate?oe.predicate:(Fe,Ge,Me,Ne)=>Ye(Fe,Ge).length>0}))),V=[r.actions.toggleHandTool,r.actions.setFrameAsActiveTool,r.actions.toggleLassoTool].map(ee=>j(ee,ct.tools)),B=[r.actions.undo,r.actions.redo,r.actions.zoomIn,r.actions.zoomOut,r.actions.resetZoom,r.actions.zoomToFit,r.actions.zenMode,r.actions.viewMode,r.actions.gridMode,r.actions.objectsSnapMode,r.actions.toggleShortcuts,r.actions.selectAll,r.actions.toggleElementLock,r.actions.unlockAllElements,r.actions.stats].map(ee=>j(ee,ct.editor)),z=[r.actions.saveToActiveFile,r.actions.saveFileToDisk,r.actions.copyAsPng,r.actions.copyAsSvg].map(ee=>j(ee,ct.export));D=[...G,...B,{label:k(Fm),icon:P(Fm),shortcut:es(Fm.name),category:ct.editor,keywords:["delete","destroy"],viewMode:!1,perform:()=>{Zs.set(tE,"clearCanvas")}},{label:M("buttons.exportImage"),category:ct.export,icon:PV,shortcut:es("imageExport"),keywords:["export","image","png","jpeg","svg","clipboard","picture"],perform:()=>{i({openDialog:{name:"imageExport"}})}},...z];const X=[{label:M("toolBar.library"),category:ct.app,icon:MV,viewMode:!1,perform:()=>{w.openSidebar?i({openSidebar:null}):i({openSidebar:{name:Rr.name,tab:Rr.defaultTab}})}},{label:M("search.title"),category:ct.app,icon:wu,viewMode:!0,perform:()=>{r.executeAction(pj)}},{label:M("labels.shapeSwitch"),category:ct.elements,icon:cv,perform:()=>{r.executeAction(TEe)}},{label:M("labels.changeStroke"),keywords:["color","outline"],category:ct.elements,icon:q8,viewMode:!1,predicate:(ee,se)=>{const oe=Ye(ee,se);return oe.length>0&&Jy(se,oe)},perform:()=>{i(ee=>({openPopup:"elementStroke"}))}},{label:M("labels.changeBackground"),keywords:["color","fill"],icon:q8,category:ct.elements,viewMode:!1,predicate:(ee,se)=>{const oe=Ye(ee,se);return oe.length>0&&eE(se,oe)},perform:()=>{i(ee=>({openPopup:"elementBackground"}))}},{label:M("labels.canvasBackground"),keywords:["color"],icon:q8,category:ct.editor,viewMode:!1,perform:()=>{i(ee=>({openMenu:ee.openMenu==="canvas"?null:"canvas",openPopup:"canvasBackground"}))}},...Nv.reduce((ee,se)=>{var Xe;const{value:oe,icon:Fe,key:Ge,numericKey:Me}=se;if(((Xe=x.UIOptions.tools)==null?void 0:Xe[oe])===!1)return ee;const et=Ge&&Pt(typeof Ge=="string"?Ge:Ge[0])||Me,Ot={label:M(`toolBar.${oe}`),category:ct.tools,shortcut:et,icon:Fe,keywords:["toolbar"],viewMode:!1,perform:({event:je})=>{oe==="image"?t.setActiveTool({type:oe}):t.setActiveTool({type:oe})}};return ee.push(Ot),ee},[]),...V,{label:M("toolBar.lock"),category:ct.tools,icon:w.activeTool.locked?Fw:by,shortcut:$.Q.toLocaleUpperCase(),viewMode:!1,perform:()=>{t.toggleLock()}},{label:`${M("labels.textToDiagram")}...`,category:ct.tools,icon:kfe,viewMode:!1,predicate:x.aiEnabled,perform:()=>{i(ee=>({...ee,openDialog:{name:"ttd",tab:"text-to-diagram"}}))}},{label:`${M("toolBar.mermaidToExcalidraw")}...`,category:ct.tools,icon:Ww,viewMode:!1,predicate:x.aiEnabled,perform:()=>{i(ee=>({...ee,openDialog:{name:"ttd",tab:"mermaid"}}))}}],Y=[...D,...X,...S||[]].map(ee=>{var se;return{...ee,icon:ee.icon||cv,order:ee.order??dL(ee.category),haystack:`${$m(ee.label.toLocaleLowerCase())} ${((se=ee.keywords)==null?void 0:se.join(" "))||""}`}});c(Y),a([...Y,...h].find(ee=>ee.label===(o==null?void 0:o.label))??null)}},[u,t,r,c,o==null?void 0:o.label,a,i,h]);const[m,p]=L.useState(""),[U,b]=L.useState(null),[y,v]=L.useState({}),_=w=>{i({openDialog:null},w),p("")},I=(w,S)=>{var x;((x=n.openDialog)==null?void 0:x.name)==="commandPalette"&&(S.stopPropagation(),S.preventDefault(),document.body.classList.add("excalidraw-animations-disabled"),_(()=>{w.perform({actionManager:r,event:S}),a(w),requestAnimationFrame(()=>{document.body.classList.remove("excalidraw-animations-disabled")})}))},R=cL(w=>w.viewMode===!1&&n.viewModeEnabled?!1:typeof w.predicate=="function"?w.predicate(t.scene.getNonDeletedElements(),n,s,t):w.predicate===void 0||w.predicate),T=cL(w=>{var P;const S=Ba(w.target)||mj(w)||w.key===$.ESCAPE;if(S&&w.key!==$.ARROW_UP&&w.key!==$.ARROW_DOWN&&w.key!==$.ENTER)return;const x=Object.values(y).flat(),k=o&&!m&&R(o);if(w.key===$.ARROW_UP){w.preventDefault();const D=x.findIndex(V=>V.label===(U==null?void 0:U.label));if(k){if(D===0){b(o);return}if(U===o){const V=x[x.length-1];V&&b(V);return}}let j;D===-1?j=x.length-1:j=D===0?x.length-1:(D-1)%x.length;const G=x[j];G&&b(G);return}if(w.key===$.ARROW_DOWN){w.preventDefault();const D=x.findIndex(V=>V.label===(U==null?void 0:U.label));if(k){if(!U||D===x.length-1){b(o);return}if(U===o){const V=x[0];V&&b(V);return}}const j=(D+1)%x.length,G=x[j];G&&b(G);return}if(w.key===$.ENTER&&U&&setTimeout(()=>{I(U,w)}),!S){if(w.stopPropagation(),/^[a-zA-Z0-9]$/.test(w.key)){(P=d==null?void 0:d.current)==null||P.focus();return}w.preventDefault()}});return L.useEffect(()=>(window.addEventListener(te.KEYDOWN,T,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,T,{capture:!0})),[T]),L.useEffect(()=>{if(!l)return;const w=P=>{const D={};for(const j of P)D[j.category]?D[j.category].push(j):D[j.category]=[j];return D};let S=(m==null?void 0:m.length)>1?[...l.filter(R).sort((P,D)=>P.order-D.order),...h]:l.filter(R).sort((P,D)=>P.order-D.order);const x=!m&&o&&R(o);if(!m){v(w(x?S.filter(P=>P.label!==(o==null?void 0:o.label)):S)),b(x?o:S[0]||null);return}const k=$m(m.toLocaleLowerCase().replace(/[<>_| -]/g,""));S=fEe.filter(k,S,{extract:P=>P.haystack??""}).sort((P,D)=>D.score-P.score).map(P=>P.original),v(w(S)),b(S[0]??null)},[m,l,R,o,h]),N(dr,{onCloseRequest:()=>_(),closeOnClickOutside:!0,title:!1,size:720,autofocus:!0,className:"command-palette-dialog",children:[g(Ru,{value:m,placeholder:M("commandPalette.search.placeholder"),onChange:w=>{p(w)},selectOnRender:!0,ref:d}),t.editorInterface.formFactor!=="phone"&&N("div",{className:"shortcuts-wrapper",children:[g(hb,{shortcut:"",children:M("commandPalette.shortcuts.select")}),g(hb,{shortcut:"",children:M("commandPalette.shortcuts.confirm")}),g(hb,{shortcut:Q("Esc"),children:M("commandPalette.shortcuts.close")})]}),N("div",{className:"commands",children:[o&&!m&&N("div",{className:"command-category",children:[N("div",{className:"command-category-title",children:[M("commandPalette.recents"),g("div",{className:"icon",style:{marginLeft:"6px"},children:Rfe})]}),g(fL,{command:o,isSelected:o.label===(U==null?void 0:U.label),onClick:w=>I(o,w),disabled:!R(o),onMouseMove:()=>b(o),showShortcut:t.editorInterface.formFactor!=="phone",appState:n})]}),Object.keys(y).length>0?Object.keys(y).map((w,S)=>N("div",{className:"command-category",children:[g("div",{className:"command-category-title",children:w}),y[w].map(x=>g(fL,{command:x,isSelected:x.label===(U==null?void 0:U.label),onClick:k=>I(x,k),onMouseMove:()=>b(x),showShortcut:t.editorInterface.formFactor!=="phone",appState:n,size:w==="Library"?"large":"small"},x.label))]},w)):l?N("div",{className:"no-match",children:[g("div",{className:"icon",children:wu})," ",M("commandPalette.search.noMatch")]}):null]})]})}const x3e=({id:e,elements:t})=>{const n=L.useRef(null),{svgCache:i}=HT();return ZX(e,t,i,n),g("div",{className:"library-item-icon",ref:n})},fL=({command:e,isSelected:t,disabled:n,onMouseMove:i,onClick:s,showShortcut:r,appState:o,size:a="small"})=>{const l=()=>{};return N("div",{className:le("command-item",{"item-selected":t,"item-disabled":n,"command-item-large":a==="large"}),ref:c=>{var d;t&&!n&&((d=c==null?void 0:c.scrollIntoView)==null||d.call(c,{block:"nearest"}))},onClick:n?l:s,onMouseMove:n?l:i,title:n?M("commandPalette.itemNotAvailable"):"",children:[N("div",{className:"name",children:[e.icon&&g(Ly,{className:"icon",size:"var(--icon-size, 1rem)",icon:typeof e.icon=="function"?e.icon(o,[]):e.icon}),g(Q$,{children:e.label})]}),r&&e.shortcut&&g(hb,{shortcut:e.shortcut})]})},m2=ue({name:"toggleLinearEditor",category:ct.elements,label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds})[0];return(i==null?void 0:i.type)==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit"},keywords:["line"],trackEvent:{category:"element"},predicate:(e,t,n,i)=>{var r;const s=i.scene.getSelectedElements(t);return!!(!((r=t.selectedLinearElement)!=null&&r.isEditing)&&s.length===1&&Ce(s[0])&&!ye(s[0]))},perform(e,t,n,i){const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];xe(s,"No selected element found"),xe(t.selectedLinearElement,"No selected linear element found"),xe(s.id===t.selectedLinearElement.elementId,"Selected element ID and linear editor elementId does not match");const r={...t.selectedLinearElement,isEditing:!t.selectedLinearElement.isEditing};return{appState:{...t,selectedLinearElement:r},captureUpdate:q.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds})[0];if(!i)return null;const s=M(i.type==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit");return g(We,{type:"button",icon:Xfe,title:s,"aria-label":s,onClick:()=>t(null)})}});ue({name:"togglePolygon",category:ct.elements,icon:GM,keywords:["loop"],label:(e,t,n)=>!n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds}).some(r=>!nn(r)||!r.polygon)?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds});return s.length>0&&s.every(r=>nn(r)&&r.points.length>=4)},perform(e,t,n,i){const s=i.scene.getSelectedElements(t);if(s.some(l=>!nn(l)))return!1;const r=s,o=r.some(l=>!l.polygon),a=be(r);return{elements:e.map(l=>!a.has(l.id)||!nn(l)?l:Te(l,{backgroundColor:o?l.backgroundColor:"transparent",...aw(l,o)})),appState:t,captureUpdate:q.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds});if(i.length===0||i.some(o=>!nn(o)||!o.polygon||o.points.length<3))return null;const s=i.every(o=>nn(o)&&o.polygon),r=M(s?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon");return g(eT,{icon:GM,title:r,"aria-label":r,active:s,onClick:()=>t(null),style:{marginLeft:"auto"}})}});const pj=ue({name:"searchMenu",icon:wu,keywords:["search","find"],label:"search.title",viewMode:!0,trackEvent:{category:"search_menu",action:"toggle",predicate:e=>e.gridModeEnabled},perform(e,t,n,i){var s,r;if(t.openDialog)return!1;if(((s=t.openSidebar)==null?void 0:s.name)===Rr.name&&t.openSidebar.tab===Jd){const o=(r=i.excalidrawContainerValue.container)==null?void 0:r.querySelector(`.${bs.SEARCH_MENU_INPUT_WRAPPER} input`);return o==null||o.focus(),o==null||o.select(),!1}return{appState:{...t,openSidebar:{name:Rr.name,tab:Jd},openDialog:null},captureUpdate:q.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[$.CTRL_OR_CMD]&&e.key===$.F}),C3e=ue({name:"cropEditor",label:"helpDialog.cropStart",icon:ck,viewMode:!0,trackEvent:{category:"menu"},keywords:["image","crop"],perform(e,t,n,i){const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];return{appState:{...t,isCropping:!1,croppingElementId:s.id},captureUpdate:q.IMMEDIATELY}},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return!!(!t.croppingElementId&&s.length===1&&wt(s[0]))},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=M("helpDialog.cropStart");return g(We,{type:"button",icon:ck,title:i,"aria-label":i,onClick:()=>t(null)})}}),Uj=(e,t)=>{const n=t.scene.getSelectedElements(e);return n.length===1&&Ue(n[0])},A3e=ue({name:"selectAllElementsInFrame",label:"labels.selectAllElementsInFrame",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t).at(0)||null;if(Ue(s)){const r=or(Yt(e),s.id).filter(o=>!(o.type==="text"&&o.containerId));return{elements:e,appState:{...t,selectedElementIds:r.reduce((o,a)=>(o[a.id]=!0,o),{})},captureUpdate:q.IMMEDIATELY}}return{elements:e,appState:t,captureUpdate:q.EVENTUALLY}},predicate:(e,t,n,i)=>Uj(t,i)}),M3e=ue({name:"removeAllElementsFromFrame",label:"labels.removeAllElementsFromFrame",trackEvent:{category:"history"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t).at(0)||null;return Ue(s)?{elements:tz(e,s),appState:{...t,selectedElementIds:{[s.id]:!0}},captureUpdate:q.IMMEDIATELY}:{elements:e,appState:t,captureUpdate:q.EVENTUALLY}},predicate:(e,t,n,i)=>Uj(t,i)});ue({name:"updateFrameRendering",label:"labels.updateFrameRendering",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t)=>({elements:e,appState:{...t,frameRendering:{...t.frameRendering,enabled:!t.frameRendering.enabled}},captureUpdate:q.EVENTUALLY}),checked:e=>e.frameRendering.enabled});ue({name:"setFrameAsActiveTool",label:"toolBar.frame",trackEvent:{category:"toolbar"},icon:su,viewMode:!1,perform:(e,t,n,i)=>{const s=qt(t,{type:"frame"});return Ro(i.interactiveCanvas,{...t,activeTool:s}),{elements:e,appState:{...t,activeTool:qt(t,{type:"frame"})},captureUpdate:q.EVENTUALLY}},keyTest:e=>!e[$.CTRL_OR_CMD]&&!e.shiftKey&&!e.altKey&&e.key.toLocaleLowerCase()===$.F});const k3e=ue({name:"wrapSelectionInFrame",label:"labels.wrapSelectionInFrame",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=Ye(e,t);return s.length>0&&!s.some(r=>Ue(r))},perform:(e,t,n,i)=>{const s=Ye(e,t),r=i.scene.getNonDeletedElementsMap(),[o,a,l,c]=pt(s,r),d=16,u=mw({x:o-d,y:a-d,width:l-o+d*2,height:c-a+d*2});if(t.editingGroupId){const h=Lt(s,t.editingGroupId);for(const m of h){const p=m.groupIds.indexOf(t.editingGroupId);Cn(m,r,{groupIds:m.groupIds.slice(0,p)})}}return{elements:km([...i.scene.getElementsIncludingDeleted(),u],s,u,t),appState:{selectedElementIds:{[u.id]:!0}},captureUpdate:q.IMMEDIATELY}}});class p2 extends pu{applyTo(t,n,i){const[s,r]=this.elements.applyTo(t,i.elements,{excludedProperties:new Set(["version","versionNonce"])}),[o,a]=this.appState.applyTo(n,s);return[s,o,r||a]}static calculate(t,n){return super.calculate(t,n)}static inverse(t){return super.inverse(t)}static applyLatestChanges(t,n,i,s){return super.applyLatestChanges(t,n,i,s)}}class J6{constructor(t=!0,n=!0){this.isUndoStackEmpty=t,this.isRedoStackEmpty=n}}class Gd{constructor(t){F(this,"onHistoryChangedEmitter",new Jr);F(this,"undoStack",[]);F(this,"redoStack",[]);this.store=t}get isUndoStackEmpty(){return this.undoStack.length===0}get isRedoStackEmpty(){return this.redoStack.length===0}clear(){this.undoStack.length=0,this.redoStack.length=0}record(t){if(t.isEmpty()||t instanceof p2)return;const n=p2.inverse(t);this.undoStack.push(n),n.elements.isEmpty()||(this.redoStack.length=0),this.onHistoryChangedEmitter.trigger(new J6(this.isUndoStackEmpty,this.isRedoStackEmpty))}undo(t,n){return this.perform(t,n,()=>Gd.pop(this.undoStack),i=>Gd.push(this.redoStack,i))}redo(t,n){return this.perform(t,n,()=>Gd.pop(this.redoStack),i=>Gd.push(this.undoStack,i))}perform(t,n,i,s){try{let r=i();if(r===null)return;const o=q.IMMEDIATELY;let a=this.store.snapshot,l=t,c=n,d=!1;for(;r;){try{[l,c,d]=r.applyTo(l,c,a);const u=a.elements,f=a.maybeClone(o,l,c),h=hh.create(a,f),m=p2.applyLatestChanges(r,u,l);m.isEmpty()||(this.store.scheduleMicroAction({action:o,change:h,delta:m}),r=m),a=f}finally{s(r)}if(d)break;r=i()}return[l,c]}finally{this.onHistoryChangedEmitter.trigger(new J6(this.isUndoStackEmpty,this.isRedoStackEmpty))}}static pop(t){if(!t.length)return null;const n=t.pop();return n!==void 0?n:null}static push(t,n){const i=p2.inverse(n);return t.push(i)}}const bj=(e,t)=>{const[n,i]=L.useState(t);return L.useEffect(()=>{const s=e.on(r=>{i(r)});return()=>{s()}},[e]),n},yj=(e,t,n)=>{if(!t.multiElement&&!t.resizingElement&&!t.editingTextElement&&!t.newElement&&!t.selectedElementsAreBeingDragged&&!t.selectionElement&&!e.flowChartCreator.isCreatingChart){const i=n();if(!i)return{captureUpdate:q.EVENTUALLY};const[s,r]=i,o=hw(Array.from(s.values()));return{appState:r,elements:o,captureUpdate:q.NEVER}}return{captureUpdate:q.EVENTUALLY}},R3e=e=>({name:"undo",label:"buttons.undo",icon:WM,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,s)=>yj(s,n,()=>e.undo(be(t),n)),keyTest:t=>t[$.CTRL_OR_CMD]&&l4(t,$.Z)&&!t.shiftKey,PanelComponent:({appState:t,updateData:n,data:i,app:s})=>{const{isUndoStackEmpty:r}=bj(e.onHistoryChangedEmitter,new J6(e.isUndoStackEmpty,e.isRedoStackEmpty)),o=Ua()==="mobile";return g(We,{type:"button",icon:WM,"aria-label":M("buttons.undo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:r,"data-testid":"button-undo",style:{...o?vp:{}}})}}),L3e=e=>({name:"redo",label:"buttons.redo",icon:KM,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,s)=>yj(s,n,()=>e.redo(be(t),n)),keyTest:t=>t[$.CTRL_OR_CMD]&&t.shiftKey&&l4(t,$.Z)||HF&&t.ctrlKey&&!t.shiftKey&&l4(t,$.Y),PanelComponent:({appState:t,updateData:n,data:i,app:s})=>{const{isRedoStackEmpty:r}=bj(e.onHistoryChangedEmitter,new J6(e.isUndoStackEmpty,e.isRedoStackEmpty)),o=Ua()==="mobile";return g(We,{type:"button",icon:KM,"aria-label":M("buttons.redo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:r,"data-testid":"button-redo",style:{...o?vp:{}}})}}),D3e=ue({name:"autoResize",label:"labels.autoResize",icon:null,trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=Ye(e,t);return s.length===1&&fe(s[0])&&!s[0].autoResize},perform:(e,t,n,i)=>{const s=Ye(e,t);return{appState:t,elements:e.map(r=>{if(r.id===s[0].id&&fe(r)){const o=qn(r.originalText,bt(r),r.lineHeight);return Te(r,{autoResize:!0,width:o.width,height:o.height,text:r.originalText})}return r}),captureUpdate:q.IMMEDIATELY}}}),D3=(e,t,n,i,s,r)=>{if(e.trackEvent)try{typeof e.trackEvent=="object"&&(!e.trackEvent.predicate||e.trackEvent.predicate(n,i,r))&&it(e.trackEvent.category,e.trackEvent.action||e.name,`${t} (${s.editorInterface.formFactor==="phone"?"mobile":"desktop"})`)}catch(o){console.error("error while logging action:",o)}};class P3e{constructor(t,n,i,s){F(this,"actions",{});F(this,"updater");F(this,"getAppState");F(this,"getElementsIncludingDeleted");F(this,"app");F(this,"renderAction",(t,n)=>{const i=this.app.props.UIOptions.canvasActions;if(this.actions[t]&&"PanelComponent"in this.actions[t]&&(!(t in i)||i[t])){const s=this.actions[t],r=s.PanelComponent;r.displayName="PanelComponent";const o=this.getElementsIncludingDeleted(),a=this.getAppState(),l=c=>{D3(s,"ui",a,o,this.app,c),this.updater(s.perform(this.getElementsIncludingDeleted(),this.getAppState(),c,this.app))};return g(r,{elements:this.getElementsIncludingDeleted(),appState:this.getAppState(),updateData:l,appProps:this.app.props,app:this.app,data:n,renderAction:this.renderAction})}return null});F(this,"isActionEnabled",t=>{const n=this.getElementsIncludingDeleted(),i=this.getAppState();return!t.predicate||t.predicate(n,i,this.app.props,this.app)});this.updater=r=>{if(Sp(r))r.then(o=>t(o));else return t(r)},this.getAppState=n,this.getElementsIncludingDeleted=i,this.app=s}registerAction(t){this.actions[t.name]=t}registerAll(t){t.forEach(n=>this.registerAction(n))}handleKeyDown(t){const n=this.app.props.UIOptions.canvasActions,i=Object.values(this.actions).sort((l,c)=>(c.keyPriority||0)-(l.keyPriority||0)).filter(l=>(l.name in n?n[l.name]:!0)&&l.keyTest&&l.keyTest(t,this.getAppState(),this.getElementsIncludingDeleted(),this.app));if(i.length!==1)return i.length>1&&console.warn("Canceling as multiple actions match this shortcut",i),!1;const s=i[0];if(this.getAppState().viewModeEnabled&&s.viewMode!==!0)return!1;const r=this.getElementsIncludingDeleted(),o=this.getAppState(),a=null;return D3(s,"keyboard",o,r,this.app,null),t.preventDefault(),t.stopPropagation(),this.updater(i[0].perform(r,o,a,this.app)),!0}executeAction(t,n="api",i=null){const s=this.getElementsIncludingDeleted(),r=this.getAppState();D3(t,n,r,s,this.app,i),this.updater(t.perform(s,r,i,this.app))}}class N3e{constructor(){F(this,"targets",new WeakMap);F(this,"rafIds",new WeakMap)}register(t,n){this.targets.set(t,{callback:n,stopped:!0})}start(t){const n=this.targets.get(t);n&&(this.rafIds.has(t)||(this.targets.set(t,{...n,stopped:!1}),this.scheduleFrame(t)))}stop(t){const n=this.targets.get(t);n&&!n.stopped&&this.targets.set(t,{...n,stopped:!0}),this.cancelFrame(t)}constructFrame(t){return n=>{const i=this.targets.get(t);if(!i)return;const s=this.onFrame(i,n);!i.stopped&&!s?this.scheduleFrame(t):this.cancelFrame(t)}}scheduleFrame(t){const n=requestAnimationFrame(this.constructFrame(t));this.rafIds.set(t,n)}cancelFrame(t){if(this.rafIds.has(t)){const n=this.rafIds.get(t);cancelAnimationFrame(n)}this.rafIds.delete(t)}onFrame(t,n){return t.callback(n)??!1}}const hL=e=>{const t=Array.from(e.values());return{x:mL(t,n=>n.x)/t.length,y:mL(t,n=>n.y)/t.length}},gL=([e,t])=>Math.hypot(e.x-t.x,e.y-t.y),mL=(e,t)=>e.reduce((n,i)=>n+t(i),0),O3e=8,pL=99999,nE=e=>O3e/e,ls=class ls{};F(ls,"referenceSnapPoints",null),F(ls,"visibleGaps",null),F(ls,"setReferenceSnapPoints",t=>{ls.referenceSnapPoints=t}),F(ls,"getReferenceSnapPoints",()=>ls.referenceSnapPoints),F(ls,"setVisibleGaps",t=>{ls.visibleGaps=t}),F(ls,"getVisibleGaps",()=>ls.visibleGaps),F(ls,"destroy",()=>{ls.referenceSnapPoints=null,ls.visibleGaps=null});let eo=ls;const W0=e=>e.props.gridModeEnabled??e.state.gridModeEnabled,Qc=({event:e,app:t,selectedElements:n})=>{if(e){const i=t.state.activeTool.type==="lasso"&&t.state.selectedElementsAreBeingDragged;return(t.state.activeTool.type!=="lasso"||i)&&(t.state.objectsSnapModeEnabled&&!e[$.CTRL_OR_CMD]||!t.state.objectsSnapModeEnabled&&e[$.CTRL_OR_CMD]&&!W0(t))}return n.length===1&&n[0].type==="arrow"?!1:t.state.objectsSnapModeEnabled},F3e=(e,t,n=.01)=>Math.abs(e-t)<=n,K0=(e,t,{omitCenter:n,boundingBoxCorners:i,dragOffset:s}={omitCenter:!1,boundingBoxCorners:!1})=>{let r=[];if(e.length===1){const o=e[0];let[a,l,c,d,u,f]=$e(o,t);s&&(a+=s.x,c+=s.x,u+=s.x,l+=s.y,d+=s.y,f+=s.y);const h=(c-a)/2,m=(d-l)/2;if((o.type==="diamond"||o.type==="ellipse")&&!i){const p=Z(C(a,l+m),C(u,f),o.angle),U=Z(C(a+h,l),C(u,f),o.angle),b=Z(C(c,l+m),C(u,f),o.angle),y=Z(C(a+h,d),C(u,f),o.angle),v=C(u,f);r=n?[p,U,b,y]:[p,U,b,y,v]}else{const p=Z(C(a,l),C(u,f),o.angle),U=Z(C(c,l),C(u,f),o.angle),b=Z(C(a,d),C(u,f),o.angle),y=Z(C(c,d),C(u,f),o.angle),v=C(u,f);r=n?[p,U,b,y]:[p,U,b,y,v]}}else if(e.length>1){const[o,a,l,c]=uw(e,s??{x:0,y:0}),d=l-o,u=c-a,f=C(o,a),h=C(l,a),m=C(o,c),p=C(l,c),U=C(o+d/2,a+u/2);r=n?[f,h,m,p]:[f,h,m,p,U]}return r.map(o=>C(un(o[0]),un(o[1])))},Ej=(e,t,n,i)=>QB(e,t,n,i),B3e=(e,t,n,i)=>{const s=Ej(e,t,n,i),r=qB(s,i).filter(u=>!(u.length===1&&Nt(u[0]))).map(u=>pt(u).map(f=>un(f))),o=r.sort((u,f)=>u[0]-f[0]),a=[];let l=0;e:for(let u=0;u<o.length;u++){const f=o[u];for(let h=u+1;h<o.length;h++){if(++l>pL)break e;const m=o[h],[,p,U,b]=f,[y,v,,_]=m;U<y&&i6(Yi(p,b),Yi(v,_))&&a.push({startBounds:f,endBounds:m,startSide:[C(U,p),C(U,b)],endSide:[C(y,v),C(y,_)],length:y-U,overlap:s6(Yi(p,b),Yi(v,_))})}}const c=r.sort((u,f)=>u[1]-f[1]),d=[];l=0;e:for(let u=0;u<c.length;u++){const f=c[u];for(let h=u+1;h<c.length;h++){if(++l>pL)break e;const m=c[h],[p,,U,b]=f,[y,v,_]=m;b<v&&i6(Yi(p,U),Yi(y,_))&&d.push({startBounds:f,endBounds:m,startSide:[C(p,b),C(U,b)],endSide:[C(y,v),C(_,v)],length:v-b,overlap:s6(Yi(p,U),Yi(y,_))})}}return{horizontalGaps:a,verticalGaps:d}},UL=(e,t,n,i,s,r,o)=>{if(!Qc({app:n,event:i,selectedElements:e}))return[];if(e.length===0)return[];const a=eo.getVisibleGaps();if(a){const{horizontalGaps:l,verticalGaps:c}=a,[d,u,f,h]=uw(e,t).map(U=>un(U)),m=(d+f)/2,p=(u+h)/2;for(const U of l){if(!i6(Yi(u,h),U.overlap))continue;const b=U.startSide[0][0]+U.length/2,y=un(b-m);if(U.length>f-d&&Math.abs(y)<=o.x){Math.abs(y)<o.x&&(s.length=0),o.x=Math.abs(y);const x={type:"gap",direction:"center_horizontal",gap:U,offset:y};s.push(x);continue}const[,,_]=U.endBounds,I=d-_,R=un(U.length-I);if(Math.abs(R)<=o.x){Math.abs(R)<o.x&&(s.length=0),o.x=Math.abs(R);const x={type:"gap",direction:"side_right",gap:U,offset:R};s.push(x);continue}const[T,,,]=U.startBounds,w=T-f,S=un(w-U.length);if(Math.abs(S)<=o.x){Math.abs(S)<o.x&&(s.length=0),o.x=Math.abs(S);const x={type:"gap",direction:"side_left",gap:U,offset:S};s.push(x);continue}}for(const U of c){if(!i6(Yi(d,f),U.overlap))continue;const b=U.startSide[0][1]+U.length/2,y=un(b-p);if(U.length>h-u&&Math.abs(y)<=o.y){Math.abs(y)<o.y&&(r.length=0),o.y=Math.abs(y);const x={type:"gap",direction:"center_vertical",gap:U,offset:y};r.push(x);continue}const[,_,,]=U.startBounds,I=_-h,R=un(I-U.length);if(Math.abs(R)<=o.y){Math.abs(R)<o.y&&(r.length=0),o.y=Math.abs(R);const x={type:"gap",direction:"side_top",gap:U,offset:R};r.push(x);continue}const[,,,T]=U.endBounds,w=un(u-T),S=U.length-w;if(Math.abs(S)<=o.y){Math.abs(S)<o.y&&(r.length=0),o.y=Math.abs(S);const x={type:"gap",direction:"side_bottom",gap:U,offset:S};r.push(x);continue}}}},z3e=(e,t,n,i)=>{const s=Ej(e,t,n,i);return qB(s,i).filter(r=>!(r.length===1&&Nt(r[0]))).flatMap(r=>K0(r,i))},dg=(e,t,n,i,s,r,o)=>{if(!Qc({app:n,event:i,selectedElements:e})||e.length===0&&t.length===0)return[];const a=eo.getReferenceSnapPoints();if(a)for(const l of t)for(const c of a){const d=c[0]-l[0],u=c[1]-l[1];Math.abs(d)<=o.x&&(Math.abs(d)<o.x&&(s.length=0),s.push({type:"point",points:[l,c],offset:d}),o.x=Math.abs(d)),Math.abs(u)<=o.y&&(Math.abs(u)<o.y&&(r.length=0),r.push({type:"point",points:[l,c],offset:u}),o.y=Math.abs(u))}},H3e=(e,t,n,i,s)=>{var U,b;const r=n.state,o=Ye(e,r);if(!Qc({app:n,event:i,selectedElements:o})||o.length===0)return{snapOffset:{x:0,y:0},snapLines:[]};t.x=un(t.x),t.y=un(t.y);const a=[],l=[],c=nE(r.zoom.value),d={x:c,y:c},u=K0(o,s,{dragOffset:t});dg(o,u,n,i,a,l,d),UL(o,t,n,i,a,l,d);const f={x:((U=a[0])==null?void 0:U.offset)??0,y:((b=l[0])==null?void 0:b.offset)??0};d.x=0,d.y=0,a.length=0,l.length=0;const h={x:un(t.x+f.x),y:un(t.y+f.y)};dg(o,K0(o,s,{dragOffset:h}),n,i,a,l,d),UL(o,h,n,i,a,l,d);const m=XT(a,l),p=$3e(o,h,[...a,...l].filter(y=>y.type==="gap"));return{snapOffset:f,snapLines:[...m,...p]}},un=e=>Math.round(e*10**6)/10**6,bL=e=>{const t=new Map;for(const n of e){const i=n.join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},XT=(e,t)=>{const n={},i={};if(e.length>0){for(const s of e)if(s.type==="point"){const r=un(s.points[0][0]);n[r]||(n[r]=[]),n[r].push(...s.points.map(o=>C(un(o[0]),un(o[1]))))}}if(t.length>0){for(const s of t)if(s.type==="point"){const r=un(s.points[0][1]);i[r]||(i[r]=[]),i[r].push(...s.points.map(o=>C(un(o[0]),un(o[1]))))}}return Object.entries(n).map(([s,r])=>({type:"points",points:bL(r.map(o=>C(Number(s),o[1])).sort((o,a)=>o[1]-a[1]))})).concat(Object.entries(i).map(([s,r])=>({type:"points",points:bL(r.map(o=>C(o[0],Number(s))).sort((o,a)=>o[0]-a[0]))})))},V3e=e=>{const t=new Map;for(const n of e){const i=n.points.flat().map(s=>[un(s)]).join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},$3e=(e,t,n)=>{const[i,s,r,o]=uw(e,t),a=[];for(const l of n){const[c,d,u,f]=l.gap.startBounds,[h,m,p,U]=l.gap.endBounds,b=s6(Yi(s,o),l.gap.overlap),y=s6(Yi(i,r),l.gap.overlap);switch(l.direction){case"center_horizontal":{if(b){const v=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[C(l.gap.startSide[0][0],v),C(i,v)]},{type:"gap",direction:"horizontal",points:[C(r,v),C(l.gap.endSide[0][0],v)]})}break}case"center_vertical":{if(y){const v=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[C(v,l.gap.startSide[0][1]),C(v,s)]},{type:"gap",direction:"vertical",points:[C(v,o),C(v,l.gap.endSide[0][1])]})}break}case"side_right":{if(b){const v=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[C(u,v),C(h,v)]},{type:"gap",direction:"horizontal",points:[C(p,v),C(i,v)]})}break}case"side_left":{if(b){const v=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[C(r,v),C(c,v)]},{type:"gap",direction:"horizontal",points:[C(u,v),C(h,v)]})}break}case"side_top":{if(y){const v=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[C(v,o),C(v,d)]},{type:"gap",direction:"vertical",points:[C(v,f),C(v,m)]})}break}case"side_bottom":{if(y){const v=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[C(v,f),C(v,m)]},{type:"gap",direction:"vertical",points:[C(v,U),C(v,s)]})}break}}}return V3e(a.map(l=>({...l,points:l.points.map(c=>C(un(c[0]),un(c[1])))})))},yL=(e,t,n,i,s,r)=>{var R,T;if(!Qc({event:i,selectedElements:e,app:n})||e.length===0||e.length===1&&!F3e(e[0].angle,0))return{snapOffset:{x:0,y:0},snapLines:[]};let[o,a,l,c]=pt(t);r&&(r.includes("e")?l+=s.x:r.includes("w")&&(o+=s.x),r.includes("n")?a+=s.y:r.includes("s")&&(c+=s.y));const d=[];if(r)switch(r){case"e":{d.push(C(l,a),C(l,c));break}case"w":{d.push(C(o,a),C(o,c));break}case"n":{d.push(C(o,a),C(l,a));break}case"s":{d.push(C(o,c),C(l,c));break}case"ne":{d.push(C(l,a));break}case"nw":{d.push(C(o,a));break}case"se":{d.push(C(l,c));break}case"sw":{d.push(C(o,c));break}}const u=nE(n.state.zoom.value),f={x:u,y:u},h=[],m=[];dg(t,d,n,i,h,m,f);const p={x:((R=h[0])==null?void 0:R.offset)??0,y:((T=m[0])==null?void 0:T.offset)??0};f.x=0,f.y=0,h.length=0,m.length=0;const[U,b,y,v]=pt(e).map(w=>un(w)),_=[C(U,b),C(U,v),C(y,b),C(y,v)];dg(e,_,n,i,h,m,f);const I=XT(h,m);return{snapOffset:p,snapLines:I}},G3e=(e,t,n,i,s,r)=>{var m,p;if(!Qc({event:n,selectedElements:[e],app:t}))return{snapOffset:{x:0,y:0},snapLines:[]};const o=[C(i.x+s.x,i.y+s.y)],a=nE(t.state.zoom.value),l={x:a,y:a},c=[],d=[];dg([e],o,t,n,c,d,l);const u={x:((m=c[0])==null?void 0:m.offset)??0,y:((p=d[0])==null?void 0:p.offset)??0};l.x=0,l.y=0,c.length=0,d.length=0;const f=K0([e],r,{boundingBoxCorners:!0,omitCenter:!0});dg([e],f,t,n,c,d,l);const h=XT(c,d);return{snapOffset:u,snapLines:h}},X3e=(e,t,n,i,s)=>{if(!Qc({event:i,selectedElements:[],app:t}))return{originOffset:{x:0,y:0},snapLines:[]};const r=QB(e,[],t.state,s),o=nE(t.state.zoom.value),a={x:o,y:o},l=[],c=[];for(const d of r){const u=K0([d],s);for(const f of u){const h=f[0]-n.x;Math.abs(h)<=Math.abs(a.x)&&(Math.abs(h)<Math.abs(a.x)&&(c.length=0),c.push({type:"pointer",points:[f,C(f[0],n.y)],direction:"vertical"}),a.x=h);const m=f[1]-n.y;Math.abs(m)<=Math.abs(a.y)&&(Math.abs(m)<Math.abs(a.y)&&(l.length=0),l.push({type:"pointer",points:[f,C(n.x,f[1])],direction:"horizontal"}),a.y=m)}}return{originOffset:{x:c.length>0?c[0].points[0][0]-n.x:0,y:l.length>0?l[0].points[0][1]-n.y:0},snapLines:[...c,...l]}},j3e=e=>e===ii.rectangle||e===ii.ellipse||e===ii.diamond||e===ii.frame||e===ii.magicframe||e===ii.image||e===ii.text,U2={width:100,height:0},hc=100,Y3e=(e,t,n)=>{const i=cr({x:0,y:0,textAlign:p0.CENTER,verticalAlign:qs.MIDDLE,...t,containerId:e.id,strokeColor:t.strokeColor||e.strokeColor});return Object.assign(e,{boundElements:(e.boundElements||[]).concat({type:"text",id:i.id})}),ns(i,e,n),[e,i]},EL=(e,t,n,i,s)=>{let r,o;if(Object.assign(e,{startBinding:(e==null?void 0:e.startBinding)||null,endBinding:e.endBinding||null}),t){const d=(t==null?void 0:t.width)??hc,u=(t==null?void 0:t.height)??hc;let f;t.id&&(f=i.getElement(t.id),f||console.error(`No element for start binding with id ${t.id} found`));const h=t.x||e.x-d,m=t.y||e.y-u/2,p=f?f.type:t.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:t.type==="text"&&(U=t.text),U||console.error(`No text found for start binding text element for ${e.id}`),r=cr({x:h,y:m,type:"text",...f,...t,text:U}),Object.assign(r,{x:t.x||e.x-r.width,y:t.y||e.y-r.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{r=aa({x:h,y:m,width:d,height:u,...f,...t,type:p});break}default:na(e,`Unhandled element start type "${t.type}"`,!0)}mu(e,r,"orbit","start",s)}}if(n){const d=(n==null?void 0:n.height)??hc,u=(n==null?void 0:n.width)??hc;let f;n.id&&(f=i.getElement(n.id),f||console.error(`No element for end binding with id ${n.id} found`));const h=n.x||e.x+e.width,m=n.y||e.y-d/2,p=f?f.type:n.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:n.type==="text"&&(U=n.text),U||console.error(`No text found for end binding text element for ${e.id}`),o=cr({x:h,y:m,type:"text",...f,...n,text:U}),Object.assign(o,{y:n.y||e.y-o.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{o=aa({x:h,y:m,width:u,height:d,...f,...n,type:p});break}default:na(e,`Unhandled element end type "${p}"`,!0)}mu(e,o,"orbit","end",s)}}if(e.points.length<2)return{linearElement:e,startBoundElement:r,endBoundElement:o};const a=e.points.length-1,l=.5,c=Ja(e.points);return e.points[a][0]>e.points[a-1][0]&&(c[0][0]=l,c[a][0]-=l),e.points[a][0]<e.points[a-1][0]&&(c[0][0]=-.5,c[a][0]+=l),e.points[a][1]>e.points[a-1][1]&&(c[0][1]=l,c[a][1]-=l),e.points[a][1]<e.points[a-1][1]&&(c[0][1]=-.5,c[a][1]+=l),Object.assign(e,re.getNormalizeElementPointsAndCoords({...e,points:c})),{linearElement:e,startBoundElement:r,endBoundElement:o}};class W3e{constructor(){F(this,"excalidrawElements",new Map);F(this,"add",t=>{t&&this.excalidrawElements.set(t.id,t)});F(this,"getElements",()=>fd(Array.from(this.excalidrawElements.values())));F(this,"getElementsMap",()=>ia(be(this.getElements())));F(this,"getElement",t=>this.excalidrawElements.get(t))}}const Fv=(e,t)=>{var l,c,d;if(!e)return[];const n=Ja(e),i=new W3e,s=new Map,r=new Map;for(const u of n){let f;const h=u.id;switch((t==null?void 0:t.regenerateIds)!==!1&&Object.assign(u,{id:ys()}),u.type){case"rectangle":case"ellipse":case"diamond":{const p=(l=u==null?void 0:u.label)!=null&&l.text&&u.width===void 0?0:(u==null?void 0:u.width)||hc,U=(c=u==null?void 0:u.label)!=null&&c.text&&u.height===void 0?0:(u==null?void 0:u.height)||hc;f=aa({...u,width:p,height:U});break}case"line":{const p=u.width||U2.width,U=u.height||U2.height;f=Sc({width:p,height:U,points:[C(0,0),C(p,U)],...u});break}case"arrow":{const p=u.width||U2.width,U=u.height||U2.height;f=ph({width:p,height:U,endArrowhead:"arrow",points:[C(0,0),C(p,U)],...u,type:"arrow"}),Object.assign(f,zh(f.points));break}case"text":{const p=(u==null?void 0:u.fontFamily)||ad,U=(u==null?void 0:u.fontSize)||Cl,b=(u==null?void 0:u.lineHeight)||zc(p),y=u.text??"",v=$h(y),_=qn(v,bt({fontFamily:p,fontSize:U}),b);f=cr({width:_.width,height:_.height,fontFamily:p,fontSize:U,...u});break}case"image":{f=Az({width:(u==null?void 0:u.width)||hc,height:(u==null?void 0:u.height)||hc,...u});break}case"frame":{f=mw({x:0,y:0,...u});break}case"magicframe":{f=C4({x:0,y:0,...u});break}case"freedraw":case"iframe":case"embeddable":{f=u;break}default:f=u,na(u,`Unhandled element type "${u.type}"`,!0)}i.getElement(f.id)?console.error(`Duplicate id found for ${f.id}`):(i.add(f),s.set(f.id,u),h&&r.set(h,f.id))}const o=i.getElementsMap(),a=new T6(o);for(const[u,f]of s){const h=i.getElement(u);switch(f.type){case"rectangle":case"ellipse":case"diamond":case"arrow":{if((d=f.label)!=null&&d.text){let[m,p]=Y3e(h,f==null?void 0:f.label,a);if(i.add(m),i.add(p),_e(m)){const U=f.type==="arrow"?f==null?void 0:f.start:void 0,b=f.type==="arrow"?f==null?void 0:f.end:void 0;if(U&&U.id){const I=r.get(U.id);I&&Object.assign(U,{id:I})}if(b&&b.id){const I=r.get(b.id);I&&Object.assign(b,{id:I})}const{linearElement:y,startBoundElement:v,endBoundElement:_}=EL(m,U,b,i,a);m=y,i.add(y),i.add(v),i.add(_)}}else switch(f.type){case"arrow":{const{start:m,end:p}=f;if(m&&m.id){const v=r.get(m.id);Object.assign(m,{id:v})}if(p&&p.id){const v=r.get(p.id);Object.assign(p,{id:v})}const{linearElement:U,startBoundElement:b,endBoundElement:y}=EL(h,m,p,i,a);i.add(U),i.add(b),i.add(y);break}}break}}}for(const[u,f]of s){if(f.type!=="frame"&&f.type!=="magicframe")continue;const h=i.getElement(u);if(!h)throw new Error(`Excalidraw element with id ${u} doesn't exist`);const m=[];f.children.forEach(w=>{var k;const S=r.get(w);if(!S)throw new Error(`Element with ${w} wasn't mapped correctly`);const x=i.getElement(S);if(!x)throw new Error(`Frame element with id ${S} doesn't exist`);Object.assign(x,{frameId:h.id}),(k=x==null?void 0:x.boundElements)==null||k.forEach(P=>{const D=i.getElement(P.id);if(!D)throw new Error(`Bound element with id ${P.id} doesn't exist`);Object.assign(D,{frameId:h.id}),m.push(D)}),m.push(x)});let[p,U,b,y]=pt(m);const v=10;p=p-v,U=U-v,b=b+v,y=y+v;const _=(h==null?void 0:h.x)||p,I=(h==null?void 0:h.y)||U,R=(h==null?void 0:h.width)||b-p,T=(h==null?void 0:h.height)||y-U;Object.assign(h,{x:_,y:I,width:R,height:T})}return i.getElements()};class vL{constructor(t){F(this,"scene");F(this,"getRenderableElements",(()=>{const t=({elementsMap:i,zoom:s,offsetLeft:r,offsetTop:o,scrollX:a,scrollY:l,height:c,width:d})=>{const u=[];for(const f of i.values())_6(f,d,c,{zoom:s,offsetLeft:r,offsetTop:o,scrollX:a,scrollY:l},i)&&u.push(f);return u},n=({elements:i,editingTextElement:s,newElementId:r})=>{const o=ia(new Map);for(const a of i)r!==a.id&&(!s||s.type!=="text"||a.id!==s.id)&&o.set(a.id,a);return o};return Dte(({zoom:i,offsetLeft:s,offsetTop:r,scrollX:o,scrollY:a,height:l,width:c,editingTextElement:d,newElementId:u,sceneNonce:f})=>{const h=this.scene.getNonDeletedElements(),m=n({elements:h,editingTextElement:d,newElementId:u}),p=t({elementsMap:m,zoom:i,offsetLeft:s,offsetTop:r,scrollX:o,scrollY:a,height:l,width:c});return{elementsMap:m,visibleElements:p}})})());this.scene=t}destroy(){dX.cancel(),this.getRenderableElements.clear()}}const K3e=5,Z3e=(e,t,n)=>{const[i,s]=$e(e,n),{x:r,y:o}=Qs({sceneX:i+e.width,sceneY:s},t),a=r-t.offsetLeft+10,l=o-t.offsetTop;return{x:a,y:l}},_L=({children:e,element:t,elementsMap:n})=>{const i=qp();if(i.contextMenu||i.newElement||i.resizingElement||i.isRotating||i.openMenu||i.viewModeEnabled)return null;const{x:s,y:r}=Z3e(t,i,n);return g("div",{className:"excalidraw-canvas-buttons",style:{top:`${r}px`,left:`${s}px`,padding:K3e},children:e})};function q3e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var Q3e={};q3e(Q3e,"LaserPointer",()=>t5);function wn([e,t,n],[i,s,r]){return[e+i,t+s,n+r]}function im([e,t,n],[i,s,r]){return[e-i,t-s,n-r]}function Vn([e,t,n],i){return[e*i,t*i,n*i]}function pf([e,t,n]){return[e/Math.sqrt(e**2+t**2),t/Math.sqrt(e**2+t**2),n]}function Gi([e,t,n],i){return[Math.cos(i)*e-Math.sin(i)*t,Math.sin(i)*e+Math.cos(i)*t,n]}function J3e(e,t,n){return wn(e,Vn(im(t,e),n))}function wL(e,t,n){return Math.atan2(n[1]-e[1],n[0]-e[0])-Math.atan2(t[1]-e[1],t[0]-e[0])}function TL(e){return Math.atan2(Math.sin(e),Math.cos(e))}function IL([e,t]){return Math.sqrt(e**2+t**2)}function Sh([e,t],[n,i]){return Math.sqrt((n-e)**2+(i-t)**2)}function e7e(e){if(e.length<2)return 0;let t=0;for(let n=1;n<=e.length-1;n++)t+=Sh(e[n-1],e[n]);return t+=Sh(e[e.length-2],e[e.length-1]),t}const t7e=(e,t,n)=>Math.max(t,Math.min(n,e));function n7e(e,t,n){const i=Sh(t,n);if(i===0)return Sh(e,t);const s=t7e(((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i**2,0,1),r=[t[0]+s*(n[0]-t[0]),t[1]+s*(n[1]-t[1]),e[2]];return Sh(r,e)}function e5(e,t){if(t===0||e.length<=2)return e;const n=e[0],i=e[e.length-1],[s,r]=e.reduce(([o,a],l,c)=>{const d=n7e(l,n,i);return d>o?[d,c]:[o,a]},[0,-1]);if(s>=t){const o=e[r];return[...e5([n,...e.slice(1,r),o],t).slice(0,-1),o,...e5([o,...e.slice(r,-1),i],t).slice(1)]}else return[n,i]}const Ql=class Ql{constructor(t){this.originalPoints=[],this.stablePoints=[],this.tailPoints=[],this.isFresh=!0,this.options=Object.assign({},Ql.defaults,t)}get lastPoint(){return this.tailPoints[this.tailPoints.length-1]??this.stablePoints[this.stablePoints.length-1]}addPoint(t){const n=this.originalPoints[this.originalPoints.length-1];if(!(n&&n[0]===t[0]&&n[1]===t[1])){if(this.originalPoints.push(t),this.isFresh){this.isFresh=!1,this.stablePoints.push(t);return}this.options.streamline>0&&(t=J3e(this.lastPoint,t,1-this.options.streamline)),this.tailPoints.push(t),e7e(this.tailPoints)>Ql.constants.maxTailLength&&this.stabilizeTail()}}close(){this.stabilizeTail()}stabilizeTail(){if(this.options.simplify>0&&this.options.simplifyPhase=="tail")throw new Error("Not implemented yet");this.stablePoints.push(...this.tailPoints),this.tailPoints=[]}getSize(t,n,i,s,r){return(t??this.options.size)*this.options.sizeMapping({pressure:n,runningLength:r,currentIndex:i,totalLength:s})}getStrokeOutline(t){if(this.isFresh)return[];let n=[...this.stablePoints,...this.tailPoints];this.options.simplify>0&&this.options.simplifyPhase==="input"&&(n=e5(n,this.options.simplify));const i=n.length;if(i===0)return[];if(i===1){const T=n[0],w=this.getSize(t,T[2],0,i,0);if(w<.5)return[];const S=[];for(let x=0;x<=Math.PI*2;x+=Math.PI/16)S.push(wn(T,Vn(Gi([1,0,0],x),w)));return S.push(wn(T,Vn([1,0,0],this.getSize(t,T[2],0,i,0)))),S}if(i===2){const T=n[0],w=n[1],S=this.getSize(t,T[2],0,i,0),x=this.getSize(t,w[2],0,i,0);if(S<.5||x<.5)return[];const k=[],P=wL(T,[T[0],T[1]-100,T[2]],w);for(let D=P;D<=Math.PI+P;D+=Math.PI/16)k.push(wn(T,Vn(Gi([1,0,0],D),S)));for(let D=Math.PI+P;D<=Math.PI*2+P;D+=Math.PI/16)k.push(wn(w,Vn(Gi([1,0,0],D),x)));return k.push(k[0]),k}const s=[],r=[];let o=0,a=0,l=0,c=0;for(let T=1;T<i-1;T++){const w=n[T-1],S=n[T],x=n[T+1];let k=S[2];const P=Sh(w,S);c+=P,o=a+(P-a)*.2;const D=this.getSize(t,k,T,i,c);if(D===0){l=T+1;continue}const j=pf(im(w,S)),G=pf(im(x,S)),V=Gi(j,Math.PI/2),B=Gi(j,-Math.PI/2),z=Gi(G,Math.PI/2),X=Gi(G,-Math.PI/2),Y=wn(S,Vn(V,D)),ee=wn(S,Vn(B,D)),se=wn(S,Vn(z,D)),oe=wn(S,Vn(X,D)),Fe=wn(V,X),Ge=wn(B,z),Me=wn(S,Vn(IL(Fe)===0?j:pf(Fe),D)),Ne=wn(S,Vn(IL(Ge)===0?G:pf(Ge),D)),et=TL(wL(S,w,x)),Ot=Ql.constants.cornerDetectionMaxAngle/180*Math.PI*Ql.constants.cornerDetectionVariance(o);if(Math.abs(et)<Ot){const Xe=Math.abs(TL(Math.PI-et));if(Xe===0)continue;if(et<0){r.push(ee,Ne);for(let je=0;je<=Xe;je+=Xe/4)s.push(wn(S,Gi(Vn(V,D),je)));for(let je=Xe;je>=0;je-=Xe/4)r.push(wn(S,Gi(Vn(V,D),je)));r.push(Ne,se)}else{s.push(Y,Me);for(let je=0;je<=Xe;je+=Xe/4)r.push(wn(S,Gi(Vn(V,-D),-je)));for(let je=Xe;je>=0;je-=Xe/4)s.push(wn(S,Gi(Vn(V,-D),-je)));s.push(Me,oe)}}else s.push(Me),r.push(Ne);a=o}if(l>=i-2)if(this.options.keepHead){const T=n[i-1],w=[];for(let S=0;S<=Math.PI*2;S+=Math.PI/16)w.push(wn(T,Vn(Gi([1,0,0],S),this.options.size)));return w.push(wn(T,Vn([1,0,0],this.options.size))),w}else return[];const d=n[l],u=n[l+1],f=n[i-2],h=n[i-1],m=pf(im(u,d)),p=pf(im(f,h)),U=Gi(m,-Math.PI/2),b=Gi(p,Math.PI/2),y=this.getSize(t,d[2],0,i,0),v=[],_=this.options.keepHead?this.options.size:this.getSize(t,f[2],i-2,i,c),I=[];if(y>1){for(let T=0;T<=Math.PI;T+=Math.PI/16)v.unshift(wn(d,Gi(Vn(U,y),-T)));v.unshift(wn(d,Vn(U,-y)))}else v.push(d);for(let T=0;T<=Math.PI*3;T+=Math.PI/16)I.push(wn(h,Gi(Vn(b,-_),-T)));const R=[...v,...s,...I.reverse(),...r.reverse()];return v.length>0&&R.push(v[0]),this.options.simplify>0&&this.options.simplifyPhase==="output"?e5(R,this.options.simplify):R}};Ql.defaults={size:2,streamline:.45,simplify:.1,simplifyPhase:"output",keepHead:!1,sizeMapping:()=>1},Ql.constants={cornerDetectionMaxAngle:75,cornerDetectionVariance:t=>t>35?.5:1,maxTailLength:50};let t5=Ql;class n5{constructor(t,n,i){F(this,"currentTrail");F(this,"pastTrails",[]);F(this,"container");F(this,"trailElement");F(this,"trailAnimation");this.animationFrameHandler=t,this.app=n,this.options=i,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.trailElement=document.createElementNS(lt,"path"),this.options.animateTrail&&(this.trailAnimation=document.createElementNS(lt,"animate"),this.trailAnimation.setAttribute("attributeName","stroke-dashoffset"),this.trailElement.setAttribute("stroke-dasharray","7 7"),this.trailElement.setAttribute("stroke-dashoffset","10"),this.trailAnimation.setAttribute("from","0"),this.trailAnimation.setAttribute("to","-14"),this.trailAnimation.setAttribute("dur","0.3s"),this.trailElement.appendChild(this.trailAnimation))}get hasCurrentTrail(){return!!this.currentTrail}hasLastPoint(t,n){if(this.currentTrail){const i=this.currentTrail.originalPoints.length;return this.currentTrail.originalPoints[i-1][0]===t&&this.currentTrail.originalPoints[i-1][1]===n}return!1}start(t){t&&(this.container=t),this.trailElement.parentNode!==this.container&&this.container&&this.container.appendChild(this.trailElement),this.animationFrameHandler.start(this)}stop(){var t;this.animationFrameHandler.stop(this),this.trailElement.parentNode===this.container&&((t=this.container)==null||t.removeChild(this.trailElement))}startPath(t,n){this.currentTrail=new t5(this.options),this.currentTrail.addPoint([t,n,performance.now()]),this.update()}addPointToPath(t,n){this.currentTrail&&(this.currentTrail.addPoint([t,n,performance.now()]),this.update())}endPath(){this.currentTrail&&(this.currentTrail.close(),this.currentTrail.options.keepHead=!1,this.pastTrails.push(this.currentTrail),this.currentTrail=void 0,this.update())}getCurrentTrail(){return this.currentTrail}clearTrails(){this.pastTrails=[],this.currentTrail=void 0,this.update()}update(){this.start(),this.trailAnimation&&(this.trailAnimation.setAttribute("begin","indefinite"),this.trailAnimation.setAttribute("repeatCount","indefinite"))}onFrame(){const t=[];for(const i of this.pastTrails)t.push(this.drawTrail(i,this.app.state));if(this.currentTrail){const i=this.drawTrail(this.currentTrail,this.app.state);t.push(i)}this.pastTrails=this.pastTrails.filter(i=>i.getStrokeOutline().length!==0),t.length===0&&this.stop();const n=t.join(" ").trim();this.trailElement.setAttribute("d",n),this.trailAnimation?(this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this)),this.trailElement.setAttribute("stroke",(this.options.stroke??(()=>"black"))(this))):this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this))}drawTrail(t,n){const i=t.getStrokeOutline(t.options.size/n.zoom.value).map(([r,o])=>{const a=Qs({sceneX:r,sceneY:o},n);return[a.x,a.y]}),s=this.trailAnimation?i.slice(0,i.length/2):i;return Pte(s,!0)}}class i7e{constructor(t,n){F(this,"localTrail");F(this,"collabTrails",new Map);F(this,"container");this.animationFrameHandler=t,this.app=n,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.localTrail=new n5(t,n,{...this.getTrailOptions(),fill:()=>dee})}getTrailOptions(){return{simplify:0,streamline:.4,sizeMapping:t=>{const s=Math.max(0,1-(performance.now()-t.pressure)/1e3),r=(50-Math.min(50,t.totalLength-t.currentIndex))/50;return Math.min(fl(r),fl(s))}}}startPath(t,n){this.localTrail.startPath(t,n)}addPointToPath(t,n){this.localTrail.addPointToPath(t,n)}endPath(){this.localTrail.endPath()}start(t){this.container=t,this.animationFrameHandler.start(this),this.localTrail.start(t)}stop(){this.animationFrameHandler.stop(this),this.localTrail.stop()}onFrame(){this.updateCollabTrails()}updateCollabTrails(){if(!(!this.container||this.app.state.collaborators.size===0)){for(const[t,n]of this.app.state.collaborators.entries()){let i;this.collabTrails.has(t)?i=this.collabTrails.get(t):(i=new n5(this.animationFrameHandler,this.app,{...this.getTrailOptions(),fill:()=>{var s;return((s=n.pointer)==null?void 0:s.laserColor)||Wy(t,n)}}),i.start(this.container),this.collabTrails.set(t,i)),n.pointer&&n.pointer.tool==="laser"&&(n.button==="down"&&!i.hasCurrentTrail&&i.startPath(n.pointer.x,n.pointer.y),n.button==="down"&&i.hasCurrentTrail&&!i.hasLastPoint(n.pointer.x,n.pointer.y)&&i.addPointToPath(n.pointer.x,n.pointer.y),n.button==="up"&&i.hasCurrentTrail&&(i.addPointToPath(n.pointer.x,n.pointer.y),i.endPath()))}for(const t of this.collabTrails.keys())this.app.state.collaborators.has(t)||(this.collabTrails.get(t).stop(),this.collabTrails.delete(t))}}}const ln=e=>t=>{cn.unstable_batchedUpdates(e,t)},P3=e=>Tp(t=>{cn.unstable_batchedUpdates(e,t)}),i5=(()=>{let e;try{const n=L.version.split(".");e=Number(n[0])>17}catch{e=!1}let t=!1;return()=>window.EXCALIDRAW_THROTTLE_RENDER===!0?e?!0:(t||(t=!0,console.warn("Excalidraw: render throttling is disabled on React versions < 18.")),!1):!1})(),s7e=(e,t,n,i,s,r)=>{const{zoom:o}=i,a=180*n/Math.PI;let l=e*(o.value-1)/2,c=t*(o.value-1)/2;return e>s&&o.value!==1&&(l=s*(o.value-1)/2),t>r&&o.value!==1&&(c=r*(o.value-1)/2),`translate(${l}px, ${c}px) scale(${o.value}) rotate(${a}deg)`},r7e=({id:e,onChange:t,onSubmit:n,getViewportCoords:i,element:s,canvas:r,excalidrawContainer:o,app:a,autoSelect:l=!0})=>{const c=(G,V)=>{if(!V.style.fontFamily||!V.style.fontSize)return!1;const B=V.style.fontFamily.replace(/"/g,"");return wp({fontFamily:G.fontFamily})!==B||`${G.fontSize}px`!==V.style.fontSize},d=()=>{const G=a.state,V=a.scene.getElement(e);if(!V)return;const{textAlign:B,verticalAlign:z}=V,X=a.scene.getNonDeletedElementsMap();if(V&&fe(V)){let Y=V.x,ee=V.y;const se=Bn(V,a.scene.getNonDeletedElementsMap());let oe=V.width,Fe=V.height,Ge=V.width,Me=V.height;if(se&&V.containerId){if(_e(se)){const yt=re.getBoundTextElementPosition(se,V,X);Y=yt.x,ee=yt.y}const je=c(V,u);let Jt;if(je?Jt=d6(se.id,se.height):(Jt=Vh[se.id],Jt||(Jt=d6(se.id,se.height))),Ge=oa(se,V),Me=Dp(se,V),!_e(se)&&Fe>Me){const yt=gu(Fe,se.type);a.scene.mutateElement(se,{height:yt});return}else if(!_e(se)&&se.height>Jt.height&&Fe<Me){const yt=gu(Fe,se.type);a.scene.mutateElement(se,{height:yt})}else{const{x:yt,y:ss}=dd(se,V,X);Y=yt,ee=ss}}const[Ne,et]=i(Y,ee);se?oe+=.5:(Ge=(G.width-8-Ne)/G.zoom.value,oe=Math.min(oe,Ge)),Fe*=1.05;const Ot=bt(V),Xe=(G.height-et)/G.zoom.value;Object.assign(u.style,{font:Ot,lineHeight:V.lineHeight,width:`${oe}px`,height:`${Fe}px`,left:`${Ne}px`,top:`${et}px`,transform:s7e(oe,Fe,pie(V,se),G,Ge,Xe),textAlign:B,verticalAlign:z,color:V.strokeColor,opacity:V.opacity/100,filter:"var(--theme-filter)",maxHeight:`${Xe}px`}),u.scrollTop=0,a.scene.mutateElement(V,{x:Y,y:ee})}},u=document.createElement("textarea");u.dir="auto",u.tabIndex=0,u.dataset.type="wysiwyg",u.wrap="off",u.classList.add("excalidraw-wysiwyg");let f="pre",h="normal";(Nt(s)||!s.autoResize)&&(f="pre-wrap",h="break-word"),Object.assign(u.style,{position:"absolute",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",zIndex:"var(--zIndex-wysiwyg)",wordBreak:h,whiteSpace:f,overflowWrap:"break-word",boxSizing:"content-box"}),u.value=s.originalText,d(),t&&(u.onpaste=async G=>{const V=(await Iv(G)).findByType(ve.text);if(!V)return;const B=$h(V.value);if(!B)return;const z=Bn(s,a.scene.getNonDeletedElementsMap()),X=bt({fontSize:a.state.currentItemFontSize,fontFamily:a.state.currentItemFontFamily});if(z){const Y=Re(z,a.scene.getNonDeletedElementsMap()),ee=cd(`${u.value}${B}`,X,oa(z,Y)),se=H_(ee,X);u.style.width=`${se}px`}},u.oninput=()=>{const G=$h(u.value);if(u.value!==G){const V=u.selectionStart;u.value=G,u.selectionStart=V,u.selectionEnd=V}t(u.value)}),u.onkeydown=G=>{if(!G.shiftKey&&zk.keyTest(G))G.preventDefault(),a.actionManager.executeAction(zk),d();else if(!G.shiftKey&&Hk.keyTest(G))G.preventDefault(),a.actionManager.executeAction(Hk),d();else if(!G.shiftKey&&Vk.keyTest(G))G.preventDefault(),a.actionManager.executeAction(Vk),d();else if(Nk.keyTest(G))a.actionManager.executeAction(Nk);else if(Ok.keyTest(G))a.actionManager.executeAction(Ok);else if(G.key===$.ESCAPE)G.preventDefault(),I=!0,R();else if(Z6.keyTest(G))G.preventDefault(),R(),a.actionManager.executeAction(Z6);else if(G.key===$.ENTER&&G[$.CTRL_OR_CMD]){if(G.preventDefault(),G.isComposing||G.keyCode===229)return;I=!0,R()}else if(G.key===$.TAB||G[$.CTRL_OR_CMD]&&(G.code===ot.BRACKET_LEFT||G.code===ot.BRACKET_RIGHT)){if(G.preventDefault(),G.isComposing)return;G.shiftKey||G.code===ot.BRACKET_LEFT?y():b(),u.dispatchEvent(new Event("input"))}};const m=4,p=" ".repeat(m),U=new RegExp(`^ {1,${m}}`),b=()=>{const{selectionStart:G,selectionEnd:V}=u,B=v();let z=u.value;B.forEach(X=>{const Y=z.slice(0,X),ee=z.slice(X);z=`${Y}${p}${ee}`}),u.value=z,u.selectionStart=G+m,u.selectionEnd=V+m*B.length},y=()=>{const{selectionStart:G,selectionEnd:V}=u,B=v(),z=[];let X=u.value;B.forEach(Y=>{const ee=X.slice(Y,Y+m).match(U);if(ee){const se=X.slice(0,Y),oe=X.slice(Y+ee[0].length);X=`${se}${oe}`,z.push(Y)}}),u.value=X,z.length&&(G>z[z.length-1]?u.selectionStart=Math.max(G-m,z[z.length-1]):u.selectionStart=G,u.selectionEnd=Math.max(u.selectionStart,V-m*z.length))},v=()=>{let{selectionStart:G,selectionEnd:V,value:B}=u;const z=B.slice(0,G).match(/[^\n]*$/)[0].length;return G=G-z,B.slice(G,V).split(`
`).reduce((Y,ee,se,oe)=>Y.concat(se?Y[se-1]+oe[se-1].length+1:G),[]).reverse()},_=G=>{G.target instanceof HTMLCanvasElement&&(G.preventDefault(),G.stopPropagation())};let I=!1;const R=()=>{var B;if(D)return;D=!0,T();const G=a.scene.getElement(s.id);if(!G)return;const V=Bn(G,a.scene.getNonDeletedElementsMap());if(V){if(u.value.trim()){const z=ra(V);!z||z!==s.id?a.scene.mutateElement(V,{boundElements:(V.boundElements||[]).concat({type:"text",id:s.id})}):_e(V)&&Ha(V)}else a.scene.mutateElement(V,{boundElements:(B=V.boundElements)==null?void 0:B.filter(z=>!fe(z))});ns(G,V,a.scene)}n({viaKeyboard:I,nextOriginalText:u.value})},T=()=>{u.onblur=null,u.oninput=null,u.onkeydown=null,j&&j.disconnect(),window.removeEventListener("resize",d),window.removeEventListener("wheel",_,!0),window.removeEventListener("pointerdown",x),window.removeEventListener("pointerup",w),window.removeEventListener("blur",R),window.removeEventListener("beforeunload",R),k(),P(),u.remove()},w=G=>{window.removeEventListener("pointerup",w);const V=G==null?void 0:G.target,B=V instanceof HTMLElement&&V.classList.contains("properties-trigger"),z=(V instanceof HTMLElement||V instanceof SVGElement)&&!!V.closest(".properties-content"),X=(V instanceof HTMLElement||V instanceof SVGElement)&&(!!V.closest(`.${bs.SHAPE_ACTIONS_MENU}`)||!!V.closest(".compact-shape-actions-island"));setTimeout(()=>{X||B||z||(u.onblur=R,u.focus())})},S=()=>{u.onblur=null,window.addEventListener("pointerup",w),window.addEventListener("blur",R)},x=G=>{const V=G==null?void 0:G.target;if(G.button===Vl.WHEEL){V instanceof HTMLTextAreaElement&&(G.preventDefault(),a.handleCanvasPanUsingWheelOrSpaceDrag(G)),S();return}const B=V instanceof HTMLElement&&V.classList.contains("properties-trigger"),z=(V instanceof HTMLElement||V instanceof SVGElement)&&!!V.closest(".properties-content");(G.target instanceof HTMLElement||G.target instanceof SVGElement)&&(G.target.closest(`.${bs.SHAPE_ACTIONS_MENU}, .${bs.ZOOM_ACTIONS}`)||G.target.closest(".compact-shape-actions-island"))&&!Ba(G.target)||B||z?S():G.target instanceof HTMLCanvasElement&&requestAnimationFrame(()=>{R()})},k=a.scene.onUpdate(()=>{var V;d(),!!((V=document.activeElement)!=null&&V.closest(".properties-content"))||u.focus()}),P=a.onScrollChangeEmitter.on(()=>{d()});let D=!1;l&&u.select(),w();let j=null;return r&&"ResizeObserver"in window?(j=new window.ResizeObserver(()=>{d()}),j.observe(r)):window.addEventListener("resize",d),u.onpointerdown=G=>G.stopPropagation(),requestAnimationFrame(()=>{window.addEventListener("pointerdown",x,{capture:!0})}),window.addEventListener("beforeunload",R),o==null||o.querySelector(".excalidraw-textEditorContainer").appendChild(u),R},Xl=4,Po=6,o7e="rgba(0,0,0,0.3)",a7e=(e,t,n,i)=>{if(!e.size)return{horizontal:null,vertical:null};const[s,r,o,a]=pt(e),l=t/i.zoom.value,c=n/i.zoom.value,d={top:parseInt(HU("sat"))||0,bottom:parseInt(HU("sab"))||0,left:parseInt(HU("sal"))||0,right:parseInt(HU("sar"))||0},u=x0().rtl,f=-i.scrollX+d.left,h=-i.scrollY+d.top,m=f+l-d.right,p=h+c-d.bottom,U=Math.min(s,f),b=Math.min(r,h),y=Math.max(o,m),v=Math.max(a,p),_=o-s,I=a-r,R=y-U,T=v-b,w=Math.max(Xl*2,d.left+d.right)+Po*2,S=t*(l/R)-w,x=Math.max(Xl*2,d.top+d.bottom)+Po*2,k=n*(c/T)-x,P=R>_?R*i.zoom.value/(S+w):t/(S+w),D=T>I?T*i.zoom.value/(k+x):n/(k+x);return{horizontal:f===U&&m===y?null:{x:Math.max(d.left,Xl)+Po+(f-U)/R*t,y:n-Po-Math.max(Xl,d.bottom),width:S,height:Po,deltaMultiplier:P},vertical:h===b&&p===v?null:{x:u?Math.max(d.left,Xl):t-Po-Math.max(d.right,Xl),y:Math.max(d.top,Xl)+Po+(h-b)/T*n,width:Po,height:k,deltaMultiplier:D}}},SL=(e,t,n)=>{const[i,s]=[e.horizontal,e.vertical].map(o=>o!=null&&o.x<=t&&t<=o.x+o.width&&o.y<=n&&n<=o.y+o.height);return{isOverEither:i||s,isOverHorizontal:i,isOverVertical:s}},l7e=e=>{const t=["flowchart","graph","sequenceDiagram","classDiagram","stateDiagram","stateDiagram-v2","erDiagram","journey","gantt","pie","quadrantChart","requirementDiagram","gitGraph","C4Context","mindmap","timeline","zenuml","sankey","xychart","block"];return new RegExp(`^(?:%%{.*?}%%[\\s\\n]*)?\\b(?:${t.map(i=>`\\s*${i}(-beta)?`).join("|")})\\b`).test(e.trim())};function N3(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function c7e(e,t,n){const i=N3(t,n);if(i===0)return N3(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return s=Math.max(0,Math.min(1,s)),N3(e,d7e(t,n,s))}function d7e(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function u7e(e,t){return Bv(e,0,e.length,t)}function Bv(e,t,n,i,s){const r=s||[],o=e[t],a=e[n-1];let l=0,c=1;for(let d=t+1;d<n-1;++d){const u=c7e(e[d],o,a);u>l&&(l=u,c=d)}return Math.sqrt(l)>i?(Bv(e,t,c+1,i,r),Bv(e,c,n,i,r)):(r.length||r.push(o),r.push(a)),r}const f7e=e=>{const{lassoPath:t,elements:n,elementsMap:i,elementsSegments:s,intersectedElements:r,enclosedElements:o,simplifyDistance:a}=e;let l=t;a&&(l=u7e(t,a));const c=n.filter(f=>!f.locked);o.clear(),r.clear();const d=t.reduce((f,h)=>[Math.min(f[0],h[0]),Math.min(f[1],h[1]),Math.max(f[2],h[0]),Math.max(f[3],h[1])],[1/0,1/0,-1/0,-1/0]);for(const f of c){const h=Mn(f,i);ud(d,h)&&!r.has(f.id)&&!o.has(f.id)&&(h7e(l,f,s)?o.add(f.id):g7e(l,f,i)&&r.add(f.id))}return{selectedElementIds:[...r,...o]}},h7e=(e,t,n)=>{const i=n6(e),s=n.get(t.id);return s?s.some(r=>r.some(o=>qF(o,i))):!1},g7e=(e,t,n)=>{const i=e.slice(1).map((r,o)=>ke(e[o],r)).concat([ke(e[e.length-1],e[0])]),s=Re(t,n);return i.some(r=>fo(t,n,r,0,!0).length>0||!!s&&fo({...s,...dd(t,s,n)},n,r,0,!0).length>0)};class m7e extends n5{constructor(n,i){super(n,i,{animateTrail:!0,streamline:.4,sizeMapping:s=>{const a=Math.max(0,1-(performance.now()-s.pressure)/(1/0)),l=(5e3-Math.min(5e3,s.totalLength-s.currentIndex))/5e3;return Math.min(fl(l),fl(a))},fill:()=>"rgba(105,101,219,0.05)",stroke:()=>"rgba(105,101,219)"});F(this,"intersectedElements",new Set);F(this,"enclosedElements",new Set);F(this,"elementsSegments",null);F(this,"canvasTranslate",null);F(this,"keepPreviousSelection",!1);F(this,"selectElementsFromIds",n=>{this.app.setState(i=>{const s=n.reduce((l,c)=>(l[c]=!0,l),{});if(this.keepPreviousSelection)for(const l of Object.keys(i.selectedElementIds))s[l]=!0;for(const[l]of Object.entries(s)){const c=this.app.scene.getNonDeletedElement(l);if(c&&fe(c)){const d=Bn(c,this.app.scene.getNonDeletedElementsMap());d&&(s[d.id]=!0,delete s[c.id])}}for(const[l]of Object.entries(s)){const c=this.app.scene.getNonDeletedElement(l);if(c&&Ue(c)){const d=or(this.app.scene.getNonDeletedElementsMap(),c.id);for(const u of d)delete s[u.id]}}const r=xi({editingGroupId:i.editingGroupId,selectedElementIds:s},this.app.scene.getNonDeletedElements(),i,this.app),o=[...Object.keys(r.selectedElementIds)],a=[...Object.keys(r.selectedGroupIds)];return{selectedElementIds:r.selectedElementIds,selectedGroupIds:r.selectedGroupIds,selectedLinearElement:o.length===1&&!a.length&&Ce(this.app.scene.getNonDeletedElement(o[0]))?new re(this.app.scene.getNonDeletedElement(o[0]),this.app.scene.getNonDeletedElementsMap()):null}})});F(this,"addPointToPath",(n,i,s=!1)=>{super.addPointToPath(n,i),this.keepPreviousSelection=s,this.updateSelection()});F(this,"updateSelection",()=>{var s,r;const n=(r=(s=super.getCurrentTrail())==null?void 0:s.originalPoints)==null?void 0:r.map(o=>C(o[0],o[1])),i={scrollX:this.app.state.scrollX,scrollY:this.app.state.scrollY,zoom:this.app.state.zoom.value};if(!this.elementsSegments||!vi(i,this.canvasTranslate??{})){this.canvasTranslate=i,this.elementsSegments=new Map;const o=be(this.app.visibleElements);for(const a of this.app.visibleElements){const l=v6(a,o);this.elementsSegments.set(a.id,l)}}if(n){const{selectedElementIds:o}=f7e({lassoPath:n,elements:this.app.visibleElements,elementsMap:this.app.scene.getNonDeletedElementsMap(),elementsSegments:this.elementsSegments,intersectedElements:this.intersectedElements,enclosedElements:this.enclosedElements,simplifyDistance:5/this.app.state.zoom.value});this.selectElementsFromIds(o)}})}startPath(n,i,s=!1){this.endPath(),super.startPath(n,i),this.intersectedElements.clear(),this.enclosedElements.clear(),this.keepPreviousSelection=s,this.keepPreviousSelection||this.app.setState({selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null})}endPath(){super.endPath(),super.clearTrails(),this.intersectedElements.clear(),this.enclosedElements.clear(),this.elementsSegments=null}}class p7e extends n5{constructor(n,i){super(n,i,{streamline:.2,size:5,keepHead:!0,sizeMapping:s=>{const a=Math.max(0,1-(performance.now()-s.pressure)/200),l=(10-Math.min(10,s.totalLength-s.currentIndex))/10;return Math.min(fl(l),fl(a))},fill:()=>i.state.theme===Se.LIGHT?"rgba(0, 0, 0, 0.2)":"rgba(255, 255, 255, 0.2)"});F(this,"elementsToErase",new Set);F(this,"groupsToErase",new Set)}startPath(n,i){this.endPath(),super.startPath(n,i),this.elementsToErase.clear()}addPointToPath(n,i,s=!1){return super.addPointToPath(n,i),this.updateElementsToBeErased(s)}updateElementsToBeErased(n){var a,l;const i=((l=(a=super.getCurrentTrail())==null?void 0:a.originalPoints)==null?void 0:l.map(c=>C(c[0],c[1])))||[];if(i.length<2)return[];const s=ke(i[i.length-1],i[i.length-2]),r=this.app.visibleElements.filter(c=>!c.locked),o=be(r);for(const c of r)if(n&&this.elementsToErase.has(c.id)){if(xL(s,c,o,this.app.state.zoom.value)){const u=c.groupIds.at(-1);if(this.groupsToErase.has(u)){const f=Lt(this.app.scene.getNonDeletedElementsMap(),u);for(const h of f)this.elementsToErase.delete(h.id);this.groupsToErase.delete(u)}if(Nt(c)&&this.elementsToErase.delete(c.containerId),Fi(c)){const f=ra(c);f&&this.elementsToErase.delete(f)}this.elementsToErase.delete(c.id)}}else if(!n&&!this.elementsToErase.has(c.id)&&xL(s,c,o,this.app.state.zoom.value)){const u=c.groupIds.at(-1);if(!this.groupsToErase.has(u)){const f=Lt(this.app.scene.getNonDeletedElementsMap(),u);for(const h of f)this.elementsToErase.add(h.id);this.groupsToErase.add(u)}if(Fi(c)){const f=ra(c);f&&this.elementsToErase.add(f)}Nt(c)&&this.elementsToErase.add(c.containerId),this.elementsToErase.add(c.id)}return Array.from(this.elementsToErase)}endPath(){super.endPath(),super.clearTrails(),this.elementsToErase.clear(),this.groupsToErase.clear()}}const xL=(e,t,n,i)=>{const s=e[1],r=ts(t)?15:t.strokeWidth/2,o=[Math.min(e[0][0],e[1][0])-r,Math.min(e[0][1],e[1][1])-r,Math.max(e[0][0],e[1][0])+r,Math.max(e[0][1],e[1][1])+r],a=Mn(t,n),l=[a[0]-r,a[1]-r,a[2]+r,a[3]+r];if(!ud(o,l))return!1;if(u6(t)&&ml(s,t,n))return!0;if(ts(t)){const d=hz(t),u=Cse(t,d,n),f=Math.max(2.25,5/i);for(const m of u)if(PC(m,e)<=f)return!0;const h=c4(...d.map(([m,p])=>C(t.x+m,t.y+p)));return!!qF(e[0],h)}const c=Re(t,n);if(_e(t)||nn(t)&&!t.polygon){const d=Math.max(t.strokeWidth,t.strokeWidth*2/i),u=v6(t,n);for(const f of u)if(PC(f,e)<=d)return!0;return!1}return fo(t,n,e,0,!0).length>0||!!c&&fo({...c,...dd(t,c,n)},n,e,0,!0).length>0},U7e=()=>N("div",{"data-testid":"brave-measure-text-error",children:[g("p",{children:g(Rs,{i18nKey:"errors.brave_measure_text_error.line1",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(Rs,{i18nKey:"errors.brave_measure_text_error.line2",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(Rs,{i18nKey:"errors.brave_measure_text_error.line3",link:e=>g("a",{href:"http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",children:e})})}),g("p",{children:g(Rs,{i18nKey:"errors.brave_measure_text_error.line4",issueLink:e=>g("a",{href:"https://github.com/excalidraw/excalidraw/issues/new",children:e}),discordLink:e=>N("a",{href:"https://discord.gg/UexuTaE",children:[e,"."]})})})]}),b7e=({children:e,left:t,top:n,onCloseRequest:i,fitInViewport:s=!1,offsetLeft:r=0,offsetTop:o=0,viewportWidth:a=window.innerWidth,viewportHeight:l=window.innerHeight,className:c})=>{const d=L.useRef(null);L.useEffect(()=>{const f=d.current;if(!f)return;f.contains(document.activeElement)||f.focus();const h=m=>{var p,U,b;if(m.key===$.TAB){const y=f4(f),{activeElement:v}=document,_=y.findIndex(I=>I===v);v===f?(m.shiftKey?(p=y[y.length-1])==null||p.focus():y[0].focus(),m.preventDefault(),m.stopImmediatePropagation()):_===0&&m.shiftKey?((U=y[y.length-1])==null||U.focus(),m.preventDefault(),m.stopImmediatePropagation()):_===y.length-1&&!m.shiftKey&&((b=y[0])==null||b.focus(),m.preventDefault(),m.stopImmediatePropagation())}};return f.addEventListener("keydown",h),()=>f.removeEventListener("keydown",h)},[]);const u=L.useRef(null);return L.useLayoutEffect(()=>{var f,h;if(s&&d.current&&n!=null&&t!=null){const m=d.current,{width:p,height:U}=m.getBoundingClientRect();if(((f=u.current)==null?void 0:f.top)===n&&((h=u.current)==null?void 0:h.left)===t)return;u.current={top:n,left:t},p>=a?(m.style.width=`${a}px`,m.style.left="0px",m.style.overflowX="scroll"):t+p-r>a?m.style.left=`${a-p-10}px`:m.style.left=`${t}px`,U>=l?(m.style.height=`${l-20}px`,m.style.top="10px",m.style.overflowY="scroll"):n+U-o>l?m.style.top=`${l-U}px`:m.style.top=`${n}px`}},[n,t,s,a,l,r,o]),L.useEffect(()=>{if(i){const f=h=>{var m;(m=d.current)!=null&&m.contains(h.target)||cn.unstable_batchedUpdates(()=>i(h))};return document.addEventListener("pointerdown",f,!1),()=>document.removeEventListener("pointerdown",f,!1)}},[i]),g("div",{className:le("popover",c),ref:d,tabIndex:-1,children:e})},ni="separator",y7e=de.memo(({actionManager:e,items:t,top:n,left:i,onClose:s})=>{const r=qp(),o=sE(),a=t.reduce((l,c)=>(c&&(c===ni||!c.predicate||c.predicate(o,r,e.app.props,e.app))&&l.push(c),l),[]);return g(b7e,{onCloseRequest:()=>{s()},top:n,left:i,fitInViewport:!0,offsetLeft:r.offsetLeft,offsetTop:r.offsetTop,viewportWidth:r.width,viewportHeight:r.height,className:"context-menu-popover",children:g("ul",{className:"context-menu",onContextMenu:l=>l.preventDefault(),children:a.map((l,c)=>{var f;if(l===ni)return!a[c-1]||a[c-1]===ni?null:g("hr",{className:"context-menu-item-separator"},c);const d=l.name;let u="";return l.label&&(typeof l.label=="function"?u=M(l.label(o,r,e.app)):u=M(l.label)),g("li",{"data-testid":d,onClick:()=>{s(()=>{e.executeAction(l,"contextMenu")})},children:N("button",{type:"button",className:le("context-menu-item",{dangerous:d==="deleteSelectedElements",checkmark:(f=l.checked)==null?void 0:f.call(l,r)}),children:[g("div",{className:"context-menu-item__label",children:u}),g("kbd",{className:"context-menu-item__shortcut",children:d?es(d):""})]})},c)})})})}),E7e=({height:e,width:t,userToFollow:n,onDisconnect:i})=>g("div",{className:"follow-mode",style:{width:t,height:e},children:N("div",{className:"follow-mode__badge",children:[N("div",{className:"follow-mode__badge__label",children:["Following"," ",g("span",{className:"follow-mode__badge__username",title:n.username,children:n.username})]}),g("button",{type:"button",onClick:i,className:"follow-mode__disconnect-btn",children:Wu})]})}),vj=({delay:e,theme:t})=>{const[n,i]=L.useState(!!e);return L.useEffect(()=>{if(!e)return;const s=setTimeout(()=>{i(!1)},e);return()=>clearTimeout(s)},[e]),n?null:N("div",{className:le("LoadingMessage",{"LoadingMessage--dark":t===Se.DARK}),children:[g("div",{children:g(Ul,{})}),g("div",{className:"LoadingMessage-text",children:M("labels.loadingScene")})]})},v7e="medium",CL={CHECKED:Fw,UNCHECKED:by},_7e=e=>N("label",{className:le("ToolIcon ToolIcon__lock",`ToolIcon_size_${v7e}`,{"is-mobile":e.isMobile}),title:`${e.title}  Q`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-lock"}),g("div",{className:"ToolIcon__icon",children:e.checked?CL.CHECKED:CL.UNCHECKED})]}),_j=e=>g(We,{className:le("Shape",{fillable:!1,active:e.checked}),type:"radio",icon:HV,name:"editor-current-shape",checked:e.checked,title:`${e.title}  H`,keyBindingLabel:e.isMobile?void 0:$.H.toLocaleUpperCase(),"aria-label":`${e.title}  H`,"aria-keyshortcuts":$.H,"data-testid":"toolbar-hand",onChange:()=>{var t;return(t=e.onChange)==null?void 0:t.call(e)}}),O3=[{type:"rectangle",icon:Bw,title:Pt(M("toolBar.rectangle"))},{type:"diamond",icon:zw,title:Pt(M("toolBar.diamond"))},{type:"ellipse",icon:Hw,title:Pt(M("toolBar.ellipse"))}],F3=[{type:"selection",icon:yy,title:Pt(M("toolBar.selection"))},{type:"lasso",icon:Nm,title:Pt(M("toolBar.lasso"))}],B3=[{type:"arrow",icon:kV,title:Pt(M("toolBar.arrow"))},{type:"line",icon:Vw,title:Pt(M("toolBar.line"))}],w7e=({app:e,onHandToolToggle:t,setAppState:n})=>{const i=e.state.activeTool,[s,r]=L.useState(!1),[o,a]=L.useState("rectangle"),[l,c]=L.useState("arrow");L.useEffect(()=>{(i.type==="rectangle"||i.type==="diamond"||i.type==="ellipse")&&a(i.type)},[i.type]),L.useEffect(()=>{(i.type==="arrow"||i.type==="line")&&c(i.type)},[i.type]);const d=i.type==="frame",u=i.type==="laser",f=i.type==="embeddable",{TTDDialogTriggerTunnel:h}=is(),m=(P,D)=>{e.state.activeTool.type!==P&&it("toolbar",P,"ui"),P==="selection"?e.state.activeTool.type==="selection"||e.setActiveTool({type:"selection"}):e.setActiveTool({type:P})},[p,U]=L.useState(0),b=36,y=4,v=7,_=v*b+(v-1)*y,I=b+y,R=p>=_+1*I,T=p>=_+2*I,w=p>=_+3*I,x=["text","frame","embeddable","laser","magicframe"].filter(P=>!(R&&P==="text"||T&&P==="image"||w&&P==="frame")).includes(i.type),k=x?i.type==="text"?Eh:i.type==="image"?q2:i.type==="frame"?su:i.type==="embeddable"?L6:i.type==="laser"?A0:i.type==="magicframe"?P6:lv:lv;return N("div",{className:"mobile-toolbar",ref:P=>{P&&U(P.getBoundingClientRect().width)},children:[g(_j,{checked:rg(e.state),onChange:t,title:M("toolBar.hand"),isMobile:!0}),g(fb,{app:e,options:F3,activeTool:i,defaultOption:e.state.preferredSelectionTool.type,namePrefix:"selectionType",title:Pt(M("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:P=>{(P==="selection"||P==="lasso")&&(e.setActiveTool({type:P}),n({preferredSelectionTool:{type:P,initialized:!0}}))},displayedOption:F3.find(P=>P.type===e.state.preferredSelectionTool.type)||F3[0]}),g(We,{className:le({active:i.type==="freedraw"}),type:"radio",icon:Hp,checked:i.type==="freedraw",name:"editor-current-shape",title:`${Pt(M("toolBar.freedraw"))}`,"aria-label":Pt(M("toolBar.freedraw")),"data-testid":"toolbar-freedraw",onChange:()=>m("freedraw")}),g(We,{className:le({active:i.type==="eraser"}),type:"radio",icon:RV,checked:i.type==="eraser",name:"editor-current-shape",title:`${Pt(M("toolBar.eraser"))}`,"aria-label":Pt(M("toolBar.eraser")),"data-testid":"toolbar-eraser",onChange:()=>m("eraser")}),g(fb,{app:e,options:O3,activeTool:i,defaultOption:o,namePrefix:"shapeType",title:Pt(M(o==="rectangle"?"toolBar.rectangle":o==="diamond"?"toolBar.diamond":o==="ellipse"?"toolBar.ellipse":"toolBar.rectangle")),"data-testid":"toolbar-rectangle",onToolChange:P=>{(P==="rectangle"||P==="diamond"||P==="ellipse")&&(a(P),e.setActiveTool({type:P}))},displayedOption:O3.find(P=>P.type===o)||O3[0]}),g(fb,{app:e,options:B3,activeTool:i,defaultOption:l,namePrefix:"linearElementType",title:Pt(M(l==="arrow"?"toolBar.arrow":"toolBar.line")),"data-testid":"toolbar-arrow",fillable:!0,onToolChange:P=>{(P==="arrow"||P==="line")&&(c(P),e.setActiveTool({type:P}))},displayedOption:B3.find(P=>P.type===l)||B3[0]}),R&&g(We,{className:le({active:i.type==="text"}),type:"radio",icon:Eh,checked:i.type==="text",name:"editor-current-shape",title:`${Pt(M("toolBar.text"))}`,"aria-label":Pt(M("toolBar.text")),"data-testid":"toolbar-text",onChange:()=>m("text")}),T&&g(We,{className:le({active:i.type==="image"}),type:"radio",icon:q2,checked:i.type==="image",name:"editor-current-shape",title:`${Pt(M("toolBar.image"))}`,"aria-label":Pt(M("toolBar.image")),"data-testid":"toolbar-image",onChange:()=>m("image")}),w&&g(We,{className:le({active:d}),type:"radio",icon:su,checked:d,name:"editor-current-shape",title:`${Pt(M("toolBar.frame"))}`,"aria-label":Pt(M("toolBar.frame")),"data-testid":"toolbar-frame",onChange:()=>m("frame")}),N(Ve,{open:s,placement:"top",children:[g(Ve.Trigger,{className:le("App-toolbar__extra-tools-trigger App-toolbar__extra-tools-trigger--mobile",{"App-toolbar__extra-tools-trigger--selected":x||s}),onToggle:()=>{r(!s),n({openMenu:null,openPopup:null})},title:M("toolBar.extraTools"),style:{width:b,height:b,display:"flex",alignItems:"center",justifyContent:"center"},children:k}),N(Ve.Content,{onClickOutside:()=>r(!1),onSelect:()=>r(!1),className:"App-toolbar__extra-tools-dropdown",children:[!R&&g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"text"}),icon:Eh,shortcut:$.T.toLocaleUpperCase(),"data-testid":"toolbar-text",selected:i.type==="text",children:M("toolBar.text")}),!T&&g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"image"}),icon:q2,"data-testid":"toolbar-image",selected:i.type==="image",children:M("toolBar.image")}),!w&&g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"frame"}),icon:su,shortcut:$.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:M("toolBar.frame")}),g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"embeddable"}),icon:L6,"data-testid":"toolbar-embeddable",selected:f,children:M("toolBar.embeddable")}),g(Ve.Item,{onSelect:()=>e.setActiveTool({type:"laser"}),icon:A0,"data-testid":"toolbar-laser",selected:u,shortcut:$.K.toLocaleUpperCase(),children:M("toolBar.laser")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),e.props.aiEnabled!==!1&&g(h.Out,{}),g(Ve.Item,{onSelect:()=>e.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:Ww,"data-testid":"toolbar-embeddable",children:M("toolBar.mermaidToExcalidraw")}),e.props.aiEnabled!==!1&&e.plugins.diagramToCode&&g(he,{children:N(Ve.Item,{onSelect:()=>e.onMagicframeToolSelect(),icon:P6,"data-testid":"toolbar-magicframe",children:[M("toolBar.magicframe"),g(Ve.Item.Badge,{children:"AI"})]})})]})]})]})},wj=({children:e,side:t,className:n})=>g("div",{className:le("FixedSideContainer",`FixedSideContainer_side_${t}`,n),children:e}),T7e="medium",Tj=e=>e.penDetected?N("label",{className:le("ToolIcon ToolIcon__penMode",`ToolIcon_size_${T7e}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:Eue})]}):null,I7e=({appState:e,elements:t,actionManager:n,setAppState:i,onHandToolToggle:s,renderTopLeftUI:r,renderTopRightUI:o,renderSidebars:a,renderWelcomeScreen:l,UIOptions:c,app:d,onPenModeToggle:u})=>{var b;const{WelcomeScreenCenterTunnel:f,MainMenuTunnel:h,DefaultSidebarTriggerTunnel:m}=is(),p=()=>{var _;if(((_=e.openDialog)==null?void 0:_.name)==="elementLinkSelector")return null;const y=N("div",{className:"excalidraw-ui-top-right",children:[(o==null?void 0:o(!0,e))??(!e.viewModeEnabled&&N(he,{children:[g(Tj,{checked:e.penMode,onChange:()=>u(null),title:M("toolBar.penMode"),isMobile:!0,penDetected:e.penDetected}),g(m.Out,{})]})),e.viewModeEnabled&&g(v3e,{actionManager:n})]}),v=N("div",{className:"excalidraw-ui-top-left",children:[r==null?void 0:r(!0,e),g(h.Out,{})]});return N("div",{className:"App-toolbar-content",style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[v,y]})},U=()=>g(w7e,{app:d,onHandToolToggle:s,setAppState:i});return N(he,{children:[a(),g("div",{className:"App-welcome-screen",children:l&&g(f.Out,{})}),!e.viewModeEnabled&&N("div",{className:"App-bottom-bar",style:{marginBottom:Po+Xl},children:[g(p3e,{appState:e,elementsMap:d.scene.getNonDeletedElementsMap(),renderAction:n.renderAction,app:d,setAppState:i}),N(Ar,{className:"App-toolbar",children:[!e.viewModeEnabled&&((b=e.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&U(),e.scrolledOutside&&!e.openMenu&&!e.openSidebar&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(y=>({...C0(t,y)}))},children:M("buttons.scrollBackToContent")})]})]}),g(wj,{side:"top",className:"App-top-bar",children:p()})]})},AL=e=>{const t=L.useRef(null),[n,i]=L.useState(null);return L.useLayoutEffect(()=>{if(!e.spreadsheet)return;const s=yye(e.chartType,e.spreadsheet,0,0);i(s);let r;const o=t.current;return(async()=>{var a;r=await RT(s,{exportBackground:!1,viewBackgroundColor:Ei.white},null,{skipInliningFonts:!0}),(a=r.querySelector(".style-fonts"))==null||a.remove(),o.replaceChildren(),o.appendChild(r),e.selected&&o.parentNode.focus()})(),()=>{o.replaceChildren()}},[e.spreadsheet,e.chartType,e.selected]),g("button",{type:"button",className:"ChartPreview",onClick:()=>{n&&e.onClick(e.chartType,n)},children:g("div",{ref:t})})},S7e=({setAppState:e,appState:t,onClose:n})=>{const{onInsertElements:i}=So(),s=de.useCallback(()=>{n&&n()},[n]),r=(o,a)=>{i(a),it("paste","chart",o),e({currentChartType:o,pasteDialog:{shown:!1,data:null}})};return g(dr,{size:"small",onCloseRequest:s,title:M("labels.pasteCharts"),className:"PasteChartDialog",autofocus:!1,children:N("div",{className:"container",children:[g(AL,{chartType:"bar",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="bar",onClick:r}),g(AL,{chartType:"line",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="line",onClick:r})]})})},zv=({heading:e,children:t,...n})=>{const{id:i}=Fs(),s=g("h2",{className:"visually-hidden",id:`${i}-${e}-title`,children:M(`headings.${e}`)});return g("section",{...n,"aria-labelledby":`${i}-${e}-title`,children:typeof t=="function"?t(s):N(he,{children:[s,t]})})},x7e=4,C7e=8,A7e=({shouldWrap:e,children:t,username:n})=>e?g(vl,{label:n||"Unknown user",children:t}):g(he,{children:t}),z3=({actionManager:e,collaborator:t,socketId:n,withName:i=!1,shouldWrapWithTooltip:s=!1,isBeingFollowed:r})=>{const o={socketId:n,collaborator:t,withName:i,isBeingFollowed:r},a=e.renderAction("goToCollaborator",o);return g(A7e,{username:t.username,shouldWrap:s,children:a},n)},M7e=["avatarUrl","id","socketId","username","isInCall","isSpeaking","isMuted"],Ij=de.memo(({className:e,mobile:t,collaborators:n,userToFollow:i})=>{const s=Bs(),r=new Map;n.forEach((p,U)=>{const b=p.id||U;r.set(b,{...p,socketId:U})});const o=Array.from(r.values()).filter(p=>{var U;return(U=p.username)==null?void 0:U.trim()}),[a,l]=de.useState(""),c=o.filter(p=>{var U;return(U=p.username)==null?void 0:U.toLowerCase().includes(a)}),d=de.useRef(null);L.useLayoutEffect(()=>{if(d.current){const p=b=>{const y=Math.max(1,Math.min(8,Math.floor(b/38)));f(y)};if(p(d.current.clientWidth),!SF)return;const U=new ResizeObserver(b=>{for(const y of b){const{width:v}=y.contentRect;p(v)}});return U.observe(d.current),()=>{U.disconnect()}}},[]);const[u,f]=de.useState(x7e),m=o.slice(0,u-1).map(p=>z3({actionManager:s,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}));return t?g("div",{className:le("UserList UserList_mobile",e),children:o.map(p=>z3({actionManager:s,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}))}):g("div",{className:"UserList__wrapper",ref:d,children:N("div",{className:le("UserList",e),style:{"--max-avatars":u},children:[m,o.length>u-1&&N(Al,{children:[N(Ml,{className:"UserList__more",children:["+",o.length-u+1]}),g(xy,{style:{zIndex:2,width:"15rem",textAlign:"left"},align:"end",sideOffset:10,children:N(Ar,{padding:2,children:[o.length>=C7e&&g(Z$,{placeholder:M("quickSearch.placeholder"),onChange:l}),g(q$,{className:"dropdown-menu UserList__collaborators",placeholder:M("userList.empty"),children:c.length>0?[g("div",{className:"hint",children:M("userList.hint.text")}),c.map(p=>z3({actionManager:s,collaborator:p,socketId:p.socketId,withName:!0,isBeingFollowed:p.socketId===i}))]:[]}),g(X$,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})]})]})})},(e,t)=>{if(e.collaborators.size!==t.collaborators.size||e.mobile!==t.mobile||e.className!==t.className||e.userToFollow!==t.userToFollow)return!1;const n=t.collaborators.keys();for(const[i,s]of e.collaborators){const r=t.collaborators.get(i);if(!r||i!==n.next().value||!vi(s,r,M7e))return!1}return!0}),k7e=e=>g("button",{className:"help-icon",onClick:e.onClick,type:"button",title:`${M("helpDialog.title")}  ?`,"aria-label":M("helpDialog.title"),children:$w}),Sj=({appState:e,actionManager:t,showExitZenModeBtn:n,renderWelcomeScreen:i})=>{const{FooterCenterTunnel:s,WelcomeScreenHelpHintTunnel:r}=is();return N("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer App-menu App-menu_bottom",children:[g("div",{className:le("layer-ui__wrapper__footer-left zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":e.zenModeEnabled}),children:g(Za.Col,{gap:2,children:N(zv,{heading:"canvasActions",children:[g(b3e,{renderAction:t.renderAction,zoom:e.zoom}),!e.viewModeEnabled&&g(y3e,{renderAction:t.renderAction,className:le("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":e.zenModeEnabled})})]})})}),g(s.Out,{}),g("div",{className:le("layer-ui__wrapper__footer-right zen-mode-transition",{"transition-right":e.zenModeEnabled}),children:N("div",{style:{position:"relative"},children:[i&&g(r.Out,{}),g(k7e,{onClick:()=>t.executeAction(FT)})]})}),g(E3e,{actionManager:t,showExitZenModeBtn:n})]})};Sj.displayName="Footer";const xj=de.createContext({}),Cj=({children:e,className:t})=>{const n=Hn(),i=L.useContext(xj),s=!!(n.canFitSidebar&&i.shouldRenderDockButton);return N("div",{className:le("sidebar__header",t),"data-testid":"sidebar-header",children:[e,N("div",{className:"sidebar__header__buttons",children:[s&&g(vl,{label:M("labels.sidebarLock"),children:g(qc,{onSelect:()=>{var r;return(r=i.onDock)==null?void 0:r.call(i,!i.docked)},selected:!!i.docked,className:"sidebar__dock","data-testid":"sidebar-dock","aria-label":M("labels.sidebarLock"),children:mue})}),g(qc,{"data-testid":"sidebar-close",className:"sidebar__close",onSelect:i.onCloseRequest,"aria-label":M("buttons.close"),children:Wu})]})]})};Cj.displayName="SidebarHeader";function R7e(e){const t=e+"CollectionProvider",[n,i]=$p(t),[s,r]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=h=>{const{scope:m,children:p}=h,U=de.useRef(null),b=de.useRef(new Map).current;return g(s,{scope:m,itemMap:b,collectionRef:U,children:p})};o.displayName=t;const a=e+"CollectionSlot",l=de.forwardRef((h,m)=>{const{scope:p,children:U}=h,b=r(a,p),y=Eo(m,b.collectionRef);return g(M0,{ref:y,children:U})});l.displayName=a;const c=e+"CollectionItemSlot",d="data-radix-collection-item",u=de.forwardRef((h,m)=>{const{scope:p,children:U,...b}=h,y=de.useRef(null),v=Eo(m,y),_=r(c,p);return de.useEffect(()=>(_.itemMap.set(y,{ref:y,...b}),()=>void _.itemMap.delete(y))),g(M0,{[d]:"",ref:v,children:U})});u.displayName=c;function f(h){const m=r(e+"CollectionConsumer",h);return de.useCallback(()=>{const U=m.collectionRef.current;if(!U)return[];const b=Array.from(U.querySelectorAll(`[${d}]`));return Array.from(m.itemMap.values()).sort((_,I)=>b.indexOf(_.ref.current)-b.indexOf(I.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:o,Slot:l,ItemSlot:u},f,i]}var L7e=L.createContext(void 0);function Aj(e){const t=L.useContext(L7e);return e||t||"ltr"}var H3="rovingFocusGroup.onEntryFocus",D7e={bubbles:!1,cancelable:!0},iE="RovingFocusGroup",[Hv,Mj,P7e]=R7e(iE),[N7e,kj]=$p(iE,[P7e]),[O7e,F7e]=N7e(iE),Rj=L.forwardRef((e,t)=>g(Hv.Provider,{scope:e.__scopeRovingFocusGroup,children:g(Hv.Slot,{scope:e.__scopeRovingFocusGroup,children:g(B7e,{...e,ref:t})})}));Rj.displayName=iE;var B7e=L.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:s=!1,dir:r,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...u}=e,f=L.useRef(null),h=Eo(t,f),m=Aj(r),[p=null,U]=uT({prop:o,defaultProp:a,onChange:l}),[b,y]=L.useState(!1),v=bl(c),_=Mj(n),I=L.useRef(!1),[R,T]=L.useState(0);return L.useEffect(()=>{const w=f.current;if(w)return w.addEventListener(H3,v),()=>w.removeEventListener(H3,v)},[v]),g(O7e,{scope:n,orientation:i,dir:m,loop:s,currentTabStopId:p,onItemFocus:L.useCallback(w=>U(w),[U]),onItemShiftTab:L.useCallback(()=>y(!0),[]),onFocusableItemAdd:L.useCallback(()=>T(w=>w+1),[]),onFocusableItemRemove:L.useCallback(()=>T(w=>w-1),[]),children:g(ws.div,{tabIndex:b||R===0?-1:0,"data-orientation":i,...u,ref:h,style:{outline:"none",...e.style},onMouseDown:Oi(e.onMouseDown,()=>{I.current=!0}),onFocus:Oi(e.onFocus,w=>{const S=!I.current;if(w.target===w.currentTarget&&S&&!b){const x=new CustomEvent(H3,D7e);if(w.currentTarget.dispatchEvent(x),!x.defaultPrevented){const k=_().filter(V=>V.focusable),P=k.find(V=>V.active),D=k.find(V=>V.id===p),G=[P,D,...k].filter(Boolean).map(V=>V.ref.current);Pj(G,d)}}I.current=!1}),onBlur:Oi(e.onBlur,()=>y(!1))})})}),Lj="RovingFocusGroupItem",Dj=L.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:s=!1,tabStopId:r,...o}=e,a=tT(),l=r||a,c=F7e(Lj,n),d=c.currentTabStopId===l,u=Mj(n),{onFocusableItemAdd:f,onFocusableItemRemove:h}=c;return L.useEffect(()=>{if(i)return f(),()=>h()},[i,f,h]),g(Hv.ItemSlot,{scope:n,id:l,focusable:i,active:s,children:g(ws.span,{tabIndex:d?0:-1,"data-orientation":c.orientation,...o,ref:t,onMouseDown:Oi(e.onMouseDown,m=>{i?c.onItemFocus(l):m.preventDefault()}),onFocus:Oi(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:Oi(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const p=V7e(m,c.orientation,c.dir);if(p!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let b=u().filter(y=>y.focusable).map(y=>y.ref.current);if(p==="last")b.reverse();else if(p==="prev"||p==="next"){p==="prev"&&b.reverse();const y=b.indexOf(m.currentTarget);b=c.loop?$7e(b,y+1):b.slice(y+1)}setTimeout(()=>Pj(b))}})})})});Dj.displayName=Lj;var z7e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function H7e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function V7e(e,t,n){const i=H7e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return z7e[i]}function Pj(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function $7e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var G7e=Rj,X7e=Dj,jT="Tabs",[j7e,rAe]=$p(jT,[kj]),Nj=kj(),[Y7e,YT]=j7e(jT),Oj=L.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:s,defaultValue:r,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=e,d=Aj(a),[u,f]=uT({prop:i,onChange:s,defaultProp:r});return g(Y7e,{scope:n,baseId:tT(),value:u,onValueChange:f,orientation:o,dir:d,activationMode:l,children:g(ws.div,{dir:d,"data-orientation":o,...c,ref:t})})});Oj.displayName=jT;var Fj="TabsList",Bj=L.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...s}=e,r=YT(Fj,n),o=Nj(n);return g(G7e,{asChild:!0,...o,orientation:r.orientation,dir:r.dir,loop:i,children:g(ws.div,{role:"tablist","aria-orientation":r.orientation,...s,ref:t})})});Bj.displayName=Fj;var zj="TabsTrigger",Hj=L.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:s=!1,...r}=e,o=YT(zj,n),a=Nj(n),l=Gj(o.baseId,i),c=Xj(o.baseId,i),d=i===o.value;return g(X7e,{asChild:!0,...a,focusable:!s,active:d,children:g(ws.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":c,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...r,ref:t,onMouseDown:Oi(e.onMouseDown,u=>{!s&&u.button===0&&u.ctrlKey===!1?o.onValueChange(i):u.preventDefault()}),onKeyDown:Oi(e.onKeyDown,u=>{[" ","Enter"].includes(u.key)&&o.onValueChange(i)}),onFocus:Oi(e.onFocus,()=>{const u=o.activationMode!=="manual";!d&&!s&&u&&o.onValueChange(i)})})})});Hj.displayName=zj;var Vj="TabsContent",$j=L.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:s,children:r,...o}=e,a=YT(Vj,n),l=Gj(a.baseId,i),c=Xj(a.baseId,i),d=i===a.value,u=L.useRef(d);return L.useEffect(()=>{const f=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(f)},[]),g(Iy,{present:s||d,children:({present:f})=>g(ws.div,{"data-state":d?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:u.current?"0s":void 0},children:f&&r})})});$j.displayName=Vj;function Gj(e,t){return`${e}-trigger-${t}`}function Xj(e,t){return`${e}-content-${t}`}var jj=Oj,Yj=Bj,Wj=Hj,Kj=$j;const Zj=({children:e,tab:t,onSelect:n,...i})=>g(Wj,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"excalidraw-button sidebar-tab-trigger",...i,children:e})});Zj.displayName="SidebarTabTrigger";const qj=({children:e,...t})=>g(Yj,{className:"sidebar-triggers",...t,children:e});qj.displayName="SidebarTabTriggers";const Qj=({name:e,tab:t,icon:n,title:i,children:s,onToggle:r,className:o,style:a})=>{var d;const l=kn(),c=di();return N("label",{title:i,className:"sidebar-trigger__label-element",children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",onChange:u=>{var h;(h=document.querySelector(".layer-ui__wrapper"))==null||h.classList.remove("animate");const f=u.target.checked;l({openSidebar:f?{name:e,tab:t}:null,openMenu:null,openPopup:null}),r==null||r(f)},checked:((d=c.openSidebar)==null?void 0:d.name)===e,"aria-label":i,"aria-keyshortcuts":"0"}),N("div",{className:le("sidebar-trigger",o),style:a,children:[n&&g("div",{children:n}),s&&g("div",{className:"sidebar-trigger__label",children:s})]})]})};Qj.displayName="SidebarTrigger";const Jj=({children:e,...t})=>{const n=di(),i=kn();if(!n.openSidebar)return null;const{name:s}=n.openSidebar;return g(jj,{className:"sidebar-tabs-root",value:n.openSidebar.tab,onValueChange:r=>i(o=>({...o,openSidebar:{...o.openSidebar,name:s,tab:r}})),...t,children:e})};Jj.displayName="SidebarTabs";const eY=({tab:e,children:t,...n})=>g(Kj,{...n,value:e,"data-testid":e,children:t});eY.displayName="SidebarTab";const WT=Wt(!1),tY=L.forwardRef(({name:e,children:t,onDock:n,docked:i,className:s,...r},o)=>{const a=kn(),l=py(WT);L.useLayoutEffect(()=>(l(!!i),()=>{l(!1)}),[l,i]);const c=L.useRef({});c.current.onCloseRequest=()=>{a({openSidebar:null})},c.current.onDock=h=>n==null?void 0:n(h),c.current=z2(c.current,{docked:i,shouldRenderDockButton:!!n&&i!=null});const d=L.useRef(null);L.useImperativeHandle(o,()=>d.current);const u=Hn(),f=L.useCallback(()=>{document.querySelector(".Dialog")||a({openSidebar:null})},[a]);return gT(d,L.useCallback(h=>{h.target.closest(".sidebar-trigger")||(!i||!u.canFitSidebar)&&f()},[f,i,u.canFitSidebar])),L.useEffect(()=>{const h=m=>{m.key===$.ESCAPE&&(!i||!u.canFitSidebar)&&f()};return document.addEventListener(te.KEYDOWN,h),()=>{document.removeEventListener(te.KEYDOWN,h)}},[f,i,u.canFitSidebar]),g(Ar,{...r,className:le(bs.SIDEBAR,{"sidebar--docked":i},s),ref:d,children:g(xj.Provider,{value:c.current,children:t})})});tY.displayName="SidebarInner";const xs=Object.assign(L.forwardRef((e,t)=>{var l;const n=di(),{onStateChange:i}=e,s=L.useRef(n.openSidebar);L.useEffect(()=>{var c,d,u,f,h;(!n.openSidebar&&((c=s==null?void 0:s.current)==null?void 0:c.name)===e.name||((d=n.openSidebar)==null?void 0:d.name)===e.name&&((u=s==null?void 0:s.current)==null?void 0:u.name)!==e.name||((f=s.current)==null?void 0:f.name)===e.name)&&n.openSidebar!==s.current&&(i==null||i(((h=n.openSidebar)==null?void 0:h.name)!==e.name?null:n.openSidebar)),s.current=n.openSidebar},[n.openSidebar,i,e.name]);const[r,o]=L.useState(!1);return L.useLayoutEffect(()=>(o(!0),()=>o(!1)),[]),r&&((l=n.openSidebar)==null?void 0:l.name)===e.name?L.createElement(tY,{...e,ref:t,key:e.name}):null}),{Header:Cj,TabTriggers:qj,TabTrigger:Zj,Tabs:Jj,Tab:eY,Trigger:Qj});xs.displayName="Sidebar";const Kp=(e,t)=>{const n=Wt(0),i=s=>{const{tunnelsJotai:{useAtom:r}}=is(),[,o]=r(n),a=L.useRef({preferHost:!1,counter:0});return L.useLayoutEffect(()=>{const l=a.current;return o(c=>{const d=c+1;return l.counter=d,d}),()=>{o(c=>{const d=c-1;return l.counter=d,d||(l.preferHost=!1),d})}},[o]),s.__fallback||(a.current.preferHost=!0),!a.current.counter&&s.__fallback&&a.current.preferHost||a.current.counter>1&&s.__fallback?null:g(t,{...s})};return i.displayName=e,i},nY=Wt({active:!1});async function Vv({title:e,description:t,actionLabel:n,color:i}){return new Promise(s=>{Zs.set(nY,{active:!0,onConfirm:()=>s(!0),onClose:()=>s(!1),onReject:()=>s(!1),title:e,description:t,actionLabel:n,color:i})})}const iY=function({onChange:e,value:t,choices:n,name:i}){return g("div",{className:"RadioGroup",children:n.map(s=>N("div",{className:le("RadioGroup__choice",{active:s.value===t}),title:s.ariaLabel,children:[g("input",{name:i,type:"radio",checked:s.value===t,onChange:()=>e(s.value),"aria-label":s.ariaLabel}),s.label]},String(s.value)))})},sY=({value:e,shortcut:t,onChange:n,choices:i,children:s,name:r})=>{const o=Hn();return N(he,{children:[N("div",{className:"dropdown-menu-item-base dropdown-menu-item-bare",children:[g("label",{className:"dropdown-menu-item__text",htmlFor:r,children:s}),g(iY,{name:r,value:e,onChange:n,choices:i})]}),t&&o.formFactor!=="phone"&&g("div",{className:"dropdown-menu-item__shortcut dropdown-menu-item__shortcut--orphaned",children:t})]})};sY.displayName="DropdownMenuItemContentRadio";const rY=()=>{const{t:e}=mn(),t=Bs(),n=sE();return t.isActionEnabled(Sv)?g(Os,{icon:Xw,onSelect:async()=>{(!n.length||await Vv({title:e("overwriteConfirm.modal.loadFromFile.title"),actionLabel:e("overwriteConfirm.modal.loadFromFile.button"),color:"warning",description:g(Rs,{i18nKey:"overwriteConfirm.modal.loadFromFile.description",bold:s=>g("strong",{children:s}),br:()=>g("br",{})})}))&&t.executeAction(Sv)},"data-testid":"load-button",shortcut:es("loadScene"),"aria-label":e("buttons.load"),children:e("buttons.load")}):null};rY.displayName="LoadScene";const oY=()=>{const{t:e}=mn(),t=Bs();return t.isActionEnabled(Z6)?g(Os,{shortcut:es("saveScene"),"data-testid":"save-button",onSelect:()=>t.executeAction(Z6),icon:Sue,"aria-label":`${e("buttons.save")}`,children:`${e("buttons.save")}`}):null};oY.displayName="SaveToActiveFile";const aY=()=>{const e=kn(),{t}=mn();return g(Os,{icon:PV,"data-testid":"image-export-button",onSelect:()=>e({openDialog:{name:"imageExport"}}),shortcut:es("imageExport"),"aria-label":t("buttons.exportImage"),children:t("buttons.exportImage")})};aY.displayName="SaveAsImage";const lY=e=>{const t=kn(),{t:n}=mn();return g(Os,{icon:cv,"data-testid":"command-palette-button",onSelect:()=>{it("command_palette","open","menu"),t({openDialog:{name:"commandPalette"}})},shortcut:es("commandPalette"),"aria-label":n("commandPalette.title"),className:e==null?void 0:e.className,children:n("commandPalette.title")})};lY.displayName="CommandPalette";const cY=e=>{const{t}=mn(),n=Bs();return g(Os,{icon:wu,"data-testid":"search-menu-button",onSelect:()=>{n.executeAction(pj)},shortcut:es("searchMenu"),"aria-label":t("search.title"),className:e==null?void 0:e.className,children:t("search.title")})};cY.displayName="SearchMenu";const dY=()=>{const{t:e}=mn(),t=Bs();return g(Os,{"data-testid":"help-menu-item",icon:$w,onSelect:()=>t.executeAction(FT),shortcut:"?","aria-label":e("helpDialog.title"),children:e("helpDialog.title")})};dY.displayName="Help";const uY=()=>{const{t:e}=mn(),t=py(tE);return Bs().isActionEnabled(Fm)?g(Os,{icon:Yc,onSelect:()=>t("clearCanvas"),"data-testid":"clear-canvas-button","aria-label":e("buttons.clearReset"),children:e("buttons.clearReset")}):null};uY.displayName="ClearCanvas";const fY=e=>{const{t}=mn(),n=di(),i=Bs(),s=es("toggleTheme");return i.isActionEnabled(V6)?e!=null&&e.allowSystemTheme?g(sY,{name:"theme",value:e.theme,onChange:r=>e.onSelect(r),choices:[{value:Se.LIGHT,label:rv,ariaLabel:`${t("buttons.lightMode")} - ${s}`},{value:Se.DARK,label:sv,ariaLabel:`${t("buttons.darkMode")} - ${s}`},{value:"system",label:$fe,ariaLabel:t("buttons.systemMode")}],children:t("labels.theme")}):g(Os,{onSelect:r=>{if(r.preventDefault(),e!=null&&e.onSelect)e.onSelect(n.theme===Se.DARK?Se.LIGHT:Se.DARK);else return i.executeAction(V6)},icon:n.theme===Se.DARK?rv:sv,"data-testid":"toggle-dark-mode",shortcut:s,"aria-label":n.theme===Se.DARK?t("buttons.lightMode"):t("buttons.darkMode"),children:n.theme===Se.DARK?t("buttons.lightMode"):t("buttons.darkMode")}):null};fY.displayName="ToggleTheme";const hY=()=>{const{t:e}=mn(),t=di(),n=Bs(),i=Zp();return t.viewModeEnabled||!i.UIOptions.canvasActions.changeViewBackgroundColor?null:N("div",{style:{marginTop:"0.5rem"},children:[g("div",{"data-testid":"canvas-background-label",style:{fontSize:".75rem",marginBottom:".5rem"},children:e("labels.canvasBackground")}),g("div",{style:{padding:"0 0.625rem"},children:n.renderAction("changeViewBackgroundColor")})]})};hY.displayName="ChangeCanvasBackground";const gY=()=>{const{t:e}=mn(),t=kn();return g(Os,{icon:Ey,onSelect:()=>{t({openDialog:{name:"jsonExport"}})},"data-testid":"json-export-button","aria-label":e("buttons.export"),children:e("buttons.export")})};gY.displayName="Export";const mY=()=>{const{t:e}=mn();return N(he,{children:[g(Xm,{icon:Gw,href:"https://github.com/excalidraw/excalidraw","aria-label":"GitHub",children:"GitHub"}),g(Xm,{icon:DV,href:"https://x.com/excalidraw","aria-label":"X",children:e("labels.followUs")}),g(Xm,{icon:LV,href:"https://discord.gg/UexuTaE","aria-label":"Discord",children:e("labels.discordChat")})]})};mY.displayName="Socials";const pY=({onSelect:e,isCollaborating:t})=>{const{t:n}=mn();return g(Os,{"data-testid":"collab-button",icon:Yw,className:le({"active-collab":t}),onSelect:e,children:n("labels.liveCollaboration")})};pY.displayName="LiveCollaborationTrigger";const W7e=Object.freeze(Object.defineProperty({__proto__:null,ChangeCanvasBackground:hY,ClearCanvas:uY,CommandPalette:lY,Export:gY,Help:dY,LiveCollaborationTrigger:pY,LoadScene:rY,SaveAsImage:aY,SaveToActiveFile:oY,SearchMenu:cY,Socials:mY,ToggleTheme:fY},Symbol.toStringTag,{value:"Module"})),Mt=Object.assign(Kp("MainMenu",({children:e,onSelect:t})=>{var o;const{MainMenuTunnel:n}=is(),i=Hn(),s=di(),r=kn();return g(n.In,{children:N(Ve,{open:s.openMenu==="canvas",children:[g(Ve.Trigger,{onToggle:()=>{r({openMenu:s.openMenu==="canvas"?null:"canvas",openPopup:null,openDialog:null})},"data-testid":"main-menu-trigger",className:"main-menu-trigger",children:wue}),N(Ve.Content,{onClickOutside:()=>r({openMenu:null}),onSelect:Z5(t,()=>{r({openMenu:null})}),placement:"bottom",className:i.formFactor==="phone"?"main-menu-dropdown":"",children:[e,i.formFactor==="phone"&&s.collaborators.size>0&&N("fieldset",{className:"UserList-Wrapper",children:[g("legend",{children:M("labels.collaborators")}),g(Ij,{mobile:!0,collaborators:s.collaborators,userToFollow:((o=s.userToFollow)==null?void 0:o.socketId)||null})]})]})]})})}),{Trigger:Ve.Trigger,Item:Ve.Item,ItemLink:Ve.ItemLink,ItemCustom:Ve.ItemCustom,Group:Ve.Group,Separator:Ve.Separator,DefaultItems:W7e}),Or=L.forwardRef(({children:e,icon:t,onClick:n,label:i,variant:s="filled",color:r="primary",size:o="medium",fullWidth:a,className:l,status:c},d)=>{const[u,f]=L.useState(!1),h=async p=>{const U=n==null?void 0:n(p);if(Sp(U)){const b=window.setTimeout(()=>{f(!0)},50);try{await U}catch(y){if(y instanceof ng)console.warn(y);else throw y}finally{clearTimeout(b),f(!1)}}},m=u?"loading":c;return r=m==="success"?"success":r,g("button",{className:le("ExcButton",`ExcButton--color-${r}`,`ExcButton--variant-${s}`,`ExcButton--size-${o}`,`ExcButton--status-${m}`,{"ExcButton--fullWidth":a},l),onClick:h,type:"button","aria-label":i,ref:d,disabled:m==="loading"||m==="success",children:N("div",{className:"ExcButton__contents",children:[m==="loading"?g(Ul,{className:"ExcButton__statusIcon"}):m==="success"&&g("div",{className:"ExcButton__statusIcon",children:Ife}),t&&g("div",{className:"ExcButton__icon","aria-hidden":!0,children:t}),s!=="icon"&&(e??i)]})})}),KT=({title:e,children:t,actionLabel:n,onClick:i})=>N("div",{className:"OverwriteConfirm__Actions__Action",children:[g("h4",{children:e}),g("div",{className:"OverwriteConfirm__Actions__Action__content",children:t}),g(Or,{variant:"outlined",color:"muted",label:n,size:"large",fullWidth:!0,onClick:i})]}),K7e=()=>{const{t:e}=mn(),t=Bs(),n=kn();return g(KT,{title:e("overwriteConfirm.action.exportToImage.title"),actionLabel:e("overwriteConfirm.action.exportToImage.button"),onClick:()=>{t.executeAction(xX,"ui",!0),n({openDialog:{name:"imageExport"}})},children:e("overwriteConfirm.action.exportToImage.description")})},Z7e=()=>{const{t:e}=mn(),t=Bs();return g(KT,{title:e("overwriteConfirm.action.saveToDisk.title"),actionLabel:e("overwriteConfirm.action.saveToDisk.button"),onClick:()=>{t.executeAction(CX,"ui")},children:e("overwriteConfirm.action.saveToDisk.description")})},ML=Object.assign(({children:e})=>g("div",{className:"OverwriteConfirm__Actions",children:e}),{ExportToImage:K7e,SaveToDisk:Z7e}),Xd=Object.assign(Kp("OverwriteConfirmDialog",({children:e})=>{const{OverwriteConfirmDialogTunnel:t}=is(),[n,i]=gn(nY);if(!n.active)return null;const s=()=>{n.onClose(),i(o=>({...o,active:!1}))},r=()=>{n.onConfirm(),i(o=>({...o,active:!1}))};return g(t.In,{children:g(dr,{onCloseRequest:s,title:!1,size:916,children:N("div",{className:"OverwriteConfirm",children:[g("h3",{children:n.title}),N("div",{className:`OverwriteConfirm__Description OverwriteConfirm__Description--color-${n.color}`,children:[g("div",{className:"OverwriteConfirm__Description__icon",children:Sfe}),g("div",{children:n.description}),g("div",{className:"OverwriteConfirm__Description__spacer"}),g(Or,{color:n.color,size:"large",label:n.actionLabel,onClick:r})]}),g(ML,{children:e})]})})})}),{Actions:ML,Action:KT});var q7e="Expected a function",kL=NaN,Q7e="[object Symbol]",J7e=/^\s+|\s+$/g,e4e=/^[-+]0x[0-9a-f]+$/i,t4e=/^0b[01]+$/i,n4e=/^0o[0-7]+$/i,i4e=parseInt,s4e=typeof $a=="object"&&$a&&$a.Object===Object&&$a,r4e=typeof self=="object"&&self&&self.Object===Object&&self,o4e=s4e||r4e||Function("return this")(),a4e=Object.prototype,l4e=a4e.toString,c4e=Math.max,d4e=Math.min,V3=function(){return o4e.Date.now()};function u4e(e,t,n){var i,s,r,o,a,l,c=0,d=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(q7e);t=RL(t)||0,$v(n)&&(d=!!n.leading,u="maxWait"in n,r=u?c4e(RL(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f);function h(R){var T=i,w=s;return i=s=void 0,c=R,o=e.apply(w,T),o}function m(R){return c=R,a=setTimeout(b,t),d?h(R):o}function p(R){var T=R-l,w=R-c,S=t-T;return u?d4e(S,r-w):S}function U(R){var T=R-l,w=R-c;return l===void 0||T>=t||T<0||u&&w>=r}function b(){var R=V3();if(U(R))return y(R);a=setTimeout(b,p(R))}function y(R){return a=void 0,f&&i?h(R):(i=s=void 0,o)}function v(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function _(){return a===void 0?o:y(V3())}function I(){var R=V3(),T=U(R);if(i=arguments,s=this,l=R,T){if(a===void 0)return m(l);if(u)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=v,I.flush=_,I}function $v(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function f4e(e){return!!e&&typeof e=="object"}function h4e(e){return typeof e=="symbol"||f4e(e)&&l4e.call(e)==Q7e}function RL(e){if(typeof e=="number")return e;if(h4e(e))return kL;if($v(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=$v(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(J7e,"");var n=t4e.test(e);return n||n4e.test(e)?i4e(e.slice(2),n?2:8):e4e.test(e)?kL:+e}var g4e=u4e;const m4e=Sl(g4e),p4e=Wt(""),UY=Wt(null),U4e=350,b4e=()=>{const e=So(),t=kn(),n=L.useRef(null),[i,s]=gn(p4e),r=i.trim(),[o,a]=L.useState(!1),[l,c]=L.useState({nonce:null,items:[]}),d=L.useRef(null),u=L.useRef(void 0),[f,h]=gn(UY),m=e.scene.getNonDeletedElementsMap();L.useEffect(()=>{o||(r!==d.current||e.scene.getSceneNonce()!==u.current)&&(d.current=null,PL(r,e,(v,_)=>{c({nonce:Hr(),items:v}),d.current=r,u.current=e.scene.getSceneNonce(),t({searchMatches:v.length?{focusedId:null,matches:v.map(I=>({id:I.element.id,focus:!1,matchedLines:I.matchedLines}))}:null})}))},[o,r,m,e,t,h,u]);const p=()=>{l.items.length>0&&h(v=>v===null?0:(v+1)%l.items.length)},U=()=>{l.items.length>0&&h(v=>v===null?0:v-1<0?l.items.length-1:v-1)};L.useEffect(()=>{t(v=>{var I,R;return v.searchMatches?{searchMatches:{focusedId:f!==null&&((R=(I=v.searchMatches)==null?void 0:I.matches[f])==null?void 0:R.id)||null,matches:v.searchMatches.matches.map((T,w)=>w===f?{...T,focus:!0}:{...T,focus:!1})}}:null})},[f,t]),L.useEffect(()=>{var v,_,I,R;if(l.items.length>0&&f!==null){const T=l.items[f];if(T){const w=e.state.zoom.value,S=cr({text:T.searchQuery,x:T.element.x+(((v=T.matchedLines[0])==null?void 0:v.offsetX)??0),y:T.element.y+(((_=T.matchedLines[0])==null?void 0:_.offsetY)??0),width:(I=T.matchedLines[0])==null?void 0:I.width,height:(R=T.matchedLines[0])==null?void 0:R.height,fontSize:Ue(T.element)?mt.nameFontSize:T.element.fontSize,fontFamily:Ue(T.element)?rt.Assistant:T.element.fontFamily}),x=14,k=S.fontSize,P=k*w<x;if(!j2([S],e.canvas.width/window.devicePixelRatio,e.canvas.height/window.devicePixelRatio,{offsetLeft:e.state.offsetLeft,offsetTop:e.state.offsetTop,scrollX:e.state.scrollX,scrollY:e.state.scrollY,zoom:e.state.zoom},e.scene.getNonDeletedElementsMap(),e.getEditorUIOffsets())||P){let D;P?k>=x?D={fitToContent:!0}:D={fitToViewport:!0,maxZoom:Qa(x/k,1)}:D={fitToContent:!0},e.scrollToContent(S,{animate:!0,duration:300,...D,canvasOffsets:e.getEditorUIOffsets()})}}}},[f,l,e]),L.useEffect(()=>()=>{h(null),d.current=null,u.current=void 0,t({searchMatches:null}),a(!1)},[t,h]);const b=Cy({goToNextItem:p,goToPreviousItem:U,searchMatches:l});L.useEffect(()=>{const v=_=>{var I,R,T;if(_.key===$.ESCAPE&&!e.state.openDialog&&!e.state.openPopup){_.preventDefault(),_.stopPropagation(),t({openSidebar:null});return}if(_[$.CTRL_OR_CMD]&&_.key===$.F){if(_.preventDefault(),_.stopPropagation(),e.state.openDialog)return;(I=n.current)!=null&&I.matches(":focus")||(e.state.openDialog&&t({openDialog:null}),(R=n.current)==null||R.focus(),(T=n.current)==null||T.select())}_.target instanceof HTMLElement&&_.target.closest(".layer-ui__search")&&b.searchMatches.items.length&&(_.key===$.ENTER&&(_.stopPropagation(),b.goToNextItem()),_.key===$.ARROW_UP?(_.stopPropagation(),b.goToPreviousItem()):_.key===$.ARROW_DOWN&&(_.stopPropagation(),b.goToNextItem()))};return tn(window,te.KEYDOWN,v,{capture:!0,passive:!1})},[t,b,e]);const y=`${l.items.length} ${l.items.length===1?M("search.singleResult"):M("search.multipleResults")}`;return N("div",{className:"layer-ui__search",children:[g("div",{className:"layer-ui__search-header",children:g(Ru,{className:bs.SEARCH_MENU_INPUT_WRAPPER,value:i,ref:n,placeholder:M("search.placeholder"),icon:wu,onChange:v=>{s(v),a(!0);const _=v.trim();PL(_,e,(I,R)=>{c({nonce:Hr(),items:I}),h(R),d.current=_,u.current=e.scene.getSceneNonce(),t({searchMatches:I.length?{focusedId:null,matches:I.map(T=>({id:T.element.id,focus:!1,matchedLines:T.matchedLines}))}:null}),a(!1)})},selectOnRender:!0})}),N("div",{className:"layer-ui__search-count",children:[l.items.length>0&&N(he,{children:[f!==null&&f>-1?N("div",{children:[f+1," / ",y]}):g("div",{children:y}),N("div",{className:"result-nav",children:[g(qc,{onSelect:()=>{p()},className:"result-nav-btn",children:XV}),g(qc,{onSelect:()=>{U()},className:"result-nav-btn",children:Yfe})]})]}),l.items.length===0&&r&&d.current&&g("div",{style:{margin:"1rem auto"},children:M("search.noMatch")})]}),g(v4e,{matches:l,onItemClick:h,focusIndex:f,searchQuery:r})]})},LL=e=>{const t=[e.preview.moreBefore?"...":"",e.preview.previewText.slice(0,e.preview.indexInSearchQuery),e.preview.previewText.slice(e.preview.indexInSearchQuery,e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.previewText.slice(e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.moreAfter?"...":""];return g("div",{tabIndex:-1,className:le("layer-ui__result-item",{active:e.highlighted}),onClick:e.onClick,ref:n=>{e.highlighted&&(n==null||n.scrollIntoView({behavior:"auto",block:"nearest"}))},children:g("div",{className:"preview-text",children:t.flatMap((n,i)=>g(L.Fragment,{children:i===2?g("b",{children:n}):n},i))})})},y4e=e=>{const t=L.useMemo(()=>e.matches.items.filter(i=>Ue(i.element)),[e.matches]),n=L.useMemo(()=>e.matches.items.filter(i=>fe(i.element)),[e.matches]);return N("div",{children:[t.length>0&&N("div",{className:"layer-ui__search-result-container",children:[N("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:su}),g("div",{children:M("search.frames")})]}),t.map((i,s)=>g(LL,{searchQuery:e.searchQuery,preview:i.preview,highlighted:s===e.focusIndex,onClick:()=>e.onItemClick(s)},i.element.id+i.index)),n.length>0&&g("div",{className:"layer-ui__divider"})]}),n.length>0&&N("div",{className:"layer-ui__search-result-container",children:[N("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:Eh}),g("div",{children:M("search.texts")})]}),n.map((i,s)=>g(LL,{searchQuery:e.searchQuery,preview:i.preview,highlighted:s+t.length===e.focusIndex,onClick:()=>e.onItemClick(s+t.length)},i.element.id+i.index))]})]})},E4e=(e,t)=>e.matches.nonce===t.matches.nonce&&e.focusIndex===t.focusIndex,v4e=L.memo(y4e,E4e),DL=(e,t,n)=>{const r=e.slice(0,t),o=r.split(/\s+/),a=r.endsWith(" "),l=o.length-2-1-(a?0:1);let c=o.slice(l<=0?0:l).join(" ")+(a?" ":"");c=c.length>20?c.slice(-20):c;const u=e.slice(t+n.length),f=u.split(/\s+/),h=!u.startsWith(" "),m=h?6:5,p=(h?"":" ")+f.slice(0,m).join(" ");return{indexInSearchQuery:c.length,previewText:c+n+p,moreBefore:l>0,moreAfter:f.length>m}},_4e=(e,t)=>{const n=e.split(`
`),i=[];let s=0;for(let r=0;r<n.length;r++){let o=n[r];const a=n[r+1];if(a){const l=t.indexOf(a,s);if(l>o.length+s){let c=l-(o.length+s);for(;c>0;)o+=" ",c--}}i.push(o),s=s+o.length}return i.join(`
`)},w4e=(e,t,n)=>{const s=_4e(e.text,e.originalText).split(`
`),r=[];let o=0,a=0;for(const u of s){const f=o,h=f+u.length-1;r.push({line:u,startIndex:f,endIndex:h,lineNumber:a}),o=h+1,a++}let l=n,c=e.originalText.slice(n,n+t.length);const d=[];for(const u of r){if(c==="")break;if(l>=u.startIndex&&l<=u.endIndex){const f=u.endIndex+1-l,h=u.line.slice(0,l-u.startIndex),m=c.slice(0,f);c=c.slice(f);const p=qn(h,bt(e),e.lineHeight);if(h===""&&(p.width=0),e.textAlign!=="left"&&u.line.length>0){const _=qn(u.line,bt(e),e.lineHeight),I=e.textAlign==="center"?(e.width-_.width)/2:e.width-_.width;p.width+=I}const{width:U,height:b}=qn(m,bt(e),e.lineHeight),y=p.width,v=u.lineNumber*p.height;d.push({offsetX:y,offsetY:v,width:U,height:b,showOnCanvas:!0}),l+=f}}return d},T4e=(e,t,n,i)=>{const s=e.name??rw(e),r=s.slice(n,n+t.length),o=s.slice(0,n),a=bt({fontSize:mt.nameFontSize,fontFamily:rt.Assistant}),l=zc(rt.Assistant),c=qn(o,a,l);o===""&&(c.width=0);const d=qn(r,a,l),u=c.width,f=-c.height-mt.strokeWidth,h=d.width;return[{offsetX:u,offsetY:f,width:h,height:d.height,showOnCanvas:u+h<=e.width*i}]},I4e=e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&"),PL=m4e((e,t,n)=>{if(!e||e===""){n([],null);return}const i=t.scene.getNonDeletedElements(),s=i.filter(f=>fe(f)),r=i.filter(f=>Ue(f));s.sort((f,h)=>f.y-h.y),r.sort((f,h)=>f.y-h.y);const o=[],a=new RegExp(I4e(e),"gi");for(const f of s){let h=null;const m=f.originalText;for(;(h=a.exec(m))!==null;){const p=DL(m,h.index,e),U=w4e(f,e,h.index);U.length>0&&o.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const l=[];for(const f of r){let h=null;const m=f.name??rw(f);for(;(h=a.exec(m))!==null;){const p=DL(m,h.index,e),U=T4e(f,e,h.index,t.state.zoom.value);U.length>0&&l.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const c=new Set(t.visibleElements.map(f=>f.id)),d=[...l,...o],u=d.findIndex(f=>c.has(f.element.id))??null;n(d,u)},U4e),bY=Kp("DefaultSidebarTrigger",e=>{const{DefaultSidebarTriggerTunnel:t}=is();return g(t.In,{children:g(xs.Trigger,{...e,className:"default-sidebar-trigger",name:Rr.name})})});bY.displayName="DefaultSidebarTrigger";const yY=({children:e})=>{const{DefaultSidebarTabTriggersTunnel:t}=is();return g(t.In,{children:e})};yY.displayName="DefaultTabTriggers";const s5=Object.assign(Kp("DefaultSidebar",({children:e,className:t,onDock:n,docked:i,...s})=>{var c;const r=di(),o=kn(),{DefaultSidebarTabTriggersTunnel:a}=is(),l=((c=r.openSidebar)==null?void 0:c.tab)===Jd;return L.createElement(xs,{...s,name:"default",key:"default",className:le("default-sidebar",t),docked:l||(i??r.defaultSidebarDockedPreference),onDock:l||n===!1||!n&&i!=null?void 0:Z5(n,d=>{o({defaultSidebarDockedPreference:d})})},N(xs.Tabs,{children:[g(xs.Header,{children:N(xs.TabTriggers,{children:[g(xs.TabTrigger,{tab:Jd,children:wu}),g(xs.TabTrigger,{tab:qb,children:MV}),g(a.Out,{})]})}),g(xs.Tab,{tab:qb,children:g(D8e,{})}),g(xs.Tab,{tab:Jd,children:g(b4e,{})}),e]}))}),{Trigger:bY,TabTriggers:yY}),EY=({input:e,placeholder:t,onChange:n,onKeyboardSubmit:i})=>{const s=L.useRef(null),r=L.useRef(i);return r.current=i,L.useEffect(()=>{if(!r.current)return;const o=s.current;if(o){const a=l=>{var c;l[$.CTRL_OR_CMD]&&l.key===$.ENTER&&(l.preventDefault(),(c=r.current)==null||c.call(r))};return o.focus(),o.addEventListener(te.KEYDOWN,a),()=>{o.removeEventListener(te.KEYDOWN,a)}}},[]),g("textarea",{className:"ttd-dialog-input",onChange:n,value:e,placeholder:t,ref:s})},S4e=({error:e})=>N("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:["Error! ",g("p",{children:e})]}),vY=({error:e,canvasRef:t,loaded:n})=>N("div",{className:"ttd-dialog-output-wrapper",children:[e&&g(S4e,{error:e.message}),n?g("div",{ref:t,style:{opacity:e?"0.15":1},className:"ttd-dialog-output-canvas-container"}):g(Ul,{size:"2rem"})]}),r5=({label:e,children:t,panelAction:n,panelActionDisabled:i=!1,onTextSubmitInProgess:s,renderTopRight:r,renderSubmitShortcut:o,renderBottomRight:a})=>N("div",{className:"ttd-dialog-panel",children:[N("div",{className:"ttd-dialog-panel__header",children:[g("label",{children:e}),r==null?void 0:r()]}),t,N("div",{className:le("ttd-dialog-panel-button-container",{invisible:!n}),style:{display:"flex",alignItems:"center"},children:[N(qc,{className:"ttd-dialog-panel-button",onSelect:n?n.action:()=>{},disabled:i||s,children:[N("div",{className:le({invisible:s}),children:[n==null?void 0:n.label,(n==null?void 0:n.icon)&&g("span",{children:n.icon})]}),s&&g(Ul,{})]}),!i&&!s&&(o==null?void 0:o()),a==null?void 0:a()]})]}),_Y=({children:e})=>g("div",{className:"ttd-dialog-panels",children:e}),wY=()=>N("div",{className:"ttd-dialog-submit-shortcut",children:[g("div",{className:"ttd-dialog-submit-shortcut__key",children:Q("CtrlOrCmd")}),g("div",{className:"ttd-dialog-submit-shortcut__key",children:Q("Enter")})]}),x4e=({canvasRef:e,setError:t})=>{const n=e.current;if(!n)return;const i=n.parentElement;i&&(i.style.background="",t(null),n.replaceChildren())},TY=async({canvasRef:e,mermaidToExcalidrawLib:t,mermaidDefinition:n,setError:i,data:s})=>{const r=e.current,o=r==null?void 0:r.parentElement;if(!(!r||!o)){if(!n){x4e({canvasRef:e,setError:i});return}try{const a=await t.api;let l;try{l=await a.parseMermaidToExcalidraw(n)}catch{l=await a.parseMermaidToExcalidraw(n.replace(/"/g,"'"))}const{elements:c,files:d}=l;i(null),s.current={elements:Fv(c,{regenerateIds:!0}),files:d};const u=await qy({elements:s.current.elements,files:s.current.files,exportPadding:Sg,maxWidthOrHeight:Math.max(o.offsetWidth,o.offsetHeight)*window.devicePixelRatio});try{await $0(u)}catch(f){throw f.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):f}o.style.background="var(--default-bg-color)",r.replaceChildren(u)}catch(a){throw o.style.background="var(--default-bg-color)",n&&i(a),a}}},ZT=e=>{ru.set(Im.MERMAID_TO_EXCALIDRAW,e)},IY=({app:e,data:t,text:n,shouldSaveMermaidDataToStorage:i})=>{const{elements:s,files:r}=t.current;s.length&&(e.addElementsFromPasteOrLibrary({elements:s,files:r,position:"center",fitToContent:!0}),e.setOpenDialog(null),i&&n&&ZT(n))},C4e=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,NL=ul(ZT,300),A4e=({mermaidToExcalidrawLib:e})=>{const[t,n]=L.useState(()=>ru.get(Im.MERMAID_TO_EXCALIDRAW)||C4e),i=L.useDeferredValue(t.trim()),[s,r]=L.useState(null),o=L.useRef(null),a=L.useRef({elements:[],files:null}),l=So();L.useEffect(()=>{TY({canvasRef:o,data:a,mermaidToExcalidrawLib:e,setError:r,mermaidDefinition:i}).catch(d=>{}),NL(i)},[i,e]),L.useEffect(()=>()=>{NL.flush()},[]);const c=()=>{IY({app:l,data:a,text:t,shouldSaveMermaidDataToStorage:!0})};return N(he,{children:[g("div",{className:"ttd-dialog-desc",children:g(Rs,{i18nKey:"mermaid.description",flowchartLink:d=>g("a",{href:"https://mermaid.js.org/syntax/flowchart.html",children:d}),sequenceLink:d=>g("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",children:d}),classLink:d=>g("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",children:d})})}),N(_Y,{children:[g(r5,{label:M("mermaid.syntax"),children:g(EY,{input:t,placeholder:"Write Mermaid diagram defintion here...",onChange:d=>n(d.target.value),onKeyboardSubmit:()=>{c()}})}),g(r5,{label:M("mermaid.preview"),panelAction:{action:()=>{c()},label:M("mermaid.button"),icon:Q2},renderSubmitShortcut:()=>g(wY,{}),children:g(vY,{canvasRef:o,loaded:e.loaded,error:s})})]})]})},SY=e=>{const t=kn(),n=L.useRef(null),i=L.useRef(0);return g(jj,{ref:n,className:"ttd-dialog-tabs-root",value:e.tab,onValueChange:s=>{var o;if(!s)return;const r=(o=n.current)==null?void 0:o.closest(".Modal__content");if(r){const a=r.offsetHeight||0;a>i.current&&(i.current=a,r.style.minHeight=`min(${i.current}px, 100%)`)}e.dialog==="ttd"&&aB(["text-to-diagram","mermaid"],s)&&t({openDialog:{name:e.dialog,tab:s}})},children:e.children})};SY.displayName="TTDDialogTabs";const xY=({children:e,...t})=>g(Yj,{className:"ttd-dialog-triggers",...t,children:e});xY.displayName="TTDDialogTabTriggers";const Gv=({children:e,tab:t,onSelect:n,...i})=>g(Wj,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"ttd-dialog-tab-trigger",...i,children:e})});Gv.displayName="TTDDialogTabTrigger";const Xv=({tab:e,children:t,...n})=>g(Kj,{...n,value:e,children:t});Xv.displayName="TTDDialogTab";const $3=3,Uf=1e3,M4e=Wt(null),k4e=Wt(null),CY=e=>{var n;const t=di();return((n=t.openDialog)==null?void 0:n.name)!=="ttd"?null:g(R4e,{...e,tab:t.openDialog.tab})},R4e=Kp("TTDDialogBase",({tab:e,...t})=>{const n=So(),i=kn(),s=L.useRef(null),[r,o]=gn(k4e),[a,l]=L.useState((r==null?void 0:r.prompt)??""),c=a.trim(),d=R=>{l(R.target.value),o(T=>({generatedResponse:(T==null?void 0:T.generatedResponse)??null,prompt:R.target.value}))},[u,f]=L.useState(!1),[h,m]=gn(M4e),p=async()=>{if(c.length>Uf||c.length<$3||u||(h==null?void 0:h.rateLimitRemaining)===0||"__fallback"in t){c.length<$3&&I(new Error(`Prompt is too short (min ${$3} characters)`)),c.length>Uf&&I(new Error(`Prompt is too long (max ${Uf} characters)`));return}try{f(!0),it("ai","generate","ttd");const{generatedResponse:R,error:T,rateLimit:w,rateLimitRemaining:S}=await t.onTextSubmit(c);if(typeof R=="string"&&o(x=>({generatedResponse:R,prompt:(x==null?void 0:x.prompt)??null})),xm(w)&&xm(S)&&m({rateLimit:w,rateLimitRemaining:S}),T){I(T);return}if(!R){I(new Error("Generation failed"));return}try{await TY({canvasRef:s,data:v,mermaidToExcalidrawLib:b,setError:I,mermaidDefinition:R}),it("ai","mermaid parse success","ttd")}catch(x){console.info(`%cTTD mermaid render errror: ${x.message}`,"color: red"),console.info(`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TTD mermaid definition render errror: ${x.message}`,"color: yellow"),it("ai","mermaid parse failed","ttd"),I(new Error("Generated an invalid diagram :(. You may also try a different prompt."))}}catch(R){let T=R.message;(!T||T==="Failed to fetch")&&(T="Request failed"),I(new Error(T))}finally{f(!1)}},U=L.useRef(p);U.current=p;const[b,y]=L.useState({loaded:!1,api:pe(()=>import("./index-BeQPmZTo.js").then(R=>R.b6),__vite__mapDeps([]))});L.useEffect(()=>{(async()=>{await b.api,y(T=>({...T,loaded:!0}))})()},[b.api]);const v=L.useRef({elements:[],files:null}),[_,I]=L.useState(null);return g(dr,{className:"ttd-dialog",onCloseRequest:()=>{n.setOpenDialog(null)},size:1200,title:!1,...t,autofocus:!1,children:N(SY,{dialog:"ttd",tab:e,children:["__fallback"in t&&t.__fallback?g("p",{className:"dialog-mermaid-title",children:M("mermaid.title")}):N(xY,{children:[g(Gv,{tab:"text-to-diagram",children:N("div",{style:{display:"flex",alignItems:"center"},children:[M("labels.textToDiagram"),g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1px 6px",marginLeft:"10px",fontSize:10,borderRadius:"12px",background:"var(--color-promo)",color:"var(--color-surface-lowest)"},children:"AI Beta"})]})}),g(Gv,{tab:"mermaid",children:"Mermaid"})]}),g(Xv,{className:"ttd-dialog-content",tab:"mermaid",children:g(A4e,{mermaidToExcalidrawLib:b})}),!("__fallback"in t)&&N(Xv,{className:"ttd-dialog-content",tab:"text-to-diagram",children:[g("div",{className:"ttd-dialog-desc",children:"Currently we use Mermaid as a middle step, so you'll get best results if you describe a diagram, workflow, flow chart, and similar."}),N(_Y,{children:[g(r5,{label:M("labels.prompt"),panelAction:{action:p,label:"Generate",icon:Q2},onTextSubmitInProgess:u,panelActionDisabled:c.length>Uf||(h==null?void 0:h.rateLimitRemaining)===0,renderTopRight:()=>h?N("div",{className:"ttd-dialog-rate-limit",style:{fontSize:12,marginLeft:"auto",color:h.rateLimitRemaining===0?"var(--color-danger)":void 0},children:[h.rateLimitRemaining," requests left today"]}):null,renderSubmitShortcut:()=>g(wY,{}),renderBottomRight:()=>{if(typeof(r==null?void 0:r.generatedResponse)=="string")return N("div",{className:"excalidraw-link",style:{marginLeft:"auto",fontSize:14},onClick:()=>{typeof(r==null?void 0:r.generatedResponse)=="string"&&(ZT(r.generatedResponse),i({openDialog:{name:"ttd",tab:"mermaid"}}))},children:["View as Mermaid",g(Ly,{icon:Q2})]});const R=c.length/Uf;return R>.8?N("div",{style:{marginLeft:"auto",fontSize:12,fontFamily:"monospace",color:R>1?"var(--color-danger)":void 0},children:["Length: ",c.length,"/",Uf]}):null},children:g(EY,{onChange:d,input:a,placeholder:"Describe what you want to see...",onKeyboardSubmit:()=>{U.current()}})}),g(r5,{label:"Preview",panelAction:{action:()=>{console.info("Panel action clicked"),IY({app:n,data:v})},label:"Insert",icon:Q2},children:g(vY,{canvasRef:s,error:_,loaded:b.loaded})})]})]})]})})}),L4e=.01,jv=10,_l=(e,t)=>!(t==="angle"&&Ue(e)),Zi=(e,t)=>{const n=e+t/2;return n-n%t},o5=(e,t,n)=>Object.keys(e).map(i=>({original:(n??t).get(i),latest:t.get(i)})).filter(i=>i.original!==void 0&&i.latest!==void 0),Z0=(e,t,n,i,s,r,o=!0)=>{if(dn(n)&&(n.startBinding||n.endBinding)){if(Math.abs(e-n.x)<g0&&Math.abs(t-n.y)<g0)return;Vr(n,"start",i),Vr(n,"end",i)}const a=i.getNonDeletedElementsMap(),l=a.get(n.id);if(!l)return;const[c,d]=[n.x+n.width/2,n.y+n.height/2],[u,f]=Z(C(n.x,n.y),C(c,d),n.angle),h=e-u,m=t-f,[p,U]=Z(C(e,t),C(c+h,d+m),-n.angle);i.mutateElement(l,{x:p,y:U},{informMutation:o,isDragging:!1}),v0(l,i,s);const b=Re(n,r);if(b){const y=a.get(b.id);y&&i.mutateElement(y,{x:b.x+h,y:b.y+m},{informMutation:o,isDragging:!1})}if(Ue(n)){const y=or(r,n.id);y.forEach(v=>{const _=a.get(v.id);if(!_)return;const[I,R]=[v.x+v.width/2,v.y+v.height/2],[T,w]=Z(C(v.x,v.y),C(I,R),v.angle),S=Math.round(T+h),x=Math.round(w+m),[k,P]=Z(C(S,x),C(I+h,R+m),-v.angle);i.mutateElement(_,{x:k,y:P},{informMutation:o,isDragging:!1}),v0(_,i,s,{simultaneouslyUpdated:y})})}},qT=(e,t)=>{const i=Ic(t).map(s=>Lt(e,s).reduce((r,o)=>(r[o.id]=!0,r),{}));return e.filter(s=>!Yh(s)).forEach(s=>{i.push({[s.id]:!0})}),i},kl=({label:e,icon:t,dragInputCallback:n,value:i,elements:s,editable:r=!0,shouldKeepAspectRatio:o,property:a,scene:l,appState:c,sensitivity:d=1,dragFinishedCallback:u})=>{const f=So(),h=kn(),m=L.useRef(null),p=L.useRef(null),[U,b]=L.useState(i.toString()),y=L.useRef(null);y.current||(y.current={originalAppState:Ja(c),originalElements:s,lastUpdatedValue:U,updatePending:!1}),L.useEffect(()=>{const I=i.toString();b(I),y.current.lastUpdatedValue=I},[i]);const v=(I,R,T)=>{if(!y.current.updatePending)return!1;y.current.updatePending=!1;const w=Number(I);if(isNaN(w)){b(i.toString());return}const S=Number(w.toFixed(2)),x=Number(i);(isNaN(x)||Math.abs(S-x)>=L4e)&&(y.current.lastUpdatedValue=I,n({accumulatedChange:0,instantChange:0,originalElements:R,originalElementsMap:f.scene.getNonDeletedElementsMap(),shouldKeepAspectRatio:o,shouldChangeByStepSize:!1,scene:l,nextValue:S,property:a,originalAppState:T,setInputValue:k=>b(String(k)),app:f,setAppState:h}),f.syncActionResult({captureUpdate:q.IMMEDIATELY}))},_=L.useRef({});return _.current.handleInputValue=v,L.useEffect(()=>{const I=m.current,R=_.current;return()=>{var w;const T=I==null?void 0:I.value;T&&((w=R.handleInputValue)==null||w.call(R,T,y.current.originalElements,y.current.originalAppState)),window.removeEventListener(te.POINTER_MOVE,R.onPointerMove,!1),window.removeEventListener(te.POINTER_UP,R.onPointerUp,!1)}},[r]),r?N("div",{className:le("drag-input-container",!r&&"disabled"),"data-testid":e,children:[g("div",{className:"drag-input-label",ref:p,onPointerDown:I=>{if(m.current&&r){document.body.classList.add("excalidraw-cursor-resize"),Number(m.current.value);let R=null,T=f.scene.getNonDeletedElements().reduce((j,G)=>(j.set(G.id,Gc(G)),j),new Map),w=s.map(j=>T.get(j.id));const S=Ja(c);let x=0,k=0;const P=j=>{if(R&&T!==null&&w!==null){const G=j.clientX-R.x;G!==0&&(k+=G,Math.abs(k)>=d&&(k=Math.sign(k)*Math.floor(Math.abs(k)/d),x+=k,n({accumulatedChange:x,instantChange:k,originalElements:w,originalElementsMap:T,shouldKeepAspectRatio:o,shouldChangeByStepSize:j.shiftKey,property:a,scene:l,originalAppState:S,setInputValue:V=>b(String(V)),app:f,setAppState:h}),k=0))}R={x:j.clientX,y:j.clientY}},D=()=>{window.removeEventListener(te.POINTER_MOVE,P,!1),f.syncActionResult({captureUpdate:q.IMMEDIATELY}),u==null||u({app:f,setAppState:h,originalElements:w,originalAppState:S}),R=null,x=0,k=0,w=null,T=null,document.body.classList.remove("excalidraw-cursor-resize"),window.removeEventListener(te.POINTER_UP,D,!1)};_.current.onPointerMove=P,_.current.onPointerUp=D,window.addEventListener(te.POINTER_MOVE,P,!1),window.addEventListener(te.POINTER_UP,D,!1)}},onPointerEnter:()=>{p.current&&(p.current.style.cursor="ew-resize")},children:t?g(Ly,{icon:t}):e}),g("input",{className:"drag-input",autoComplete:"off",spellCheck:"false",onKeyDown:I=>{if(r){const R=I.target;R instanceof HTMLInputElement&&I.key===$.ENTER&&(v(R.value,s,c),f.focusContainer())}},ref:m,value:U,onChange:I=>{y.current.updatePending=!0,b(I.target.value)},onFocus:I=>{I.target.select(),y.current.originalElements=s,y.current.originalAppState=Ja(c)},onBlur:I=>{U?r&&v(I.target.value,y.current.originalElements,y.current.originalAppState):b(i.toString())},disabled:!r})]}):null},D4e=15,P4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s,app:r})=>{const o=s.getNonDeletedElementsMap(),a=t[0];if(a&&!ye(a)){const l=o.get(a.id);if(!l)return;if(i!==void 0){const m=eu(i);s.mutateElement(l,{angle:m}),v0(l,s,r.state);const p=Re(l,o);p&&!_e(l)&&s.mutateElement(p,{angle:m});return}const c=Math.round(Y5(a.angle)*100)/100,d=Math.round(e);let u=(c+d)%360;n&&(u=Zi(u,D4e)),u=u<0?u+360:u;const f=eu(u);s.mutateElement(l,{angle:f}),v0(l,s,r.state);const h=Re(l,o);h&&!_e(l)&&s.mutateElement(h,{angle:f})}},N4e=({element:e,scene:t,appState:n,property:i})=>g(kl,{label:"A",icon:zV,value:Math.round(Y5(e.angle)%360*100)/100,elements:[e],dragInputCallback:P4e,editable:_l(e,"angle"),scene:t,appState:n,property:i}),OL=5,O4e=({property:e,scene:t,appState:n,setAppState:i})=>g(kl,{label:"Grid step",sensitivity:8,elements:[],dragInputCallback:({nextValue:s,instantChange:r,shouldChangeByStepSize:o,setInputValue:a})=>{i(l=>{let c;return s?c=s:r&&(c=o?Zi(l.gridStep+OL*Math.sign(r),OL):l.gridStep+r),c?(c=CV(c),a(c),{gridStep:c}):(a(l.gridStep),null)})},scene:t,value:n.gridStep,property:e,appState:n}),FL=10,F4e=e=>e.type==="image",B4e=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldKeepAspectRatio:i,shouldChangeByStepSize:s,nextValue:r,property:o,originalAppState:a,instantChange:l,scene:c,app:d,setAppState:u})=>{const f=c.getNonDeletedElementsMap(),h=t[0],m=f.get(h.id);if(h&&m){const p=i||F4e(h),U=h.width/h.height;if(a.croppingElementId===h.id){const b=f.get(h.id);if(!b||!wt(b)||!b.crop)return;const y=b.crop;let v={...y};const _=b.scale[0]===-1,I=b.scale[1]===-1,{width:R,height:T}=gl(b),w=y.naturalWidth/R,S=y.naturalHeight/T,x=_?y.width+y.x:y.naturalWidth-y.x,k=I?y.height+y.y:y.naturalHeight-y.y,P=fi*w,D=fi*S;if(r!==void 0){if(o==="width"){const z=r*w,X=Ze(z,P,x);v={...v,width:X,x:_?y.x+y.width-X:y.x}}else if(o==="height"){const z=r*S,X=Ze(z,D,k);v={...v,height:X,y:I?y.y+y.height-X:y.y}}c.mutateElement(b,{crop:v,width:v.width/(y.naturalWidth/R),height:v.height/(y.naturalHeight/T)});return}const j=o==="width"?l:0,G=o==="height"?l:0,V=Ze(y.width+j,P,x),B=Ze(y.height+G,P,k);v={...y,x:_?y.x+y.width-V:y.x,y:I?y.y+y.height-B:y.y,width:V,height:B},c.mutateElement(b,{crop:v,width:v.width/(y.naturalWidth/R),height:v.height/(y.naturalHeight/T)});return}if(r!==void 0){const b=Math.max(o==="width"?r:p?r*U:h.width,Ur),y=Math.max(o==="height"?r:p?r/U:h.height,Ur);if(S0(b,y,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),Ue(m)){const v=Qo(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap()),_=Ag(c.getElementsIncludingDeleted(),v,m,d);c.replaceAllElements(_)}return}{const b=o==="width"?e:0,y=o==="height"?e:0;let v=Math.max(0,h.width+b);o==="width"&&(s?v=Zi(v,FL):v=Math.round(v));let _=Math.max(0,h.height+y);if(o==="height"&&(s?_=Zi(_,FL):_=Math.round(_)),p&&(o==="width"?_=Math.round(v/U*100)/100:v=Math.round(_*U*100)/100),_=Math.max(Ur,_),v=Math.max(Ur,v),S0(v,_,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),Ue(m)){const I=Qo(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap());u({elementsToHighlight:I})}}}},z4e=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const s=t.scene.getNonDeletedElementsMap(),r=n==null?void 0:n[0],o=r&&s.get(r.id);if(o&&Ue(o)){const a=Qo(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=Ag(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},BL=({property:e,element:t,scene:n,appState:i})=>{let s=Qa(e==="width"?t.width:t.height,2);if(i.croppingElementId&&i.croppingElementId===t.id&&wt(t)&&t.crop){const{width:r,height:o}=gl(t);if(e==="width"){const a=r/t.crop.naturalWidth;s=Qa(t.crop.width*a,2)}if(e==="height"){const a=o/t.crop.naturalHeight;s=Qa(t.crop.height*a,2)}}return g(kl,{label:e==="width"?"W":"H",elements:[t],dragInputCallback:B4e,value:s,editable:_l(t,e),scene:n,appState:i,property:e,dragFinishedCallback:z4e})},zL=4,H4e=4,V4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t[0];if(o){const a=r.get(o.id);if(!a||!fe(a))return;let l;if(i!==void 0)l=Math.max(Math.round(i),zL);else if(o.type==="text"){const c=Math.round(o.fontSize),d=Math.round(e);l=Math.max(c+d,zL),n&&(l=Zi(l,H4e))}l&&(s.mutateElement(a,{fontSize:l}),ns(a,s.getContainerElement(a),s))}},$4e=({element:e,scene:t,appState:n,property:i})=>{const s=fe(e)?e:Fi(e)?Re(e,t.getNonDeletedElementsMap()):null;return s?g(kl,{label:"F",value:Math.round(s.fontSize*10)/10,elements:[s],dragInputCallback:V4e,icon:vy,appState:n,scene:t,property:i}):null},G4e=15,X4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,property:s,scene:r})=>{const o=r.getNonDeletedElementsMap(),a=t.map(c=>o.get(c.id)).filter(c=>c&&!Yh(c)&&_l(c,s)),l=t.filter(c=>!Yh(c)&&_l(c,s));if(i!==void 0){const c=eu(i);for(const d of a){if(!d)continue;r.mutateElement(d,{angle:c});const u=Re(d,o);u&&!_e(d)&&r.mutateElement(u,{angle:c})}r.triggerUpdate();return}for(let c=0;c<a.length;c++){const d=a[c];if(!d)continue;const u=l[c],f=Math.round(Y5(u.angle)*100)/100,h=Math.round(e);let m=(f+h)%360;n&&(m=Zi(m,G4e)),m=m<0?m+360:m;const p=eu(m);r.mutateElement(d,{angle:p});const U=Re(d,o);U&&!_e(d)&&r.mutateElement(U,{angle:p})}r.triggerUpdate()},j4e=({elements:e,scene:t,appState:n,property:i})=>{const s=e.filter(l=>!Yh(l)&&_l(l,"angle")),r=s.map(l=>Math.round(Y5(l.angle)%360*100)/100),o=new Set(r).size===1?r[0]:"Mixed",a=s.some(l=>_l(l,"angle"));return g(kl,{label:"A",icon:zV,value:o,elements:e,dragInputCallback:X4e,editable:a,appState:n,scene:t,property:i})},bf=10,Y4e=(e,t,n,i)=>{const s=i.x-e,r=i.y-t,o=i.width*n,a=i.height*n,l=e+s*n,c=t+r*n;return{width:o,height:a,x:l,y:c,...pw(i,o,a,!1),...fe(i)?{fontSize:i.fontSize*n}:{}}},W4e=(e,t,n,i,s,r,o,a)=>{const l=a.getNonDeletedElementsMap(),c=Y4e(e,t,i,r);a.mutateElement(s,c);const d=Re(r,o);if(d){const u=d.fontSize*i;ps(s,a);const f=l.get(d.id);f&&fe(f)&&(a.mutateElement(f,{fontSize:u}),Lp(s,a,n==="width"?"e":"s",!0))}},HL=(e,t,n,i,s,r,o,a,l,c)=>{r==="width"?t=Math.round(e/i*100)/100:e=Math.round(t*i*100)/100;const d=t/n;for(let u=0;u<a.length;u++){const f=a[u],h=o[u];W4e(s[0],s[1],r,d,h,f,l,c)}},K4e=({accumulatedChange:e,originalElements:t,originalElementsMap:n,originalAppState:i,shouldChangeByStepSize:s,nextValue:r,scene:o,property:a,setAppState:l,app:c})=>{const d=o.getNonDeletedElementsMap(),u=qT(t,i);if(r!==void 0){for(const p of u){const U=o5(p,d,n);if(U.length>1){const b=U.map(P=>P.latest),y=U.map(P=>P.original),[v,_,I,R]=pt(y),T=I-v,w=R-_,S=T/w,x=Math.max(Ur,a==="width"?Math.max(0,r):T),k=Math.max(Ur,a==="height"?Math.max(0,r):w);HL(x,k,w,S,C(v,_),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,v=b==null?void 0:b.original;if(y&&v&&_l(y,a)){let _=a==="width"?Math.max(0,r):y.width;a==="width"&&(s?_=Zi(_,bf):_=Math.round(_));let I=a==="height"?Math.max(0,r):y.height;if(a==="height"&&(s?I=Zi(I,bf):I=Math.round(I)),_=Math.max(Ur,_),I=Math.max(Ur,I),S0(_,I,y,v,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),Ue(y)){const R=Qo(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap()),T=Ag(o.getElementsIncludingDeleted(),R,y,c);o.replaceAllElements(T)}}}}o.triggerUpdate();return}const f=a==="width"?e:0,h=a==="height"?e:0,m=[];for(const p of u){const U=o5(p,d,n);if(U.length>1){const b=U.map(P=>P.latest),y=U.map(P=>P.original),[v,_,I,R]=pt(y),T=I-v,w=R-_,S=T/w;let x=Math.max(0,T+f);a==="width"&&(s?x=Zi(x,bf):x=Math.round(x));let k=Math.max(0,w+h);a==="height"&&(s?k=Zi(k,bf):k=Math.round(k)),x=Math.max(Ur,x),k=Math.max(Ur,k),HL(x,k,w,S,C(v,_),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,v=b==null?void 0:b.original;if(y&&v&&_l(y,a)){let _=Math.max(0,v.width+f);a==="width"&&(s?_=Zi(_,bf):_=Math.round(_));let I=Math.max(0,v.height+h);if(a==="height"&&(s?I=Zi(I,bf):I=Math.round(I)),_=Math.max(Ur,_),I=Math.max(Ur,I),S0(_,I,y,v,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),Ue(y)){const R=Qo(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap());m.push(...R)}}}}l({elementsToHighlight:m}),o.triggerUpdate()},Z4e=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const s=t.scene.getNonDeletedElementsMap(),r=n==null?void 0:n[0],o=r&&s.get(r.id);if(o&&Ue(o)){const a=Qo(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=Ag(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},VL=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:s,appState:r})=>{const o=L.useMemo(()=>i.map(c=>{const d=o5(c,n);if(d.length>1){const[f,h,m,p]=pt(d.map(U=>U.latest));return Math.round((e==="width"?m-f:p-h)*100)/100}const[u]=d;return Math.round((e==="width"?u.latest.width:u.latest.height)*100)/100}),[n,i,e]),a=new Set(o).size===1?Math.round(o[0]*100)/100:"Mixed",l=o.length>0;return g(kl,{label:e==="width"?"W":"H",elements:t,dragInputCallback:K4e,value:a,editable:l,appState:r,property:e,scene:s,dragFinishedCallback:Z4e})},$L=4,q4e=4,Q4e=(e,t)=>e.reduce((n,i)=>{if(!i||Yh(i))return n;if(fe(i))return n.push(i),n;if(Fi(i)){const s=Re(i,t);if(s)return n.push(s),n}return n},[]),J4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t.map(l=>r.get(l.id));let a;if(i){a=Math.max(Math.round(i),$L);for(const l of o)s.mutateElement(l,{fontSize:a}),ns(l,s.getContainerElement(l),s);s.triggerUpdate()}else{const l=t;for(let c=0;c<o.length;c++){const d=o[c],u=l[c],f=Math.round(u.fontSize),h=Math.round(e);let m=Math.max(f+h,$L);n&&(m=Zi(m,q4e)),s.mutateElement(d,{fontSize:m}),ns(d,s.getContainerElement(d),s)}s.triggerUpdate()}},eve=({elements:e,scene:t,appState:n,property:i,elementsMap:s})=>{const r=Q4e(e,s);if(!r.length)return null;const o=r.map(c=>Math.round(c.fontSize*10)/10),a=new Set(o).size===1?o[0]:"Mixed",l=o.length>0;return g(kl,{label:"F",icon:vy,elements:r,dragInputCallback:J4e,value:a,editable:l,scene:t,property:i,appState:n})},tve=(e,t,n,i,s,r,o)=>{for(let a=0;a<i.length;a++){const l=i[a],[c,d]=[l.x+l.width/2,l.y+l.height/2],[u,f]=Z(C(l.x,l.y),C(c,d),l.angle),h=e==="x"?Math.round(u+t):u,m=e==="y"?Math.round(f+n):f;Z0(h,m,l,r,o,s,!1)}},nve=(e,t,n,i,s,r)=>{const o=s.getNonDeletedElementsMap(),[a,l,,]=pt(n),c=e-a,d=t-l;for(let u=0;u<n.length;u++){const f=n[u],h=o.get(f.id);if(h&&(!fe(h)||!h.containerId)){const[m,p]=[h.x+h.width/2,h.y+h.height/2],[U,b]=Z(C(h.x,h.y),C(m,p),h.angle);Z0(U+c,b+d,f,s,r,i,!1)}}},ive=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldChangeByStepSize:i,nextValue:s,property:r,scene:o,originalAppState:a,app:l})=>{var h,m;const c=o.getNonDeletedElementsMap();if(s!==void 0){for(const p of qT(t,a)){const U=o5(p,c,n);if(U.length>1){const[b,y,,]=pt(U.map(I=>I.latest));nve(r==="x"?s:b,r==="y"?s:y,U.map(I=>I.original),n,o,l.state)}else{const b=(h=U[0])==null?void 0:h.original,y=(m=U[0])==null?void 0:m.latest;if(b&&y&&_l(y,r)){const[v,_]=[b.x+b.width/2,b.y+b.height/2],[I,R]=Z(C(b.x,b.y),C(v,_),b.angle);Z0(r==="x"?s:I,r==="y"?s:R,b,o,l.state,n,!1)}}}o.triggerUpdate();return}const d=i?Zi(e,jv):e;tve(r,r==="x"?d:0,r==="y"?d:0,t,n,o,l.state),o.triggerUpdate()},GL=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:s,appState:r})=>{const o=L.useMemo(()=>i.map(l=>{const c=Object.keys(l).map(p=>n.get(p)).filter(p=>p!==void 0);if(c.length>1){const[p,U]=pt(c);return Math.round((e==="x"?p:U)*100)/100}const[d]=c,[u,f]=[d.x+d.width/2,d.y+d.height/2],[h,m]=Z(C(d.x,d.y),C(u,f),d.angle);return Math.round((e==="x"?h:m)*100)/100}),[i,n,e]),a=new Set(o).size===1?o[0]:"Mixed";return g(kl,{label:e==="x"?"X":"Y",elements:t,dragInputCallback:ive,value:a,property:e,scene:s,appState:r})},sve=({accumulatedChange:e,instantChange:t,originalElements:n,originalElementsMap:i,shouldChangeByStepSize:s,nextValue:r,property:o,scene:a,originalAppState:l,app:c})=>{const d=a.getNonDeletedElementsMap(),u=n[0],[f,h]=[u.x+u.width/2,u.y+u.height/2],[m,p]=Z(C(u.x,u.y),C(f,h),u.angle);if(l.croppingElementId===u.id){const _=d.get(u.id);if(!_||!wt(_)||!_.crop)return;const I=_.crop;let R=I;const T=_.scale[0]===-1,w=_.scale[1]===-1,{width:S,height:x}=gl(_);if(r!==void 0){if(o==="x"){const D=r*(I.naturalWidth/S);T?R={...I,x:Ze(I.naturalWidth-D-I.width,0,I.naturalWidth-I.width)}:R={...I,x:Ze(r*(I.naturalWidth/S),0,I.naturalWidth-I.width)}}o==="y"&&(R={...I,y:Ze(r*(I.naturalHeight/x),0,I.naturalHeight-I.height)}),a.mutateElement(_,{crop:R});return}const k=(o==="x"?t:0)*(T?-1:1),P=(o==="y"?t:0)*(w?-1:1);R={...I,x:Ze(I.x+k,0,I.naturalWidth-I.width),y:Ze(I.y+P,0,I.naturalHeight-I.height)},a.mutateElement(_,{crop:R});return}if(r!==void 0){Z0(o==="x"?r:m,o==="y"?r:p,u,a,c.state,i);return}const U=o==="x"?e:0,b=o==="y"?e:0,y=o==="x"?Math.round(s?Zi(u.x+U,jv):m+U):m,v=o==="y"?Math.round(s?Zi(u.y+b,jv):p+b):p;Z0(y,v,u,a,c.state,i)},XL=({property:e,element:t,elementsMap:n,scene:i,appState:s})=>{const[r,o]=Z(C(t.x,t.y),C(t.x+t.width/2,t.y+t.height/2),t.angle);let a=Qa(e==="x"?r:o,2);if(s.croppingElementId===t.id&&wt(t)&&t.crop){const l=jne(t);l&&(a=Qa(e==="x"?l.x:l.y,2))}return g(kl,{label:e==="x"?"X":"Y",elements:[t],dragInputCallback:sve,scene:i,value:a,property:e,appState:s})},rve=50,Pa=e=>{const t=qp(),n=e.app.scene.getSceneNonce()||1,i=e.app.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}),s=W0(e.app);return g(ove,{...e,appState:t,sceneNonce:n,selectedElements:i,gridModeEnabled:s})},Kt=({children:e,columns:t=1,heading:n,style:i,...s})=>g("div",{className:le("exc-stats__row",{"exc-stats__row--heading":n}),style:{gridTemplateColumns:`repeat(${t}, 1fr)`,...i},...s,children:e});Kt.displayName="StatsRow";const a5=({children:e,order:t,style:n,...i})=>g("div",{className:"exc-stats__rows",style:{order:t,...n},...i,children:e});a5.displayName="StatsRows";Pa.StatsRow=Kt;Pa.StatsRows=a5;const ove=L.memo(({app:e,onClose:t,renderCustomStats:n,selectedElements:i,appState:s,sceneNonce:r,gridModeEnabled:o})=>{const a=e.scene,l=a.getNonDeletedElements(),c=a.getNonDeletedElementsMap(),d=kn(),u=i.length===1?i[0]:null,f=i.length>1?i:null,h=s.croppingElementId&&wt(u),m=h?gl(u):null,[p,U]=L.useState({width:0,height:0}),b=L.useMemo(()=>jo(_=>{const I=pt(_);U({width:Math.round(I[2])-Math.round(I[0]),height:Math.round(I[3])-Math.round(I[1])})},rve),[]);L.useEffect(()=>{b(l)},[r,l,b]),L.useEffect(()=>()=>b.cancel(),[b]);const y=L.useMemo(()=>qT(i,s),[i,s]),v=L.useMemo(()=>iz(i),[i]);return g("div",{className:"exc-stats",children:N(Ar,{padding:3,children:[N("div",{className:"title",children:[g("h2",{children:M("stats.title")}),g("div",{className:"close",onClick:t,children:Wu})]}),N(yv,{label:g("h3",{children:M("stats.generalStats")}),open:!!(s.stats.panels&jf.generalStats),openTrigger:()=>d(_=>({stats:{open:!0,panels:_.stats.panels^jf.generalStats}})),children:[N(a5,{children:[g(Kt,{heading:!0,children:M("stats.scene")}),N(Kt,{columns:2,children:[g("div",{children:M("stats.shapes")}),g("div",{children:l.length})]}),N(Kt,{columns:2,children:[g("div",{children:M("stats.width")}),g("div",{children:p.width})]}),N(Kt,{columns:2,children:[g("div",{children:M("stats.height")}),g("div",{children:p.height})]}),o&&N(he,{children:[g(Kt,{heading:!0,children:"Canvas"}),g(Kt,{children:g(O4e,{property:"gridStep",scene:a,appState:s,setAppState:d})})]})]}),n==null?void 0:n(l,s)]}),!v&&i.length>0&&g("div",{id:"elementStats",style:{marginTop:12},children:g(yv,{label:g("h3",{children:M("stats.elementProperties")}),open:!!(s.stats.panels&jf.elementProperties),openTrigger:()=>d(_=>({stats:{open:!0,panels:_.stats.panels^jf.elementProperties}})),children:N(a5,{children:[u&&N(he,{children:[h&&g(Kt,{heading:!0,children:M("labels.unCroppedDimension")}),s.croppingElementId&&wt(u)&&m&&N(Kt,{columns:2,children:[g("div",{children:M("stats.width")}),g("div",{children:Qa(m.width,2)})]}),s.croppingElementId&&wt(u)&&m&&N(Kt,{columns:2,children:[g("div",{children:M("stats.height")}),g("div",{children:Qa(m.height,2)})]}),g(Kt,{heading:!0,"data-testid":"stats-element-type",style:{margin:"0.3125rem 0"},children:s.croppingElementId?M("labels.imageCropping"):M(`element.${u.type}`)}),g(Kt,{children:g(XL,{element:u,property:"x",elementsMap:c,scene:a,appState:s})}),g(Kt,{children:g(XL,{element:u,property:"y",elementsMap:c,scene:a,appState:s})}),g(Kt,{children:g(BL,{property:"width",element:u,scene:a,appState:s})}),g(Kt,{children:g(BL,{property:"height",element:u,scene:a,appState:s})}),g(Kt,{children:g(N4e,{property:"angle",element:u,scene:a,appState:s})}),g(Kt,{children:g($4e,{property:"fontSize",element:u,scene:a,appState:s})})]}),f&&N(he,{children:[Q_(f)&&g(Kt,{heading:!0,children:M("element.group")}),N(Kt,{columns:2,style:{margin:"0.3125rem 0"},children:[g("div",{children:M("stats.shapes")}),g("div",{children:i.length})]}),g(Kt,{children:g(GL,{property:"x",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Kt,{children:g(GL,{property:"y",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Kt,{children:g(VL,{property:"width",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Kt,{children:g(VL,{property:"height",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Kt,{children:g(j4e,{property:"angle",elements:f,scene:a,appState:s})}),g(Kt,{children:g(eve,{property:"fontSize",elements:f,scene:a,appState:s,elementsMap:c})})]})]})})})]})})},(e,t)=>e.sceneNonce===t.sceneNonce&&e.selectedElements===t.selectedElements&&e.appState.stats.panels===t.appState.stats.panels&&e.gridModeEnabled===t.gridModeEnabled&&e.appState.gridStep===t.appState.gridStep&&e.appState.croppingElementId===t.appState.croppingElementId),ave=({sourceElementId:e,onClose:t,appState:n,scene:i,generateLinkForSelection:s=Iz})=>{var f;const r=i.getNonDeletedElementsMap(),o=((f=r.get(e))==null?void 0:f.link)??null,[a,l]=L.useState(o),[c,d]=L.useState(!1);L.useEffect(()=>{const h=Ye(r,n);let m=o;if(h.length>0&&s){const p=Sz(h,n);p&&(m=rr(s(p.id,p.type)))}l(m)},[r,n,n.selectedElementIds,o,s]);const u=L.useCallback(()=>{var h;if(a&&a!==((h=r.get(e))==null?void 0:h.link)){const m=r.get(e);m&&i.mutateElement(m,{link:a})}if(!a&&c&&e){const m=r.get(e);m&&i.mutateElement(m,{link:null})}t==null||t()},[e,a,r,c,i,t]);return L.useEffect(()=>{const h=m=>{var p,U;((p=n.openDialog)==null?void 0:p.name)==="elementLinkSelector"&&m.key===$.ENTER&&u(),((U=n.openDialog)==null?void 0:U.name)==="elementLinkSelector"&&m.key===$.ESCAPE&&(t==null||t())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[n,t,u]),N("div",{className:"ElementLinkDialog",children:[N("div",{className:"ElementLinkDialog__header",children:[g("h2",{children:M("elementLink.title")}),g("p",{children:M("elementLink.desc")})]}),N("div",{className:"ElementLinkDialog__input",children:[g(Ru,{value:a??"",onChange:h=>{c||d(!0),l(h)},onKeyDown:h=>{h.key===$.ENTER&&u()},className:"ElementLinkDialog__input-field",selectOnRender:!0}),o&&a&&g(We,{type:"button",title:M("buttons.remove"),"aria-label":M("buttons.remove"),label:M("buttons.remove"),onClick:()=>{l(null),d(!0)},className:"ElementLinkDialog__remove",icon:Yc})]}),N("div",{className:"ElementLinkDialog__actions",children:[g(lg,{label:M("buttons.cancel"),onClick:()=>{t==null||t()},style:{marginRight:10}}),g(lg,{label:M("buttons.confirm"),onClick:u,actionType:"primary"})]})]})},QT=({children:e,onClose:t})=>{const[n,i]=L.useState(!!e),{container:s}=Fs(),r=de.useCallback(()=>{i(!1),t&&t(),s==null||s.focus()},[t,s]);return g(he,{children:n&&g(dr,{size:"small",onCloseRequest:r,title:M("errorDialog.title"),children:g("div",{style:{whiteSpace:"pre-wrap"},children:e})})})},lve=()=>N("div",{className:"HelpDialog__header",children:[N("a",{className:"HelpDialog__btn",href:"https://docs.excalidraw.com",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:YM}),M("helpDialog.documentation")]}),N("a",{className:"HelpDialog__btn",href:"https://plus.excalidraw.com/blog",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:YM}),M("helpDialog.blog")]}),N("a",{className:"HelpDialog__btn",href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:Gw}),M("helpDialog.github")]}),N("a",{className:"HelpDialog__btn",href:"https://youtube.com/@excalidraw",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:GV}),"YouTube"]})]}),cve=e=>N(he,{children:[g("h3",{children:e.title}),g("div",{className:"HelpDialog__islands-container",children:e.children})]}),G3=e=>N("div",{className:`HelpDialog__island ${e.className}`,children:[g("h4",{className:"HelpDialog__island-title",children:e.caption}),g("div",{className:"HelpDialog__island-content",children:e.children})]});function*dve(e,t){let n=!0;for(const i of e)n||(yield t),n=!1,yield i}const uve=e=>e.replace(/\b[a-z]\b/,t=>t.toUpperCase()),me=({label:e,shortcuts:t,isOr:n=!0})=>{const i=t.map(s=>(s.endsWith("++")?[...s.slice(0,-2).split("+"),"+"]:s.split("+")).map(o=>g(fve,{children:uve(o)},o)));return N("div",{className:"HelpDialog__shortcut",children:[g("div",{children:e}),g("div",{className:"HelpDialog__key-container",children:[...dve(i,n?M("helpDialog.or"):null)]})]})},fve=e=>g("kbd",{className:"HelpDialog__key",...e}),hve=({onClose:e})=>{const t=de.useCallback(()=>{e&&e()},[e]);return g(he,{children:N(dr,{onCloseRequest:t,title:M("helpDialog.title"),className:"HelpDialog",children:[g(lve,{}),N(cve,{title:M("helpDialog.shortcuts"),children:[N(G3,{className:"HelpDialog__island--tools",caption:M("helpDialog.tools"),children:[g(me,{label:M("toolBar.hand"),shortcuts:[$.H]}),g(me,{label:M("toolBar.selection"),shortcuts:[$.V,$[1]]}),g(me,{label:M("toolBar.rectangle"),shortcuts:[$.R,$[2]]}),g(me,{label:M("toolBar.diamond"),shortcuts:[$.D,$[3]]}),g(me,{label:M("toolBar.ellipse"),shortcuts:[$.O,$[4]]}),g(me,{label:M("toolBar.arrow"),shortcuts:[$.A,$[5]]}),g(me,{label:M("toolBar.line"),shortcuts:[$.L,$[6]]}),g(me,{label:M("toolBar.freedraw"),shortcuts:[$.P,$[7]]}),g(me,{label:M("toolBar.text"),shortcuts:[$.T,$[8]]}),g(me,{label:M("toolBar.image"),shortcuts:[$[9]]}),g(me,{label:M("toolBar.eraser"),shortcuts:[$.E,$[0]]}),g(me,{label:M("toolBar.frame"),shortcuts:[$.F]}),g(me,{label:M("toolBar.laser"),shortcuts:[$.K]}),g(me,{label:M("labels.eyeDropper"),shortcuts:[$.I,"Shift+S","Shift+G"]}),g(me,{label:M("helpDialog.editLineArrowPoints"),shortcuts:[Q("CtrlOrCmd+Enter")]}),g(me,{label:M("helpDialog.editText"),shortcuts:[Q("Enter")]}),g(me,{label:M("helpDialog.textNewLine"),shortcuts:[Q("Enter"),Q("Shift+Enter")]}),g(me,{label:M("helpDialog.textFinish"),shortcuts:[Q("Esc"),Q("CtrlOrCmd+Enter")]}),g(me,{label:M("helpDialog.curvedArrow"),shortcuts:["A",M("helpDialog.click"),M("helpDialog.click"),M("helpDialog.click")],isOr:!1}),g(me,{label:M("helpDialog.curvedLine"),shortcuts:["L",M("helpDialog.click"),M("helpDialog.click"),M("helpDialog.click")],isOr:!1}),g(me,{label:M("helpDialog.cropStart"),shortcuts:[M("helpDialog.doubleClick"),Q("Enter")],isOr:!0}),g(me,{label:M("helpDialog.cropFinish"),shortcuts:[Q("Enter"),Q("Escape")],isOr:!0}),g(me,{label:M("toolBar.lock"),shortcuts:[$.Q]}),g(me,{label:M("helpDialog.preventBinding"),shortcuts:[Q("CtrlOrCmd")]}),g(me,{label:M("toolBar.link"),shortcuts:[Q("CtrlOrCmd+K")]}),g(me,{label:M("toolBar.convertElementType"),shortcuts:["Tab","Shift+Tab"],isOr:!0})]}),N(G3,{className:"HelpDialog__island--view",caption:M("helpDialog.view"),children:[g(me,{label:M("buttons.zoomIn"),shortcuts:[Q("CtrlOrCmd++")]}),g(me,{label:M("buttons.zoomOut"),shortcuts:[Q("CtrlOrCmd+-")]}),g(me,{label:M("buttons.resetZoom"),shortcuts:[Q("CtrlOrCmd+0")]}),g(me,{label:M("helpDialog.zoomToFit"),shortcuts:["Shift+1"]}),g(me,{label:M("helpDialog.zoomToSelection"),shortcuts:["Shift+2"]}),g(me,{label:M("helpDialog.movePageUpDown"),shortcuts:["PgUp/PgDn"]}),g(me,{label:M("helpDialog.movePageLeftRight"),shortcuts:["Shift+PgUp/PgDn"]}),g(me,{label:M("buttons.zenMode"),shortcuts:[Q("Alt+Z")]}),g(me,{label:M("buttons.objectsSnapMode"),shortcuts:[Q("Alt+S")]}),g(me,{label:M("labels.toggleGrid"),shortcuts:[Q("CtrlOrCmd+'")]}),g(me,{label:M("labels.viewMode"),shortcuts:[Q("Alt+R")]}),g(me,{label:M("labels.toggleTheme"),shortcuts:[Q("Alt+Shift+D")]}),g(me,{label:M("stats.fullTitle"),shortcuts:[Q("Alt+/")]}),g(me,{label:M("search.title"),shortcuts:[es("searchMenu")]}),g(me,{label:M("commandPalette.title"),shortcuts:U0?[es("commandPalette")]:[es("commandPalette"),es("commandPalette",1)]})]}),N(G3,{className:"HelpDialog__island--editor",caption:M("helpDialog.editor"),children:[g(me,{label:M("helpDialog.createFlowchart"),shortcuts:[Q("CtrlOrCmd+Arrow Key")],isOr:!0}),g(me,{label:M("helpDialog.navigateFlowchart"),shortcuts:[Q("Alt+Arrow Key")],isOr:!0}),g(me,{label:M("labels.moveCanvas"),shortcuts:[Q(`Space+${M("helpDialog.drag")}`),Q(`Wheel+${M("helpDialog.drag")}`)],isOr:!0}),g(me,{label:M("buttons.clearReset"),shortcuts:[Q("CtrlOrCmd+Delete")]}),g(me,{label:M("labels.delete"),shortcuts:[Q("Delete")]}),g(me,{label:M("labels.cut"),shortcuts:[Q("CtrlOrCmd+X")]}),g(me,{label:M("labels.copy"),shortcuts:[Q("CtrlOrCmd+C")]}),g(me,{label:M("labels.paste"),shortcuts:[Q("CtrlOrCmd+V")]}),g(me,{label:M("labels.pasteAsPlaintext"),shortcuts:[Q("CtrlOrCmd+Shift+V")]}),g(me,{label:M("labels.selectAll"),shortcuts:[Q("CtrlOrCmd+A")]}),g(me,{label:M("labels.multiSelect"),shortcuts:[Q(`Shift+${M("helpDialog.click")}`)]}),g(me,{label:M("helpDialog.deepSelect"),shortcuts:[Q(`CtrlOrCmd+${M("helpDialog.click")}`)]}),g(me,{label:M("helpDialog.deepBoxSelect"),shortcuts:[Q(`CtrlOrCmd+${M("helpDialog.drag")}`)]}),(OT||U0)&&g(me,{label:M("labels.copyAsPng"),shortcuts:[Q("Shift+Alt+C")]}),g(me,{label:M("labels.copyStyles"),shortcuts:[Q("CtrlOrCmd+Alt+C")]}),g(me,{label:M("labels.pasteStyles"),shortcuts:[Q("CtrlOrCmd+Alt+V")]}),g(me,{label:M("labels.sendToBack"),shortcuts:[Q(po?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")]}),g(me,{label:M("labels.bringToFront"),shortcuts:[Q(po?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")]}),g(me,{label:M("labels.sendBackward"),shortcuts:[Q("CtrlOrCmd+[")]}),g(me,{label:M("labels.bringForward"),shortcuts:[Q("CtrlOrCmd+]")]}),g(me,{label:M("labels.alignTop"),shortcuts:[Q("CtrlOrCmd+Shift+Up")]}),g(me,{label:M("labels.alignBottom"),shortcuts:[Q("CtrlOrCmd+Shift+Down")]}),g(me,{label:M("labels.alignLeft"),shortcuts:[Q("CtrlOrCmd+Shift+Left")]}),g(me,{label:M("labels.alignRight"),shortcuts:[Q("CtrlOrCmd+Shift+Right")]}),g(me,{label:M("labels.duplicateSelection"),shortcuts:[Q("CtrlOrCmd+D"),Q(`Alt+${M("helpDialog.drag")}`)]}),g(me,{label:M("helpDialog.toggleElementLock"),shortcuts:[Q("CtrlOrCmd+Shift+L")]}),g(me,{label:M("buttons.undo"),shortcuts:[Q("CtrlOrCmd+Z")]}),g(me,{label:M("buttons.redo"),shortcuts:HF?[Q("CtrlOrCmd+Y"),Q("CtrlOrCmd+Shift+Z")]:[Q("CtrlOrCmd+Shift+Z")]}),g(me,{label:M("labels.group"),shortcuts:[Q("CtrlOrCmd+G")]}),g(me,{label:M("labels.ungroup"),shortcuts:[Q("CtrlOrCmd+Shift+G")]}),g(me,{label:M("labels.flipHorizontal"),shortcuts:[Q("Shift+H")]}),g(me,{label:M("labels.flipVertical"),shortcuts:[Q("Shift+V")]}),g(me,{label:M("labels.showStroke"),shortcuts:[Q("S")]}),g(me,{label:M("labels.showBackground"),shortcuts:[Q("G")]}),g(me,{label:M("labels.showFonts"),shortcuts:[Q("Shift+F")]}),g(me,{label:M("labels.decreaseFontSize"),shortcuts:[Q("CtrlOrCmd+Shift+<")]}),g(me,{label:M("labels.increaseFontSize"),shortcuts:[Q("CtrlOrCmd+Shift+>")]})]})]})]})})},Ct=e=>Array.isArray(e)?`<kbd>${e.map(Q).join(" + ")}</kbd>`:`<kbd>${Q(e)}</kbd>`,gve=({appState:e,isMobile:t,editorInterface:n,app:i})=>{var d,u,f,h,m,p;const{activeTool:s,isResizing:r,isRotating:o,lastPointerDownWith:a}=e,l=e.multiElement!==null;if(((d=e.openSidebar)==null?void 0:d.name)===Rr.name&&e.openSidebar.tab===Jd&&((u=e.searchMatches)!=null&&u.matches.length))return M("hints.dismissSearch",{shortcut:Ct("Escape")});if(e.openSidebar&&!n.canFitSidebar)return null;if(Oo(e))return M("hints.eraserRevert",{shortcut:Ct("Alt")});const c=i.scene.getSelectedElements(e);if((f=e.selectedLinearElement)!=null&&f.isDragging&&((h=c[0])==null?void 0:h.type)==="arrow")return M("hints.arrowBindModifiers",{shortcut_1:Ct("Ctrl"),shortcut_2:Ct("Alt")});if(s.type==="arrow"||s.type==="line")return l?M("hints.linearElementMulti",{shortcut_1:Ct("Escape"),shortcut_2:Ct("Enter")}):s.type==="arrow"?M("hints.arrowTool",{shortcut:Ct("A")}):M("hints.linearElement");if(s.type==="freedraw")return M("hints.freeDraw");if(s.type==="text")return M("hints.text");if(s.type==="embeddable")return M("hints.embeddable");if(r&&a==="mouse"&&c.length===1){const U=c[0];return Ce(U)&&U.points.length===2?M("hints.lockAngle",{shortcut:Ct("Shift")}):wt(U)?M("hints.resizeImage",{shortcut_1:Ct("Shift"),shortcut_2:Ct("Alt")}):M("hints.resize",{shortcut_1:Ct("Shift"),shortcut_2:Ct("Alt")})}if(o&&a==="mouse")return M("hints.rotate",{shortcut:Ct("Shift")});if(c.length===1&&fe(c[0]))return M("hints.text_selected",{shortcut:Ct("Enter")});if(e.editingTextElement)return M("hints.text_editing",{shortcut_1:Ct("Escape"),shortcut_2:Ct(["CtrlOrCmd","Enter"])});if(e.croppingElementId)return M("hints.leaveCropEditor",{shortcut_1:Ct("Enter"),shortcut_2:Ct("Escape")});if(c.length===1&&wt(c[0]))return M("hints.enterCropEditor",{shortcut:Ct("Enter")});if(s.type==="selection"){if(e.selectionElement&&!c.length&&!e.editingTextElement&&!((m=e.selectedLinearElement)!=null&&m.isEditing))return M("hints.deepBoxSelect",{shortcut:Ct("CtrlOrCmd")});if(W0(i)&&e.selectedElementsAreBeingDragged)return M("hints.disableSnapping",{shortcut:Ct("CtrlOrCmd")});if(!c.length&&!t)return M("hints.canvasPanning",{shortcut_1:Ct(M("keys.mmb")),shortcut_2:Ct("Space")});if(c.length===1){if(Ce(c[0]))return(p=e.selectedLinearElement)!=null&&p.isEditing?e.selectedLinearElement.selectedPointsIndices?M("hints.lineEditor_pointSelected",{shortcut_1:Ct("Delete"),shortcut_2:Ct(["CtrlOrCmd","D"])}):M("hints.lineEditor_nothingSelected",{shortcut_1:Ct("Shift"),shortcut_2:Ct("Alt")}):nn(c[0])?M("hints.lineEditor_line_info",{shortcut:Ct("Enter")}):M("hints.lineEditor_info",{shortcut_1:Ct("CtrlOrCmd"),shortcut_2:Ct(["CtrlOrCmd","Enter"])});if(!e.newElement&&!e.selectedElementsAreBeingDragged&&tu(c[0])){const U=M("hints.bindTextToElement",{shortcut:Ct("Enter")}),b=M("hints.createFlowchart",{shortcut:Ct(["CtrlOrCmd",""])});return Q5(c[0])?qre(c[0],i.scene.getNonDeletedElementsMap())?[U,b]:[U,b]:U}}}return null},mve=({appState:e,isMobile:t,editorInterface:n,app:i})=>{const s=gve({appState:e,isMobile:t,editorInterface:n,app:i});if(!s)return null;const o=(Array.isArray(s)?s.map(a=>a.replace(/\. ?$/,"")).join(", "):s).split(/(<kbd>[^<]+<\/kbd>)/g).map((a,l)=>{if(l%2===1){const c=a[0]==="<"&&a.match(/^<kbd>([^<]+)<\/kbd>$/);return g("kbd",{children:c?c[1]:a},l)}return a});return g("div",{className:"HintViewer",children:g("span",{children:o})})},pve=2e3,JT=()=>{const[e,t]=L.useState(null),n=L.useRef(0),i=()=>{clearTimeout(n.current),t("success"),n.current=window.setTimeout(()=>{t(null)},pve)},s=L.useCallback(()=>{t(null)},[]);return{copyStatus:e,resetCopyStatus:s,onCopy:i}},b2=({title:e,name:t,checked:n,onChange:i,disabled:s=!1})=>g("div",{className:le("Switch",{toggled:n,disabled:s}),children:g("input",{name:t,id:t,title:e,type:"checkbox",checked:n,disabled:s,onChange:()=>i(!n),onKeyDown:r=>{r.key===" "&&i(!n)}})}),Uve="filter"in document.createElement("canvas").getContext("2d"),bve=()=>N("div",{children:[g("h3",{children:M("canvasError.cannotShowPreview")}),g("p",{children:g("span",{children:M("canvasError.canvasTooBig")})}),N("em",{children:["(",M("canvasError.canvasTooBigTip"),")"]})]}),yve=({appStateSnapshot:e,elementsSnapshot:t,files:n,actionManager:i,onExportImage:s,name:r})=>{const o=Qn(t,e),[a,l]=L.useState(r),[c,d]=L.useState(o),[u,f]=L.useState(e.exportBackground),[h,m]=L.useState(e.exportWithDarkMode),[p,U]=L.useState(e.exportEmbedScene),[b,y]=L.useState(e.exportScale),v=L.useRef(null),[_,I]=L.useState(null),{onCopy:R,copyStatus:T,resetCopyStatus:w}=JT();L.useEffect(()=>{w()},[a,u,h,b,p,w]);const{exportedElements:S,exportingFrame:x}=jy(t,e,c);return L.useEffect(()=>{const k=v.current;if(!k)return;const P=k.offsetWidth,D=k.offsetHeight;P&&qy({elements:S,appState:{...e,name:a,exportBackground:u,exportWithDarkMode:h,exportScale:b,exportEmbedScene:p},files:n,exportPadding:Sg,maxWidthOrHeight:Math.max(P,D),exportingFrame:x}).then(j=>(I(null),$0(j).then(()=>{k.replaceChildren(j)}).catch(G=>{throw G.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):G}))).catch(j=>{console.error(j),I(j)})},[e,n,S,x,a,u,h,b,p]),N("div",{className:"ImageExportModal",children:[g("h3",{children:M("imageExportDialog.header")}),N("div",{className:"ImageExportModal__preview",children:[g("div",{className:"ImageExportModal__preview__canvas",ref:v,children:_&&g(bve,{})}),g("div",{className:"ImageExportModal__preview__filename",children:!Zu&&g("input",{type:"text",className:"TextInput",value:a,style:{width:"30ch"},onChange:k=>{l(k.target.value),i.executeAction(Nye,"ui",k.target.value)}})})]}),N("div",{className:"ImageExportModal__settings",children:[g("h3",{children:M("imageExportDialog.header")}),o&&g(A1,{label:M("imageExportDialog.label.onlySelected"),name:"exportOnlySelected",children:g(b2,{name:"exportOnlySelected",checked:c,onChange:k=>{d(k)}})}),g(A1,{label:M("imageExportDialog.label.withBackground"),name:"exportBackgroundSwitch",children:g(b2,{name:"exportBackgroundSwitch",checked:u,onChange:k=>{f(k),i.executeAction(Fye,"ui",k)}})}),Uve&&g(A1,{label:M("imageExportDialog.label.darkMode"),name:"exportDarkModeSwitch",children:g(b2,{name:"exportDarkModeSwitch",checked:h,onChange:k=>{m(k),i.executeAction(Bye,"ui",k)}})}),g(A1,{label:M("imageExportDialog.label.embedScene"),tooltip:M("imageExportDialog.tooltip.embedScene"),name:"exportEmbedSwitch",children:g(b2,{name:"exportEmbedSwitch",checked:p,onChange:k=>{U(k),i.executeAction(xX,"ui",k)}})}),g(A1,{label:M("imageExportDialog.label.scale"),name:"exportScale",children:g(iY,{name:"exportScale",value:b,onChange:k=>{y(k),i.executeAction(Oye,"ui",k)},choices:T_.map(k=>({value:k,label:`${k}`}))})}),N("div",{className:"ImageExportModal__settings__buttons",children:[g(Or,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.exportToPng"),onClick:()=>s(y8.png,S,{exportingFrame:x}),icon:lk,children:M("imageExportDialog.button.exportToPng")}),g(Or,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.exportToSvg"),onClick:()=>s(y8.svg,S,{exportingFrame:x}),icon:lk,children:M("imageExportDialog.button.exportToSvg")}),(OT||U0)&&g(Or,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.copyPngToClipboard"),status:T,onClick:async()=>{await s(y8.clipboard,S,{exportingFrame:x}),R()},icon:Vp,children:M("imageExportDialog.button.copyPngToClipboard")})]})]})]})},A1=({label:e,children:t,tooltip:n,name:i})=>N("div",{className:"ImageExportModal__settings__setting",title:e,children:[N("label",{htmlFor:i,className:"ImageExportModal__settings__setting__label",children:[e,n&&g(vl,{label:n,long:!0,children:_fe})]}),g("div",{className:"ImageExportModal__settings__setting__content",children:t})]}),Eve=({elements:e,appState:t,files:n,actionManager:i,onExportImage:s,onCloseRequest:r,name:o})=>{const[{appStateSnapshot:a,elementsSnapshot:l}]=L.useState(()=>({appStateSnapshot:Ja(t),elementsSnapshot:Ja(e)}));return g(dr,{onCloseRequest:r,size:"wide",title:!1,children:g(yve,{elementsSnapshot:l,appStateSnapshot:a,files:n,actionManager:i,onExportImage:s,name:o})})},Yv=({children:e,color:t})=>g("div",{className:"Card",style:{"--card-color":t==="primary"?"var(--color-primary)":Ei[t][7],"--card-color-darker":t==="primary"?"var(--color-primary-darker)":Ei[t][8],"--card-color-darkest":t==="primary"?"var(--color-primary-darkest)":Ei[t][9]},children:e}),vve=({elements:e,appState:t,setAppState:n,files:i,actionManager:s,exportOpts:r,canvas:o,onCloseRequest:a})=>{const{onExportToBackend:l}=r;return g("div",{className:"ExportDialog ExportDialog--json",children:N("div",{className:"ExportDialog-cards",children:[r.saveFileToDisk&&N(Yv,{color:"lime",children:[g("div",{className:"Card-icon",children:Aue}),g("h2",{children:M("exportDialog.disk_title")}),N("div",{className:"Card-details",children:[M("exportDialog.disk_details"),!Zu&&s.renderAction("changeProjectName")]}),g(We,{className:"Card-button",type:"button",title:M("exportDialog.disk_button"),"aria-label":M("exportDialog.disk_button"),showAriaLabel:!0,onClick:()=>{s.executeAction(CX,"ui")}})]}),l&&N(Yv,{color:"pink",children:[g("div",{className:"Card-icon",children:D6}),g("h2",{children:M("exportDialog.link_title")}),g("div",{className:"Card-details",children:M("exportDialog.link_details")}),g(We,{className:"Card-button",type:"button",title:M("exportDialog.link_button"),"aria-label":M("exportDialog.link_button"),showAriaLabel:!0,onClick:async()=>{try{it("export","link",`ui (${Ip()})`),await l(e,t,i),a()}catch(c){n({errorMessage:c.message})}}})]}),r.renderCustomUI&&r.renderCustomUI(e,t,i,o)]})})},_ve=({elements:e,appState:t,files:n,actionManager:i,exportOpts:s,canvas:r,setAppState:o})=>{var l;const a=de.useCallback(()=>{o({openDialog:null})},[o]);return g(he,{children:((l=t.openDialog)==null?void 0:l.name)==="jsonExport"&&g(dr,{onCloseRequest:a,title:M("buttons.export"),children:g(vve,{elements:e,appState:t,setAppState:o,files:n,actionManager:i,onCloseRequest:a,exportOpts:s,canvas:r})})})},wve="small",Tve=e=>N("label",{className:le("ToolIcon ToolIcon__LaserPointer",`ToolIcon_size_${wve}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-LaserPointer"}),g("div",{className:"ToolIcon__icon",children:A0})]}),Ive=({UIOptions:e})=>N(Mt,{__fallback:!0,children:[g(Mt.DefaultItems.LoadScene,{}),g(Mt.DefaultItems.SaveToActiveFile,{}),e.canvasActions.export&&g(Mt.DefaultItems.Export,{}),e.canvasActions.saveAsImage&&g(Mt.DefaultItems.SaveAsImage,{}),g(Mt.DefaultItems.SearchMenu,{}),g(Mt.DefaultItems.Help,{}),g(Mt.DefaultItems.ClearCanvas,{}),g(Mt.Separator,{}),g(Mt.Group,{title:"Excalidraw links",children:g(Mt.DefaultItems.Socials,{})}),g(Mt.Separator,{}),g(Mt.DefaultItems.ToggleTheme,{}),g(Mt.DefaultItems.ChangeCanvasBackground,{})]}),Sve=()=>N(Xd,{__fallback:!0,children:[g(Xd.Actions.SaveToDisk,{}),g(Xd.Actions.ExportToImage,{})]}),xve=({actionManager:e,appState:t,files:n,setAppState:i,elements:s,canvas:r,onLockToggle:o,onHandToolToggle:a,onPenModeToggle:l,showExitZenModeBtn:c,renderTopLeftUI:d,renderTopRightUI:u,renderCustomStats:f,UIOptions:h,onExportImage:m,renderWelcomeScreen:p,children:U,app:b,isCollaborating:y,generateLinkForSelection:v})=>{var Y,ee,se;const _=Hn(),R=Ua()==="compact",T=f3e(),w=R?{menuTopGap:4,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:.5,islandPadding:1,collabMarginLeft:8}:{menuTopGap:6,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:1,islandPadding:1,collabMarginLeft:8},S=T.tunnelsJotai.Provider,[x,k]=gn(Ay),P=()=>h.canvasActions.export?g(_ve,{elements:s,appState:t,files:n,actionManager:e,exportOpts:h.canvasActions.export,canvas:r,setAppState:i}):null,D=()=>{var oe;return!h.canvasActions.saveAsImage||((oe=t.openDialog)==null?void 0:oe.name)!=="imageExport"?null:g(Eve,{elements:s,appState:t,files:n,actionManager:e,onExportImage:m,onCloseRequest:()=>i({openDialog:null}),name:b.getName()})},j=()=>N("div",{style:{position:"relative"},children:[g(T.MainMenuTunnel.Out,{}),p&&g(T.WelcomeScreenMenuHintTunnel.Out,{})]}),G=()=>{const oe=R;return g(zv,{heading:"selectedShapeActions",className:le("selected-shape-actions zen-mode-transition",{"transition-left":t.zenModeEnabled}),children:oe?g(Ar,{className:le("compact-shape-actions-island"),padding:0,style:{maxHeight:`${t.height-166}px`},children:g(m3e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b,setAppState:i})}):g(Ar,{className:bs.SHAPE_ACTIONS_MENU,padding:2,style:{maxHeight:`${t.height-166}px`},children:g(h3e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b})})})},V=()=>{var Ge,Me,Ne,et,Ot;const oe=foe(t,s),Fe=t.stats.open&&!t.zenModeEnabled&&!t.viewModeEnabled&&((Ge=t.openDialog)==null?void 0:Ge.name)!=="elementLinkSelector";return g(wj,{side:"top",children:N("div",{className:"App-menu App-menu_top",children:[N(Za.Col,{gap:w.menuTopGap,className:le("App-menu_top__left"),children:[j(),g("div",{className:le("selected-shape-actions-container",{"selected-shape-actions-container--compact":R}),children:oe&&G()})]}),!t.viewModeEnabled&&((Me=t.openDialog)==null?void 0:Me.name)!=="elementLinkSelector"&&g(zv,{heading:"shapes",className:"shapes-section",children:Xe=>N("div",{style:{position:"relative"},children:[p&&g(T.WelcomeScreenToolbarHintTunnel.Out,{}),g(Za.Col,{gap:w.toolbarColGap,align:"start",children:N(Za.Row,{gap:w.toolbarRowGap,className:le("App-toolbar-container",{"zen-mode":t.zenModeEnabled}),children:[N(Ar,{padding:w.islandPadding,className:le("App-toolbar",{"zen-mode":t.zenModeEnabled,"App-toolbar--compact":R}),children:[g(mve,{appState:t,isMobile:_.formFactor==="phone",editorInterface:_,app:b}),Xe,N(Za.Row,{gap:w.toolbarInnerRowGap,children:[g(Tj,{zenModeEnabled:t.zenModeEnabled,checked:t.penMode,onChange:()=>l(null),title:M("toolBar.penMode"),penDetected:t.penDetected}),g(_7e,{checked:t.activeTool.locked,onChange:o,title:M("toolBar.lock")}),g("div",{className:"App-toolbar__divider"}),g(_j,{checked:rg(t),onChange:()=>a(),title:M("toolBar.hand"),isMobile:!0}),g(U3e,{setAppState:i,activeTool:t.activeTool,UIOptions:h,app:b})]})]}),y&&g(Ar,{style:{marginLeft:w.collabMarginLeft,alignSelf:"center",height:"fit-content"},children:g(Tve,{title:M("toolBar.laser"),checked:t.activeTool.type===ii.laser,onChange:()=>b.setActiveTool({type:ii.laser}),isMobile:!0})})]})})]})}),N("div",{className:le("layer-ui__wrapper__top-right zen-mode-transition",{"transition-right":t.zenModeEnabled,"layer-ui__wrapper__top-right--compact":R}),children:[t.collaborators.size>0&&g(Ij,{collaborators:t.collaborators,userToFollow:((Ne=t.userToFollow)==null?void 0:Ne.socketId)||null}),u==null?void 0:u(_.formFactor==="phone",t),!t.viewModeEnabled&&((et=t.openDialog)==null?void 0:et.name)!=="elementLinkSelector"&&(!z||((Ot=t.openSidebar)==null?void 0:Ot.name)!==Rr.name)&&g(T.DefaultSidebarTriggerTunnel.Out,{}),Fe&&g(Pa,{app:b,onClose:()=>{e.executeAction(Cv)},renderCustomStats:f})]})]})})},B=()=>g(s5,{__fallback:!0,onDock:oe=>{it("sidebar",`toggleDock (${oe?"dock":"undock"})`,`(${_.formFactor==="phone"?"mobile":"desktop"})`)}}),z=FH(WT),X=N(he,{children:[U,g(Ive,{UIOptions:h}),g(s5.Trigger,{__fallback:!0,icon:qfe,title:Pt(M("toolBar.library")),onToggle:oe=>{oe&&it("sidebar",`${Rr.name} (open)`,`button (${_.formFactor==="phone"?"mobile":"desktop"})`)},tab:Rr.defaultTab}),g(Sve,{}),((Y=t.openDialog)==null?void 0:Y.name)==="ttd"&&g(CY,{__fallback:!0}),t.isLoading&&g(vj,{delay:250}),t.errorMessage&&g(QT,{onClose:()=>i({errorMessage:null}),children:t.errorMessage}),x&&_.formFactor!=="phone"&&g(G1e,{colorPickerType:x.colorPickerType,onCancel:()=>{k(null)},onChange:(oe,Fe,Ge,{altKey:Me})=>{if(!(oe!=="elementBackground"&&oe!=="elementStroke"))if(Ge.length){for(const Ne of Ge)Cn(Ne,be(s),{[Me&&x.swapPreviewOnAlt?oe==="elementBackground"?"strokeColor":"backgroundColor":oe==="elementBackground"?"backgroundColor":"strokeColor"]:Fe}),sn.delete(Ne);b.scene.triggerUpdate()}else i(oe==="elementBackground"?{currentItemBackgroundColor:Fe}:{currentItemStrokeColor:Fe})},onSelect:(oe,Fe)=>{var Ge;k(Me=>Me!=null&&Me.keepOpenOnAlt&&Fe.altKey?Me:null),(Ge=x==null?void 0:x.onSelect)==null||Ge.call(x,oe,Fe)}}),((ee=t.openDialog)==null?void 0:ee.name)==="help"&&g(hve,{onClose:()=>{i({openDialog:null})}}),g(_3e,{}),((se=t.openDialog)==null?void 0:se.name)==="elementLinkSelector"&&g(ave,{sourceElementId:t.openDialog.sourceElementId,onClose:()=>{i({openDialog:null})},scene:b.scene,appState:t,generateLinkForSelection:v}),g(T.OverwriteConfirmDialogTunnel.Out,{}),D(),P(),t.pasteDialog.shown&&g(S7e,{setAppState:i,appState:t,onClose:()=>i({pasteDialog:{shown:!1,data:null}})}),_.formFactor==="phone"&&g(I7e,{app:b,appState:t,elements:s,actionManager:e,renderJSONExportDialog:P,renderImageExportDialog:D,setAppState:i,onHandToolToggle:a,onPenModeToggle:l,renderTopLeftUI:d,renderTopRightUI:u,renderSidebars:B,renderWelcomeScreen:p,UIOptions:h}),_.formFactor!=="phone"&&N(he,{children:[N("div",{className:"layer-ui__wrapper",style:t.openSidebar&&z&&_.canFitSidebar?{width:"calc(100% - var(--right-sidebar-width))"}:{},children:[p&&g(T.WelcomeScreenCenterTunnel.Out,{}),V(),g(Sj,{appState:t,actionManager:e,showExitZenModeBtn:c,renderWelcomeScreen:p}),t.scrolledOutside&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(oe=>({...C0(s,oe)}))},children:M("buttons.scrollBackToContent")})]}),B()]})]});return g(Y$.Provider,{value:t,children:g(S,{children:g(dj.Provider,{value:T,children:X})})})},jL=e=>{const{startBoundElement:t,cursorButton:n,scrollX:i,scrollY:s,...r}=e;return r},Cve=(e,t)=>{if(e.children!==t.children)return!1;const{canvas:n,appState:i,...s}=e,{canvas:r,appState:o,...a}=t;return vi(jL(i),jL(o),{selectedElementIds:vi,selectedGroupIds:vi})&&vi(s,a)},Ave=de.memo(xve,Cve),Mve="small",X3=e=>N("label",{className:le("ToolIcon ToolIcon__MagicButton",`ToolIcon_size_${Mve}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:e.icon})]}),kve=({trails:e})=>{const t=L.useRef(null);return L.useEffect(()=>{if(t.current)for(const n of e)n.start(t.current);return()=>{for(const n of e)n.stop()}},e),g("div",{className:"SVGLayer",children:g("svg",{ref:t})})},hi=class hi{static start(t,n){const i=n({deltaTime:0,state:void 0});i&&(hi.animations.set(t,{animation:n,lastTime:0,state:i}),hi.isRunning||(hi.isRunning=!0,i5()?requestAnimationFrame(hi.tick):setTimeout(hi.tick,0)))}static tick(){if(hi.animations.size>0){for(const[t,n]of hi.animations){const i=performance.now(),s=n.lastTime===0?0:i-n.lastTime,r=n.animation({deltaTime:s,state:n.state});if(r)n.lastTime=i,n.state=r;else if(hi.animations.delete(t),hi.animations.size===0){hi.isRunning=!1;return}}i5()?requestAnimationFrame(hi.tick):setTimeout(hi.tick,0)}}static running(t){return hi.animations.has(t)}static cancel(t){hi.animations.delete(t)}};F(hi,"isRunning",!1),F(hi,"animations",new Map);let l5=hi;const Rve="#ff6b6b",Lve="#ff0000",YL=1,WL=2,Dve=(e,t)=>{if(!t.snapLines.length)return;const n=t.theme===Se.LIGHT||t.zenModeEnabled?Rve:Lve,i=(t.zenModeEnabled?YL*1.5:YL)/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY);for(const s of t.snapLines)s.type==="pointer"?(e.lineWidth=i,e.strokeStyle=n,Nve(s,e,t)):s.type==="gap"?(e.lineWidth=i,e.strokeStyle=n,Ove(s.points[0],s.points[1],s.direction,t,e)):s.type==="points"&&(e.lineWidth=i,e.strokeStyle=n,Pve(s,e,t));e.restore()},Pve=(e,t,n)=>{if(!n.zenModeEnabled){const i=e.points[0],s=e.points[e.points.length-1];gr(i,s,t)}for(const i of e.points)AY(i,n,t)},Nve=(e,t,n)=>{AY(e.points[0],n,t),n.zenModeEnabled||gr(e.points[0],e.points[1],t)},AY=([e,t],n,i)=>{i.save();const s=(n.zenModeEnabled?WL*1.5:WL)/n.zoom.value;i.beginPath(),i.moveTo(e-s,t-s),i.lineTo(e+s,t+s),i.moveTo(e+s,t-s),i.lineTo(e-s,t+s),i.stroke(),i.restore()},gr=(e,t,n)=>{n.beginPath(),n.lineTo(e[0],e[1]),n.lineTo(t[0],t[1]),n.stroke()},Ove=(e,t,n,i,s)=>{const r=8/i.zoom.value,o=r/2,a=r/4;if(n==="horizontal"){const l=[(e[0]+t[0])/2,e[1]];i.zenModeEnabled||gr(C(e[0],e[1]-r),C(e[0],e[1]+r),s),gr(C(l[0]-a,l[1]-o),C(l[0]-a,l[1]+o),s),gr(C(l[0]+a,l[1]-o),C(l[0]+a,l[1]+o),s),i.zenModeEnabled||(gr(C(t[0],t[1]-r),C(t[0],t[1]+r),s),gr(e,t,s))}else{const l=[e[0],(e[1]+t[1])/2];i.zenModeEnabled||gr(C(e[0]-r,e[1]),C(e[0]+r,e[1]),s),gr(C(l[0]-o,l[1]-a),C(l[0]+o,l[1]-a),s),gr(C(l[0]-o,l[1]+a),C(l[0]+o,l[1]+a),s),i.zenModeEnabled||(gr(C(t[0]-r,t[1]),C(t[0]+r,t[1]),s),gr(e,t,s))}},Fve=(e,t)=>{xe(t.selectedLinearElement,"selectedLinearElement is null");const{segmentMidPointHoveredCoords:n}=t.selectedLinearElement;xe(n,"midPointCoords is null"),e.save(),e.translate(t.scrollX,t.scrollY),MY(n,e,t),e.restore()},Bve=(e,t,n)=>{var a,l,c;const{elementId:i,hoverPointIndex:s}=t.selectedLinearElement;if((a=t.selectedLinearElement)!=null&&a.isEditing&&((c=(l=t.selectedLinearElement)==null?void 0:l.selectedPointsIndices)!=null&&c.includes(s)))return;const r=re.getElement(i,n);if(!r)return;const o=re.getPointAtIndexGlobalCoordinates(r,s,n);e.save(),e.translate(t.scrollX,t.scrollY),MY(o,e,t),e.restore()},MY=(e,t,n)=>{t.fillStyle="rgba(105, 101, 219, 0.4)",kT(t,e[0],e[1],re.POINT_HANDLE_SIZE/n.zoom.value,!1)},j3=(e,t,n,i,s,r,o)=>{var a;e.strokeStyle="#5e5ad8",e.setLineDash([]),e.fillStyle="rgba(255, 255, 255, 0.9)",s?e.fillStyle="rgba(134, 131, 226, 0.9)":r&&(e.fillStyle="rgba(177, 151, 252, 0.7)"),kT(e,n[0],n[1],(o?i*((a=t.selectedLinearElement)!=null&&a.isEditing?1.5:2):i)/t.zoom.value,!r,!o||s)},zve=(e,t,n,i)=>{const s=t.frameId&&n.get(t.frameId);switch(s&&Ue(s)&&(e.translate(s.x,s.y),e.beginPath(),e.roundRect?e.roundRect(-1,-1,s.width+1,s.height+1,mt.radius/i.zoom.value):e.rect(-1,-1,s.width+1,s.height+1),e.clip(),e.translate(-s.x,-s.y)),t.type){case"magicframe":case"frame":e.save(),e.translate(t.x,t.y),e.lineWidth=mt.strokeWidth/i.zoom.value,e.strokeStyle=i.theme===Se.DARK?"rgba(3, 93, 161, 1)":"rgba(106, 189, 252, 1)",e.roundRect?(e.beginPath(),e.roundRect(0,0,t.width,t.height,mt.radius/i.zoom.value),e.stroke(),e.closePath()):e.strokeRect(0,0,t.width,t.height),e.restore();break;default:e.save();const r=Ti(t,n);switch(e.translate(r[0],r[1]),e.rotate(t.angle),e.translate(-r[0],-r[1]),e.translate(t.x,t.y),e.lineWidth=Ze(1.75,t.strokeWidth,4)/Math.max(.25,i.zoom.value),e.strokeStyle=i.theme===Se.DARK?"rgba(3, 93, 161, 1)":"rgba(106, 189, 252, 1)",t.type){case"ellipse":e.beginPath(),e.ellipse(t.width/2,t.height/2,t.width/2,t.height/2,0,0,2*Math.PI),e.closePath(),e.stroke();break;case"diamond":{const[o,a]=Mp(t);o.forEach(l=>{e.beginPath(),e.moveTo(l[0][0]-t.x,l[0][1]-t.y),e.lineTo(l[1][0]-t.x,l[1][1]-t.y),e.stroke()}),a.forEach(l=>{const[c,d,u,f]=l;e.beginPath(),e.moveTo(c[0]-t.x,c[1]-t.y),e.bezierCurveTo(d[0]-t.x,d[1]-t.y,u[0]-t.x,u[1]-t.y,f[0]-t.x,f[1]-t.y),e.stroke()})}break;default:{const[o,a]=Ap(t);o.forEach(l=>{e.beginPath(),e.moveTo(l[0][0]-t.x,l[0][1]-t.y),e.lineTo(l[1][0]-t.x,l[1][1]-t.y),e.stroke()}),a.forEach(l=>{const[c,d,u,f]=l;e.beginPath(),e.moveTo(c[0]-t.x,c[1]-t.y),e.bezierCurveTo(d[0]-t.x,d[1]-t.y,u[0]-t.x,u[1]-t.y,f[0]-t.x,f[1]-t.y),e.stroke()})}break}e.restore();break}},Hve=(e,t,n,i,s,r,o)=>{const a=e.state.bindMode==="orbit"&&e.bindModeHandler!==null,l=Tf-((o==null?void 0:o.runtime)??(a?0:Tf)),c=Ze(1/Tf*l,1e-4,1),d=n.strokeWidth/2,u=n.frameId&&i.get(n.frameId);switch(u&&Ue(u)&&(t.translate(u.x,u.y),t.beginPath(),t.roundRect?t.roundRect(-1,-1,u.width+1,u.height+1,mt.radius/s.zoom.value):t.rect(-1,-1,u.width+1,u.height+1),t.clip(),t.translate(-u.x,-u.y)),n.type){case"magicframe":case"frame":t.save(),t.translate(n.x,n.y),t.lineWidth=mt.strokeWidth/s.zoom.value,t.strokeStyle=s.theme===Se.DARK?`rgba(3, 93, 161, ${c})`:`rgba(106, 189, 252, ${c})`,t.roundRect?(t.beginPath(),t.roundRect(0,0,n.width,n.height,mt.radius/s.zoom.value),t.stroke(),t.closePath()):t.strokeRect(0,0,n.width,n.height),t.restore();break;default:t.save();const h=Ti(n,i),m=h[0]+s.scrollX,p=h[1]+s.scrollY;switch(t.translate(m,p),t.rotate(n.angle),t.translate(-m,-p),t.translate(n.x+s.scrollX-d,n.y+s.scrollY-d),t.lineWidth=Ze(2.5,n.strokeWidth*1.75,4)/Math.max(.25,s.zoom.value),t.strokeStyle=s.theme===Se.DARK?`rgba(3, 93, 161, ${c/2})`:`rgba(106, 189, 252, ${c/2})`,n.type){case"ellipse":t.beginPath(),t.ellipse((n.width+d*2)/2,(n.height+d*2)/2,(n.width+d*2)/2,(n.height+d*2)/2,0,0,2*Math.PI),t.closePath(),t.stroke();break;case"diamond":{const[U,b]=Mp(n,d);U.forEach(y=>{t.beginPath(),t.moveTo(y[0][0]-n.x+d,y[0][1]-n.y+d),t.lineTo(y[1][0]-n.x+d,y[1][1]-n.y+d),t.stroke()}),b.forEach(y=>{const[v,_,I,R]=y;t.beginPath(),t.moveTo(v[0]-n.x+d,v[1]-n.y+d),t.bezierCurveTo(_[0]-n.x+d,_[1]-n.y+d,I[0]-n.x+d,I[1]-n.y+d,R[0]-n.x+d,R[1]-n.y+d),t.stroke()})}break;default:{const[U,b]=Ap(n,d);U.forEach(y=>{t.beginPath(),t.moveTo(y[0][0]-n.x+d,y[0][1]-n.y+d),t.lineTo(y[1][0]-n.x+d,y[1][1]-n.y+d),t.stroke()}),b.forEach(y=>{const[v,_,I,R]=y;t.beginPath(),t.moveTo(v[0]-n.x+d,v[1]-n.y+d),t.bezierCurveTo(_[0]-n.x+d,_[1]-n.y+d,I[0]-n.x+d,I[1]-n.y+d,R[0]-n.x+d,R[1]-n.y+d),t.stroke()})}break}t.restore();break}if(!a||((o==null?void 0:o.runtime)??0)>Tf)return;const f=.5*(Math.min(n.width,n.height)/2);if(!Ue(n)){t.save(),t.translate(n.x+s.scrollX,n.y+s.scrollY);const h=1/Tf*l;t.strokeStyle="rgba(0, 0, 0, 0.2)",t.lineWidth=1/s.zoom.value,t.setLineDash([4/s.zoom.value,4/s.zoom.value]),t.lineDashOffset=-h*10/s.zoom.value,t.beginPath(),t.ellipse(n.width/2,n.height/2,f,f,0,0,2*Math.PI),t.stroke(),t.fillStyle="rgba(0, 0, 0, 0.04)",t.beginPath(),t.ellipse(n.width/2,n.height/2,f*(1-c),f*(1-c),0,0,2*Math.PI),t.fill(),t.restore()}return{runtime:((o==null?void 0:o.runtime)??0)+r}},Vve=(e,t,n,i,s,r,o)=>{if(ki("COMPLEX_BINDINGS"))return Hve(e,t,n,i,s,r,o);t.save(),t.translate(s.scrollX,s.scrollY),zve(t,n,i,s),t.restore()},kY=(e,t,n)=>{const{angle:i,x1:s,y1:r,x2:o,y2:a,selectionColors:l,cx:c,cy:d,dashed:u,activeEmbeddable:f}=n,h=o-s,m=a-r,U=(n.padding??fu*2)/t.zoom.value,b=8/t.zoom.value,y=4/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=(f?4:1)/t.zoom.value;const v=l.length;for(let _=0;_<v;++_)e.strokeStyle=l[_],u&&e.setLineDash([b,y+(b+y)*(v-1)]),e.lineDashOffset=(b+y)*_,Gy(e,s-U,r-U,h+U*2,m+U*2,c,d,i);e.restore()},$ve=(e,t,n,i)=>{const[s,r,o,a]=$e(n,i),l=o-s,c=a-r;e.strokeStyle="rgb(0,118,255)",e.lineWidth=mt.strokeWidth/t.zoom.value,e.save(),e.translate(t.scrollX,t.scrollY),Gy(e,s,r,l,c,s+l/2,r+c/2,n.angle,!1,mt.radius/t.zoom.value),e.restore()},KL=(e,t,n,i)=>{const{colors:s=["rgb(0,118,255)"],dashed:r=!1}=i||{},o=n.filter(d=>d.groupIds.length===0),a=n.filter(d=>d.groupIds.length>0),l=d=>{const[u,f,h,m]=pt(d);return{angle:0,x1:u,x2:h,y1:f,y2:m,selectionColors:s,dashed:r,cx:u+(h-u)/2,cy:f+(m-f)/2,activeEmbeddable:!1}},c=d=>{const u=Lt(n,d);return l(u)};Object.entries(Pp(a,t)).filter(([d,u])=>u).map(([d,u])=>d).map(d=>c(d)).concat(o.map(d=>l([d]))).forEach(d=>kY(e,t,d))},Y3=(e,t,n,i)=>{var c,d;if(!t.selectedLinearElement)return;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=1/t.zoom.value;const s=re.getPointsGlobalCoordinates(n,i),{POINT_HANDLE_SIZE:r}=re,o=(c=t.selectedLinearElement)!=null&&c.isEditing?r:r/2,a=ye(n),l=nn(n);if(s.forEach((u,f)=>{var p,U,b,y,v,_;if(a&&f!==0&&f!==s.length-1)return;const h=f>0&&(f!==s.length-1||!l||!n.polygon)&&Uo(u,f===s.length-1?s[0]:s[f-1],2/t.zoom.value);let m=!!((p=t.selectedLinearElement)!=null&&p.isEditing)&&!!((b=(U=t.selectedLinearElement)==null?void 0:U.selectedPointsIndices)!=null&&b.includes(f));l&&n.polygon&&!m&&f===n.points.length-1&&((y=t.selectedLinearElement)!=null&&y.isEditing)&&((_=(v=t.selectedLinearElement)==null?void 0:v.selectedPointsIndices)!=null&&_.includes(0))&&(m=!0),j3(e,t,u,o,m,!1,h)}),ye(n)){const u=((d=n.fixedSegments)==null?void 0:d.map(f=>f.index))||[];s.slice(0,-1).forEach((f,h)=>{re.isSegmentTooShort(n,s[h+1],s[h],h,t.zoom)||j3(e,t,C((f[0]+s[h+1][0])/2,(f[1]+s[h+1][1])/2),r/2,!1,!u.includes(h+1),!1)})}else re.getEditorMidPoints(n,i,t).filter((f,h,m)=>f!==null&&!(ye(n)&&(h===0||h===m.length-1))).forEach(f=>{var h;((h=t.selectedLinearElement)!=null&&h.isEditing||s.length===2)&&j3(e,t,f,r/2,!1,!0,!1)});e.restore()},ZL=(e,t,n,i,s)=>{Object.keys(i).forEach(r=>{const o=i[r];if(o!==void 0){const[a,l,c,d]=o;e.save(),e.lineWidth=1/n.zoom.value,t.selectionColor&&(e.strokeStyle=t.selectionColor),r==="rotation"?kT(e,a+c/2,l+d/2,c/2,!0):e.roundRect?(e.beginPath(),e.roundRect(a,l,c,d,2/n.zoom.value),e.fill(),e.stroke()):Gy(e,a,l,c,d,a+c/2,l+d/2,s,!0),e.restore()}})},Gve=(e,t,n,i,s)=>{const[r,o,,,a,l]=$e(i,s),c=3,d=20,u=c/n.zoom.value,f=u/2,h=a-r+u,m=l-o+u,p=Math.min(d/n.zoom.value,h),U=Math.min(d/n.zoom.value,m);e.save(),e.fillStyle=t.selectionColor,e.strokeStyle=t.selectionColor,e.lineWidth=u,[[[-h,-m],[0,f],[p,f],[f,0],[f,U]],[[h-f,-m],[f,f],[-p+f,f],[0,0],[0,U]],[[-h,m],[0,-f],[p,-f],[f,0],[f,-U]],[[h-f,m],[f,-f],[-p+f,-f],[0,0],[0,-U]]].forEach(y=>{const[[v,_],[I,R],[T,w],[S,x],[k,P]]=y;e.save(),e.translate(a,l),e.rotate(i.angle),e.beginPath(),e.moveTo(v+I,_+R),e.lineTo(v+T,_+w),e.stroke(),e.beginPath(),e.moveTo(v+S,_+x),e.lineTo(v+k,_+P),e.stroke(),e.restore()}),e.restore()},Xve=(e,t,n,i)=>{t.save();const s=fu*2/n.zoom.value,r=e.width+s*2,o=e.height+s*2,a=e.x+r/2,l=e.y+o/2,c=-(r/2+s),d=-(o/2+s);t.translate(a+n.scrollX,l+n.scrollY),t.rotate(e.angle),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(c,d,r,o),t.restore()},jve=({app:e,canvas:t,elementsMap:n,visibleElements:i,selectedElements:s,allElementsMap:r,scale:o,appState:a,renderConfig:l,editorInterface:c,animationState:d,deltaTime:u})=>{var v,_,I,R,T;if(t===null)return{atLeastOneVisibleElement:!1,elementsMap:n};const[f,h]=Vy(t,o);let m=d;const p=$y({canvas:t,scale:o,normalizedWidth:f,normalizedHeight:h});p.save(),p.scale(a.zoom.value,a.zoom.value);let U;if(i.forEach(w=>{var S;(S=a.selectedLinearElement)!=null&&S.isEditing&&a.selectedLinearElement.elementId===w.id&&w&&(U=w)}),U&&Y3(p,a,U,n),a.selectionElement&&!a.isCropping)try{Ise(a.selectionElement,p,a,l.selectionColor)}catch(w){console.error(w)}if(a.editingTextElement&&fe(a.editingTextElement)){const w=r.get(a.editingTextElement.id);w&&!w.autoResize&&Xve(w,p,a,l.selectionColor)}if(a.isBindingEnabled&&a.suggestedBinding?m={...d,bindingHighlight:Vve(e,p,a.suggestedBinding,r,a,u,d==null?void 0:d.bindingHighlight)}:m={...d,bindingHighlight:void 0},a.frameToHighlight&&$ve(p,a,a.frameToHighlight,n),a.elementsToHighlight&&KL(p,a,a.elementsToHighlight),a.activeLockedId){const w=r.get(a.activeLockedId),S=w?[w]:Lt(r,a.activeLockedId);KL(p,a,S,{colors:["#ced4da"],dashed:!0})}const b=s.some(w=>Ue(w));if(s.length===1&&((v=a.selectedLinearElement)!=null&&v.isEditing)&&a.selectedLinearElement.elementId===s[0].id&&Y3(p,a,s[0],n),a.selectedLinearElement){const w=a.selectedLinearElement,S=s.find(x=>x.id===w.elementId);a.selectedLinearElement.isDragging||(w.segmentMidPointHoveredCoords?Fve(p,a):(ye(S)?w.hoverPointIndex===0||w.hoverPointIndex===S.points.length-1:w.hoverPointIndex>=0)&&Bve(p,a,n))}if(!a.multiElement&&!a.newElement&&!((_=a.selectedLinearElement)!=null&&_.isEditing)){const w=Fz(s,a,c),S=s.length===1&&Ce(s[0]);S&&((I=a.selectedLinearElement)==null?void 0:I.elementId)===s[0].id&&!s[0].locked&&Y3(p,a,s[0],n);const x=l.selectionColor||Ei.black;if(w){const k=be(s),P=[];for(const j of n.values()){const G=[],V=l.remoteSelectedElementIds.get(j.id);if(S&&ye(j)&&(j.startBinding||j.endBinding)||(k.has(j.id)&&!q_(a,j)&&G.push(x),V&&G.push(...V.map(B=>Wy(B,a.collaborators.get(B))))),G.length){const[B,z,X,Y,ee,se]=$e(j,n,!0);P.push({angle:j.angle,x1:B,y1:z,x2:X,y2:Y,selectionColors:j.locked?["#ced4da"]:G,dashed:!!V||j.locked,cx:ee,cy:se,activeEmbeddable:((R=a.activeEmbeddable)==null?void 0:R.element)===j&&a.activeEmbeddable.state==="active",padding:j.id===a.croppingElementId||wt(j)?0:void 0})}}const D=j=>{const G=Lt(n,j),[V,B,z,X]=pt(G);P.push({angle:0,x1:V,x2:z,y1:B,y2:X,selectionColors:G.some(Y=>Y.locked)?["#ced4da"]:[Ei.black],dashed:!0,cx:V+(z-V)/2,cy:B+(X-B)/2,activeEmbeddable:!1})};for(const j of Ic(a))D(j);a.editingGroupId&&D(a.editingGroupId),P.forEach(j=>kY(p,a,j))}if(p.save(),p.translate(a.scrollX,a.scrollY),s.length===1){p.fillStyle=Ei.white;const k=Oz(s[0],a.zoom,n,"mouse",Dm(c));if(!a.viewModeEnabled&&w&&!fe(a.editingTextElement)&&!a.croppingElementId&&ZL(p,l,a,k,s[0].angle),a.croppingElementId&&!a.isCropping){const P=n.get(a.croppingElementId);P&&wt(P)&&Gve(p,l,a,P,n)}}else if(s.length>1&&!a.isRotating&&!s.some(k=>k.locked)){const k=fu*2/a.zoom.value;p.fillStyle=Ei.white;const[P,D,j,G]=pt(s,n),V=p.getLineDash();p.setLineDash([2/a.zoom.value]);const B=p.lineWidth;p.lineWidth=1/a.zoom.value,p.strokeStyle=x,Gy(p,P-k,D-k,j-P+k*2,G-D+k*2,(P+j)/2,(D+G)/2,0),p.lineWidth=B,p.setLineDash(V);const z=yw([P,D,j,G,(P+j)/2,(D+G)/2],0,a.zoom,"mouse",b?{...Dm(c),rotation:!0}:Dm(c));s.some(X=>!X.locked)&&ZL(p,l,a,z,0)}p.restore()}(T=a.searchMatches)==null||T.matches.forEach(({id:w,focus:S,matchedLines:x})=>{const k=n.get(w);if(k){const[P,D,,,j,G]=$e(k,n,!0);p.save(),a.theme===Se.LIGHT?S?p.fillStyle="rgba(255, 124, 0, 0.4)":p.fillStyle="rgba(255, 226, 0, 0.4)":S?p.fillStyle="rgba(229, 82, 0, 0.4)":p.fillStyle="rgba(99, 52, 0, 0.4)";const V=Ue(k)?a.zoom.value:1;p.translate(a.scrollX,a.scrollY),p.translate(j,G),p.rotate(k.angle),x.forEach(B=>{(B.showOnCanvas||S)&&p.fillRect(P+B.offsetX/V-j,D+B.offsetY/V-G,B.width/V,B.height/V)}),p.restore()}}),Dve(p,a),p.restore(),Yye({context:p,renderConfig:l,appState:a,normalizedWidth:f,normalizedHeight:h});let y;return l.renderScrollbars&&(y=a7e(n,f,h,a),p.save(),p.fillStyle=o7e,p.strokeStyle="rgba(255,255,255,0.8)",[y.horizontal,y.vertical].forEach(w=>{w&&MX(p,w.x,w.y,w.width,w.height,Po/2)}),p.restore()),{scrollBars:y,atLeastOneVisibleElement:i.length>0,elementsMap:n,animationState:m}},Yve=e=>{const t=jve(e);return e.callback(t),t},qL="animateInteractiveScene",Wve=e=>{const t=L.useRef(!1),n=L.useRef(null);return L.useEffect(()=>{var c;if(!t.current){t.current=!0;return}const i=new Map,s=new Map,r=new Map,o=new Map,a=new Map;e.appState.collaborators.forEach((d,u)=>{if(d.selectedElementIds)for(const f of Object.keys(d.selectedElementIds))r.has(f)||r.set(f,[]),r.get(f).push(u);!d.pointer||d.pointer.renderCursor===!1||(d.username&&o.set(u,d.username),d.userState&&a.set(u,d.userState),s.set(u,Qs({sceneX:d.pointer.x,sceneY:d.pointer.y},e.appState)),i.set(u,d.button))});const l=((c=e.containerRef)==null?void 0:c.current)&&getComputedStyle(e.containerRef.current).getPropertyValue("--color-selection")||"#6965db";n.current={app:e.app,canvas:e.canvas,elementsMap:e.elementsMap,visibleElements:e.visibleElements,selectedElements:e.selectedElements,allElementsMap:e.allElementsMap,scale:window.devicePixelRatio,appState:e.appState,renderConfig:{remotePointerViewportCoords:s,remotePointerButton:i,remoteSelectedElementIds:r,remotePointerUsernames:o,remotePointerUserStates:a,selectionColor:l,renderScrollbars:e.renderScrollbars,lastViewportPosition:e.app.lastViewportPosition},editorInterface:e.editorInterface,callback:e.renderInteractiveSceneCallback,animationState:{bindingHighlight:void 0},deltaTime:0},l5.running(qL)||l5.start(qL,({deltaTime:d,state:u})=>{const f=Yve({...n.current,deltaTime:d,animationState:u}).animationState;if(f){for(const h in f)if(f[h]!==void 0)return f}})}),g("canvas",{className:"excalidraw__canvas interactive",style:{width:e.appState.width,height:e.appState.height,cursor:e.appState.viewModeEnabled?Rt.GRAB:Rt.AUTO},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:e.handleCanvasRef,onContextMenu:e.onContextMenu,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onTouchMove:e.onTouchMove,onPointerDown:e.onPointerDown,onDoubleClick:e.appState.viewModeEnabled?void 0:e.onDoubleClick,children:M("labels.drawingCanvas")})},QL=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,editingGroupId:e.editingGroupId,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,selectionElement:e.selectionElement,selectedGroupIds:e.selectedGroupIds,selectedLinearElement:e.selectedLinearElement,multiElement:e.multiElement,newElement:e.newElement,isBindingEnabled:e.isBindingEnabled,suggestedBinding:e.suggestedBinding,isRotating:e.isRotating,elementsToHighlight:e.elementsToHighlight,collaborators:e.collaborators,activeEmbeddable:e.activeEmbeddable,snapLines:e.snapLines,zenModeEnabled:e.zenModeEnabled,editingTextElement:e.editingTextElement,isCropping:e.isCropping,croppingElementId:e.croppingElementId,searchMatches:e.searchMatches,activeLockedId:e.activeLockedId,hoveredElementIds:e.hoveredElementIds,frameRendering:e.frameRendering,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,exportScale:e.exportScale}),Kve=(e,t)=>e.selectionNonce!==t.selectionNonce||e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements||e.selectedElements!==t.selectedElements||e.renderScrollbars!==t.renderScrollbars?!1:vi(QL(e.appState),QL(t.appState)),Zve=de.memo(Wve,Kve),qve=e=>{const t=L.useRef(null),n=L.useRef(!1);return L.useEffect(()=>{e.canvas.style.width=`${e.appState.width}px`,e.canvas.style.height=`${e.appState.height}px`,e.canvas.width=e.appState.width*e.scale,e.canvas.height=e.appState.height*e.scale},[e.appState.height,e.appState.width,e.canvas,e.scale]),L.useEffect(()=>{const i=t.current;if(!i)return;const s=e.canvas;n.current||(n.current=!0,i.replaceChildren(s),s.classList.add("excalidraw__canvas","static")),uX({canvas:s,rc:e.rc,scale:e.scale,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,visibleElements:e.visibleElements,appState:e.appState,renderConfig:e.renderConfig},i5())}),g("div",{className:"excalidraw__canvas-wrapper",ref:t})},JL=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,hoveredElementIds:e.hoveredElementIds,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,viewBackgroundColor:e.viewBackgroundColor,exportScale:e.exportScale,selectedElementsAreBeingDragged:e.selectedElementsAreBeingDragged,gridSize:e.gridSize,gridStep:e.gridStep,frameRendering:e.frameRendering,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,editingGroupId:e.editingGroupId,currentHoveredFontFamily:e.currentHoveredFontFamily,croppingElementId:e.croppingElementId,suggestedBinding:e.suggestedBinding}),Qve=(e,t)=>e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements?!1:vi(JL(e.appState),JL(t.appState))&&vi(e.renderConfig,t.renderConfig),Jve=de.memo(qve,Qve),RY=({canvas:e,rc:t,newElement:n,elementsMap:i,allElementsMap:s,scale:r,appState:o,renderConfig:a})=>{var l;if(e){const[c,d]=Vy(e,r),u=$y({canvas:e,scale:r,normalizedWidth:c,normalizedHeight:d});if(u.save(),u.scale(o.zoom.value,o.zoom.value),n&&n.type!=="selection"){if(nl(n))return;if((n.frameId||((l=o.frameToHighlight)==null?void 0:l.id))&&o.frameRendering.enabled&&o.frameRendering.clip){const h=m6(n,i,o);h&&v4(n,h,o,i)&&Tv(h,u,a,o)}Cd(n,i,s,t,u,a,o)}else u.clearRect(0,0,c,d);u.restore()}},e9e=Tp(e=>{RY(e)},{trailing:!0}),t9e=(e,t)=>{if(t){e9e(e);return}RY(e)},n9e=e=>{const t=L.useRef(null);return L.useEffect(()=>{t.current&&t9e({canvas:t.current,scale:e.scale,newElement:e.appState.newElement,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,rc:e.rc,renderConfig:e.renderConfig,appState:e.appState},i5())}),g("canvas",{className:"excalidraw__canvas",style:{width:e.appState.width,height:e.appState.height},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:t})},i9e=5e3,s9e=({message:e,onClose:t,closable:n=!1,duration:i=i9e,style:s})=>{const r=L.useRef(0),o=i!==1/0,a=L.useCallback(()=>{o&&(r.current=window.setTimeout(()=>t(),i))},[t,i,o]);return L.useEffect(()=>{if(o)return a(),()=>clearTimeout(r.current)},[a,e,i,o]),N("div",{className:"Toast",onMouseEnter:o?()=>clearTimeout(r==null?void 0:r.current):void 0,onMouseLeave:o?a:void 0,style:s,children:[g("p",{className:"Toast__message",children:e}),n&&g(We,{icon:Wu,"aria-label":"close",type:"icon",onClick:t,className:"close"})]})},r9e=({app:e,activeLockedId:t})=>{const n=e.scene.getElement(t),i=n?[n]:Lt(e.scene.getNonDeletedElementsMap(),t);if(i.length===0)return null;const[s,r]=pt(i),{x:o,y:a}=Qs({sceneX:s,sceneY:r},e.state);return g("div",{className:"UnlockPopup",style:{bottom:`${e.state.height+12-a+e.state.offsetTop}px`,left:`${o-e.state.offsetLeft}px`},onClick:()=>{cn.flushSync(()=>{const l=Pp(i,e.state);e.setState({selectedElementIds:i.reduce((c,d)=>({...c,[d.id]:!0}),{}),selectedGroupIds:l,activeLockedId:null})}),e.actionManager.executeAction(OX)},title:M("labels.elementLock.unlock"),children:pue})},LY=de.createContext(null),DY=de.createContext(null),Wv={formFactor:"desktop",desktopUIMode:"full",userAgent:$F(typeof navigator<"u"?navigator.userAgent:""),isTouchScreen:!1,canFitSidebar:!1,isLandscape:!0},eI=de.createContext(Wv);eI.displayName="EditorInterfaceContext";const tI=de.createContext({container:null,id:null});tI.displayName="ExcalidrawContainerContext";const nI=de.createContext([]);nI.displayName="ExcalidrawElementsContext";const iI=de.createContext({...da(),width:0,height:0,offsetLeft:0,offsetTop:0});iI.displayName="ExcalidrawAppStateContext";const sI=de.createContext(()=>{console.warn("Uninitialized ExcalidrawSetAppStateContext context!")});sI.displayName="ExcalidrawSetAppStateContext";const rI=de.createContext(null);rI.displayName="ExcalidrawActionManagerContext";const So=()=>L.useContext(LY),Zp=()=>L.useContext(DY),Hn=()=>L.useContext(eI),Ua=()=>Sm(Hn()),Fs=()=>L.useContext(tI),sE=()=>L.useContext(nI),qp=()=>L.useContext(iI),kn=()=>L.useContext(sI),Bs=()=>L.useContext(rI);let M1=!1,W3=0,k1=null,_d=!1,R1=!1,K3=!1,L1={horizontal:null,vertical:null},zl=0,D1=!1;const Z3=new Map;let q3=!1,eD=0,tD=!1,wd=null;const Et={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null};class oI extends de.Component{constructor(n){super(n);F(this,"canvas");F(this,"interactiveCanvas",null);F(this,"rc");F(this,"unmounted",!1);F(this,"actionManager");F(this,"editorInterface",Wv);F(this,"stylesPanelMode",Sm(Wv));F(this,"excalidrawContainerRef",de.createRef());F(this,"scene");F(this,"fonts");F(this,"renderer");F(this,"visibleElements");F(this,"resizeObserver");F(this,"library");F(this,"libraryItemsFromStorage");F(this,"id");F(this,"store");F(this,"history");F(this,"excalidrawContainerValue");F(this,"files",{});F(this,"imageCache",new Map);F(this,"iFrameRefs",new Map);F(this,"embedsValidationStatus",new Map);F(this,"initializedEmbeds",new Set);F(this,"handleToastClose",()=>{this.setToast(null)});F(this,"elementsPendingErasure",new Set);F(this,"flowChartCreator",new Zre);F(this,"flowChartNavigator",new Kre);F(this,"bindModeHandler",null);F(this,"hitLinkElement");F(this,"lastPointerDownEvent",null);F(this,"lastPointerUpEvent",null);F(this,"lastPointerMoveEvent",null);F(this,"lastPointerMoveCoords",null);F(this,"lastViewportPosition",{x:0,y:0});F(this,"animationFrameHandler",new N3e);F(this,"laserTrails",new i7e(this.animationFrameHandler,this));F(this,"eraserTrail",new p7e(this.animationFrameHandler,this));F(this,"lassoTrail",new m7e(this.animationFrameHandler,this));F(this,"onChangeEmitter",new Jr);F(this,"onPointerDownEmitter",new Jr);F(this,"onPointerUpEmitter",new Jr);F(this,"onUserFollowEmitter",new Jr);F(this,"onScrollChangeEmitter",new Jr);F(this,"missingPointerEventCleanupEmitter",new Jr);F(this,"onRemoveEventListenersEmitter",new Jr);F(this,"updateEditorAtom",(n,...i)=>{const s=Zs.set(n,...i);return this.triggerRender(),s});F(this,"previousHoveredBindableElement",null);F(this,"getEffectiveGridSize",()=>W0(this)?this.state.gridSize:null);F(this,"updateEmbedValidationStatus",(n,i)=>{this.embedsValidationStatus.set(n.id,i),sn.delete(n)});F(this,"updateEmbeddables",()=>{const n=new Set;let i=!1;this.scene.getNonDeletedElements().filter(s=>{if(ds(s)){if(n.add(s.id),!this.embedsValidationStatus.has(s.id)){i=!0;const r=Y2(s.link,this.props.validateEmbeddable);this.updateEmbedValidationStatus(s,r)}}else Kl(s)&&n.add(s.id);return!1}),i&&this.scene.triggerUpdate(),this.iFrameRefs.forEach((s,r)=>{n.has(r)||this.iFrameRefs.delete(r)})});F(this,"getFrameNameDOMId",n=>`${this.id}-frame-name-${n.id}`);F(this,"frameNameBoundsCache",{get:n=>{let i=this.frameNameBoundsCache._cache.get(n.id);if(!i||i.zoom!==this.state.zoom.value||i.versionNonce!==n.versionNonce){const s=document.getElementById(this.getFrameNameDOMId(n));if(s){const r=s.getBoundingClientRect(),o=Dt({clientX:r.x,clientY:r.y},this.state),a=Dt({clientX:r.right,clientY:r.bottom},this.state);return i={x:o.x,y:o.y,width:a.x-o.x,height:a.y-o.y,angle:0,zoom:this.state.zoom.value,versionNonce:n.versionNonce},this.frameNameBoundsCache._cache.set(n.id,i),i}return null}return i},_cache:new Map});F(this,"resetEditingFrame",n=>{var i;n&&this.scene.mutateElement(n,{name:((i=n.name)==null?void 0:i.trim())||null}),this.setState({editingFrame:null})});F(this,"renderFrameNames",()=>{var r;if(!this.state.frameRendering.enabled||!this.state.frameRendering.name)return this.state.editingFrame&&this.resetEditingFrame(null),null;const n=this.state.theme===Se.DARK,i=this.scene.getNonDeletedFramesLikes(),s=i.length>0&&(r=this.state.searchMatches)!=null&&r.focusedId&&Ue(this.scene.getElement(this.state.searchMatches.focusedId))?this.state.searchMatches.matches.find(o=>o.focus):null;return i.map(o=>{if(!_6(o,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap()))return this.state.editingFrame===o.id&&this.resetEditingFrame(o),null;const{x:a,y:l}=Qs({sceneX:o.x,sceneY:o.y},this.state),c=6;let d;const u=nz(o);if(o.id===this.state.editingFrame){const f=u;d=g("input",{autoFocus:!0,value:f,onChange:h=>{this.scene.mutateElement(o,{name:h.target.value})},onFocus:h=>h.target.select(),onBlur:()=>this.resetEditingFrame(o),onKeyDown:h=>{(h.key===$.ESCAPE||h.key===$.ENTER)&&this.resetEditingFrame(o)},style:{background:this.state.viewBackgroundColor,filter:n?w_:"none",zIndex:2,border:"none",display:"block",padding:`${c}px`,borderRadius:4,boxShadow:"inset 0 0 0 1px var(--color-primary)",fontFamily:"Assistant",fontSize:`${mt.nameFontSize}px`,transform:`translate(-${c}px, ${c}px)`,color:"var(--color-gray-80)",overflow:"hidden",maxWidth:`${document.body.clientWidth-a-c}px`},size:f.length+1||1,dir:"auto",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off"})}else d=u;return g("div",{id:this.getFrameNameDOMId(o),className:bs.FRAME_NAME,style:{position:"absolute",bottom:`${this.state.height+mt.nameOffsetY-l+this.state.offsetTop}px`,left:`${a-this.state.offsetLeft}px`,zIndex:2,fontSize:mt.nameFontSize,color:n?mt.nameColorDarkTheme:mt.nameColorLightTheme,lineHeight:mt.nameLineHeight,width:"max-content",maxWidth:(s==null?void 0:s.id)===o.id&&(s!=null&&s.focus)?"none":`${o.width*this.state.zoom.value}px`,overflow:o.id===this.state.editingFrame?"visible":"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:Rt.MOVE,pointerEvents:this.state.viewModeEnabled?Sd.disabled:Sd.enabled},onPointerDown:f=>this.handleCanvasPointerDown(f),onWheel:f=>this.handleWheel(f),onContextMenu:this.handleCanvasContextMenu,onDoubleClick:()=>{this.setState({editingFrame:o.id})},children:d},o.id)})});F(this,"focusContainer",()=>{var n;(n=this.excalidrawContainerRef.current)==null||n.focus()});F(this,"getSceneElementsIncludingDeleted",()=>this.scene.getElementsIncludingDeleted());F(this,"getSceneElementsMapIncludingDeleted",()=>this.scene.getElementsMapIncludingDeleted());F(this,"getSceneElements",()=>this.scene.getNonDeletedElements());F(this,"onInsertElements",n=>{this.addElementsFromPasteOrLibrary({elements:n,position:"center",files:null})});F(this,"onExportImage",async(n,i,s)=>{it("export",n,"ui");const r=await Yy(n,i,this.state,this.files,{exportBackground:this.state.exportBackground,name:this.getName(),viewBackgroundColor:this.state.viewBackgroundColor,exportingFrame:s.exportingFrame}).catch(iB).catch(o=>{console.error(o),this.setState({errorMessage:o.message})});this.state.exportEmbedScene&&r&&DT(r)&&this.setState({fileHandle:r})});F(this,"magicGenerations",new Map);F(this,"updateMagicGeneration",({frameElement:n,data:i})=>{i.status==="pending"?this.scene.mutateElement(n,{customData:{generationData:void 0}},{informMutation:!1,isDragging:!1}):this.scene.mutateElement(n,{customData:{generationData:i}},{informMutation:!1,isDragging:!1}),this.magicGenerations.set(n.id,i),this.triggerRender()});F(this,"plugins",{});F(this,"onMagicframeToolSelect",()=>{const n=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});if(n.length===0)this.setActiveTool({type:ii.magicframe}),it("ai","tool-select (empty-selection)","d2c");else{const i=n.length===1&&G2(n[0])&&n[0];if(!i&&n.some(r=>Ue(r)||r.frameId)){this.setActiveTool({type:ii.magicframe});return}it("ai","tool-select (existing selection)","d2c");let s;if(i)s=i;else{const[r,o,a,l]=pt(n),c=50;s=C4({...mt,x:r-c,y:o-c,width:a-r+c*2,height:l-o+c*2,opacity:100,locked:!1}),this.scene.insertElement(s);for(const d of n)this.scene.mutateElement(d,{frameId:s.id});this.setState({selectedElementIds:{[s.id]:!0}})}this.onMagicFrameGenerate(s,"upstream")}});F(this,"openEyeDropper",({type:n})=>{this.updateEditorAtom(Ay,{swapPreviewOnAlt:!0,colorPickerType:n==="stroke"?"elementStroke":"elementBackground",onSelect:(i,s)=>{const r=n==="background"&&s.altKey||n==="stroke"&&!s.altKey;!this.scene.getSelectedElements(this.state).length||this.state.activeTool.type!=="selection"?r?this.syncActionResult({appState:{...this.state,currentItemStrokeColor:i},captureUpdate:q.IMMEDIATELY}):this.syncActionResult({appState:{...this.state,currentItemBackgroundColor:i},captureUpdate:q.IMMEDIATELY}):this.updateScene({elements:this.scene.getElementsIncludingDeleted().map(a=>this.state.selectedElementIds[a.id]?Te(a,{[r?"strokeColor":"backgroundColor"]:i}):a),captureUpdate:q.IMMEDIATELY})},keepOpenOnAlt:!1})});F(this,"dismissLinearEditor",()=>{setTimeout(()=>{var n;(n=this.state.selectedLinearElement)!=null&&n.isEditing&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isEditing:!1}})})});F(this,"syncActionResult",ln(n=>{var r,o,a,l,c,d;if(this.unmounted||n===!1)return;this.store.scheduleAction(n.captureUpdate);let i=!1,s=null;if(n.elements&&(this.scene.replaceAllElements(n.elements),i=!0),n.files&&(this.addMissingFiles(n.files,n.replaceFiles),this.addNewImagesToImageCache()),n.appState||s||this.state.contextMenu){let u=((r=n==null?void 0:n.appState)==null?void 0:r.viewModeEnabled)||!1,f=((o=n==null?void 0:n.appState)==null?void 0:o.zenModeEnabled)||!1;const h=((a=n==null?void 0:n.appState)==null?void 0:a.theme)||this.props.theme||Se.LIGHT,m=((l=n==null?void 0:n.appState)==null?void 0:l.name)??this.state.name,p=((c=n==null?void 0:n.appState)==null?void 0:c.errorMessage)??this.state.errorMessage;typeof this.props.viewModeEnabled<"u"&&(u=this.props.viewModeEnabled),typeof this.props.zenModeEnabled<"u"&&(f=this.props.zenModeEnabled),s=((d=n.appState)==null?void 0:d.editingTextElement)||null,n.elements&&s&&n.elements.forEach(U=>{(s==null?void 0:s.id)===U.id&&s!==U&&N4(U)&&fe(U)&&(s=U)}),s!=null&&s.isDeleted&&(s=null),this.setState(U=>{const b=n.appState||{};return{...U,...b,contextMenu:null,editingTextElement:s,viewModeEnabled:u,zenModeEnabled:f,theme:h,name:m,errorMessage:p}}),i=!0}i||this.scene.triggerUpdate()}));F(this,"onBlur",ln(()=>{_d=!1,this.setState({isBindingEnabled:!0})}));F(this,"onUnload",()=>{this.onBlur()});F(this,"disableEvent",n=>{n.preventDefault()});F(this,"resetHistory",()=>{this.history.clear()});F(this,"resetStore",()=>{this.store.clear()});F(this,"resetScene",ln(n=>{this.scene.replaceAllElements([]),this.setState(i=>({...da(),isLoading:n!=null&&n.resetLoadingState?!1:i.isLoading,theme:this.state.theme})),this.resetStore(),this.resetHistory()}));F(this,"initializeScene",async()=>{var r;"launchQueue"in window&&"LaunchParams"in window&&window.launchQueue.setConsumer(async o=>{if(!o.files.length)return;const a=o.files[0],l=await a.getFile();this.loadFileToCanvas(new File([l],l.name||"",{type:l.type}),a)}),this.props.theme&&this.setState({theme:this.props.theme}),this.state.isLoading||this.setState({isLoading:!0});let n=null;try{typeof this.props.initialData=="function"?n=await this.props.initialData()||null:n=await this.props.initialData||null,n!=null&&n.libraryItems&&this.library.updateLibrary({libraryItems:n.libraryItems,merge:!0}).catch(o=>{console.error(o)})}catch(o){console.error(o),n={appState:{errorMessage:o.message||"Encountered an error during importing or restoring scene data"}}}const i=ku(n,null,null,{repairBindings:!0,deleteInvisibleElements:!0}),s=i.appState.activeTool;i.appState.preferredSelectionTool.initialized||(i.appState.preferredSelectionTool={type:this.editorInterface.formFactor==="phone"?"lasso":"selection",initialized:!0}),i.appState={...i.appState,theme:this.props.theme||i.appState.theme,openSidebar:((r=i.appState)==null?void 0:r.openSidebar)||this.state.openSidebar,activeTool:s.type==="image"||s.type==="lasso"||s.type==="selection"?{...s,type:i.appState.preferredSelectionTool.type}:i.appState.activeTool,isLoading:!1,toast:this.state.toast},n!=null&&n.scrollToContent&&(i.appState={...i.appState,...C0(i.elements,{...i.appState,width:this.state.width,height:this.state.height,offsetTop:this.state.offsetTop,offsetLeft:this.state.offsetLeft})}),this.resetStore(),this.resetHistory(),this.syncActionResult({...i,captureUpdate:q.NEVER}),this.clearImageShapeCache(),this.fonts.loadSceneFonts().then(o=>{this.fonts.onLoaded(o)}),mh(window.location.href)&&this.scrollToContent(window.location.href,{animate:!1})});F(this,"getFormFactor",(n,i)=>this.props.UIOptions.formFactor??Xee(n,i));F(this,"refreshEditorInterface",()=>{const n=this.excalidrawContainerRef.current;if(!n)return;const{width:i,height:s}=n.getBoundingClientRect(),r=jee(),o=$F(typeof navigator<"u"?navigator.userAgent:""),a=this.props.UIOptions.dockedSidebarBreakpoint!=null?this.props.UIOptions.dockedSidebarBreakpoint:Fee,l=z2(this.editorInterface,{desktopUIMode:this.props.UIOptions.desktopUIMode??r??this.editorInterface.desktopUIMode,formFactor:this.getFormFactor(i,s),userAgent:o,canFitSidebar:i>a,isLandscape:i>s});this.editorInterface=l,this.reconcileStylesPanelMode(l)});F(this,"reconcileStylesPanelMode",n=>{const i=Sm(n);if(i===this.stylesPanelMode)return;const s=this.stylesPanelMode;this.stylesPanelMode=i,s!=="full"&&i==="full"&&this.setState(r=>({preferredSelectionTool:{type:"selection",initialized:!0}}))});F(this,"setDesktopUIMode",n=>{const i=Wee(n);this.editorInterface=z2(this.editorInterface,{desktopUIMode:i}),this.reconcileStylesPanelMode(this.editorInterface)});F(this,"onResize",ln(()=>{this.scene.getElementsIncludingDeleted().forEach(n=>sn.delete(n)),this.refreshEditorInterface(),this.updateDOMRect(),this.setState({})}));F(this,"onFullscreenChange",()=>{var n;!document.fullscreenElement&&((n=this.state.activeEmbeddable)==null?void 0:n.state)==="active"&&this.setState({activeEmbeddable:null})});F(this,"renderInteractiveSceneCallback",({atLeastOneVisibleElement:n,scrollBars:i,elementsMap:s})=>{i&&(L1=i);const r=this.state.editingTextElement?!1:!n&&s.size>0;this.state.scrolledOutside!==r&&this.setState({scrolledOutside:r}),this.scheduleImageRefresh()});F(this,"onScroll",ul(()=>{const{offsetTop:n,offsetLeft:i}=this.getCanvasOffsets();this.setState(s=>s.offsetLeft===i&&s.offsetTop===n?null:{offsetTop:n,offsetLeft:i})},_ee));F(this,"onCut",ln(n=>{var s;!((s=this.excalidrawContainerRef.current)!=null&&s.contains(document.activeElement))||Ba(n.target)||(this.actionManager.executeAction(XR,"keyboard",n),n.preventDefault(),n.stopPropagation())}));F(this,"onCopy",ln(n=>{var s;!((s=this.excalidrawContainerRef.current)!=null&&s.contains(document.activeElement))||Ba(n.target)||(this.actionManager.executeAction(ub,"keyboard",n),n.preventDefault(),n.stopPropagation())}));F(this,"onTouchStart",n=>{if(S_&&n.preventDefault(),!M1){M1=!0,n.touches.length===1&&(k1={x:n.touches[0].clientX,y:n.touches[0].clientY}),clearTimeout(W3),W3=window.setTimeout(oI.resetTapTwice,yee);return}if(M1&&n.touches.length===1&&k1){const i=n.touches[0];Qe(C(i.clientX,i.clientY),C(k1.x,k1.y))<=kee&&(this.lassoTrail.endPath(),this.deselectElements(),this.handleCanvasDoubleClick({clientX:i.clientX,clientY:i.clientY})),M1=!1,clearTimeout(W3)}n.touches.length===2&&this.setState({selectedElementIds:vt({},this.state),activeEmbeddable:null})});F(this,"onTouchEnd",n=>{this.resetContextMenuTimer(),n.touches.length>0?this.setState({previousSelectedElementIds:{},selectedElementIds:vt(this.state.previousSelectedElementIds,this.state)}):Et.pointers.clear()});F(this,"pasteFromClipboard",ln(async n=>{var d;const i=!!q3,s=document.activeElement,r=(d=this.excalidrawContainerRef.current)==null?void 0:d.contains(s);if(n&&!r)return;const o=document.elementFromPoint(this.lastViewportPosition.x,this.lastViewportPosition.y);if(n&&(!(o instanceof HTMLCanvasElement)||Ba(s)))return;const a=await Iv(n),l=a.getFiles(),c=await kye(a,i);if(this.props.onPaste)try{if(await this.props.onPaste(c,n)===!1)return}catch(u){console.error(u)}await this.insertClipboardContent(c,l,i),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n==null||n.preventDefault()}));F(this,"addElementsFromPasteOrLibrary",n=>{var w,S;const i=Mu(n.elements,null,{deleteInvisibleElements:!0}),[s,r,o,a]=pt(i),l=Ki(s,o)/2,c=Ki(r,a)/2,d=typeof n.position=="object"?n.position.clientX:n.position==="cursor"?this.lastViewportPosition.x:this.state.width/2+this.state.offsetLeft,u=typeof n.position=="object"?n.position.clientY:n.position==="cursor"?this.lastViewportPosition.y:this.state.height/2+this.state.offsetTop,{x:f,y:h}=Dt({clientX:d,clientY:u},this.state),m=f-l,p=h-c,[U,b]=ti(m,p,this.getEffectiveGridSize()),{duplicatedElements:y}=Rm({type:"everything",elements:i.map(x=>Te(x,{x:x.x+U-s,y:x.y+b-r})),randomizeSeed:!n.retainSeed}),v=this.scene.getElementsIncludingDeleted();let _=[...v,...y];_=((S=(w=this.props).onDuplicate)==null?void 0:S.call(w,_,v))||_,bo(_,be(y));const R=this.getTopLayerFrameAtSceneCoords({x:f,y:h});if(R){const x=Ese(y,R);km(_,x,R,this.state)}this.scene.replaceAllElements(_),y.forEach(x=>{if(fe(x)&&Nt(x)){const k=Bn(x,this.scene.getElementsMapIncludingDeleted());ns(x,k,this.scene)}}),zee&&rl.loadElementsFonts(y).then(x=>{this.fonts.onLoaded(x)}),n.files&&this.addMissingFiles(n.files);const T=J_(y);this.store.scheduleCapture(),this.setState({...this.state,openSidebar:this.state.openSidebar&&this.editorInterface.canFitSidebar&&Zs.get(WT)?this.state.openSidebar:null,...xi({editingGroupId:null,selectedElementIds:T.reduce((x,k)=>(Nt(k)||(x[k.id]=!0),x),{})},this.scene.getNonDeletedElements(),this.state,this)},()=>{n.files&&this.addNewImagesToImageCache()}),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n.fitToContent&&this.scrollToContent(y,{fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()})});F(this,"setAppState",(n,i)=>{this.setState(n,i)});F(this,"removePointer",n=>{zl&&this.resetContextMenuTimer(),Et.pointers.delete(n.pointerId)});F(this,"toggleLock",(n="ui")=>{this.state.activeTool.locked||it("toolbar","toggleLock",`${n} (${this.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),this.setState(i=>({activeTool:{...i.activeTool,...qt(this.state,i.activeTool.locked?{type:this.state.preferredSelectionTool.type}:i.activeTool),locked:!i.activeTool.locked}}))});F(this,"updateFrameRendering",n=>{this.setState(i=>{const s=typeof n=="function"?n(i.frameRendering):n;return{frameRendering:{enabled:(s==null?void 0:s.enabled)??i.frameRendering.enabled,clip:(s==null?void 0:s.clip)??i.frameRendering.clip,name:(s==null?void 0:s.name)??i.frameRendering.name,outline:(s==null?void 0:s.outline)??i.frameRendering.outline}}})});F(this,"togglePenMode",n=>{this.setState(i=>({penMode:n??!i.penMode,penDetected:!0}))});F(this,"onHandToolToggle",()=>{this.actionManager.executeAction(q2e)});F(this,"zoomCanvas",n=>{this.setState({...Hd({viewportX:this.state.width/2+this.state.offsetLeft,viewportY:this.state.height/2+this.state.offsetTop,nextZoom:Ka(n)},this.state)})});F(this,"cancelInProgressAnimation",null);F(this,"scrollToContent",(n=this.scene.getNonDeletedElements(),i)=>{var l;if(typeof n=="string"){let c;if(mh(n)?c=Mre(n):c=n,c){const d=this.scene.getElementsFromId(c);d!=null&&d.length?this.scrollToContent(d,{fitToContent:(i==null?void 0:i.fitToContent)??!0,animate:(i==null?void 0:i.animate)??!0}):mh(n)&&this.setState({toast:{message:M("elementLink.notFound"),duration:3e3,closable:!0}})}return}(l=this.cancelInProgressAnimation)==null||l.call(this);const s=Array.isArray(n)?n:[n];let r=this.state.zoom,o=this.state.scrollX,a=this.state.scrollY;if(i!=null&&i.fitToContent||i!=null&&i.fitToViewport){const{appState:c}=Dy({canvasOffsets:i.canvasOffsets,targetElements:s,appState:this.state,fitToViewport:!!(i!=null&&i.fitToViewport),viewportZoomFactor:i==null?void 0:i.viewportZoomFactor,minZoom:i==null?void 0:i.minZoom,maxZoom:i==null?void 0:i.maxZoom});r=c.zoom,o=c.scrollX,a=c.scrollY}else{const c=C0(s,this.state);o=c.scrollX,a=c.scrollY}if(i!=null&&i.animate){const c=this.state.scrollX,d=this.state.scrollY,u=this.state.zoom.value,f=Ete({fromValues:{scrollX:c,scrollY:d,zoom:u},toValues:{scrollX:o,scrollY:a,zoom:r.value},interpolateValue:(h,m,p,U)=>{if(U==="zoom")return h*Math.pow(m/h,fl(p))},onStep:({scrollX:h,scrollY:m,zoom:p})=>{this.setState({scrollX:h,scrollY:m,zoom:{value:p}})},onStart:()=>{this.setState({shouldCacheIgnoreZoom:!0})},onEnd:()=>{this.setState({shouldCacheIgnoreZoom:!1})},onCancel:()=>{this.setState({shouldCacheIgnoreZoom:!1})},duration:(i==null?void 0:i.duration)??500});this.cancelInProgressAnimation=()=>{f(),this.cancelInProgressAnimation=null}}else this.setState({scrollX:o,scrollY:a,zoom:r})});F(this,"maybeUnfollowRemoteUser",()=>{this.state.userToFollow&&this.setState({userToFollow:null})});F(this,"translateCanvas",n=>{var i;(i=this.cancelInProgressAnimation)==null||i.call(this),this.maybeUnfollowRemoteUser(),this.setState(n)});F(this,"setToast",n=>{this.setState({toast:n})});F(this,"restoreFileFromShare",async()=>{try{const n=await caches.open("web-share-target"),i=await n.match("shared-file");if(i){const s=await i.blob(),r=new File([s],s.name||"",{type:s.type});this.loadFileToCanvas(r,null),await n.delete("shared-file"),window.history.replaceState(null,Tc,window.location.pathname)}}catch(n){this.setState({errorMessage:n.message})}});F(this,"addFiles",ln(n=>{const{addedFiles:i}=this.addMissingFiles(n);this.clearImageShapeCache(i),this.scene.triggerUpdate(),this.addNewImagesToImageCache()}));F(this,"addMissingFiles",(n,i=!1)=>{const s=i?{}:{...this.files},r={},o=Array.isArray(n)?n:Object.values(n);for(const a of o)if(!s[a.id]&&(r[a.id]=a,s[a.id]=a,a.mimeType===ve.svg))try{const l=aye(VA(lye(a.dataURL)),ve.svg);a.dataURL!==l&&(a.version=(a.version??1)+1,a.dataURL=l)}catch(l){console.error(l)}return this.files=s,{addedFiles:r}});F(this,"updateScene",ln(n=>{const{elements:i,appState:s,collaborators:r,captureUpdate:o}=n;if(o){const a=i||void 0,l=s?gh({...this.store.snapshot.appState,...s}):void 0;this.store.scheduleMicroAction({action:o,elements:a,appState:l})}s&&this.setState(s),i&&this.scene.replaceAllElements(i),r&&this.setState({collaborators:r})}));F(this,"applyDeltas",(n,i)=>{const s=pu.squash(...n),r={...this.state},o=new Map(this.scene.getElementsMapIncludingDeleted());return pu.applyTo(s,o,r,i)});F(this,"mutateElement",(n,i,s=!0)=>this.scene.mutateElement(n,i,{informMutation:s,isDragging:!1}));F(this,"triggerRender",n=>{n===!0?this.scene.triggerUpdate():this.setState({})});F(this,"toggleSidebar",({name:n,tab:i,force:s})=>{var a,l;let r;s===void 0?r=((a=this.state.openSidebar)==null?void 0:a.name)===n&&((l=this.state.openSidebar)==null?void 0:l.tab)===i?null:n:r=s?n:null;const o=r?{name:r}:null;return o&&i&&(o.tab=i),this.setState({openSidebar:o}),!!r});F(this,"updateCurrentCursorPosition",ln(n=>{this.lastViewportPosition.x=n.clientX,this.lastViewportPosition.y=n.clientY}));F(this,"getEditorUIOffsets",()=>{var o,a,l,c,d,u,f,h,m,p;const n=((c=(l=(a=(o=this.excalidrawContainerRef)==null?void 0:o.current)==null?void 0:a.querySelector(".App-toolbar"))==null?void 0:l.getBoundingClientRect())==null?void 0:c.bottom)??0,i=(f=(u=(d=this.excalidrawContainerRef)==null?void 0:d.current)==null?void 0:u.querySelector(".sidebar"))==null?void 0:f.getBoundingClientRect(),s=(p=(m=(h=this.excalidrawContainerRef)==null?void 0:h.current)==null?void 0:m.querySelector(".App-menu__left"))==null?void 0:p.getBoundingClientRect(),r=16;return x0().rtl?{top:n+r,right:Math.max(this.state.width-((s==null?void 0:s.left)??this.state.width),0)+r,bottom:r,left:Math.max((i==null?void 0:i.right)??0,0)+r}:{top:n+r,right:Math.max(this.state.width-((i==null?void 0:i.left)??this.state.width)+r,0),bottom:r,left:Math.max((s==null?void 0:s.right)??0,0)+r}});F(this,"onKeyDown",ln(n=>{var o,a,l,c,d,u;if("Proxy"in window&&(!n.shiftKey&&/^[A-Z]$/.test(n.key)||n.shiftKey&&/^[a-z]$/.test(n.key))&&(n=new Proxy(n,{get(f,h){const m=f[h];return typeof m=="function"?m.bind(f):h==="key"?n.shiftKey?f.key.toUpperCase():f.key.toLowerCase():m}})),!d4(n.target)){if((n.key===$.ESCAPE||n.key===$.ENTER)&&this.state.croppingElementId){this.finishImageCropping();return}const f=Ye(this.scene.getNonDeletedElementsMap(),this.state);if(f.length===1&&wt(f[0])&&n.key===$.ENTER){this.startImageCropping(f[0]);return}if(n.key===$.ESCAPE)this.updateEditorAtom(Da,null);else if(n.key===$.TAB&&(document.activeElement===((o=this.excalidrawContainerRef)==null?void 0:o.current)||(a=document.activeElement)!=null&&a.classList.contains(bs.CONVERT_ELEMENT_TYPE_POPUP))){n.preventDefault();const m=Ky(f);((l=Zs.get(Da))==null?void 0:l.type)==="panel"&&BX(this,{conversionType:m,direction:n.shiftKey?"left":"right"})&&this.store.scheduleCapture(),m&&this.updateEditorAtom(Da,{type:"panel"})}if(n.key===$.ESCAPE&&this.flowChartCreator.isCreatingChart){this.flowChartCreator.clear(),this.triggerRender(!0);return}const h=X1(n.key);if(n[$.CTRL_OR_CMD]&&h&&!n.shiftKey){n.preventDefault();const m=Ye(this.scene.getNonDeletedElementsMap(),this.state);m.length===1&&Q5(m[0])&&this.flowChartCreator.createNodes(m[0],this.state,HA(n.key),this.scene),(c=this.flowChartCreator.pendingNodes)!=null&&c.length&&!j2(this.flowChartCreator.pendingNodes,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(this.flowChartCreator.pendingNodes,{animate:!0,duration:300,fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()});return}if(n.altKey){const m=Ye(this.scene.getNonDeletedElementsMap(),this.state);if(m.length===1&&h){n.preventDefault();const p=this.flowChartNavigator.exploreByDirection(m[0],this.scene.getNonDeletedElementsMap(),HA(n.key));if(p){this.setState(b=>({selectedElementIds:vt({[p]:!0},b)}));const U=this.scene.getNonDeletedElementsMap().get(p);U&&!j2([U],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(U,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})}return}}}if(n[$.CTRL_OR_CMD]&&n.key===$.P&&!n.shiftKey&&!n.altKey){this.setToast({message:M("commandPalette.shortcutHint",{shortcut:es("commandPalette")})}),n.preventDefault();return}if(n[$.CTRL_OR_CMD]&&n.key.toLowerCase()===$.V&&(q3=n.shiftKey,clearTimeout(eD),eD=window.setTimeout(()=>{q3=!1},100)),n[$.CTRL_OR_CMD]&&Ba(n.target)&&(n.code===ot.MINUS||n.code===ot.EQUAL)){n.preventDefault();return}if(Ba(n.target)&&n.key!==$.ESCAPE||X1(n.key)&&d4(n.target))return;if(n.key===$.QUESTION_MARK){this.setState({openDialog:{name:"help"}});return}else if(n.key.toLowerCase()===$.E&&n.shiftKey&&n[$.CTRL_OR_CMD]){n.preventDefault(),this.setState({openDialog:{name:"imageExport"}});return}if(n.key===$.PAGE_UP||n.key===$.PAGE_DOWN){let f=(n.shiftKey?this.state.width:this.state.height)/this.state.zoom.value;n.key===$.PAGE_DOWN&&(f=-f),n.shiftKey?this.translateCanvas(h=>({scrollX:h.scrollX+f})):this.translateCanvas(h=>({scrollY:h.scrollY+f}))}if(((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector"||(n.key===$.ALT&&ki("COMPLEX_BINDINGS")&&this.handleSkipBindMode(),this.actionManager.handleKeyDown(n))||this.state.viewModeEnabled)return;if(n[$.CTRL_OR_CMD]&&this.state.isBindingEnabled&&(ki("COMPLEX_BINDINGS")&&this.resetDelayedBindMode(),this.setState({isBindingEnabled:!1})),X1(n.key)){let f=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});const h=new Set;f.filter(b=>dn(b)).filter(b=>{const y=b.startBinding&&!f.some(_=>{var I;return _.id===((I=b.startBinding)==null?void 0:I.elementId)}),v=b.endBinding&&!f.some(_=>{var I;return _.id===((I=b.endBinding)==null?void 0:I.elementId)});return y||v}).forEach(b=>h.add(b.id)),f=f.filter(b=>!h.has(b.id));const m=this.getEffectiveGridSize()&&(n.shiftKey?SC:this.getEffectiveGridSize())||(n.shiftKey?lee:SC);let p=0,U=0;n.key===$.ARROW_LEFT?p=-m:n.key===$.ARROW_RIGHT?p=m:n.key===$.ARROW_UP?U=-m:n.key===$.ARROW_DOWN&&(U=m),f.forEach(b=>{this.scene.mutateElement(b,{x:b.x+p,y:b.y+U},{informMutation:!1,isDragging:!1}),ps(b,this.scene,{simultaneouslyUpdated:f})}),this.scene.triggerUpdate(),n.preventDefault()}else if(n.key===$.ENTER){const f=this.scene.getSelectedElements(this.state);if(f.length===1){const h=f[0];if(n[$.CTRL_OR_CMD]||nn(h))Ce(h)&&(!((u=this.state.selectedLinearElement)!=null&&u.isEditing)||this.state.selectedLinearElement.elementId!==h.id)&&(this.store.scheduleCapture(),ye(h)||this.actionManager.executeAction(m2));else if(fe(h)||bie(h)){let m;fe(h)||(m=h);const p=D8(h,this.state,this.scene.getNonDeletedElementsMap()),U=p.x,b=p.y;this.startTextEditing({sceneX:U,sceneY:b,container:m}),n.preventDefault();return}else Ue(h)&&this.setState({editingFrame:h.id})}}else if(!n.ctrlKey&&!n.altKey&&!n.metaKey&&!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged){const f=O8e(n.key,this);f?(this.state.activeTool.type!==f&&it("toolbar",f,`keyboard (${this.editorInterface.formFactor==="phone"?"mobile":"desktop"})`),f==="arrow"&&this.state.activeTool.type==="arrow"&&this.setState(h=>({currentItemArrowType:h.currentItemArrowType===Dn.sharp?Dn.round:h.currentItemArrowType===Dn.round?Dn.elbow:Dn.sharp})),this.setActiveTool({type:f}),n.stopPropagation()):n.key===$.Q&&(this.toggleLock("keyboard"),n.stopPropagation())}if(n.key===$.SPACE&&Et.pointers.size===0&&(_d=!0,Ft(this.interactiveCanvas,Rt.GRAB),n.preventDefault()),(n.key===$.G||n.key===$.S)&&!n.altKey&&!n[$.CTRL_OR_CMD]){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;n.key===$.G&&($c(this.state.activeTool.type)||f.some(h=>$c(h.type)))&&(this.setState({openPopup:"elementBackground"}),n.stopPropagation()),n.key===$.S&&(this.setState({openPopup:"elementStroke"}),n.stopPropagation())}if(!n[$.CTRL_OR_CMD]&&n.shiftKey&&n.key.toLowerCase()===$.F){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;(this.state.activeTool.type==="text"||f.find(h=>fe(h)||Re(h,this.scene.getNonDeletedElementsMap())))&&(n.preventDefault(),this.setState({openPopup:"fontFamily"}))}if(n.key===$.K&&!n.altKey&&!n[$.CTRL_OR_CMD]){this.state.activeTool.type==="laser"?this.setActiveTool({type:this.state.preferredSelectionTool.type}):this.setActiveTool({type:"laser"});return}n[$.CTRL_OR_CMD]&&(n.key===$.BACKSPACE||n.key===$.DELETE)&&this.updateEditorAtom(tE,"clearCanvas");const i=n.key.toLocaleLowerCase(),s=i===$.S&&n.shiftKey,r=n.key===$.I||i===$.G&&n.shiftKey;(s||r)&&this.openEyeDropper({type:s?"stroke":"background"})}));F(this,"onKeyUp",ln(n=>{var i,s,r;if(n.key===$.SPACE&&(this.state.viewModeEnabled||((i=this.state.openDialog)==null?void 0:i.name)==="elementLinkSelector"?Ft(this.interactiveCanvas,Rt.GRAB):zU(this.state.activeTool.type)?Kr(this.interactiveCanvas):(Ro(this.interactiveCanvas,this.state),this.setState({selectedElementIds:vt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})),_d=!1),(n.key===$.ALT&&this.state.bindMode==="skip"||!n[$.CTRL_OR_CMD]&&!Va(this.state))&&(this.setState({bindMode:"orbit"}),this.lastPointerMoveEvent)){const o=Dt({clientX:this.lastPointerMoveEvent.clientX,clientY:this.lastPointerMoveEvent.clientY},this.state),a=Ci(C(o.x,o.y),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());if(this.state.selectedLinearElement){const l=re.getElement(this.state.selectedLinearElement.elementId,this.scene.getNonDeletedElementsMap());dn(l)&&ki("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(l,a)}}if(!n[$.CTRL_OR_CMD]&&!this.state.isBindingEnabled&&this.setState({isBindingEnabled:!0}),X1(n.key)){y4(this.scene.getSelectedElements(this.state).filter(_e),this.scene,this.state);const o=this.scene.getNonDeletedElementsMap();this.scene.getSelectedElements(this.state).filter(M8).forEach(a=>{a.startBinding&&this.scene.mutateElement(a,{startBinding:{...a.startBinding,...Xh(a,o.get(a.startBinding.elementId),"start",o)}}),a.endBinding&&this.scene.mutateElement(a,{endBinding:{...a.endBinding,...Xh(a,o.get(a.endBinding.elementId),"end",o)}})}),this.setState({suggestedBinding:null})}if(n.altKey||this.flowChartNavigator.isExploring&&(this.flowChartNavigator.clear(),this.syncActionResult({captureUpdate:q.IMMEDIATELY})),!n[$.CTRL_OR_CMD]&&this.flowChartCreator.isCreatingChart){(s=this.flowChartCreator.pendingNodes)!=null&&s.length&&this.scene.insertElements(this.flowChartCreator.pendingNodes);const o=(r=this.flowChartCreator.pendingNodes)==null?void 0:r[0];o&&(this.setState(a=>({selectedElementIds:vt({[o.id]:!0},a)})),j2([o],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())||this.scrollToContent(o,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})),this.flowChartCreator.clear(),this.syncActionResult({captureUpdate:q.IMMEDIATELY})}}));F(this,"isToolSupported",n=>{var i;return((i=this.props.UIOptions.tools)==null?void 0:i[n])!==!1});F(this,"setActiveTool",(n,i=!1)=>{if(!this.isToolSupported(n.type)){console.warn(`"${n.type}" tool is disabled via "UIOptions.canvasActions.tools.${n.type}"`);return}const s=qt(this.state,n);s.type==="hand"?Ft(this.interactiveCanvas,Rt.GRAB):_d||Ro(this.interactiveCanvas,{...this.state,activeTool:s}),Ute(document.activeElement)&&this.focusContainer(),_B(s.type)||this.setState({suggestedBinding:null}),s.type==="image"&&this.onImageToolbarButtonClick(),this.setState(r=>{const o={snapLines:r.snapLines.length?[]:r.snapLines,originSnapOffset:null,activeEmbeddable:null,selectedLinearElement:zU(s.type)?r.selectedLinearElement:null};return s.type==="freedraw"&&this.store.scheduleCapture(),s.type==="lasso"?{...r,...o,activeTool:s,...i?{}:{selectedElementIds:vt({},r),selectedGroupIds:vt({},r),editingGroupId:null,multiElement:null}}:s.type!=="selection"?{...r,...o,activeTool:s,selectedElementIds:vt({},r),selectedGroupIds:vt({},r),editingGroupId:null,multiElement:null}:{...r,...o,activeTool:s}})});F(this,"setOpenDialog",n=>{this.setState({openDialog:n})});F(this,"setCursor",n=>{Ft(this.interactiveCanvas,n)});F(this,"resetCursor",()=>{Kr(this.interactiveCanvas)});F(this,"isTouchScreenMultiTouchGesture",()=>Et.pointers.size>=2);F(this,"getName",()=>this.state.name||this.props.name||`${M("labels.untitled")}-${OC()}`);F(this,"onGestureStart",ln(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({selectedElementIds:vt({},this.state),activeEmbeddable:null}),Et.initialScale=this.state.zoom.value}));F(this,"onGestureChange",ln(n=>{if(n.preventDefault(),this.isTouchScreenMultiTouchGesture())return;const i=Et.initialScale;i&&this.setState(s=>({...Hd({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:Ka(i*n.scale)},s)}))}));F(this,"onGestureEnd",ln(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({previousSelectedElementIds:{},selectedElementIds:vt(this.state.previousSelectedElementIds,this.state)}),Et.initialScale=null}));F(this,"startTextEditing",({sceneX:n,sceneY:i,insertAtParentCenter:s=!0,container:r,autoEdit:o=!0})=>{let a=!1,l=s&&this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,r);r&&l&&(Re(r,this.scene.getNonDeletedElementsMap())||(a=!0));let c=null;const d=this.scene.getSelectedElements(this.state);d.length===1?fe(d[0])?c=d[0]:r?c=Re(d[0],this.scene.getNonDeletedElementsMap()):c=this.getTextElementAtPosition(n,i):c=this.getTextElementAtPosition(n,i);const u=(c==null?void 0:c.fontFamily)||this.state.currentItemFontFamily,f=(c==null?void 0:c.lineHeight)||zc(u),h=this.state.currentItemFontSize;if(!c&&a&&r&&!_e(r)){const b=kB(bt({fontSize:h,fontFamily:u}),f),y=RB(h,f),v=Math.max(r.height,y),_=Math.max(r.width,b);this.scene.mutateElement(r,{height:v,width:_}),n=r.x+_/2,i=r.y+v/2,l&&(l=this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,r))}const m=this.getTopLayerFrameAtSceneCoords({x:n,y:i}),p=c||cr({x:l?l.elementCenterX:n,y:l?l.elementCenterY:i,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:"",fontSize:h,fontFamily:u,textAlign:l?"center":this.state.currentItemTextAlign,verticalAlign:l?qs.MIDDLE:Wb,containerId:a?r==null?void 0:r.id:void 0,groupIds:(r==null?void 0:r.groupIds)??[],lineHeight:f,angle:r?_e(r)?0:r.angle:0,frameId:m?m.id:null});if(!c&&a&&r&&this.scene.mutateElement(r,{boundElements:(r.boundElements||[]).concat({type:"text",id:p.id})}),this.setState({editingTextElement:p}),!c)if(r&&a){const U=this.scene.getElementIndex(r.id);this.scene.insertElementAtIndex(p,U+1)}else this.scene.insertElement(p);o||c||r?this.handleTextWysiwyg(p,{isExistingElement:!!c}):this.setState({newElement:p,multiElement:null})});F(this,"startImageCropping",n=>{this.store.scheduleCapture(),this.setState({croppingElementId:n.id})});F(this,"finishImageCropping",()=>{this.state.croppingElementId&&(this.store.scheduleCapture(),this.setState({croppingElementId:null}))});F(this,"handleCanvasDoubleClick",n=>{var a,l,c;if(this.state.multiElement||this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const i=this.scene.getSelectedElements(this.state);let{x:s,y:r}=Dt(n,this.state);if(i.length===1&&Ce(i[0])){const d=i[0];if((n[$.CTRL_OR_CMD]&&M8(d)||nn(d))&&(!((a=this.state.selectedLinearElement)!=null&&a.isEditing)||this.state.selectedLinearElement.elementId!==d.id)){this.actionManager.executeAction(m2);return}else if(this.state.selectedLinearElement&&ye(i[0])){const u=re.getSegmentMidpointHitCoords(this.state.selectedLinearElement,{x:s,y:r},this.state,this.scene.getNonDeletedElementsMap()),f=u?re.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,u,this.scene.getNonDeletedElementsMap()):-1;if(f&&f>-1){this.store.scheduleCapture(),re.deleteFixedSegment(i[0],this.scene,f);const h=re.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:s,y:r},this.state,this.scene.getNonDeletedElementsMap()),m=h?re.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,h,this.scene.getNonDeletedElementsMap()):null;this.setState({selectedLinearElement:{...this.state.selectedLinearElement,initialState:{...this.state.selectedLinearElement.initialState,segmentMidpoint:{index:m,value:u,added:!1}},segmentMidPointHoveredCoords:h}});return}}else if((l=this.state.selectedLinearElement)!=null&&l.isEditing&&this.state.selectedLinearElement.elementId===d.id&&nn(d))return}if(i.length===1&&wt(i[0])){this.startImageCropping(i[0]);return}if(Kr(this.interactiveCanvas),Ic(this.state).length>0){const d=this.getElementAtPosition(s,r),u=d&&ZB(d,this.state.selectedGroupIds);if(u){this.store.scheduleCapture(),this.setState(f=>({...f,...xi({editingGroupId:u,selectedElementIds:{[d.id]:!0}},this.scene.getNonDeletedElements(),f,this)}));return}}if(Kr(this.interactiveCanvas),!n[$.CTRL_OR_CMD]&&!this.state.viewModeEnabled){const d=this.getElementAtPosition(s,r);if(wr(d)){this.setState({activeEmbeddable:{element:d,state:"active"}});return}if(!((c=this.state.selectedLinearElement)!=null&&c.isEditing)){const u=this.getTextBindableContainerAtPosition(s,r);if(u&&(Fi(u)||!ms(u.backgroundColor)||Sf({point:C(s,r),element:u,elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(u)}))){const f=D8(u,this.state,this.scene.getNonDeletedElementsMap());s=f.x,r=f.y}this.startTextEditing({sceneX:s,sceneY:r,insertAtParentCenter:!n.altKey,container:u})}}});F(this,"getElementLinkAtPosition",(n,i)=>{if(i&&i.locked)return;const s=this.scene.getNonDeletedElements();let r=-1;for(let o=s.length-1;o>=0;o--){const a=s[o];if(i&&a.id===i.id&&(r=o),a.link&&o>=r&&x3(a,this.scene.getNonDeletedElementsMap(),this.state,C(n.x,n.y),this.editorInterface.formFactor==="phone"))return a}});F(this,"redirectToLink",(n,i)=>{const s=Qe(C(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY),C(this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY));if(!this.hitLinkElement||s>g0)return;const r=Dt(this.lastPointerDownEvent,this.state),o=this.scene.getNonDeletedElementsMap(),a=x3(this.hitLinkElement,o,this.state,C(r.x,r.y),this.editorInterface.formFactor==="phone"),l=Dt(this.lastPointerUpEvent,this.state),c=x3(this.hitLinkElement,o,this.state,C(l.x,l.y),this.editorInterface.formFactor==="phone");if(a&&c){qR();let d=this.hitLinkElement.link;if(d){d=rr(d);let u;if(this.props.onLinkOpen&&(u=oB(te.EXCALIDRAW_LINK,n.nativeEvent),this.props.onLinkOpen({...this.hitLinkElement,link:d},u)),!(u!=null&&u.defaultPrevented)){const f=fB(d)?"_self":"_blank",h=window.open(void 0,f);h&&(h.opener=null,h.location=d)}}}});F(this,"getTopLayerFrameAtSceneCoords",n=>{const i=this.scene.getNonDeletedElementsMap(),s=this.scene.getNonDeletedFramesLikes().filter(r=>!r.locked&&mA(n,r,i));return s.length?s[s.length-1]:null});F(this,"handleCanvasPointerMove",n=>{var m,p,U,b,y,v,_,I,R,T;this.savePointer(n.clientX,n.clientY,this.state.cursorButton),this.lastPointerMoveEvent=n.nativeEvent;const i=Dt(n,this.state),{x:s,y:r}=i;this.lastPointerMoveCoords={x:s,y:r},Et.pointers.has(n.pointerId)&&Et.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY});const o=Et.initialScale;if(Et.pointers.size===2&&Et.lastCenter&&o&&Et.initialDistance){const w=hL(Et.pointers),S=w.x-Et.lastCenter.x,x=w.y-Et.lastCenter.y;Et.lastCenter=w;const k=gL(Array.from(Et.pointers.values())),P=this.state.activeTool.type==="freedraw"&&this.state.penMode?1:k/Et.initialDistance,D=P?Ka(o*P):this.state.zoom.value;this.setState(j=>{const G=Hd({viewportX:w.x,viewportY:w.y,nextZoom:D},j);return this.translateCanvas({zoom:G.zoom,scrollX:G.scrollX+2*(S/D),scrollY:G.scrollY+2*(x/D),shouldCacheIgnoreZoom:!0}),null}),this.resetShouldCacheIgnoreZoomDebounced()}else Et.lastCenter=Et.initialDistance=Et.initialScale=null;if(_d||R1||K3||rg(this.state))return;const l=SL(L1,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop).isOverEither;if(!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.multiElement&&(l?Kr(this.interactiveCanvas):Ro(this.interactiveCanvas,this.state)),!this.state.newElement&&j3e(this.state.activeTool.type)){const{originOffset:w,snapLines:S}=X3e(this.scene.getNonDeletedElements(),this,{x:s,y:r},n,this.scene.getNonDeletedElementsMap());this.setState(x=>{const k=U1(x.snapLines,S),P=x.originSnapOffset?U1(x.originSnapOffset,w):w;return x.snapLines===k&&x.originSnapOffset===P?null:{snapLines:k,originSnapOffset:P}})}else!this.state.newElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.selectionElement&&this.setState(w=>w.snapLines.length?{snapLines:[]}:null);if((m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedLinearElement.isDragging){const w=this.state.newElement?null:re.handlePointerMoveInEditMode(n,s,r,this);w&&w!==this.state.selectedLinearElement&&cn.flushSync(()=>{this.setState({selectedLinearElement:w})})}if(wB(this.state.activeTool.type)){const{newElement:w}=this.state;if(!w&&Va(this.state)){const S=Ci(C(s,r),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),x=>nu(this.state.zoom));S?this.setState({suggestedBinding:S}):this.state.suggestedBinding&&this.setState({suggestedBinding:null})}}if(this.state.multiElement&&this.state.selectedLinearElement){const{multiElement:w,selectedLinearElement:S}=this.state,{x,y:k,points:P}=w,D=P[P.length-1],{lastCommittedPoint:j}=S;if(Ro(this.interactiveCanvas,this.state),D===j)_e(this.state.newElement)&&Va(this.state)&&Ci(C(s,r),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),V=>nu(this.state.zoom))?(this.actionManager.executeAction(Vs,"ui",{event:n.nativeEvent,sceneCoords:{x:s,y:r}}),this.setState({suggestedBinding:null,startBoundElement:null}),this.state.activeTool.locked||(Kr(this.interactiveCanvas),this.setState(V=>({newElement:null,activeTool:qt(this.state,{type:this.state.preferredSelectionTool.type}),selectedElementIds:vt({...V.selectedElementIds,[w.id]:!0},V),selectedLinearElement:new re(w,this.scene.getNonDeletedElementsMap())})))):Qe(C(s-x,r-k),D)>=B2?(this.scene.mutateElement(w,{points:[...P,C(s-x,r-k)]},{informMutation:!1,isDragging:!1}),xe((p=this.state.selectedLinearElement)==null?void 0:p.initialState,"initialState must be set"),this.setState({selectedLinearElement:{...this.state.selectedLinearElement,lastCommittedPoint:P[P.length-1],selectedPointsIndices:[w.points.length-1],initialState:{...this.state.selectedLinearElement.initialState,lastClickedPoint:w.points.length-1}}})):Ft(this.interactiveCanvas,Rt.POINTER);else if(P.length>2&&j&&Qe(C(s-x,r-k),j)<B2)Ft(this.interactiveCanvas,Rt.POINTER),this.scene.mutateElement(w,{points:P.slice(0,-1)},{informMutation:!1,isDragging:!1}),this.setState({selectedLinearElement:{...S,selectedPointsIndices:(U=S.selectedPointsIndices)!=null&&U.includes(w.points.length)?[...S.selectedPointsIndices.filter(G=>G!==w.points.length&&G!==w.points.length-1),w.points.length-1]:S.selectedPointsIndices,lastCommittedPoint:w.points[w.points.length-1],initialState:{...S.initialState,lastClickedPoint:w.points.length-1}}});else{sa(P,this.state.zoom.value)&&Ft(this.interactiveCanvas,Rt.POINTER);const G=this.scene.getNonDeletedElementsMap();if(M8(w)){const B=Ci(C(s,r),this.scene.getNonDeletedElements(),G);ki("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(w,B)}xe(this.state.selectedLinearElement,"Expected selectedLinearElement to be set to operate on a linear element");const V=re.handlePointerMove(n.nativeEvent,this,s,r,this.state.selectedLinearElement);V&&this.setState(V)}return}if(this.state.activeTool.type==="arrow"){const w=Ci(C(s,r),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),S=>nu(this.state.zoom));w&&!ml(C(s,r),w,this.scene.getNonDeletedElementsMap())&&this.setState({suggestedBinding:w})}if(!!n.buttons||this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="lasso"&&this.state.activeTool.type!=="text"&&this.state.activeTool.type!=="eraser")return;const d=this.scene.getNonDeletedElements(),u=this.scene.getSelectedElements(this.state);if(u.length===1&&!l&&!((b=this.state.selectedLinearElement)!=null&&b.isEditing)){if(this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,s,r),(!this.state.selectedLinearElement||this.state.selectedLinearElement.hoverPointIndex===-1)&&((y=this.state.openDialog)==null?void 0:y.name)!=="elementLinkSelector"&&!(u.length===1&&ye(u[0]))&&!(Ce(u[0])&&(this.editorInterface.userAgent.isMobileDevice||u[0].points.length===2))){const w=jA(d,this.state,s,r,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.editorInterface);if(w&&w.transformHandleType){Ft(this.interactiveCanvas,WA(w));return}}}else if(u.length>1&&!l&&((v=this.state.openDialog)==null?void 0:v.name)!=="elementLinkSelector"){const w=YA(pt(u),s,r,this.state.zoom,n.pointerType,this.editorInterface);if(w){Ft(this.interactiveCanvas,WA({transformHandleType:w}));return}}const f=this.getElementAtPosition(s,r,{preferSelected:!0,includeLockedElements:!0});let h=null;f&&f.locked?h=null:h=f,this.hitLinkElement=this.getElementLinkAtPosition(i,f),!Oo(this.state)&&(this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?(Ft(this.interactiveCanvas,Rt.POINTER),aEe(this.hitLinkElement,this.state,this.scene.getNonDeletedElementsMap())):(qR(),h&&(h.link||ds(h))&&this.state.selectedElementIds[h.id]&&!this.state.contextMenu&&!this.state.showHyperlinkPopup?this.setState({showHyperlinkPopup:"info"}):this.state.activeTool.type==="text"?Ft(this.interactiveCanvas,fe(h)?Rt.TEXT:Rt.CROSSHAIR):this.state.viewModeEnabled?Ft(this.interactiveCanvas,Rt.GRAB):((_=this.state.openDialog)==null?void 0:_.name)==="elementLinkSelector"?Ft(this.interactiveCanvas,Rt.AUTO):l?Ft(this.interactiveCanvas,Rt.AUTO):n[$.CTRL_OR_CMD]?Ft(this.interactiveCanvas,Rt.AUTO):(h||this.isHittingCommonBoundingBoxOfSelectedElements(i,u))&&!(h!=null&&h.locked)&&(h&&wr(h)&&this.isIframeLikeElementCenter(h,n,s,r)?(Ft(this.interactiveCanvas,Rt.POINTER),this.setState({activeEmbeddable:{element:h,state:"hover"}})):(!h||!ye(h)||!(h.startBinding||h.endBinding))&&((this.state.activeTool.type!=="lasso"||u.length>0)&&Ft(this.interactiveCanvas,Rt.MOVE),((I=this.state.activeEmbeddable)==null?void 0:I.state)==="hover"&&this.setState({activeEmbeddable:null}))),this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,s,r)),((R=this.state.openDialog)==null?void 0:R.name)==="elementLinkSelector"&&h?this.setState(w=>({hoveredElementIds:U1(w.hoveredElementIds,xi({editingGroupId:w.editingGroupId,selectedElementIds:{[h.id]:!0}},this.scene.getNonDeletedElements(),w,this).selectedElementIds)})):((T=this.state.openDialog)==null?void 0:T.name)==="elementLinkSelector"&&!h&&this.setState(w=>({hoveredElementIds:U1(w.hoveredElementIds,{})})))});F(this,"handleEraser",(n,i)=>{const s=this.eraserTrail.addPointToPath(i.x,i.y,n.altKey);this.elementsPendingErasure=new Set(s),this.triggerRender()});F(this,"handleTouchMove",n=>{D1=!0});F(this,"handleCanvasPointerDown",n=>{var m,p,U;const i=Dt(n,this.state),{x:s,y:r}=i;this.lastPointerMoveCoords={x:s,y:r};const o=n.target;if(o.setPointerCapture&&o.setPointerCapture(n.pointerId),this.maybeCleanupAfterMissingPointerUp(n.nativeEvent),this.maybeUnfollowRemoteUser(),this.state.searchMatches&&(this.setState(b=>({searchMatches:b.searchMatches&&{focusedId:null,matches:b.searchMatches.matches.map(y=>({...y,focus:!1}))}})),this.updateEditorAtom(UY,null)),Zs.get(Da)&&this.updateEditorAtom(Da,null),this.state.contextMenu&&this.setState({contextMenu:null}),this.state.snapLines&&this.setAppState({snapLines:[]}),this.state.openPopup&&this.setState({openPopup:null}),this.updateGestureOnPointerDown(n),n.pointerType==="touch"&&this.state.newElement&&this.state.newElement.type==="freedraw"){const b=this.state.newElement;this.updateScene({...b.points.length<10?{elements:this.scene.getElementsIncludingDeleted().filter(y=>y.id!==b.id)}:{},appState:{newElement:null,editingTextElement:null,startBoundElement:null,suggestedBinding:null,selectedElementIds:vt(Object.keys(this.state.selectedElementIds).filter(y=>y!==b.id).reduce((y,v)=>(y[v]=this.state.selectedElementIds[v],y),{}),this.state)},captureUpdate:((m=this.state.openDialog)==null?void 0:m.name)==="elementLinkSelector"?q.EVENTUALLY:q.NEVER});return}const a=document.getSelection();if(a!=null&&a.anchorNode&&a.removeAllRanges(),this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(n),!this.state.penDetected&&n.pointerType==="pen"&&this.setState(b=>({penMode:!0,penDetected:!0})),!this.editorInterface.isTouchScreen&&["pen","touch"].includes(n.pointerType)&&(this.editorInterface=z2(this.editorInterface,{isTouchScreen:!0})),R1||(this.lastPointerDownEvent=n,this.handleCanvasPanUsingWheelOrSpaceDrag(n)))return;if(this.setState({lastPointerDownWith:n.pointerType,cursorButton:"down"}),this.savePointer(n.clientX,n.clientY,"down"),n.button===Vl.ERASER&&this.state.activeTool.type!==ii.eraser){this.setState({activeTool:qt(this.state,{type:ii.eraser,lastActiveToolBeforeEraser:this.state.activeTool})},()=>{this.handleCanvasPointerDown(n);const b=()=>{y(),v==null||v(),Oo(this.state)&&this.setState({activeTool:qt(this.state,{...this.state.activeTool.lastActiveTool||{type:ii.selection},lastActiveToolBeforeEraser:null})})},y=tn(window,te.POINTER_UP,b,{once:!0});let v;requestAnimationFrame(()=>{v=this.missingPointerEventCleanupEmitter.once(b)})});return}if(n.button!==Vl.MAIN&&n.button!==Vl.TOUCH&&n.button!==Vl.ERASER||Et.pointers.size>1)return;const l=this.initialPointerDownState(n);if(this.setState({selectedElementsAreBeingDragged:!1}),this.handleDraggingScrollBar(n,l)||(this.clearSelectionIfNotUsingSelection(),this.updateBindingEnabledOnPointerMove(n),this.handleSelectionOnPointerDown(n,l))||!(!this.state.penMode||n.pointerType!=="touch"||this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"||this.state.activeTool.type==="text"||this.state.activeTool.type==="image"))return;if(this.state.activeTool.type==="lasso"){const b=l.hit.element&&this.isASelectedElement(l.hit.element);!l.hit.hasHitCommonBoundingBoxOfSelectedElements&&!l.resize.handleType&&!b&&(this.lassoTrail.startPath(l.origin.x,l.origin.y,n.shiftKey),l.drag.blockDragging=this.editorInterface.formFactor==="desktop"),this.editorInterface.formFactor!=="desktop"&&l.hit.element&&!b&&(this.setState(y=>{const v={...y.selectedElementIds,[l.hit.element.id]:!0},_=[];Object.keys(y.selectedElementIds).forEach(R=>{const T=this.scene.getElement(R);T&&_.push(T)});const I=l.hit.element;if(Ue(I))or(_,I.id).forEach(R=>{delete v[R.id]});else if(I.frameId)v[I.frameId]&&delete v[I.id];else{const R=I.groupIds,T=new Set(R.flatMap(w=>Lt(this.scene.getNonDeletedElements(),w)).filter(w=>Ue(w)).map(w=>w.id));T.size>0&&_.forEach(w=>{w.frameId&&T.has(w.frameId)&&(delete v[w.id],w.groupIds.flatMap(S=>Lt(this.scene.getNonDeletedElements(),S)).forEach(S=>{delete v[S.id]}))})}return{...xi({editingGroupId:y.editingGroupId,selectedElementIds:v},this.scene.getNonDeletedElements(),y,this),showHyperlinkPopup:I.link||ds(I)?"info":!1}}),l.hit.wasAddedToSelection=!0)}else this.state.activeTool.type==="text"?this.handleTextOnPointerDown(n,l):this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line"?this.handleLinearElementOnPointerDown(n,this.state.activeTool.type,l):this.state.activeTool.type==="freedraw"?this.handleFreeDrawElementOnPointerDown(n,this.state.activeTool.type,l):this.state.activeTool.type==="custom"?Ro(this.interactiveCanvas,this.state):this.state.activeTool.type===ii.frame||this.state.activeTool.type===ii.magicframe?this.createFrameElementOnPointerDown(l,this.state.activeTool.type):this.state.activeTool.type==="laser"?this.laserTrails.startPath(l.lastCoords.x,l.lastCoords.y):this.state.activeTool.type!=="eraser"&&this.state.activeTool.type!=="hand"&&this.state.activeTool.type!=="image"&&this.createGenericElementOnPointerDown(this.state.activeTool.type,l);(U=(p=this.props)==null?void 0:p.onPointerDown)==null||U.call(p,this.state.activeTool,l),this.onPointerDownEmitter.trigger(this.state.activeTool,l,n),this.state.activeTool.type==="eraser"&&this.eraserTrail.startPath(l.lastCoords.x,l.lastCoords.y);const d=this.onPointerMoveFromPointerDownHandler(l),u=this.onPointerUpFromPointerDownHandler(l),f=this.onKeyDownFromPointerDownHandler(l),h=this.onKeyUpFromPointerDownHandler(l);this.missingPointerEventCleanupEmitter.once(b=>u(b||n.nativeEvent)),(!this.state.viewModeEnabled||this.state.activeTool.type==="laser")&&(window.addEventListener(te.POINTER_MOVE,d),window.addEventListener(te.POINTER_UP,u),window.addEventListener(te.KEYDOWN,f),window.addEventListener(te.KEYUP,h),l.eventListeners.onMove=d,l.eventListeners.onUp=u,l.eventListeners.onKeyUp=h,l.eventListeners.onKeyDown=f)});F(this,"handleCanvasPointerUp",n=>{var a;ki("COMPLEX_BINDINGS")&&this.resetDelayedBindMode(),this.removePointer(n),this.lastPointerUpEvent=n;const i=Dt({clientX:n.clientX,clientY:n.clientY},this.state),{x:s,y:r}=i;this.lastPointerMoveCoords={x:s,y:r};const o=n.timeStamp-(((a=this.lastPointerDownEvent)==null?void 0:a.timeStamp)??0);if(this.editorInterface.formFactor==="phone"&&o<300){const l=this.getElementAtPosition(i.x,i.y);if(wr(l)&&this.isIframeLikeElementCenter(l,n,i.x,i.y)){this.handleEmbeddableCenterClick(l);return}}if(this.editorInterface.isTouchScreen){const l=this.getElementAtPosition(i.x,i.y,{includeLockedElements:!0});this.hitLinkElement=this.getElementLinkAtPosition(i,l)}this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?o<300&&wr(this.hitLinkElement)&&!lX(this.hitLinkElement,this.scene.getNonDeletedElementsMap(),this.state,C(i.x,i.y))?this.handleEmbeddableCenterClick(this.hitLinkElement):this.redirectToLink(n,this.editorInterface.isTouchScreen):this.state.viewModeEnabled&&this.setState({activeEmbeddable:null,selectedElementIds:{}})});F(this,"maybeOpenContextMenuAfterPointerDownOnTouchDevices",n=>{n.pointerType==="touch"&&(D1=!1,zl?D1=!0:zl=window.setTimeout(()=>{zl=0,D1||this.handleCanvasContextMenu(n)},Eee))});F(this,"resetContextMenuTimer",()=>{clearTimeout(zl),zl=0,D1=!1});F(this,"maybeCleanupAfterMissingPointerUp",n=>{wd==null||wd(),this.missingPointerEventCleanupEmitter.trigger(n).clear()});F(this,"handleCanvasPanUsingWheelOrSpaceDrag",n=>{if(!(Et.pointers.size<=1&&(n.button===Vl.WHEEL||n.button===Vl.MAIN&&_d||rg(this.state)||this.state.viewModeEnabled)))return!1;R1=!0,this.focusContainer(),this.state.editingTextElement||n.preventDefault();let i=!1;const s=typeof window===void 0?!1:/Linux/.test(window.navigator.platform);Ft(this.interactiveCanvas,Rt.GRABBING);let{clientX:r,clientY:o}=n;const a=P3(c=>{const d=r-c.clientX,u=o-c.clientY;if(r=c.clientX,o=c.clientY,s&&!i&&(Math.abs(d)>1||Math.abs(u)>1)){i=!0;const f=m=>{document.body.removeEventListener(te.PASTE,f),m.stopPropagation()},h=()=>{setTimeout(()=>{document.body.removeEventListener(te.PASTE,f),window.removeEventListener(te.POINTER_UP,h)},100)};document.body.addEventListener(te.PASTE,f),window.addEventListener(te.POINTER_UP,h)}this.translateCanvas({scrollX:this.state.scrollX-d/this.state.zoom.value,scrollY:this.state.scrollY-u/this.state.zoom.value})}),l=ln(wd=()=>{wd=null,R1=!1,_d||(this.state.viewModeEnabled?Ft(this.interactiveCanvas,Rt.GRAB):Ro(this.interactiveCanvas,this.state)),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,a),window.removeEventListener(te.POINTER_UP,l),window.removeEventListener(te.BLUR,l),a.flush()});return window.addEventListener(te.BLUR,l),window.addEventListener(te.POINTER_MOVE,a,{passive:!0}),window.addEventListener(te.POINTER_UP,l),!0});F(this,"clearSelectionIfNotUsingSelection",()=>{zU(this.state.activeTool.type)||this.setState({selectedElementIds:vt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})});F(this,"handleSelectionOnPointerDown",(n,i)=>{var s,r,o,a,l,c;if(zU(this.state.activeTool.type)){const d=this.scene.getNonDeletedElements(),u=this.scene.getNonDeletedElementsMap(),f=this.scene.getSelectedElements(this.state);if(f.length===1&&!((s=this.state.selectedLinearElement)!=null&&s.isEditing)&&!ye(f[0])&&!(Ce(f[0])&&(this.editorInterface.userAgent.isMobileDevice||f[0].points.length===2))&&!(this.state.selectedLinearElement&&this.state.selectedLinearElement.hoverPointIndex!==-1)){const h=jA(d,this.state,i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.editorInterface);h!=null&&(h.transformHandleType==="rotation"?(this.setState({resizingElement:h.element}),i.resize.handleType=h.transformHandleType):(this.state.croppingElementId||this.setState({resizingElement:h.element}),i.resize.handleType=h.transformHandleType))}else f.length>1&&(i.resize.handleType=YA(pt(f),i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.editorInterface));if(i.resize.handleType)i.resize.isResizing=!0,i.resize.offset=I8(soe(i.resize.handleType,f,u,i.origin.x,i.origin.y)),f.length===1&&Ce(f[0])&&f[0].points.length===2&&(i.resize.arrowDirection=roe(i.resize.handleType,f[0]));else{if(this.state.selectedLinearElement){const y=this.state.selectedLinearElement,v=re.handlePointerDown(n,this,this.store,i.origin,y,this.scene);if(v.hitElement&&(i.hit.element=v.hitElement),v.linearElementEditor&&this.setState({selectedLinearElement:v.linearElementEditor}),v.didAddPoint)return!0}const h=this.getElementsAtPosition(i.origin.x,i.origin.y,{includeLockedElements:!0}),m=h.filter(y=>!y.locked),p=this.getElementAtPosition(i.origin.x,i.origin.y,{allHitElements:h});if((!p||p.id!==this.state.activeLockedId)&&this.setState({activeLockedId:null}),p&&p.locked&&!m.some(y=>this.state.selectedElementIds[y.id])?i.hit.element=null:i.hit.element=i.hit.element??this.getElementAtPosition(i.origin.x,i.origin.y),this.hitLinkElement=this.getElementLinkAtPosition(i.origin,p),this.hitLinkElement)return!0;if(this.state.croppingElementId&&((r=i.hit.element)==null?void 0:r.id)!==this.state.croppingElementId&&this.finishImageCropping(),i.hit.element&&this.getElementLinkAtPosition({x:i.origin.x,y:i.origin.y},i.hit.element))return!1;i.hit.allHitElements=m;const U=i.hit.element,b=i.hit.allHitElements.some(y=>this.isASelectedElement(y));if((U===null||!b)&&!n.shiftKey&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&(!((o=this.state.selectedLinearElement)!=null&&o.isEditing)||U&&(U==null?void 0:U.id)!==((a=this.state.selectedLinearElement)==null?void 0:a.elementId))&&this.clearSelection(U),(l=this.state.selectedLinearElement)!=null&&l.isEditing)this.setState(y=>{var v;return{selectedLinearElement:y.selectedLinearElement?{...y.selectedLinearElement,isEditing:!!U&&U.id===((v=this.state.selectedLinearElement)==null?void 0:v.elementId)}:null,selectedElementIds:y.selectedLinearElement?vt({[y.selectedLinearElement.elementId]:!0},this.state):vt({},y)}});else if(U!=null){if(n[$.CTRL_OR_CMD])return n.altKey?(((c=this.state.openDialog)==null?void 0:c.name)==="elementLinkSelector"&&this.setOpenDialog(null),this.lassoTrail.startPath(i.origin.x,i.origin.y,n.shiftKey),this.setActiveTool({type:"lasso",fromSelection:!0}),!1):(this.state.selectedElementIds[U.id]||(i.hit.wasAddedToSelection=!0),this.setState(y=>({...dse(y,U),previousSelectedElementIds:this.state.selectedElementIds})),!1);this.state.selectedElementIds[U.id]||(this.state.editingGroupId&&!w0(U,this.state.editingGroupId)&&this.setState({selectedElementIds:vt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),!b&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&(this.setState(y=>{var I;let v={...y.selectedElementIds,[U.id]:!0};const _=[];if(Object.keys(y.selectedElementIds).forEach(R=>{const T=this.scene.getElement(R);T&&_.push(T)}),Ue(U))or(_,U.id).forEach(R=>{delete v[R.id]});else if(U.frameId)v[U.frameId]&&delete v[U.id];else{const R=U.groupIds,T=new Set(R.flatMap(w=>Lt(this.scene.getNonDeletedElements(),w)).filter(w=>Ue(w)).map(w=>w.id));T.size>0&&_.forEach(w=>{w.frameId&&T.has(w.frameId)&&(delete v[w.id],w.groupIds.flatMap(S=>Lt(this.scene.getNonDeletedElements(),S)).forEach(S=>{delete v[S.id]}))})}return((I=y.openDialog)==null?void 0:I.name)==="elementLinkSelector"&&(U.groupIds.some(R=>y.selectedGroupIds[R])||(v={[U.id]:!0})),{...xi({editingGroupId:y.editingGroupId,selectedElementIds:v},this.scene.getNonDeletedElements(),y,this),showHyperlinkPopup:U.link||ds(U)?"info":!1}}),i.hit.wasAddedToSelection=!0))}this.setState({previousSelectedElementIds:this.state.selectedElementIds})}}return!1});F(this,"handleTextOnPointerDown",(n,i)=>{if(this.state.editingTextElement)return;let s=i.origin.x,r=i.origin.y;const o=this.getElementAtPosition(s,r,{includeBoundTextElement:!0});let a=this.getTextBindableContainerAtPosition(s,r);Fi(o)&&(a=o,s=o.x+o.width/2,r=o.y+o.height/2),this.startTextEditing({sceneX:s,sceneY:r,insertAtParentCenter:!n.altKey,container:a,autoEdit:!1}),Kr(this.interactiveCanvas),this.state.activeTool.locked||this.setState({activeTool:qt(this.state,{type:this.state.preferredSelectionTool.type})})});F(this,"handleFreeDrawElementOnPointerDown",(n,i,s)=>{const[r,o]=ti(s.origin.x,s.origin.y,null),a=this.getTopLayerFrameAtSceneCoords({x:r,y:o}),l=n.pressure===.5,c=Dre({type:i,x:r,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:null,simulatePressure:l,locked:!1,frameId:a?a.id:null,points:[C(0,0)],pressures:l?[]:[n.pressure]});this.scene.insertElement(c),this.setState(u=>{const f={...u.selectedElementIds};return delete f[c.id],{selectedElementIds:vt(f,u)}});const d=Ci(C(s.origin.x,s.origin.y),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());this.setState({newElement:c,startBoundElement:d,suggestedBinding:null})});F(this,"insertIframeElement",({sceneX:n,sceneY:i,width:s,height:r})=>{var c;const[o,a]=ti(n,i,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=kre({type:"iframe",x:o,y:a,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("iframe"),opacity:this.state.currentItemOpacity,locked:!1,width:s,height:r});return this.scene.insertElement(l),l});F(this,"insertEmbeddableElement",({sceneX:n,sceneY:i,link:s})=>{var c;const[r,o]=ti(n,i,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=Jf(s);if(!a)return;a.error instanceof URIError&&this.setToast({message:M("toast.unrecognizedLinkFormat"),closable:!0});const l=PA({type:"embeddable",x:r,y:o,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("embeddable"),opacity:this.state.currentItemOpacity,locked:!1,width:a.intrinsicSize.w,height:a.intrinsicSize.h,link:s});return this.scene.insertElement(l),l});F(this,"newImagePlaceholder",({sceneX:n,sceneY:i,addToFrameUnderCursor:s=!0})=>{var c;const[r,o]=ti(n,i,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=s?this.getTopLayerFrameAtSceneCoords({x:r,y:o}):null,l=100/this.state.zoom.value;return Az({type:"image",strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:null,opacity:this.state.currentItemOpacity,locked:!1,frameId:a?a.id:null,x:r-l/2,y:o-l/2,width:l,height:l})});F(this,"handleLinearElementOnPointerDown",(n,i,s)=>{var r,o;if(n.ctrlKey&&cn.flushSync(()=>{this.setState({isBindingEnabled:!1})}),this.state.multiElement){const{multiElement:a,selectedLinearElement:l}=this.state;if(xe(l,"selectedLinearElement is expected to be set"),a.type==="line"&&sa(a.points,this.state.zoom.value)){cn.flushSync(()=>{this.setState({selectedLinearElement:{...l,lastCommittedPoint:a.points[a.points.length-1],initialState:{...l.initialState,lastClickedPoint:-1}}})}),this.actionManager.executeAction(Vs);return}if(ye(a)&&a.points.length>1){this.actionManager.executeAction(Vs,"ui",{event:n.nativeEvent,sceneCoords:{x:s.origin.x,y:s.origin.y}});return}const{x:c,y:d}=a,{lastCommittedPoint:u}=l,f=Va(this.state)&&Ci(C(((r=this.lastPointerMoveCoords)==null?void 0:r.x)??c+a.points[a.points.length-1][0],((o=this.lastPointerMoveCoords)==null?void 0:o.y)??d+a.points[a.points.length-1][1]),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());if(dn(a)&&f||a.points.length>1&&u&&Qe(C(s.origin.x-c,s.origin.y-d),u)<B2){this.actionManager.executeAction(Vs,"ui",{event:n.nativeEvent,sceneCoords:{x:s.origin.x,y:s.origin.y}});return}this.setState(h=>({selectedElementIds:vt({...h.selectedElementIds,[a.id]:!0},h)})),Ft(this.interactiveCanvas,Rt.POINTER)}else{const[a,l]=ti(s.origin.x,s.origin.y,n[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),c=this.getTopLayerFrameAtSceneCoords({x:a,y:l}),{currentItemStartArrowhead:d,currentItemEndArrowhead:u}=this.state,[f,h]=i==="arrow"?[d,u]:[null,null],m=i==="arrow"?ph({type:i,x:a,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemArrowType===Dn.round?{type:En.PROPORTIONAL_RADIUS}:null,startArrowhead:f,endArrowhead:h,locked:!1,frameId:c?c.id:null,elbowed:this.state.currentItemArrowType===Dn.elbow,fixedSegments:this.state.currentItemArrowType===Dn.elbow?[]:null}):Sc({type:i,x:a,y:l,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemRoundness==="round"?{type:En.PROPORTIONAL_RADIUS}:null,locked:!1,frameId:c?c.id:null}),p=C(s.origin.x,s.origin.y),U=this.scene.getNonDeletedElementsMap(),b=Va(this.state)?Ci(p,this.scene.getNonDeletedElements(),U):null;this.scene.mutateElement(m,{points:[C(0,0),C(0,0)]}),this.scene.insertElement(m),dn(m)&&ty(m,new Map([[0,{point:C(0,0),isDragging:!1}]]),this.scene,this.state,{newArrow:!0,altKey:n.altKey,initialBinding:!0,angleLocked:ic(n.nativeEvent)}),cn.flushSync(()=>{this.setState(y=>{let v=null,_=y.selectedElementIds;if(Ce(m)){v=new re(m,this.scene.getNonDeletedElementsMap());const I=m.points.length-1;v={...v,selectedPointsIndices:[I],initialState:{...v.initialState,lastClickedPoint:I,origin:C(s.origin.x,s.origin.y)}}}return _=this.state.activeTool.locked?y.selectedElementIds:vt({[m.id]:!0},y),{...y,bindMode:"orbit",newElement:m,startBoundElement:b,suggestedBinding:b||null,selectedElementIds:_,selectedLinearElement:v}})}),dn(m)&&ki("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(m,b)}});F(this,"createGenericElementOnPointerDown",(n,i)=>{var c;const[s,r]=ti(i.origin.x,i.origin.y,(c=this.lastPointerDownEvent)!=null&&c[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o=this.getTopLayerFrameAtSceneCoords({x:s,y:r}),a={x:s,y:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.getCurrentItemRoundness(n),locked:!1,frameId:o?o.id:null};let l;n==="embeddable"?l=PA({type:"embeddable",...a}):l=aa({type:n,...a}),l.type==="selection"?this.setState({selectionElement:l}):(this.scene.insertElement(l),this.setState({multiElement:null,newElement:l}))});F(this,"createFrameElementOnPointerDown",(n,i)=>{var l;const[s,r]=ti(n.origin.x,n.origin.y,(l=this.lastPointerDownEvent)!=null&&l[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o={x:s,y:r,opacity:this.state.currentItemOpacity,locked:!1,...mt},a=i===ii.magicframe?C4(o):mw(o);this.scene.insertElement(a),this.setState({multiElement:null,newElement:a})});F(this,"restoreReadyToEraseElements",()=>{this.elementsPendingErasure=new Set,this.triggerRender()});F(this,"eraseElements",()=>{let n=!1;this.elementsPendingErasure.forEach(s=>{var o;const r=this.scene.getElement(s);if(dn(r)){if(r.startBinding){const a=this.scene.getElement(r.startBinding.elementId);Cn(a,this.scene.getElementsMapIncludingDeleted(),{boundElements:a.boundElements.filter(l=>l.id!==r.id)})}if(r.endBinding){const a=this.scene.getElement(r.endBinding.elementId);Cn(a,this.scene.getElementsMapIncludingDeleted(),{boundElements:a.boundElements.filter(l=>l.id!==r.id)})}}else Lr(r)&&((o=r.boundElements)==null||o.forEach(a=>{var l,c;if(a.type==="arrow"){const d=this.scene.getElement(a.id);((l=d==null?void 0:d.startBinding)==null?void 0:l.elementId)===r.id&&Cn(d,this.scene.getElementsMapIncludingDeleted(),{startBinding:null}),((c=d==null?void 0:d.endBinding)==null?void 0:c.elementId)===r.id&&Cn(d,this.scene.getElementsMapIncludingDeleted(),{endBinding:null})}}))});const i=this.scene.getElementsIncludingDeleted().map(s=>this.elementsPendingErasure.has(s.id)||s.frameId&&this.elementsPendingErasure.has(s.frameId)||Nt(s)&&this.elementsPendingErasure.has(s.containerId)?(n=!0,Te(s,{isDeleted:!0})):s);this.elementsPendingErasure=new Set,n&&(this.store.scheduleCapture(),this.scene.replaceAllElements(i))});F(this,"initializeImage",async(n,i)=>{var l,c,d;if(!V0(i))throw new Error(M("errors.unsupportedFileType"));const s=i.type;if(Ft(this.interactiveCanvas,"wait"),s===ve.svg)try{i=BR(VA(await i.text()),i.name)}catch(u){throw console.warn(u),new Error(M("errors.svgImageInsertError"))}const r=await(((c=(l=this.props).generateIdForFile)==null?void 0:c.call(l,i))||oye(i));if(!r)throw console.warn("Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one."),new Error(M("errors.imageInsertError"));const o=this.files[r];if(!(o!=null&&o.dataURL)){try{i=await _X(i,{maxWidthOrHeight:Tee})}catch(u){console.error("Error trying to resizing image file on insertion",u)}if(i.size>kC)throw new Error(M("errors.fileTooBig",{maxSize:`${Math.trunc(kC/1024/1024)}MB`}))}const a=((d=this.files[r])==null?void 0:d.dataURL)||await vX(i);return new Promise(async(u,f)=>{var h,m;try{let p=this.getLatestInitializedImageElement(n,r);if(this.addMissingFiles([{mimeType:s,id:r,dataURL:a,created:Date.now(),lastRetrieved:Date.now()}]),!this.imageCache.get(r)){this.addNewImagesToImageCache();const{erroredFiles:b}=await this.updateImageCache([p]);if(b.size)throw new Error("Image cache update resulted with an error.")}const U=await((h=this.imageCache.get(r))==null?void 0:h.image);if(U&&((m=this.state.newElement)==null?void 0:m.id)!==p.id){p=this.getLatestInitializedImageElement(n,r);const b=this.getImageNaturalDimensions(p,U);Object.assign(p,b)}u(p)}catch(p){console.error(p),f(new Error(M("errors.imageInsertError")))}})});F(this,"getLatestInitializedImageElement",(n,i)=>{const s=this.scene.getElement(n.id)??n;return Te(s,{fileId:i})});F(this,"onImageToolbarButtonClick",async()=>{try{const n=this.state.width/2+this.state.offsetLeft,i=this.state.height/2+this.state.offsetTop,{x:s,y:r}=Dt({clientX:n,clientY:i},this.state),o=await AT({description:"Image",extensions:Object.keys(Oh),multiple:!0});this.insertImages(o,s,r)}catch(n){n.name!=="AbortError"?console.error(n):console.warn(n),this.setState({newElement:null,activeTool:qt(this.state,{type:this.state.preferredSelectionTool.type})},()=>{this.actionManager.executeAction(Vs)})}});F(this,"getImageNaturalDimensions",(n,i)=>{const s=Math.max(this.state.height-120,160),r=Math.min(s,Math.floor(this.state.height*.5)/this.state.zoom.value),o=Math.min(i.naturalHeight,r),a=o*(i.naturalWidth/i.naturalHeight),l=n.x+n.width/2-a/2,c=n.y+n.height/2-o/2;return{x:l,y:c,width:a,height:o,crop:null}});F(this,"updateImageCache",async(n,i=this.files)=>{const{updatedFiles:s,erroredFiles:r}=await Lz({imageCache:this.imageCache,fileIds:n.map(o=>o.fileId),files:i});return r.size&&(this.store.scheduleAction(q.NEVER),this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().map(o=>On(o)&&r.has(o.fileId)?Te(o,{status:"error"}):o))),{updatedFiles:s,erroredFiles:r}});F(this,"addNewImagesToImageCache",async(n=Dz(this.scene.getNonDeletedElements()),i=this.files)=>{const s=n.filter(r=>!r.isDeleted&&!this.imageCache.has(r.fileId));if(s.length){const{updatedFiles:r}=await this.updateImageCache(s,i);if(r.size)for(const o of s)r.has(o.fileId)&&sn.delete(o);r.size&&this.scene.triggerUpdate()}});F(this,"scheduleImageRefresh",jo(()=>{this.addNewImagesToImageCache()},bee));F(this,"updateBindingEnabledOnPointerMove",n=>{const i=Hie(n);this.state.isBindingEnabled!==i&&this.setState({isBindingEnabled:i})});F(this,"handleInteractiveCanvasRef",n=>{var i,s;n!==null?(this.interactiveCanvas=n,this.interactiveCanvas.addEventListener(te.TOUCH_START,this.onTouchStart,{passive:!1}),this.interactiveCanvas.addEventListener(te.TOUCH_END,this.onTouchEnd)):((i=this.interactiveCanvas)==null||i.removeEventListener(te.TOUCH_START,this.onTouchStart),(s=this.interactiveCanvas)==null||s.removeEventListener(te.TOUCH_END,this.onTouchEnd))});F(this,"insertImages",async(n,i,s)=>{const r=50/this.state.zoom.value,o=$A(n.map(()=>this.newImagePlaceholder({sceneX:i,sceneY:s})),i,s,r);o.forEach(f=>this.scene.insertElement(f));const a=await Promise.all(o.map(async(f,h)=>{try{return await this.initializeImage(f,await G0(n[h]))}catch(m){return this.setState({errorMessage:m.message||M("errors.imageInsertError")}),Te(f,{isDeleted:!0})}})),l=be(a),c=$A(a.filter(f=>!f.isDeleted),i,s,r),d=be(c),u=this.scene.getElementsIncludingDeleted().map(f=>d.get(f.id)??l.get(f.id)??f);this.updateScene({appState:{selectedElementIds:vt(Object.fromEntries(c.map(f=>[f.id,!0])),this.state)},elements:u,captureUpdate:q.IMMEDIATELY}),this.setState({},()=>{this.actionManager.executeAction(Vs)})});F(this,"handleAppOnDrop",async n=>{var u;const{x:i,y:s}=Dt(n,this.state),r=await Iv(n),o=r.getFiles();if(o.length===1){const{file:f,fileHandle:h}=o[0];if(f&&(f.type===ve.png||f.type===ve.svg))try{const m=await PT(f,this.state,this.scene.getElementsIncludingDeleted(),h);this.syncActionResult({...m,appState:{...m.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:q.IMMEDIATELY});return}catch(m){if(m.name!=="EncodingError")throw new Error(M("alerts.couldNotLoadInvalidFile"))}}const a=o.map(f=>f.file).filter(f=>V0(f));if(a.length>0&&this.isToolSupported("image"))return this.insertImages(a,i,s);const l=r.getData(ve.excalidrawlibIds),c=r.getData(ve.excalidrawlib);if(l||c){try{let f=null;if(l){const{itemIds:h}=JSON.parse(l);f=(await this.library.getLatestLibrary()).filter(p=>h.includes(p.id))}else c&&(f=EX(c));f!=null&&f.length&&(f=f.map(h=>({...h,elements:Rm({type:"everything",elements:h.elements,randomizeSeed:!0}).duplicatedElements})),this.addElementsFromPasteOrLibrary({elements:VT(f),position:n,files:null}))}catch(f){this.setState({errorMessage:f.message})}return}if(o.length>0){const{file:f,fileHandle:h}=o[0];f&&await this.loadFileToCanvas(f,h)}const d=r.findByType(ve.text);if(d){const f=d.value;if(f&&Y2(f,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(f)||((u=Jf(f))==null?void 0:u.type)==="video")){const h=this.insertEmbeddableElement({sceneX:i,sceneY:s,link:rr(f)});h&&(this.store.scheduleCapture(),this.setState({selectedElementIds:{[h.id]:!0}}))}}});F(this,"loadFileToCanvas",async(n,i)=>{n=await G0(n);try{const s=this.scene.getElementsIncludingDeleted();let r;try{r=await yX(n,this.state,s,i)}catch(o){const a=o instanceof zd;if(a&&o.code==="IMAGE_NOT_CONTAINS_SCENE_DATA"&&!this.isToolSupported("image")){this.setState({isLoading:!1,errorMessage:M("errors.imageToolNotSupported")});return}const l=M(a?"alerts.cannotRestoreFromImage":"alerts.couldNotLoadInvalidFile");this.setState({isLoading:!1,errorMessage:l})}if(!r)return;r.type===ve.excalidraw?(fd(s.concat(r.data.elements)),this.store.scheduleMicroAction({action:q.NEVER,elements:s,appState:void 0}),this.setState({isLoading:!0}),this.syncActionResult({...r.data,appState:{...r.data.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:q.IMMEDIATELY})):r.type===ve.excalidrawlib&&await this.library.updateLibrary({libraryItems:n,merge:!0,openLibraryMenu:!0}).catch(o=>{console.error(o),this.setState({errorMessage:M("errors.importLibraryError")})})}catch(s){this.setState({isLoading:!1,errorMessage:s.message})}});F(this,"handleCanvasContextMenu",n=>{if(n.preventDefault(),("pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="touch"||"pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="pen"&&n.button!==Vl.SECONDARY)&&this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const{x:i,y:s}=Dt(n,this.state),r=this.getElementAtPosition(i,s,{preferSelected:!0,includeLockedElements:!0}),o=this.scene.getSelectedElements(this.state),a=this.isHittingCommonBoundingBoxOfSelectedElements({x:i,y:s},o),l=r||a?"element":"canvas",c=this.excalidrawContainerRef.current,{top:d,left:u}=c.getBoundingClientRect(),f=n.clientX-u,h=n.clientY-d;it("contextMenu","openContextMenu",l),this.setState({...r&&!this.state.selectedElementIds[r.id]?{...this.state,...xi({editingGroupId:this.state.editingGroupId,selectedElementIds:{[r.id]:!0}},this.scene.getNonDeletedElements(),this.state,this),selectedLinearElement:Ce(r)?new re(r,this.scene.getNonDeletedElementsMap()):null}:this.state,showHyperlinkPopup:!1},()=>{this.setState({contextMenu:{top:h,left:f,items:this.getContextMenuItems(l)}})})});F(this,"maybeDragNewGenericElement",(n,i,s=!0)=>{var m,p,U;const r=this.state.selectionElement,o=n.lastCoords;if(r&&n.boxSelection.hasOccurred&&this.state.activeTool.type!=="eraser"){DA({newElement:r,elementType:this.state.activeTool.type,originX:n.origin.x,originY:n.origin.y,x:o.x,y:o.y,width:Ki(n.origin.x,o.x),height:Ki(n.origin.y,o.y),shouldMaintainAspectRatio:m1(i),shouldResizeFromCenter:!1,scene:this.scene,zoom:this.state.zoom.value,informMutation:!1});return}const a=this.state.newElement;if(!a)return;let[l,c]=ti(o.x,o.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const d=On(a)&&((m=this.imageCache.get(a.fileId))==null?void 0:m.image),u=d&&!(d instanceof Promise)?d.width/d.height:null;this.maybeCacheReferenceSnapPoints(i,[a]);const{snapOffset:f,snapLines:h}=G3e(a,this,i,{x:n.originInGrid.x+(((p=this.state.originSnapOffset)==null?void 0:p.x)??0),y:n.originInGrid.y+(((U=this.state.originSnapOffset)==null?void 0:U.y)??0)},{x:l-n.originInGrid.x,y:c-n.originInGrid.y},this.scene.getNonDeletedElementsMap());l+=f.x,c+=f.y,this.setState({snapLines:h}),dn(a)||DA({newElement:a,elementType:this.state.activeTool.type,originX:n.originInGrid.x,originY:n.originInGrid.y,x:l,y:c,width:Ki(n.originInGrid.x,l),height:Ki(n.originInGrid.y,c),shouldMaintainAspectRatio:wt(a)?!m1(i):m1(i),shouldResizeFromCenter:RC(i),zoom:this.state.zoom.value,scene:this.scene,widthAspectRatio:u,originOffset:this.state.originSnapOffset,informMutation:s}),this.setState({newElement:a}),(this.state.activeTool.type===ii.frame||this.state.activeTool.type===ii.magicframe)&&this.setState({elementsToHighlight:Qo(this.scene.getNonDeletedElements(),a,this.state,this.scene.getNonDeletedElementsMap())})});F(this,"maybeHandleCrop",(n,i)=>{var c;if(!this.state.croppingElementId)return!1;const s=n.resize.handleType,r=n.lastCoords,[o,a]=ti(r.x-n.resize.offset.x,r.y-n.resize.offset.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(s&&l&&wt(l)){const d=n.originalElements.get(l.id),u=On(l)&&((c=this.imageCache.get(l.fileId))==null?void 0:c.image);if(d&&wt(d)&&u&&!(u instanceof Promise)){const[f,h]=ti(r.x,r.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),m={x:f-n.originInGrid.x,y:h-n.originInGrid.y};this.maybeCacheReferenceSnapPoints(i,[l]);const{snapOffset:p,snapLines:U}=yL([l],[d],this,i,m,s);this.scene.mutateElement(l,Vne(l,this.scene.getNonDeletedElementsMap(),s,u.naturalWidth,u.naturalHeight,o+p.x,a+p.y,i.shiftKey?d.width/d.height:void 0)),ps(l,this.scene),this.setState({isCropping:s&&s!=="rotation",snapLines:U})}return!0}return!1});F(this,"maybeHandleResize",(n,i)=>{const s=this.scene.getSelectedElements(this.state),r=s.filter(u=>Ue(u)),o=n.resize.handleType;if(r.length>0&&o==="rotation"||s.length===1&&ye(s[0])||this.state.croppingElementId)return!1;this.setState({isResizing:o&&o!=="rotation",isRotating:o==="rotation",activeEmbeddable:null});const a=n.lastCoords;let[l,c]=ti(a.x-n.resize.offset.x,a.y-n.resize.offset.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const d=new Map;if(r.forEach(u=>{or(this.scene.getNonDeletedElements(),u.id).forEach(h=>{d.set(u.id+h.id,{x:h.x-u.x,y:h.y-u.y})})}),!this.state.selectedElementsAreBeingDragged){const[u,f]=ti(a.x,a.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),h={x:u-n.originInGrid.x,y:f-n.originInGrid.y},m=[...n.originalElements.values()];this.maybeCacheReferenceSnapPoints(i,s);const{snapOffset:p,snapLines:U}=yL(s,Ye(m,this.state),this,i,h,o);l+=p.x,c+=p.y,this.setState({snapLines:U})}if(eoe(n.originalElements,o,s,this.scene,ic(i),RC(i),s.some(u=>wt(u))?!m1(i):m1(i),l,c,n.resize.center.x,n.resize.center.y)){const u=new Set;return r.forEach(f=>{Qo(this.scene.getNonDeletedElements(),f,this.state,this.scene.getNonDeletedElementsMap()).forEach(h=>u.add(h))}),this.setState({elementsToHighlight:[...u]}),!0}return!1});F(this,"getContextMenuItems",n=>{const i=[];if(i.push(YR,jR),n==="canvas")return this.state.viewModeEnabled?[...i,KR,xv,Ov,Cv]:[GR,ni,YR,jR,WR,ni,ohe,dEe,ni,KR,Qye,xv,Ov,Cv];if(i.push(WR),this.state.viewModeEnabled)return[ub,...i];const s=this.editorInterface.formFactor==="desktop"?[ni,nhe,ihe,she,rhe]:[];return[ni,XR,ub,GR,ni,A3e,M3e,k3e,ni,C3e,ni,...i,ni,zye,Hye,ni,$ye,D3e,Jye,eEe,iEe,Gye,ni,Wye,...s,ni,Kye,Zye,ni,m2,ni,NX,VX,ni,ahe,OX,ni,KV]});F(this,"handleWheel",ln(n=>{if(!(n.target instanceof HTMLCanvasElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLIFrameElement||n.target instanceof HTMLElement&&n.target.classList.contains(bs.FRAME_NAME))){n[$.CTRL_OR_CMD]&&n.preventDefault();return}if(n.preventDefault(),R1)return;const{deltaX:i,deltaY:s}=n;if(n.metaKey||n.ctrlKey){const r=Math.sign(s),o=X5*100,a=Math.abs(s);let l=s;a>o&&(l=o*r);let c=this.state.zoom.value-l/100;c+=Math.log10(Math.max(1,this.state.zoom.value))*-r*Math.min(1,a/20),this.translateCanvas(d=>({...Hd({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:Ka(c)},d),shouldCacheIgnoreZoom:!0})),this.resetShouldCacheIgnoreZoomDebounced();return}if(n.shiftKey){this.translateCanvas(({zoom:r,scrollX:o})=>({scrollX:o-(s||i)/r.value}));return}this.translateCanvas(({zoom:r,scrollX:o,scrollY:a})=>({scrollX:o-i/r.value,scrollY:a-s/r.value}))}));F(this,"savePointer",(n,i,s)=>{var l,c;if(!n||!i)return;const{x:r,y:o}=Dt({clientX:n,clientY:i},this.state),a={x:r,y:o,tool:this.state.activeTool.type==="laser"?"laser":"pointer"};(c=(l=this.props).onPointerUpdate)==null||c.call(l,{pointer:a,button:s,pointersMap:Et.pointers})});F(this,"resetShouldCacheIgnoreZoomDebounced",ul(()=>{this.unmounted||this.setState({shouldCacheIgnoreZoom:!1})},300));F(this,"updateDOMRect",n=>{var i;if((i=this.excalidrawContainerRef)!=null&&i.current){const s=this.excalidrawContainerRef.current,{width:r,height:o,left:a,top:l}=s.getBoundingClientRect(),{width:c,height:d,offsetTop:u,offsetLeft:f}=this.state;if(r===c&&o===d&&a===f&&l===u){n&&n();return}this.setState({width:r,height:o,offsetLeft:a,offsetTop:l},()=>{n&&n()})}});F(this,"refresh",()=>{this.setState({...this.getCanvasOffsets()})});F(this,"watchState",()=>{});const i=da(),{excalidrawAPI:s,viewModeEnabled:r=!1,zenModeEnabled:o=!1,gridModeEnabled:a=!1,objectsSnapModeEnabled:l=!1,theme:c=i.theme,name:d=`${M("labels.untitled")}-${OC()}`}=n;if(this.state={...i,theme:c,isLoading:!0,...this.getCanvasOffsets(),viewModeEnabled:r,zenModeEnabled:o,objectsSnapModeEnabled:l,gridModeEnabled:a??i.gridModeEnabled,name:d,width:window.innerWidth,height:window.innerHeight},this.refreshEditorInterface(),this.stylesPanelMode=Sm(this.editorInterface),this.id=MH(),this.library=new i8e(this),this.actionManager=new P3e(this.syncActionResult,()=>this.state,()=>this.scene.getElementsIncludingDeleted(),this),this.scene=new T6,this.canvas=document.createElement("canvas"),this.rc=ld.canvas(this.canvas),this.renderer=new vL(this.scene),this.visibleElements=[],this.store=new Qse(this),this.history=new Gd(this.store),s){const u={updateScene:this.updateScene,applyDeltas:this.applyDeltas,mutateElement:this.mutateElement,updateLibrary:this.library.updateLibrary,addFiles:this.addFiles,resetScene:this.resetScene,getSceneElementsIncludingDeleted:this.getSceneElementsIncludingDeleted,getSceneElementsMapIncludingDeleted:this.getSceneElementsMapIncludingDeleted,history:{clear:this.resetHistory},scrollToContent:this.scrollToContent,getSceneElements:this.getSceneElements,getAppState:()=>this.state,getFiles:()=>this.files,getName:this.getName,registerAction:f=>{this.actionManager.registerAction(f)},refresh:this.refresh,setToast:this.setToast,id:this.id,setActiveTool:this.setActiveTool,setCursor:this.setCursor,resetCursor:this.resetCursor,getEditorInterface:()=>this.editorInterface,updateFrameRendering:this.updateFrameRendering,toggleSidebar:this.toggleSidebar,onChange:f=>this.onChangeEmitter.on(f),onIncrement:f=>this.store.onStoreIncrementEmitter.on(f),onPointerDown:f=>this.onPointerDownEmitter.on(f),onPointerUp:f=>this.onPointerUpEmitter.on(f),onScrollChange:f=>this.onScrollChangeEmitter.on(f),onUserFollow:f=>this.onUserFollowEmitter.on(f)};typeof s=="function"?s(u):console.error("excalidrawAPI should be a function!")}this.excalidrawContainerValue={container:this.excalidrawContainerRef.current,id:this.id},this.fonts=new rl(this.scene),this.history=new Gd(this.store),this.actionManager.registerAll(dv),this.actionManager.registerAction(R3e(this.history)),this.actionManager.registerAction(L3e(this.history))}onWindowMessage(n){if(n.origin!=="https://player.vimeo.com"&&n.origin!=="https://www.youtube.com")return;let i=null;try{i=JSON.parse(n.data)}catch{}if(i)switch(n.origin){case"https://player.vimeo.com":if(i.method==="paused"){let s=null;const r=document.body.querySelectorAll("iframe.excalidraw__embeddable");if(!r)break;for(const o of r)o.contentWindow===n.source&&(s=o.contentWindow);s==null||s.postMessage(JSON.stringify({method:i.value?"play":"pause",value:!0}),"*")}break;case"https://www.youtube.com":if(i.event==="infoDelivery"&&i.info&&i.id&&typeof i.info.playerState=="number"){const s=i.id,r=i.info.playerState;Object.values(NU).includes(r)&&Z3.set(s,r)}break}}handleSkipBindMode(){var n,i,s,r;if((n=this.state.selectedLinearElement)!=null&&n.initialState&&!this.state.selectedLinearElement.initialState.arrowStartIsInside){xe(this.lastPointerMoveCoords,"Missing last pointer move coords when changing bind skip mode for arrow start");const o=this.scene.getNonDeletedElementsMap(),a=Ci(C(this.lastPointerMoveCoords.x,this.lastPointerMoveCoords.y),this.scene.getNonDeletedElements(),o),l=re.getElement(this.state.selectedLinearElement.elementId,o);l!=null&&l.startBinding&&(a==null?void 0:a.id)===l.startBinding.elementId&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,initialState:{...this.state.selectedLinearElement.initialState,arrowStartIsInside:!0}}})}if(this.state.bindMode==="orbit"&&(this.bindModeHandler&&(clearTimeout(this.bindModeHandler),this.bindModeHandler=null),cn.flushSync(()=>{this.setState({bindMode:"skip"})}),this.lastPointerMoveCoords&&((i=this.state.selectedLinearElement)!=null&&i.selectedPointsIndices)&&((s=this.state.selectedLinearElement)!=null&&s.selectedPointsIndices.length))){const{x:o,y:a}=this.lastPointerMoveCoords,l=this.lastPointerMoveEvent??((r=this.lastPointerDownEvent)==null?void 0:r.nativeEvent);xe(l,"Last event must exist");const c=o-this.state.selectedLinearElement.pointerOffset.x,d=a-this.state.selectedLinearElement.pointerOffset.y,u=this.state.multiElement?re.handlePointerMove(l,this,c,d,this.state.selectedLinearElement):re.handlePointDragging(l,this,c,d,this.state.selectedLinearElement);u&&this.setState(u)}}resetDelayedBindMode(){this.bindModeHandler&&(clearTimeout(this.bindModeHandler),this.bindModeHandler=null),this.state.bindMode!=="orbit"&&setTimeout(()=>this.setState({bindMode:"orbit"}))}handleDelayedBindModeChange(n,i){var u,f,h,m,p,U,b,y,v,_,I,R,T;if(n.isDeleted||ye(n))return;const s=()=>{var k,P,D;if(this.bindModeHandler=null,xe(this.lastPointerMoveCoords,"Expected lastPointerMoveCoords to be set"),!this.state.multiElement){if(!this.state.selectedLinearElement||!this.state.selectedLinearElement.selectedPointsIndices||!this.state.selectedLinearElement.selectedPointsIndices.length)return;const j=this.state.selectedLinearElement.selectedPointsIndices.includes(0),G=this.state.selectedLinearElement.selectedPointsIndices.includes(n.points.length-1);if(!j&&!G||j&&G)return}const{x:w,y:S}=this.lastPointerMoveCoords,x=Ci(C(w,S),this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap());if(x&&this.state.bindMode!=="skip"){xe(((k=this.state.selectedLinearElement)==null?void 0:k.elementId)===n.id,"The selectedLinearElement is expected to not change while a bind mode timeout is ticking");const j=this.state.selectedLinearElement.initialState.arrowStartIsInside||((P=n.startBinding)==null?void 0:P.elementId)===x.id;cn.flushSync(()=>{xe(this.state.selectedLinearElement,"this.state.selectedLinearElement must exist"),this.setState({bindMode:"inside",selectedLinearElement:{...this.state.selectedLinearElement,initialState:{...this.state.selectedLinearElement.initialState,arrowStartIsInside:j}}})});const G=this.lastPointerMoveEvent??((D=this.lastPointerDownEvent)==null?void 0:D.nativeEvent);xe(G,"Last event must exist");const V=w-this.state.selectedLinearElement.pointerOffset.x,B=S-this.state.selectedLinearElement.pointerOffset.y,z=this.state.multiElement?re.handlePointerMove(G,this,V,B,this.state.selectedLinearElement):re.handlePointDragging(G,this,V,B,this.state.selectedLinearElement);z&&this.setState(z)}};let r=!1;if((u=this.state.selectedLinearElement)!=null&&u.selectedPointsIndices){const w=this.scene.getNonDeletedElementsMap(),S=this.state.selectedLinearElement.selectedPointsIndices.includes(0),x=this.state.selectedLinearElement.selectedPointsIndices.includes(n.points.length-1),k=S?i:n.startBinding&&w.get(n.startBinding.elementId),P=x?i:n.endBinding&&w.get(n.endBinding.elementId),D=k&&Mn(k,w),j=P&&Mn(P,w);r=!!(D&&j&&k.id!==P.id&&ud(D,j))}const o=(h=(f=this.state.selectedLinearElement)==null?void 0:f.selectedPointsIndices)==null?void 0:h.includes(0),a=(p=(m=this.state.selectedLinearElement)==null?void 0:m.selectedPointsIndices)==null?void 0:p.includes(n.points.length-1),l=o?"startBinding":a?"endBinding":null,c=o?"endBinding":a?"startBinding":null,d=c&&((U=n[c])==null?void 0:U.mode)==="inside"&&((b=n[c])==null?void 0:b.elementId)===(i==null?void 0:i.id)||l&&((y=n[l])==null?void 0:y.mode)==="inside"&&(i==null?void 0:i.id)===((v=n[l])==null?void 0:v.elementId);l&&c&&((_=n[l])==null?void 0:_.mode)==="inside"&&(i==null?void 0:i.id)!==((I=n[l])==null?void 0:I.elementId)&&((R=n[c])==null?void 0:R.elementId)!==((T=n[l])==null?void 0:T.elementId)&&this.scene.mutateElement(n,{[l]:{...n[l],mode:"orbit"}},{informMutation:!1,isDragging:!0}),!i||this.previousHoveredBindableElement&&i.id!==this.previousHoveredBindableElement.id?(this.bindModeHandler&&(clearTimeout(this.bindModeHandler),this.bindModeHandler=null),this.state.bindMode==="inside"&&cn.flushSync(()=>{this.setState({bindMode:"orbit"})}),this.previousHoveredBindableElement=null):!this.bindModeHandler&&(!this.state.newElement||!n.startBinding||r)&&!d&&(this.bindModeHandler=setTimeout(s,Tf)),this.previousHoveredBindableElement=i}cacheEmbeddableRef(n,i){i&&this.iFrameRefs.set(n.id,i)}getHTMLIFrameElement(n){return this.iFrameRefs.get(n.id)}handleEmbeddableCenterClick(n){var s,r,o,a;if(((s=this.state.activeEmbeddable)==null?void 0:s.element)===n&&((r=this.state.activeEmbeddable)==null?void 0:r.state)==="active"||(setTimeout(()=>{this.setState({activeEmbeddable:{element:n,state:"active"},selectedElementIds:{[n.id]:!0},newElement:null,selectionElement:null})},100),Kl(n)))return;const i=this.getHTMLIFrameElement(n);if(i!=null&&i.contentWindow){if(i.src.includes("youtube")){const l=Z3.get(n.id);switch(l||(Z3.set(n.id,NU.UNSTARTED),i.contentWindow.postMessage(JSON.stringify({event:"listening",id:n.id}),"*")),l){case NU.PLAYING:case NU.BUFFERING:(o=i.contentWindow)==null||o.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*");break;default:(a=i.contentWindow)==null||a.postMessage(JSON.stringify({event:"command",func:"playVideo",args:""}),"*")}}i.src.includes("player.vimeo.com")&&i.contentWindow.postMessage(JSON.stringify({method:"paused"}),"*")}}isIframeLikeElementCenter(n,i,s,r){var o,a;return n&&!i.altKey&&!i.shiftKey&&!i.metaKey&&!i.ctrlKey&&(((o=this.state.activeEmbeddable)==null?void 0:o.element)!==n||((a=this.state.activeEmbeddable)==null?void 0:a.state)==="hover"||!this.state.activeEmbeddable)&&s>=n.x+n.width/3&&s<=n.x+2*n.width/3&&r>=n.y+n.height/3&&r<=n.y+2*n.height/3}renderEmbeddables(){const n=this.state.zoom.value,i=this.state.width,s=this.state.height,r=this.scene.getNonDeletedElements().filter(o=>ds(o)&&this.embedsValidationStatus.get(o.id)===!0||Kl(o));return g(he,{children:r.map(o=>{var p,U,b,y,v,_,I,R,T;const{x:a,y:l}=Qs({sceneX:o.x,sceneY:o.y},this.state),c=_6(o,i,s,this.state,this.scene.getNonDeletedElementsMap()),d=this.initializedEmbeds.has(o.id);if(c&&!d&&this.initializedEmbeds.add(o.id),!(c||d))return null;let f;if(Kl(o)){f=null;const w=(((p=o.customData)==null?void 0:p.generationData)??this.magicGenerations.get(o.id))||{status:"error",message:"No generation data",code:"ERR_NO_GENERATION_DATA"};if(w.status==="done"){const S=w.html;f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>S}}else if(w.status==="pending")f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>Lm(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${this.state.theme===Se.DARK?"white":"black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `)};else{let S;w.code==="ERR_GENERATION_INTERRUPTED"?S="Generation was interrupted...":S=w.message||"Generation failed",f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>Lm(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${Ke.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${S}</h3>
                  `)}}}else f=Jf(L_(o.link||""));const h=((U=this.state.activeEmbeddable)==null?void 0:U.element)===o&&((b=this.state.activeEmbeddable)==null?void 0:b.state)==="active",m=((y=this.state.activeEmbeddable)==null?void 0:y.element)===o&&((v=this.state.activeEmbeddable)==null?void 0:v.state)==="hover";return g("div",{className:le("excalidraw__embeddable-container",{"is-hovered":m}),style:{transform:c?`translate(${a-this.state.offsetLeft}px, ${l-this.state.offsetTop}px) scale(${n})`:"none",display:c?"block":"none",opacity:az(o,Ls(o,this.scene.getNonDeletedElementsMap()),this.elementsPendingErasure,null,((_=this.state.openDialog)==null?void 0:_.name)==="elementLinkSelector"?OF:1),"--embeddable-radius":`${qo(Math.min(o.width,o.height),o)}px`},children:N("div",{className:"excalidraw__embeddable-container__inner",style:{width:c?`${o.width}px`:0,height:c?`${o.height}px`:0,transform:c?`rotate(${o.angle}rad)`:"none",pointerEvents:h?Sd.enabled:Sd.disabled},children:[m&&g("div",{className:"excalidraw__embeddable-hint",children:M("buttons.embeddableInteractionButton")}),g("div",{className:"excalidraw__embeddable__outer",style:{padding:`${o.strokeWidth}px`},children:(ds(o)?(R=(I=this.props).renderEmbeddable)==null?void 0:R.call(I,o,this.state):null)??g("iframe",{ref:w=>this.cacheEmbeddableRef(o,w),className:"excalidraw__embeddable",srcDoc:(f==null?void 0:f.type)==="document"?f.srcdoc(this.state.theme):void 0,src:(f==null?void 0:f.type)!=="document"?(f==null?void 0:f.link)??"":void 0,scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",title:"Excalidraw Embedded Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:`${(T=f==null?void 0:f.sandbox)!=null&&T.allowSameOrigin?"allow-same-origin":""} allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads`})})]})},o.id)})})}toggleOverscrollBehavior(n){document.documentElement.style.overscrollBehaviorX=n.type==="pointerenter"?"none":"auto"}render(){var h,m,p,U,b,y,v,_,I;const n=this.scene.getSelectedElements(this.state),{renderTopRightUI:i,renderTopLeftUI:s,renderCustomStats:r}=this.props,o=this.scene.getSceneNonce(),{elementsMap:a,visibleElements:l}=this.renderer.getRenderableElements({sceneNonce:o,zoom:this.state.zoom,offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,height:this.state.height,width:this.state.width,editingTextElement:this.state.editingTextElement,newElementId:(h=this.state.newElement)==null?void 0:h.id});this.visibleElements=l;const c=this.scene.getNonDeletedElementsMap(),d="setPointerCapture"in HTMLElement.prototype?!1:this.state.selectionElement||this.state.newElement||this.state.selectedElementsAreBeingDragged||this.state.resizingElement||this.state.activeTool.type==="laser"&&this.state.cursorButton==="down",u=n[0],f=((m=Zs.get(Da))==null?void 0:m.type)==="panel";return g("div",{translate:"no",className:le("excalidraw excalidraw-container notranslate",{"excalidraw--view-mode":this.state.viewModeEnabled||((p=this.state.openDialog)==null?void 0:p.name)==="elementLinkSelector","excalidraw--mobile":this.editorInterface.formFactor==="phone"}),style:{"--ui-pointerEvents":d?Sd.disabled:Sd.enabled,"--right-sidebar-width":"302px"},ref:this.excalidrawContainerRef,onDrop:this.handleAppOnDrop,tabIndex:0,onKeyDown:this.props.handleKeyboardGlobally?void 0:this.onKeyDown,onPointerEnter:this.toggleOverscrollBehavior,onPointerLeave:this.toggleOverscrollBehavior,children:g(LY.Provider,{value:this,children:g(DY.Provider,{value:this.props,children:g(tI.Provider,{value:this.excalidrawContainerValue,children:g(eI.Provider,{value:this.editorInterface,children:g(sI.Provider,{value:this.setAppState,children:g(iI.Provider,{value:this.state,children:N(nI.Provider,{value:this.scene.getNonDeletedElements(),children:[N(rI.Provider,{value:this.actionManager,children:[g(Ave,{canvas:this.canvas,appState:this.state,files:this.files,setAppState:this.setAppState,actionManager:this.actionManager,elements:this.scene.getNonDeletedElements(),onLockToggle:this.toggleLock,onPenModeToggle:this.togglePenMode,onHandToolToggle:this.onHandToolToggle,langCode:x0().code,renderTopLeftUI:s,renderTopRightUI:i,renderCustomStats:r,showExitZenModeBtn:typeof((U=this.props)==null?void 0:U.zenModeEnabled)>"u"&&this.state.zenModeEnabled,UIOptions:this.props.UIOptions,onExportImage:this.onExportImage,renderWelcomeScreen:!this.state.isLoading&&this.state.showWelcomeScreen&&this.state.activeTool.type===this.state.preferredSelectionTool.type&&!this.state.zenModeEnabled&&!this.scene.getElementsIncludingDeleted().length,app:this,isCollaborating:this.props.isCollaborating,generateLinkForSelection:this.props.generateLinkForSelection,children:this.props.children}),g("div",{className:"excalidraw-textEditorContainer"}),g("div",{className:"excalidraw-contextMenuContainer"}),g("div",{className:"excalidraw-eye-dropper-container"}),g(kve,{trails:[this.laserTrails,this.lassoTrail,this.eraserTrail]}),n.length===1&&((b=this.state.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&this.state.showHyperlinkPopup&&g(oEe,{element:u,scene:this.scene,setAppState:this.setAppState,onLinkOpen:this.props.onLinkOpen,setToast:this.setToast,updateEmbedValidationStatus:this.updateEmbedValidationStatus},u.id),this.props.aiEnabled!==!1&&n.length===1&&G2(u)&&g(_L,{element:u,elementsMap:a,children:g(X3,{title:M("labels.convertToCode"),icon:P6,checked:!1,onChange:()=>this.onMagicFrameGenerate(u,"button")})}),n.length===1&&Kl(u)&&((v=(y=u.customData)==null?void 0:y.generationData)==null?void 0:v.status)==="done"&&N(_L,{element:u,elementsMap:a,children:[g(X3,{title:M("labels.copySource"),icon:Vp,checked:!1,onChange:()=>this.onIframeSrcCopy(u)}),g(X3,{title:"Enter fullscreen",icon:Cfe,checked:!1,onChange:()=>{const R=this.getHTMLIFrameElement(u);if(R)try{R.requestFullscreen(),this.setState({activeEmbeddable:{element:u,state:"active"},selectedElementIds:{[u.id]:!0},newElement:null,selectionElement:null})}catch(T){console.warn(T),this.setState({errorMessage:"Couldn't enter fullscreen"})}}})]}),this.state.toast!==null&&g(s9e,{message:this.state.toast.message,onClose:this.handleToastClose,duration:this.state.toast.duration,closable:this.state.toast.closable}),this.state.contextMenu&&g(y7e,{items:this.state.contextMenu.items,top:this.state.contextMenu.top,left:this.state.contextMenu.left,actionManager:this.actionManager,onClose:R=>{this.setState({contextMenu:null},()=>{this.focusContainer(),R==null||R()})}}),g(Jve,{canvas:this.canvas,rc:this.rc,elementsMap:a,allElementsMap:c,visibleElements:l,sceneNonce:o,selectionNonce:(_=this.state.selectionElement)==null?void 0:_.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:W0(this),canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:this.flowChartCreator.pendingNodes}}),this.state.newElement&&g(n9e,{appState:this.state,scale:window.devicePixelRatio,rc:this.rc,elementsMap:a,allElementsMap:c,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!1,canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:null}}),g(Zve,{app:this,containerRef:this.excalidrawContainerRef,canvas:this.interactiveCanvas,elementsMap:a,visibleElements:l,allElementsMap:c,selectedElements:n,sceneNonce:o,selectionNonce:(I=this.state.selectionElement)==null?void 0:I.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderScrollbars:this.props.renderScrollbars===!0,editorInterface:this.editorInterface,renderInteractiveSceneCallback:this.renderInteractiveSceneCallback,handleCanvasRef:this.handleInteractiveCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.handleCanvasPointerUp,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick}),this.state.userToFollow&&g(E7e,{width:this.state.width,height:this.state.height,userToFollow:this.state.userToFollow,onDisconnect:this.maybeUnfollowRemoteUser}),this.renderFrameNames(),this.state.activeLockedId&&g(r9e,{app:this,activeLockedId:this.state.activeLockedId}),f&&g(UEe,{app:this})]}),this.renderEmbeddables()]})})})})})})})})}setPlugins(n){Object.assign(this.plugins,n)}async onMagicFrameGenerate(n,i){var a;const s=(a=this.plugins.diagramToCode)==null?void 0:a.generate;if(!s){this.setState({errorMessage:"No diagram to code plugin found"});return}const r=ow(this.scene.getNonDeletedElements(),n).filter(l=>!G2(l));if(!r.length){i==="button"?(this.setState({errorMessage:"Cannot generate from an empty frame"}),it("ai","generate (no-children)","d2c")):this.setActiveTool({type:"magicframe"});return}const o=this.insertIframeElement({sceneX:n.x+n.width+30,sceneY:n.y,width:n.width,height:n.height});if(o){this.updateMagicGeneration({frameElement:o,data:{status:"pending"}}),this.setState({selectedElementIds:{[o.id]:!0}}),it("ai","generate (start)","d2c");try{const{html:l}=await s({frame:n,children:r});if(it("ai","generate (success)","d2c"),!l.trim()){this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:"Nothing genereated :("}});return}const c=l.includes("<!DOCTYPE html>")&&l.includes("</html>")?l.slice(l.indexOf("<!DOCTYPE html>"),l.indexOf("</html>")+7):l;this.updateMagicGeneration({frameElement:o,data:{status:"done",html:c}})}catch(l){it("ai","generate (failed)","d2c"),this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:l.message||"Unknown error during generation"}})}}}onIframeSrcCopy(n){var i,s;((s=(i=n.customData)==null?void 0:i.generationData)==null?void 0:s.status)==="done"&&(gd(n.customData.generationData.html),this.setToast({message:"copied to clipboard",closable:!1,duration:1500}))}clearImageShapeCache(n){const i=n??this.files;this.scene.getNonDeletedElements().forEach(s=>{On(s)&&i[s.fileId]&&(this.imageCache.delete(s.fileId),sn.delete(s))})}async componentDidMount(){var s;this.unmounted=!1,this.excalidrawContainerValue.container=this.excalidrawContainerRef.current,this.store.onDurableIncrementEmitter.on(r=>{this.history.record(r.delta)});const{onIncrement:n}=this.props;n&&this.store.onStoreIncrementEmitter.on(r=>{n(r)}),this.scene.onUpdate(this.triggerRender),this.addEventListeners(),this.props.autoFocus&&this.excalidrawContainerRef.current&&this.focusContainer(),SF&&this.excalidrawContainerRef.current&&(this.resizeObserver=new ResizeObserver(()=>{this.refreshEditorInterface(),this.updateDOMRect()}),(s=this.resizeObserver)==null||s.observe(this.excalidrawContainerRef.current)),new URLSearchParams(window.location.search.slice(1)).has("web-share-target")?this.restoreFileFromShare():this.updateDOMRect(this.initializeScene),Hee()&&!eie()&&this.setState({errorMessage:g(U7e,{})})}componentWillUnmount(){var n,i;(n=window.launchQueue)==null||n.setConsumer(()=>{}),this.renderer.destroy(),this.scene.destroy(),this.scene=new T6,this.fonts=new rl(this.scene),this.renderer=new vL(this.scene),this.files={},this.imageCache.clear(),(i=this.resizeObserver)==null||i.disconnect(),this.unmounted=!0,this.removeEventListeners(),this.library.destroy(),this.laserTrails.stop(),this.eraserTrail.stop(),this.onChangeEmitter.clear(),this.store.onStoreIncrementEmitter.clear(),this.store.onDurableIncrementEmitter.clear(),sn.destroy(),eo.destroy(),clearTimeout(zl),Qn.clearCache(),xi.clearCache(),zl=0,document.documentElement.style.overscrollBehaviorX=""}removeEventListeners(){this.onRemoveEventListenersEmitter.trigger()}addEventListeners(){this.removeEventListeners(),this.props.handleKeyboardGlobally&&this.onRemoveEventListenersEmitter.once(tn(document,te.KEYDOWN,this.onKeyDown,!1)),this.onRemoveEventListenersEmitter.once(tn(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),tn(window,te.MESSAGE,this.onWindowMessage,!1),tn(document,te.POINTER_UP,this.removePointer,{passive:!1}),tn(document,te.COPY,this.onCopy,{passive:!1}),tn(document,te.KEYUP,this.onKeyUp,{passive:!0}),tn(document,te.POINTER_MOVE,this.updateCurrentCursorPosition,{passive:!1}),tn(document.fonts,"loadingdone",n=>{const i=n.fontfaces;this.fonts.onLoaded(i)},{passive:!1}),tn(document,te.GESTURE_START,this.onGestureStart,!1),tn(document,te.GESTURE_CHANGE,this.onGestureChange,!1),tn(document,te.GESTURE_END,this.onGestureEnd,!1),tn(window,te.FOCUS,()=>{this.maybeCleanupAfterMissingPointerUp(null),this.triggerRender(!0)},{passive:!1})),!this.state.viewModeEnabled&&(this.onRemoveEventListenersEmitter.once(tn(document,te.FULLSCREENCHANGE,this.onFullscreenChange,{passive:!1}),tn(document,te.PASTE,this.pasteFromClipboard,{passive:!1}),tn(document,te.CUT,this.onCut,{passive:!1}),tn(window,te.RESIZE,this.onResize,!1),tn(window,te.UNLOAD,this.onUnload,!1),tn(window,te.BLUR,this.onBlur,!1),tn(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),tn(this.excalidrawContainerRef.current,te.DRAG_OVER,this.disableEvent,!1),tn(this.excalidrawContainerRef.current,te.DROP,this.disableEvent,!1)),this.props.detectScroll&&this.onRemoveEventListenersEmitter.once(tn(Ste(this.excalidrawContainerRef.current),te.SCROLL,this.onScroll,{passive:!1})))}componentDidUpdate(n,i){var a,l,c,d,u,f,h,m,p,U,b;this.updateEmbeddables();const s=this.scene.getElementsIncludingDeleted(),r=this.scene.getElementsMapIncludingDeleted();!this.state.showWelcomeScreen&&!s.length&&this.setState({showWelcomeScreen:!0}),i.userToFollow&&!this.state.collaborators.has(i.userToFollow.socketId)&&this.maybeUnfollowRemoteUser(),(i.zoom.value!==this.state.zoom.value||i.scrollX!==this.state.scrollX||i.scrollY!==this.state.scrollY)&&((l=(a=this.props)==null?void 0:a.onScrollChange)==null||l.call(a,this.state.scrollX,this.state.scrollY,this.state.zoom),this.onScrollChangeEmitter.trigger(this.state.scrollX,this.state.scrollY,this.state.zoom)),i.userToFollow!==this.state.userToFollow&&(i.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:i.userToFollow,action:"UNFOLLOW"}),this.state.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:this.state.userToFollow,action:"FOLLOW"})),Object.keys(this.state.selectedElementIds).length&&Oo(this.state)&&this.setState({activeTool:qt(this.state,{type:"selection"})}),this.state.activeTool.type==="eraser"&&i.theme!==this.state.theme&&dG(this.interactiveCanvas,this.state.theme),i.activeTool.type==="selection"&&this.state.activeTool.type!=="selection"&&this.state.showHyperlinkPopup&&this.setState({showHyperlinkPopup:!1}),n.langCode!==this.props.langCode&&this.updateLanguage(),Oo(i)&&!Oo(this.state)&&this.eraserTrail.endPath(),n.viewModeEnabled!==this.props.viewModeEnabled&&this.setState({viewModeEnabled:!!this.props.viewModeEnabled}),i.viewModeEnabled!==this.state.viewModeEnabled&&(this.addEventListeners(),this.deselectElements()),(((c=i.openDialog)==null?void 0:c.name)==="elementLinkSelector"||((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector")&&((u=i.openDialog)==null?void 0:u.name)!==((f=this.state.openDialog)==null?void 0:f.name)&&(this.deselectElements(),this.setState({hoveredElementIds:{}})),n.zenModeEnabled!==this.props.zenModeEnabled&&this.setState({zenModeEnabled:!!this.props.zenModeEnabled}),n.theme!==this.props.theme&&this.props.theme&&this.setState({theme:this.props.theme}),(h=this.excalidrawContainerRef.current)==null||h.classList.toggle("theme--dark",this.state.theme===Se.DARK),(m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&setTimeout(()=>{var y;(y=this.state.selectedLinearElement)!=null&&y.isEditing&&this.actionManager.executeAction(Vs)}),(p=this.state.editingTextElement)!=null&&p.isDeleted&&this.setState({editingTextElement:null}),this.store.commit(r,this.state),this.state.isLoading||((b=(U=this.props).onChange)==null||b.call(U,s,this.state,this.files),this.onChangeEmitter.trigger(s,this.state,this.files))}static resetTapTwice(){M1=!1,k1=null}async insertClipboardContent(n,i,s){const{x:r,y:o}=Dt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state);if(n.errorMessage){this.setState({errorMessage:n.errorMessage});return}if(i.length===0&&!s&&n.mixedContent){await this.addElementsFromMixedContentPaste(n.mixedContent,{isPlainPaste:s,sceneX:r,sceneY:o});return}if(n.spreadsheet&&!s){this.setState({pasteDialog:{data:n.spreadsheet,shown:!0}});return}const a=i.map(d=>d.file);if(a.length===0&&n.text&&!s){const d=n.text.trim();d.startsWith("<svg")&&d.endsWith("</svg>")&&a.push(BR(d))}if(a.length>0){this.isToolSupported("image")?await this.insertImages(a,r,o):this.setState({errorMessage:M("errors.imageToolNotSupported")});return}if(n.elements){const d=n.programmaticAPI?Fv(n.elements):n.elements;this.addElementsFromPasteOrLibrary({elements:d,files:n.files||null,position:this.editorInterface.formFactor==="desktop"?"cursor":"center",retainSeed:s});return}if(!n.text)return;if(!s&&l7e(n.text)){const d=await pe(()=>import("./index-BeQPmZTo.js").then(u=>u.b6),__vite__mapDeps([]));try{const{elements:u,files:f}=await d.parseMermaidToExcalidraw(n.text),h=Fv(u,{regenerateIds:!0});this.addElementsFromPasteOrLibrary({elements:h,files:f,position:this.editorInterface.formFactor==="desktop"?"cursor":"center"});return}catch(u){console.warn(`parsing pasted text as mermaid definition failed: ${u.message}`)}}const l=lB(n.text).split(/\n+/).map(d=>d.trim()).filter(Boolean),c=l.map(d=>Xre(d)).filter(d=>{var u;return Y2(d,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(d)||((u=Jf(d))==null?void 0:u.type)==="video")});if(!s&&c.length>0&&c.length===l.length){const d=[];for(const u of c){const f=d[d.length-1],h=this.insertEmbeddableElement({sceneX:f?f.x+f.width+20:r,sceneY:o,link:rr(u)});h&&d.push(h)}d.length&&(this.store.scheduleCapture(),this.setState({selectedElementIds:Object.fromEntries(d.map(u=>[u.id,!0]))}));return}this.addTextFromPaste(n.text,s)}async addElementsFromMixedContentPaste(n,{isPlainPaste:i,sceneX:s,sceneY:r}){if(!i&&n.some(o=>o.type==="imageUrl")&&this.isToolSupported("image")){const o=n.filter(d=>d.type==="imageUrl").map(d=>d.value),a=await Promise.all(o.map(async d=>{try{return{file:await cye(d)}}catch(u){let f=u.message;return u.cause==="FETCH_ERROR"?f=M("errors.failedToFetchImage"):u.cause==="UNSUPPORTED"&&(f=M("errors.unsupportedFileType")),{errorMessage:f}}})),l=a.filter(d=>!!d.file).map(d=>d.file);await this.insertImages(l,s,r);const c=a.find(d=>!!d.errorMessage);c&&c.errorMessage&&this.setState({errorMessage:c.errorMessage})}else{const o=n.filter(a=>a.type==="text");o.length&&this.addTextFromPaste(o.map(a=>a.value).join(`

`),i)}}addTextFromPaste(n,i=!1){const{x:s,y:r}=Dt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),o={x:s,y:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roundness:null,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:n,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:Ep,verticalAlign:Wb,locked:!1},a=bt({fontSize:o.fontSize,fontFamily:o.fontFamily}),l=zc(o.fontFamily),[c,,d]=pz(this.state),u=Math.max(Math.min((d-c)*.5,800),200),f=10;let h=r;const m=i?[n]:n.split(`
`),p=m.reduce((U,b,y)=>{var _;const v=$h(b).trim();if(v.length){const I=this.getTopLayerFrameAtSceneCoords({x:s,y:h});let R=qn(v,a,l);const T=R.width>u,w=T?cd(v,a,u):v;R=T?qn(w,a,l):R;const S=s-R.width/2,x=h-R.height/2,k=cr({...o,x:S,y:x,text:w,originalText:v,lineHeight:l,autoResize:!T,frameId:I?I.id:null});U.push(k),h+=k.height+f}else((_=m[y-1])==null?void 0:_.trim())&&(h+=kp(o.fontSize,l)+f);return U},[]);p.length!==0&&(this.scene.insertElements(p),this.store.scheduleCapture(),this.setState({selectedElementIds:vt(Object.fromEntries(p.map(U=>[U.id,!0])),this.state)}),!i&&p.length>1&&tD===!1&&this.editorInterface.formFactor!=="phone"&&(this.setToast({message:M("toast.pasteAsSingleElement",{shortcut:Q("CtrlOrCmd+Shift+V")}),duration:5e3}),tD=!0))}handleTextWysiwyg(n,{isExistingElement:i=!1}){const s=this.scene.getElementsMapIncludingDeleted(),r=(o,a)=>{this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted().map(l=>l.id===n.id&&fe(l)?Te(l,{originalText:o,isDeleted:a??l.isDeleted,...Cz(l,Bn(l,s),s,o)}):l)])};r7e({id:n.id,canvas:this.canvas,getViewportCoords:(o,a)=>{const{x:l,y:c}=Qs({sceneX:o,sceneY:a},this.state);return[l-this.state.offsetLeft,c-this.state.offsetTop]},onChange:ln(o=>{r(o,!1),N4(n)&&ps(n,this.scene)}),onSubmit:ln(({viaKeyboard:o,nextOriginalText:a})=>{const l=!a.trim();if(r(a,l),!l&&o){const c=n.containerId?n.containerId:n.id;cn.flushSync(()=>{this.setState(d=>({selectedElementIds:vt({...d.selectedElementIds,[c]:!0},d)}))})}l&&YB(this.scene.getNonDeletedElements(),[n]),(!l||i)&&this.store.scheduleCapture(),cn.flushSync(()=>{this.setState({newElement:null,editingTextElement:null})}),this.state.activeTool.locked&&Ro(this.interactiveCanvas,this.state),this.focusContainer()}),element:n,excalidrawContainer:this.excalidrawContainerRef.current,app:this,autoSelect:!this.editorInterface.isTouchScreen}),this.deselectElements(),r(n.originalText,!1)}deselectElements(){this.setState({selectedElementIds:vt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})}getTextElementAtPosition(n,i){const s=this.getElementAtPosition(n,i,{includeBoundTextElement:!0});return s&&fe(s)&&!s.isDeleted?s:null}getElementAtPosition(n,i,s){let r=[];if(s&&"allHitElements"in s?r=(s==null?void 0:s.allHitElements)||[]:r=this.getElementsAtPosition(n,i,{includeBoundTextElement:s==null?void 0:s.includeBoundTextElement,includeLockedElements:s==null?void 0:s.includeLockedElements}),r.length>1){if(s!=null&&s.preferSelected){for(let a=r.length-1;a>-1;a--)if(this.state.selectedElementIds[r[a].id])return r[a]}const o=r[r.length-1];return Sf({point:C(n,i),element:o,threshold:this.getElementHitThreshold(o)/2,elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:Ue(o)?this.frameNameBoundsCache.get(o):null})?o:r[r.length-2]}return r.length===1?r[0]:null}getElementsAtPosition(n,i,s){const r=[],o=this.scene.getNonDeletedElementsMap();return(s!=null&&s.includeBoundTextElement&&(s!=null&&s.includeLockedElements)?this.scene.getNonDeletedElements():this.scene.getNonDeletedElements().filter(l=>((s==null?void 0:s.includeLockedElements)||!l.locked)&&((s==null?void 0:s.includeBoundTextElement)||!(fe(l)&&l.containerId)))).filter(l=>this.hitElement(n,i,l)).filter(l=>{const c=Ls(l,o);return c&&this.state.frameRendering.enabled&&this.state.frameRendering.clip?mA({x:n,y:i},c,o):!0}).filter(l=>Kl(l)?(r.push(l),!1):!0).concat(r)}getElementHitThreshold(n){return Math.max(n.strokeWidth/2+.1,.85*(xC/this.state.zoom.value))}hitElement(n,i,s,r=!0){return r&&this.state.selectedElementIds[s.id]&&Fz([s],this.state,this.editorInterface)&&ey(C(n,i),s,this.scene.getNonDeletedElementsMap(),this.getElementHitThreshold(s))||NB(C(n,i),s,this.scene.getNonDeletedElementsMap())?!0:Sf({point:C(n,i),element:s,threshold:this.getElementHitThreshold(s),elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:Ue(s)?this.frameNameBoundsCache.get(s):null})}getTextBindableContainerAtPosition(n,i){const s=this.scene.getNonDeletedElements(),r=this.scene.getSelectedElements(this.state);if(r.length===1)return tu(r[0],!1)?r[0]:null;let o=null;for(let a=s.length-1;a>=0;--a){if(s[a].isDeleted)continue;const[l,c,d,u]=$e(s[a],this.scene.getNonDeletedElementsMap());if(_e(s[a])&&Sf({point:C(n,i),element:s[a],elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(s[a])})){o=s[a];break}else if(l<n&&n<d&&c<i&&i<u){o=s[a];break}}return tu(o,!1)?o:null}handleHoverSelectedLinearElement(n,i,s){const r=this.scene.getNonDeletedElementsMap(),o=re.getElement(n.elementId,r);if(o)if(this.state.selectedLinearElement){let a=-1,l=null;Sf({point:C(i,s),element:o,elementsMap:r,threshold:this.getElementHitThreshold(o)})?(a=re.getPointIndexUnderCursor(o,r,this.state.zoom,i,s),l=re.getSegmentMidpointHitCoords(n,{x:i,y:s},this.state,this.scene.getNonDeletedElementsMap()),(ye(o)?a===0||a===o.points.length-1:a>=0)||l?Ft(this.interactiveCanvas,Rt.POINTER):this.hitElement(i,s,o)&&(!ye(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Ft(this.interactiveCanvas,Rt.MOVE)):this.hitElement(i,s,o)&&(!ye(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Ft(this.interactiveCanvas,Rt.MOVE),this.state.selectedLinearElement.hoverPointIndex!==a&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,hoverPointIndex:a}}),re.arePointsEqual(this.state.selectedLinearElement.segmentMidPointHoveredCoords,l)||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:l}})}else Ft(this.interactiveCanvas,Rt.AUTO)}updateGestureOnPointerDown(n){Et.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY}),Et.pointers.size===2&&(Et.lastCenter=hL(Et.pointers),Et.initialScale=this.state.zoom.value,Et.initialDistance=gL(Array.from(Et.pointers.values())))}initialPointerDownState(n){const i=Dt(n,this.state),s=this.scene.getSelectedElements(this.state),[r,o,a,l]=pt(s),c=s.findIndex(ye)===0;return{origin:i,withCmdOrCtrl:n[$.CTRL_OR_CMD],originInGrid:I8(ti(i.x,i.y,n[$.CTRL_OR_CMD]||c?null:this.getEffectiveGridSize())),scrollbars:SL(L1,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop),lastCoords:{...i},originalElements:this.scene.getNonDeletedElements().reduce((d,u)=>(d.set(u.id,Gc(u)),d),new Map),resize:{handleType:!1,isResizing:!1,offset:{x:0,y:0},arrowDirection:"origin",center:{x:(a+r)/2,y:(l+o)/2}},hit:{element:null,allHitElements:[],wasAddedToSelection:!1,hasBeenDuplicated:!1,hasHitCommonBoundingBoxOfSelectedElements:this.isHittingCommonBoundingBoxOfSelectedElements(i,s)},drag:{hasOccurred:!1,offset:null,origin:{...i},blockDragging:!1},eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null},boxSelection:{hasOccurred:!1}}}handleDraggingScrollBar(n,i){if(!(i.scrollbars.isOverEither&&!this.state.multiElement))return!1;K3=!0,i.lastCoords.x=n.clientX,i.lastCoords.y=n.clientY;const s=P3(o=>{o.target instanceof HTMLElement&&this.handlePointerMoveOverScrollbars(o,i)}),r=ln(()=>{wd=null,K3=!1,Ro(this.interactiveCanvas,this.state),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,s),window.removeEventListener(te.POINTER_UP,r),s.flush()});return wd=r,window.addEventListener(te.POINTER_MOVE,s),window.addEventListener(te.POINTER_UP,r),!0}isASelectedElement(n){return n!=null&&this.state.selectedElementIds[n.id]}isHittingCommonBoundingBoxOfSelectedElements(n,i){if(i.length<2)return!1;const s=Math.max(xC/this.state.zoom.value,1),[r,o,a,l]=pt(i);return n.x>r-s&&n.x<a+s&&n.y>o-s&&n.y<l+s}getCurrentItemRoundness(n){return this.state.currentItemRoundness==="round"?{type:$u(n)?En.ADAPTIVE_RADIUS:En.PROPORTIONAL_RADIUS}:null}maybeCacheReferenceSnapPoints(n,i,s=!1){Qc({event:n,app:this,selectedElements:i})&&(s||!eo.getReferenceSnapPoints())&&eo.setReferenceSnapPoints(z3e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}maybeCacheVisibleGaps(n,i,s=!1){Qc({event:n,app:this,selectedElements:i})&&(s||!eo.getVisibleGaps())&&eo.setVisibleGaps(B3e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}onKeyDownFromPointerDownHandler(n){return ln(i=>{this.maybeHandleResize(n,i)||this.maybeDragNewGenericElement(n,i)})}onKeyUpFromPointerDownHandler(n){return ln(i=>{i.key===$.ALT&&i.preventDefault(),!this.maybeHandleResize(n,i)&&this.maybeDragNewGenericElement(n,i)})}onPointerMoveFromPointerDownHandler(n){return P3(i=>{var f,h,m,p,U,b,y,v,_,I,R,T,w,S,x,k,P,D,j,G,V;if(((f=this.state.openDialog)==null?void 0:f.name)==="elementLinkSelector")return;const s=Dt(i,this.state);if(this.state.activeLockedId&&this.setState({activeLockedId:null}),this.state.selectedLinearElement&&this.state.selectedLinearElement.elbowed&&this.state.selectedLinearElement.initialState.segmentMidpoint.index){const[B,z]=ti(s.x,s.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());let X=this.state.selectedLinearElement.initialState.segmentMidpoint.index;if(X<0){const ee=re.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:B,y:z},this.state,this.scene.getNonDeletedElementsMap());X=ee?re.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,ee,this.scene.getNonDeletedElementsMap()):-1}const Y=re.moveFixedSegment(this.state.selectedLinearElement,X,B,z,this.scene);this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isDragging:!0,segmentMidPointHoveredCoords:Y.segmentMidPointHoveredCoords,initialState:Y.initialState}});return}const r=this.lastPointerMoveCoords??n.origin;if(this.lastPointerMoveCoords=s,n.drag.offset===null&&(n.drag.offset=I8(Are(this.scene.getSelectedElements(this.state),n.origin.x,n.origin.y))),!(i.target instanceof HTMLElement)||this.handlePointerMoveOverScrollbars(i,n))return;if(Oo(this.state)){this.handleEraser(i,s);return}this.state.activeTool.type==="laser"&&this.laserTrails.addPointToPath(s.x,s.y);const[a,l]=ti(s.x,s.y,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize());if(n.resize.isResizing&&(n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeHandleCrop(n,i)||this.maybeHandleResize(n,i)))return!0;const c=this.scene.getNonDeletedElementsMap();if(this.state.selectedLinearElement){const B=this.state.selectedLinearElement;if(re.shouldAddMidpoint(this.state.selectedLinearElement,s,this.state,c)){const z=re.addMidpoint(this.state.selectedLinearElement,s,this,!i[$.CTRL_OR_CMD],this.scene);if(!z)return;cn.flushSync(()=>{this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,initialState:z.pointerDownState,selectedPointsIndices:z.selectedPointsIndices,segmentMidPointHoveredCoords:null}})});return}else{if(B.initialState.segmentMidpoint.value!==null&&!B.initialState.segmentMidpoint.added)return;if(B.initialState.lastClickedPoint>-1){const z=re.getElement(B.elementId,c);if(z!=null&&z.isDeleted)return;if(dn(z)){const Y=Ci(C(s.x,s.y),this.scene.getNonDeletedElements(),c);ki("COMPLEX_BINDINGS")&&this.handleDelayedBindModeChange(z,Y)}if(i.altKey&&!((m=(h=this.state.selectedLinearElement)==null?void 0:h.initialState)!=null&&m.arrowStartIsInside)&&ki("COMPLEX_BINDINGS")&&this.handleSkipBindMode(),B.initialState.lastClickedPoint===-1)return;const X=re.handlePointDragging(i,this,s.x,s.y,B);if(X){n.lastCoords.x=s.x,n.lastCoords.y=s.y,n.drag.hasOccurred=!0,(X.suggestedBinding!==this.state.suggestedBinding||!vi(((p=X.selectedLinearElement)==null?void 0:p.selectedPointsIndices)??[],((U=this.state.selectedLinearElement)==null?void 0:U.selectedPointsIndices)??[])||((b=X.selectedLinearElement)==null?void 0:b.hoverPointIndex)!==((y=this.state.selectedLinearElement)==null?void 0:y.hoverPointIndex)||((v=X.selectedLinearElement)==null?void 0:v.customLineAngle)!==((_=this.state.selectedLinearElement)==null?void 0:_.customLineAngle)||this.state.selectedLinearElement.isDragging!==((I=X.selectedLinearElement)==null?void 0:I.isDragging)||((T=(R=this.state.selectedLinearElement)==null?void 0:R.initialState)==null?void 0:T.altFocusPoint)!==((S=(w=X.selectedLinearElement)==null?void 0:w.initialState)==null?void 0:S.altFocusPoint))&&this.setState(X);return}}}}const d=n.hit.allHitElements.some(B=>this.isASelectedElement(B)),u=((x=this.state.selectedLinearElement)==null?void 0:x.isEditing)&&i.shiftKey&&this.state.selectedLinearElement.elementId===((k=n.hit.element)==null?void 0:k.id);if((d||n.hit.hasHitCommonBoundingBoxOfSelectedElements)&&!u&&!n.drag.blockDragging){const B=this.scene.getSelectedElements(this.state);if(B.length>0&&B.every(ee=>ee.locked))return;const z=B.find(ee=>Ue(ee)),X=this.getTopLayerFrameAtSceneCoords(s),Y=X&&!z?X:null;if(this.state.frameToHighlight!==Y&&cn.flushSync(()=>{this.setState({frameToHighlight:Y})}),n.drag.hasOccurred=!0,this.state.activeTool.type==="lasso"&&this.lassoTrail.hasCurrentTrail&&!(this.editorInterface.formFactor!=="desktop"&&n.hit.element)&&!this.state.activeTool.fromSelection)return;if(this.state.activeTool.type==="lasso"&&B.length>0&&n.drag.hasOccurred&&!this.state.activeTool.fromSelection&&this.lassoTrail.endPath(),B.length>0&&!n.withCmdOrCtrl&&!this.state.editingTextElement&&((P=this.state.activeEmbeddable)==null?void 0:P.state)!=="active"){const ee={x:s.x-n.drag.origin.x,y:s.y-n.drag.origin.y},se=[...n.originalElements.values()],oe=i.shiftKey;if(oe){const Me=Math.abs(ee.x),Ne=Math.abs(ee.y),et=oe&&Me<Ne,Ot=oe&&Me>Ne;et&&(ee.x=0),Ot&&(ee.y=0)}if(this.state.croppingElementId){const Me=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(Me&&wt(Me)&&Me.crop!==null&&n.hit.element===Me){const Ne=Me.crop,et=On(Me)&&((D=this.imageCache.get(Me.fileId))==null?void 0:D.image);if(et&&!(et instanceof Promise)){const Ot=vn(Sn(s.x-r.x,s.y-r.y),Math.max(this.state.zoom.value,2)),[Xe,je,Jt,yt,ss,Gr]=$e(Me,c),ba=Ie(Z(C(Xe,je),C(ss,Gr),Me.angle)),It=Ie(Z(C(Jt,je),C(ss,Gr),Me.angle)),ui=Ie(Z(C(Xe,yt),C(ss,Gr),Me.angle)),Ts=uo(Jb(It,ba)),Rl=uo(Jb(ui,ba)),jg=Sn(Cm(Ot,Ts),Cm(Ot,Rl)),yE={...Ne,x:Ze(Ne.x+jg[0]*Math.sign(Me.scale[0]),0,et.naturalWidth-Ne.width),y:Ze(Ne.y+jg[1]*Math.sign(Me.scale[1]),0,et.naturalHeight-Ne.height)};this.scene.mutateElement(Me,{crop:yE});return}}}this.maybeCacheVisibleGaps(i,B),this.maybeCacheReferenceSnapPoints(i,B);const{snapOffset:Fe,snapLines:Ge}=H3e(se,ee,this,i,this.scene.getNonDeletedElementsMap());if(this.setState({snapLines:Ge}),this.state.editingFrame||xre(n,B,ee,this.scene,Fe,i[$.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),this.setState({selectedElementsAreBeingDragged:!0,selectionElement:null}),i.altKey&&!n.hit.hasBeenDuplicated){n.hit.hasBeenDuplicated=!0;const Me=this.scene.getElementsIncludingDeleted(),Ne=n.hit.element,et=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});Ne&&n.hit.wasAddedToSelection&&!et.find(It=>It.id===Ne.id)&&et.push(Ne);const Ot=new Map(et.map(It=>[It.id,It])),{duplicatedElements:Xe,duplicateElementsMap:je,elementsWithDuplicates:Jt,origIdToDuplicateId:yt}=Rm({type:"in-place",elements:Me,appState:this.state,randomizeSeed:!0,idsOfElementsToDuplicate:Ot,overrides:({duplicateElement:It,origElement:ui})=>({frameId:It.frameId??ui.frameId,seed:Hr()})});Xe.forEach(It=>{n.originalElements.set(It.id,Gc(It))});const ss=Jt.map(It=>{if(Ot.has(It.id)){const ui=n.originalElements.get(It.id);if(ui)return Te(It,{x:ui.x,y:ui.y})}return It}),Gr=(G=(j=this.props).onDuplicate)==null?void 0:G.call(j,ss,Me),ba=bo(Gr||ss,be(Xe));cn.flushSync(()=>{if(n.hit.element){const It=yt.get(n.hit.element.id),ui=It&&je.get(It);n.hit.element=ui||null}n.hit.allHitElements=n.hit.allHitElements.reduce((It,ui)=>{const Ts=yt.get(ui.id),Rl=Ts&&je.get(Ts);return Rl&&It.push(Rl),It},[]),n.drag.origin=Dt(i,this.state),this.setState(It=>({...JB(Xe,this.scene.getNonDeletedElements(),It)})),this.scene.replaceAllElements(ba),et.forEach(It=>{var ui;Lr(It)&&((ui=It.boundElements)!=null&&ui.some(Ts=>Ts.type==="arrow"))&&ps(It,this.scene)}),this.maybeCacheVisibleGaps(i,et,!0),this.maybeCacheReferenceSnapPoints(i,et,!0)})}return}}if(this.state.selectionElement){if(n.lastCoords.x=s.x,n.lastCoords.y=s.y,i.altKey){this.setActiveTool({type:"lasso",fromSelection:!0},i.shiftKey),this.lassoTrail.startPath(n.origin.x,n.origin.y,i.shiftKey),this.setAppState({selectionElement:null});return}this.maybeDragNewGenericElement(n,i)}else if(this.state.activeTool.type==="lasso")!i.altKey&&this.state.activeTool.fromSelection?(this.setActiveTool({type:"selection"}),this.createGenericElementOnPointerDown("selection",n),n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,i),this.lassoTrail.endPath()):this.lassoTrail.addPointToPath(s.x,s.y,i.shiftKey);else{const B=this.state.newElement;if(!B)return;if(B.type==="freedraw"){const z=B.points,X=s.x-B.x,Y=s.y-B.y,ee=z.length>0&&z[z.length-1];if(!(ee&&ee[0]===X&&ee[1]===Y)){const oe=B.simulatePressure?B.pressures:[...B.pressures,i.pressure];this.scene.mutateElement(B,{points:[...z,C(X,Y)],pressures:oe},{informMutation:!1,isDragging:!1}),this.setState({newElement:B})}}else if(Ce(B)&&!B.isDeleted){n.drag.hasOccurred=!0;const z=B.points;xe(z.length>1,"Do not create linear elements with less than 2 points");let X=this.state.selectedLinearElement;X||(X=new re(B,this.scene.getNonDeletedElementsMap()),X={...X,selectedPointsIndices:[1],initialState:{...X.initialState,lastClickedPoint:1}}),this.setState({newElement:B,...re.handlePointDragging(i,this,a,l,X)})}else n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,i,!1)}if(this.state.activeTool.type==="selection"){n.boxSelection.hasOccurred=!0;const B=this.scene.getNonDeletedElements();if((V=this.state.selectedLinearElement)!=null&&V.isEditing)re.handleBoxSelection(i,this.state,this.setState.bind(this),this.scene.getNonDeletedElementsMap());else{let z=!0;!i.shiftKey&&Qn(B,this.state)&&(n.withCmdOrCtrl&&n.hit.element?this.setState(Y=>xi({...Y,selectedElementIds:{[n.hit.element.id]:!0}},this.scene.getNonDeletedElements(),Y,this)):z=!1);const X=this.state.selectionElement?ew(B,this.state.selectionElement,this.scene.getNonDeletedElementsMap(),!1):[];this.setState(Y=>{const ee={...z&&Y.selectedElementIds,...X.reduce((se,oe)=>(se[oe.id]=!0,se),{})};return n.hit.element&&(X.length?delete ee[n.hit.element.id]:ee[n.hit.element.id]=!0),Y=z?Y:{...Y,selectedGroupIds:{},editingGroupId:null},{...xi({editingGroupId:Y.editingGroupId,selectedElementIds:ee},this.scene.getNonDeletedElements(),Y,this),selectedLinearElement:X.length===1&&Ce(X[0])?new re(X[0],this.scene.getNonDeletedElementsMap()):null,showHyperlinkPopup:X.length===1&&(X[0].link||ds(X[0]))?"info":!1}})}}})}handlePointerMoveOverScrollbars(n,i){var s,r;if(i.scrollbars.isOverHorizontal){const o=n.clientX,a=o-i.lastCoords.x;return this.translateCanvas({scrollX:this.state.scrollX-a*(((s=L1.horizontal)==null?void 0:s.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.x=o,!0}if(i.scrollbars.isOverVertical){const o=n.clientY,a=o-i.lastCoords.y;return this.translateCanvas({scrollY:this.state.scrollY-a*(((r=L1.vertical)==null?void 0:r.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.y=o,!0}return!1}onPointerUpFromPointerDownHandler(n){return ln(i=>{var y,v,_,I,R,T,w,S,x,k,P,D,j,G,V;const s=this.scene.getNonDeletedElementsMap();this.removePointer(i),n.drag.blockDragging=!1,n.eventListeners.onMove&&n.eventListeners.onMove.flush();const{newElement:r,resizingElement:o,croppingElementId:a,multiElement:l,activeTool:c,isResizing:d,isRotating:u,isCropping:f}=this.state;this.setState(B=>({isResizing:!1,isRotating:!1,isCropping:!1,resizingElement:null,selectionElement:null,frameToHighlight:null,elementsToHighlight:null,cursorButton:"up",snapLines:U1(B.snapLines,[]),originSnapOffset:null})),this.lassoTrail.endPath(),eo.setReferenceSnapPoints(null),eo.setVisibleGaps(null),this.savePointer(i.clientX,i.clientY,"up");const h=n.hit.allHitElements,m=Dt({clientX:i.clientX,clientY:i.clientY},this.state);if(this.state.activeTool.type==="selection"&&!n.boxSelection.hasOccurred&&!n.resize.isResizing&&!h.some(B=>this.state.selectedElementIds[B.id])){const B=this.getElementAtPosition(m.x,m.y,{includeLockedElements:!0});this.store.scheduleCapture(),B!=null&&B.locked?this.setState({activeLockedId:B.groupIds.length>0?B.groupIds.at(-1)||"":B.id}):this.setState({activeLockedId:null})}else this.setState({activeLockedId:null});if(ki("COMPLEX_BINDINGS")&&this.resetDelayedBindMode(),this.setState({selectedElementsAreBeingDragged:!1,bindMode:"orbit"}),n.drag.hasOccurred&&((v=(y=n.hit)==null?void 0:y.element)!=null&&v.id)){const B=s.get(n.hit.element.id);Lr(B)&&((_=B.boundElements)==null||_.filter(z=>z.type==="arrow").map(z=>s.get(z.id)).filter(z=>ye(z)).forEach(z=>{z&&this.scene.mutateElement(z,{})}))}if((I=this.state.selectedLinearElement)!=null&&I.isEditing&&!this.state.newElement)if(!n.boxSelection.hasOccurred&&((T=(R=n.hit)==null?void 0:R.element)==null?void 0:T.id)!==this.state.selectedLinearElement.elementId)this.actionManager.executeAction(Vs);else{const B=re.handlePointerUp(i,this.state.selectedLinearElement,this.state,this.scene);this.actionManager.executeAction(Vs,"ui",{event:i,sceneCoords:m}),B!==this.state.selectedLinearElement&&this.setState({selectedLinearElement:B,suggestedBinding:null})}else if(this.state.selectedLinearElement){if(this.state.selectedLinearElement.elbowed){const B=re.getElement(this.state.selectedLinearElement.elementId,this.scene.getNonDeletedElementsMap());B&&this.scene.mutateElement(B,{})}if(((S=(w=n.hit)==null?void 0:w.element)==null?void 0:S.id)!==this.state.selectedLinearElement.elementId?this.scene.getSelectedElements(this.state).length>1&&this.setState({selectedLinearElement:null}):this.state.selectedLinearElement.isDragging&&this.actionManager.executeAction(Vs,"ui",{event:i,sceneCoords:m}),this.state.newElement&&this.state.multiElement&&Ce(this.state.newElement)&&this.state.selectedLinearElement){const{multiElement:B}=this.state;this.setState({selectedLinearElement:{...this.state.selectedLinearElement,lastCommittedPoint:B.points[B.points.length-1]}})}}if(this.missingPointerEventCleanupEmitter.clear(),window.removeEventListener(te.POINTER_MOVE,n.eventListeners.onMove),window.removeEventListener(te.POINTER_UP,n.eventListeners.onUp),window.removeEventListener(te.KEYDOWN,n.eventListeners.onKeyDown),window.removeEventListener(te.KEYUP,n.eventListeners.onKeyUp),(k=(x=this.props)==null?void 0:x.onPointerUp)==null||k.call(x,c,n),this.onPointerUpEmitter.trigger(this.state.activeTool,n,i),(r==null?void 0:r.type)==="freedraw"){const B=Dt(i,this.state),z=r.points;let X=B.x-r.x,Y=B.y-r.y;X===z[0][0]&&Y===z[0][1]&&(Y+=1e-4,X+=1e-4);const ee=r.simulatePressure?[]:[...r.pressures,i.pressure];this.scene.mutateElement(r,{points:[...z,C(X,Y)],pressures:ee}),this.actionManager.executeAction(Vs);return}if(Ce(r)){r.points.length>1&&r.points[1][0]!==0&&r.points[1][1]!==0&&this.store.scheduleCapture();const B=Dt(i,this.state),z=Qe(C(B.x,B.y),C(n.origin.x,n.origin.y))*this.state.zoom.value;if((!n.drag.hasOccurred||z<aee)&&r&&!l)if(this.editorInterface.isTouchScreen){const X=Math.min(this.state.width*.7/this.state.zoom.value,100);this.scene.mutateElement(r,{x:r.x-X/2,points:[C(0,0),C(X,0)]},{informMutation:!1,isDragging:!1}),this.actionManager.executeAction(Vs)}else{const X=B.x-r.x,Y=B.y-r.y;this.scene.mutateElement(r,{points:[r.points[0],C(X,Y)]},{informMutation:!1,isDragging:!1}),this.setState({multiElement:r,newElement:r})}else n.drag.hasOccurred&&!l&&(dn(r,!1)&&this.actionManager.executeAction(Vs,"ui",{event:i,sceneCoords:m}),this.setState({suggestedBinding:null,startBoundElement:null}),c.locked?this.setState(X=>({newElement:null})):(Kr(this.interactiveCanvas),this.setState(X=>({newElement:null,activeTool:qt(this.state,{type:this.state.preferredSelectionTool.type}),selectedElementIds:vt({...X.selectedElementIds,[r.id]:!0},X),selectedLinearElement:new re(r,this.scene.getNonDeletedElementsMap())}))),this.scene.triggerUpdate());return}if(fe(r)){const B=B_(bt({fontSize:r.fontSize,fontFamily:r.fontFamily}),r.lineHeight);r.width<B&&this.scene.mutateElement(r,{autoResize:!0}),this.resetCursor(),this.handleTextWysiwyg(r,{isExistingElement:!0})}if(c.type!=="selection"&&r&&nl(r)){this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter(B=>B.id!==r.id),appState:{newElement:null},captureUpdate:q.NEVER});return}if(Ue(r)){const B=bse(this.scene.getElementsIncludingDeleted(),r,this.scene.getNonDeletedElementsMap());this.scene.replaceAllElements(km(this.scene.getElementsMapIncludingDeleted(),B,r,this.state))}if(r&&(this.scene.mutateElement(r,Uz(r),{informMutation:!1,isDragging:!1}),this.scene.triggerUpdate()),n.drag.hasOccurred){const B=Dt(i,this.state);if(this.state.selectedLinearElement&&this.state.selectedLinearElement.isDragging){const z=this.scene.getElement(this.state.selectedLinearElement.elementId);if(z!=null&&z.frameId){const X=Ls(z,s);X&&z&&(Vc(z,X,this.scene.getNonDeletedElementsMap())||(this.scene.mutateElement(z,{groupIds:[]}),sy([z],this.scene.getNonDeletedElementsMap()),this.scene.triggerUpdate()))}}else{const z=this.getTopLayerFrameAtSceneCoords(B),X=this.scene.getSelectedElements(this.state);let Y=this.scene.getElementsMapIncludingDeleted();const ee=se=>{if(se.length>0){for(const oe of se){const Fe=oe.groupIds.indexOf(this.state.editingGroupId);this.scene.mutateElement(oe,{groupIds:oe.groupIds.slice(0,Fe)},{informMutation:!1,isDragging:!1})}Y.forEach(oe=>{oe.groupIds.length&&Lt(Y,oe.groupIds[oe.groupIds.length-1]).length<2&&this.scene.mutateElement(oe,{groupIds:[]},{informMutation:!1,isDragging:!1})}),this.setState({editingGroupId:null})}};if(z&&!this.state.selectedElementIds[z.id]){const se=X.filter(oe=>oe.frameId!==z.id&&p6(oe,Y,this.state));this.state.editingGroupId&&ee(se),Y=km(Y,se,z,this.state)}else if(!z&&this.state.editingGroupId){const se=X.filter(oe=>oe.frameId&&!p6(oe,Y,this.state));ee(se)}Y=Wh(Y,this.state,this),this.scene.replaceAllElements(Y)}}if(o&&this.store.scheduleCapture(),o&&nl(o)&&this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter(B=>B.id!==o.id),captureUpdate:q.NEVER}),n.resize.isResizing){let B=Wh(this.scene.getElementsIncludingDeleted(),this.state,this);const z=this.scene.getSelectedElements(this.state).filter(X=>Ue(X));for(const X of z)B=Ag(B,Qo(this.scene.getElementsIncludingDeleted(),X,this.state,s),X,this);this.scene.replaceAllElements(B)}const p=n.hit.element;((P=this.state.selectedLinearElement)==null?void 0:P.elementId)!==(p==null?void 0:p.id)&&Ce(p)&&this.scene.getSelectedElements(this.state).length===1&&this.setState({selectedLinearElement:new re(p,this.scene.getNonDeletedElementsMap())}),(!a||a&&(!p&&!f||p&&p.id!==a))&&this.finishImageCropping();const U=this.lastPointerDownEvent,b=this.lastPointerUpEvent||this.lastPointerMoveEvent;if(Oo(this.state)&&U&&b){if(this.eraserTrail.endPath(),Qe(C(U.clientX,U.clientY),C(b.clientX,b.clientY))===0){const z=Dt({clientX:b.clientX,clientY:b.clientY},this.state);this.getElementsAtPosition(z.x,z.y).forEach(Y=>this.elementsPendingErasure.add(Y.id))}this.eraseElements();return}else this.elementsPendingErasure.size&&this.restoreReadyToEraseElements();if(p&&!n.drag.hasOccurred&&!n.hit.wasAddedToSelection&&(!((D=this.state.selectedLinearElement)!=null&&D.isEditing)||!n.boxSelection.hasOccurred)&&this.state.activeTool.type!=="lasso"&&(i.shiftKey&&!((j=this.state.selectedLinearElement)!=null&&j.isEditing)?this.state.selectedElementIds[p.id]?q_(this.state,p)?this.setState(B=>{const z={...B.selectedElementIds};for(const X of p.groupIds.flatMap(Y=>Lt(this.scene.getNonDeletedElements(),Y)))delete z[X.id];return{selectedGroupIds:{...B.selectedElementIds,...p.groupIds.map(X=>({[X]:!1})).reduce((X,Y)=>({...X,...Y}),{})},selectedElementIds:vt(z,B)}}):(G=this.state.selectedLinearElement)!=null&&G.isDragging||this.setState(B=>{const z={...B.selectedElementIds};delete z[p.id];const X=Ye(this.scene.getNonDeletedElements(),{selectedElementIds:z});return{...xi({editingGroupId:B.editingGroupId,selectedElementIds:z},this.scene.getNonDeletedElements(),B,this),selectedLinearElement:X.length===1&&Ce(X[0])?new re(X[0],this.scene.getNonDeletedElementsMap()):B.selectedLinearElement}}):p.frameId&&this.state.selectedElementIds[p.frameId]?this.setState(B=>{var X;const z={...B.selectedElementIds,[p.id]:!0};return delete z[p.frameId],(((X=this.scene.getElement(p.frameId))==null?void 0:X.groupIds)??[]).flatMap(Y=>Lt(this.scene.getNonDeletedElements(),Y)).forEach(Y=>{delete z[Y.id]}),{...xi({editingGroupId:B.editingGroupId,selectedElementIds:z},this.scene.getNonDeletedElements(),B,this),showHyperlinkPopup:p.link||ds(p)?"info":!1}}):this.setState(B=>({selectedElementIds:vt({...B.selectedElementIds,[p.id]:!0},B)})):this.setState(B=>{var z;return{...xi({editingGroupId:B.editingGroupId,selectedElementIds:{[p.id]:!0}},this.scene.getNonDeletedElements(),B,this),selectedLinearElement:Ce(p)&&((z=B.selectedLinearElement)==null?void 0:z.elementId)!==p.id?new re(p,this.scene.getNonDeletedElementsMap()):B.selectedLinearElement}})),this.state.activeTool.type!=="lasso"&&!(p&&ye(p))&&!n.drag.hasOccurred&&!this.state.isResizing&&(p&&wie({point:C(n.origin.x,n.origin.y),element:p,elementsMap:s,threshold:this.getElementHitThreshold(p),frameNameBound:Ue(p)?this.frameNameBoundsCache.get(p):null},s)||!p&&n.hit.hasHitCommonBoundingBoxOfSelectedElements)){(V=this.state.selectedLinearElement)!=null&&V.isEditing?this.actionManager.executeAction(m2):this.setState({selectedElementIds:vt({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),Ft(this.interactiveCanvas,Rt.AUTO);return}if(!c.locked&&c.type!=="freedraw"&&r&&this.setState(B=>({selectedElementIds:vt({...B.selectedElementIds,[r.id]:!0},B),showHyperlinkPopup:ds(r)&&!r.link?"editor":B.showHyperlinkPopup})),(c.type!=="selection"||Qn(this.scene.getNonDeletedElements(),this.state)||!vi(this.state.previousSelectedElementIds,this.state.selectedElementIds))&&this.store.scheduleCapture(),n.drag.hasOccurred&&!this.state.selectedLinearElement||d||u||f){const B=this.scene.getSelectedElements(this.state).filter(_e);y4(B,this.scene,this.state)}if(c.type==="laser"){this.laserTrails.endPath();return}!c.locked&&c.type!=="freedraw"&&(c.type!=="lasso"||c.type==="lasso"&&c.fromSelection)?(Kr(this.interactiveCanvas),this.setState({newElement:null,suggestedBinding:null,activeTool:qt(this.state,{type:this.state.preferredSelectionTool.type})})):this.setState({newElement:null,suggestedBinding:null}),p&&this.lastPointerUpEvent&&this.lastPointerDownEvent&&this.lastPointerUpEvent.timeStamp-this.lastPointerDownEvent.timeStamp<300&&Et.pointers.size<=1&&wr(p)&&this.isIframeLikeElementCenter(p,this.lastPointerUpEvent,n.origin.x,n.origin.y)&&this.handleEmbeddableCenterClick(p)})}clearSelection(n){this.setState(i=>({selectedElementIds:vt({},i),activeEmbeddable:null,selectedGroupIds:{},editingGroupId:i.editingGroupId&&n!=null&&w0(n,i.editingGroupId)?i.editingGroupId:null})),this.setState({selectedElementIds:vt({},this.state),activeEmbeddable:null,previousSelectedElementIds:this.state.selectedElementIds,selectedLinearElement:null})}getTextWysiwygSnappedToCenterPosition(n,i,s,r){if(r){let o=r.x+r.width/2,a=r.y+r.height/2;const l=D8(r,s,this.scene.getNonDeletedElementsMap());if(l&&(o=l.x,a=l.y),Math.hypot(n-o,i-a)<cee){const{x:u,y:f}=Qs({sceneX:o,sceneY:a},s);return{viewportX:u,viewportY:f,elementCenterX:o,elementCenterY:a}}}}getCanvasOffsets(){var n;if((n=this.excalidrawContainerRef)!=null&&n.current){const i=this.excalidrawContainerRef.current,{left:s,top:r}=i.getBoundingClientRect();return{offsetLeft:s,offsetTop:r}}return{offsetLeft:0,offsetTop:0}}async updateLanguage(){const n=Uy.find(i=>i.code===this.props.langCode)||Yu;await IV(n),this.setAppState({})}}const o9e=e=>{const[t,n]=L.useState(!0);return L.useEffect(()=>{const i=async()=>{await IV(s),n(!1)},s=Uy.find(r=>r.code===e.langCode)||Yu;i()},[e.langCode]),t?g(vj,{theme:e.theme}):e.children},PY=({children:e})=>{const{FooterCenterTunnel:t}=is(),n=di();return g(t.In,{children:g("div",{className:le("footer-center zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":n.zenModeEnabled}),children:e})})};PY.displayName="FooterCenter";const NY=({isCollaborating:e,onSelect:t,editorInterface:n,...i})=>{const s=di(),r=(n==null?void 0:n.formFactor)!=="desktop"||s.width<Oee;return N(qc,{...i,className:le("collab-button",{active:e}),type:"button",onSelect:t,style:{position:"relative",width:r?void 0:"auto"},title:M("labels.liveCollaboration"),children:[r?jw:M("labels.share"),s.collaborators.size>0&&g("div",{className:"CollabButton-collaborators",children:s.collaborators.size})]})};NY.displayName="LiveCollaborationTrigger";const a9e=()=>g("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"ExcalidrawLogo-icon",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),l9e=()=>N("svg",{viewBox:"0 0 450 55",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"ExcalidrawLogo-text",children:[g("path",{d:"M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",fill:"currentColor",transform:"translate(-144.023 -51.76)"})]}),OY=({style:e,size:t="small",withText:n})=>N("div",{className:`ExcalidrawLogo is-${t}`,style:e,children:[g(a9e,{}),n&&g(l9e,{})]}),aI=({icon:e,shortcut:t,children:n})=>{const i=Hn();return N(he,{children:[g("div",{className:"welcome-screen-menu-item__icon",children:e}),g("div",{className:"welcome-screen-menu-item__text",children:n}),t&&i.formFactor!=="phone"&&g("div",{className:"welcome-screen-menu-item__shortcut",children:t})]})};aI.displayName="WelcomeScreenMenuItemContent";const Qp=({onSelect:e,children:t,icon:n,shortcut:i,className:s="",...r})=>g("button",{...r,type:"button",className:`welcome-screen-menu-item ${s}`,onClick:e,children:g(aI,{icon:n,shortcut:i,children:t})});Qp.displayName="WelcomeScreenMenuItem";const FY=({children:e,href:t,icon:n,shortcut:i,className:s="",...r})=>g("a",{...r,className:`welcome-screen-menu-item ${s}`,href:t,target:"_blank",rel:"noopener",children:g(aI,{icon:n,shortcut:i,children:e})});FY.displayName="WelcomeScreenMenuItemLink";const xo=({children:e})=>{const{WelcomeScreenCenterTunnel:t}=is();return g(t.In,{children:g("div",{className:"welcome-screen-center",children:e||N(he,{children:[g(lI,{}),g(cI,{children:M("welcomeScreen.defaults.center_heading")}),N(dI,{children:[g(fI,{}),g(uI,{})]})]})})})};xo.displayName="Center";const lI=({children:e})=>g("div",{className:"welcome-screen-center__logo excalifont welcome-screen-decor",children:e||g(OY,{withText:!0})});lI.displayName="Logo";const cI=({children:e})=>g("div",{className:"welcome-screen-center__heading welcome-screen-decor excalifont",children:e});cI.displayName="Heading";const dI=({children:e})=>g("div",{className:"welcome-screen-menu",children:e});dI.displayName="Menu";const uI=()=>{const e=Bs();return g(Qp,{onSelect:()=>e.executeAction(FT),shortcut:"?",icon:$w,children:M("helpDialog.title")})};uI.displayName="MenuItemHelp";const fI=()=>{const e=di(),t=Bs();return e.viewModeEnabled?null:g(Qp,{onSelect:()=>t.executeAction(Sv),shortcut:es("loadScene"),icon:Xw,children:M("buttons.load")})};fI.displayName="MenuItemLoadScene";const BY=({onSelect:e})=>{const{t}=mn();return g(Qp,{shortcut:null,onSelect:e,icon:Yw,children:t("labels.liveCollaboration")})};BY.displayName="MenuItemLiveCollaborationTrigger";xo.Logo=lI;xo.Heading=cI;xo.Menu=dI;xo.MenuItem=Qp;xo.MenuItemLink=FY;xo.MenuItemHelp=uI;xo.MenuItemLoadScene=fI;xo.MenuItemLiveCollaborationTrigger=BY;const hI=({children:e})=>{const{WelcomeScreenMenuHintTunnel:t}=is();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",children:[Uue,g("div",{className:"welcome-screen-decor-hint__label",children:e||M("welcomeScreen.defaults.menuHint")})]})})};hI.displayName="MenuHint";const gI=({children:e})=>{const{WelcomeScreenToolbarHintTunnel:t}=is();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",children:[g("div",{className:"welcome-screen-decor-hint__label",children:e||M("welcomeScreen.defaults.toolbarHint")}),yue]})})};gI.displayName="ToolbarHint";const mI=({children:e})=>{const{WelcomeScreenHelpHintTunnel:t}=is();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",children:[g("div",{children:e||M("welcomeScreen.defaults.helpHint")}),bue]})})};mI.displayName="HelpHint";const cs=e=>g(he,{children:e.children||N(he,{children:[g(xo,{}),g(hI,{}),g(gI,{}),g(mI,{})]})});cs.displayName="WelcomeScreen";cs.Center=xo;cs.Hints={MenuHint:hI,ToolbarHint:gI,HelpHint:mI};const zY=()=>{Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(e){if(e=Math.trunc(e)||0,e<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...e){this.innerHTML="",this.append(...e)})},c9e=(e,t,n)=>{var i,s,r;return!!(t&&(t.id===((i=e.editingTextElement)==null?void 0:i.id)||t.id===((s=e.resizingElement)==null?void 0:s.id)||t.id===((r=e.newElement)==null?void 0:r.id)||t.version>n.version||t.version===n.version&&t.versionNonce<n.versionNonce))},d9e=jo((e,t,n)=>{if(window!=null&&window.DEBUG_FRACTIONAL_INDICES){const i=fd(e.map(s=>({...s})));fw(i,{shouldThrow:k_(),includeBoundTextValidation:!0,reconciliationContext:{localElements:t,remoteElements:n}})}},1e3*60,{leading:!0,trailing:!1}),pI=(e,t,n)=>{const i=be(e),s=[],r=new Set;for(const a of t)if(!r.has(a.id)){const l=i.get(a.id),c=c9e(n,l,a);l&&c?(s.push(l),r.add(l.id)):(s.push(a),r.add(a.id))}for(const a of e)r.has(a.id)||(s.push(a),r.add(a.id));const o=hw(s);return d9e(o,e,t),fd(o),o},HY=({children:e,icon:t})=>{const{t:n}=mn(),{TTDDialogTriggerTunnel:i}=is(),s=kn();return g(i.In,{children:N(Ve.Item,{onSelect:()=>{it("ai","dialog open","ttd"),s({openDialog:{name:"ttd",tab:"text-to-diagram"}})},icon:t??Mfe,children:[e??n("labels.textToDiagram"),g(Ve.Item.Badge,{children:"AI"})]})})};HY.displayName="TTDDialogTrigger";const u9e=e=>{const t=So();return L.useLayoutEffect(()=>{t.setPlugins({diagramToCode:{generate:e.generate}})},[t,e.generate]),null};zY();const f9e=e=>{var ee,se,oe,Fe;const{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:s,isCollaborating:r=!1,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c=Yu.code,viewModeEnabled:d,zenModeEnabled:u,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,onPaste:b,detectScroll:y=!0,handleKeyboardGlobally:v=!1,onLibraryChange:_,autoFocus:I=!1,generateIdForFile:R,onLinkOpen:T,generateLinkForSelection:w,onPointerDown:S,onPointerUp:x,onScrollChange:k,onDuplicate:P,children:D,validateEmbeddable:j,renderEmbeddable:G,aiEnabled:V,showDeprecatedFonts:B,renderScrollbars:z}=e,X=(ee=e.UIOptions)==null?void 0:ee.canvasActions,Y={...e.UIOptions,canvasActions:{...MC.canvasActions,...X},tools:{image:((oe=(se=e.UIOptions)==null?void 0:se.tools)==null?void 0:oe.image)??!0}};return X!=null&&X.export&&(Y.canvasActions.export.saveFileToDisk=((Fe=X.export)==null?void 0:Fe.saveFileToDisk)??MC.canvasActions.export.saveFileToDisk),Y.canvasActions.toggleTheme===null&&typeof m>"u"&&(Y.canvasActions.toggleTheme=!0),L.useEffect(()=>{(async()=>{await pe(()=>import("./roundRect-0PYZxl1G.js"),__vite__mapDeps([]))})();const Me=Ne=>{typeof Ne.scale=="number"&&Ne.scale!==1&&Ne.preventDefault()};return document.addEventListener("touchmove",Me,{passive:!1}),()=>{document.removeEventListener("touchmove",Me)}},[]),g(oue,{store:Zs,children:g(o9e,{langCode:c,theme:m,children:g(oI,{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:s,isCollaborating:r,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c,viewModeEnabled:d,zenModeEnabled:u,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,UIOptions:Y,onPaste:b,detectScroll:y,handleKeyboardGlobally:v,onLibraryChange:_,autoFocus:I,generateIdForFile:R,onLinkOpen:T,generateLinkForSelection:w,onPointerDown:S,onPointerUp:x,onScrollChange:k,onDuplicate:P,validateEmbeddable:j,renderEmbeddable:G,aiEnabled:V!==!1,showDeprecatedFonts:B,renderScrollbars:z,children:D})})})},h9e=(e,t)=>{if(e.children!==t.children)return!1;const{initialData:n,UIOptions:i={},...s}=e,{initialData:r,UIOptions:o={},...a}=t,l=Object.keys(i),c=Object.keys(o);return l.length!==c.length?!1:l.every(u=>u==="canvasActions"?Object.keys(i.canvasActions).every(h=>{var m,p,U,b;return h==="export"&&((m=i==null?void 0:i.canvasActions)!=null&&m.export)&&((p=o==null?void 0:o.canvasActions)!=null&&p.export)?i.canvasActions.export.saveFileToDisk===o.canvasActions.export.saveFileToDisk:((U=i==null?void 0:i.canvasActions)==null?void 0:U[h])===((b=o==null?void 0:o.canvasActions)==null?void 0:b[h])}):i[u]===o[u])&&vi(s,a)},VY=de.memo(f9e,h9e);VY.displayName="Excalidraw";const g9e=({link:e,onCloseRequest:t,setErrorMessage:n})=>{const{t:i}=mn(),[,s]=L.useState(!1),r=L.useRef(0),o=L.useRef(null),a=async()=>{var d;try{await gd(e)}catch{n(i("errors.copyToSystemClipboardFailed"))}s(!0),r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{s(!1)},3e3),(d=o.current)==null||d.select()},{onCopy:l,copyStatus:c}=JT();return g(dr,{onCloseRequest:t,title:!1,size:"small",children:N("div",{className:"ShareableLinkDialog",children:[g("h3",{children:"Shareable link"}),N("div",{className:"ShareableLinkDialog__linkRow",children:[g(Ru,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:e,selectOnRender:!0}),g(Or,{size:"large",label:i("buttons.copyLink"),icon:Vp,status:c,onClick:()=>{l(),a()}})]}),N("div",{className:"ShareableLinkDialog__description",children:[" ",i("alerts.uploadedSecurly")]})]})})},m9e=300,p9e=5e3,U9e=300,b9e=500,nD=2e4,y9e=50,E9e=33,v9e=24*60*60*1e3,UI=4*1024*1024,_9e=31536e3,gb={SERVER_VOLATILE:"server-volatile-broadcast",SERVER:"server-broadcast",USER_FOLLOW_CHANGE:"user-follow",USER_FOLLOW_ROOM_CHANGE:"user-follow-room-change"};var us=(e=>(e.INVALID_RESPONSE="INVALID_RESPONSE",e.INIT="SCENE_INIT",e.UPDATE="SCENE_UPDATE",e.MOUSE_LOCATION="MOUSE_LOCATION",e.IDLE_STATUS="IDLE_STATUS",e.USER_VISIBLE_SCENE_BOUNDS="USER_VISIBLE_SCENE_BOUNDS",e))(us||{});const $Y={shareLinkFiles:"/files/shareLinks",collabFiles:"/files/rooms"},w9e=10,An={LOCAL_STORAGE_ELEMENTS:"excalidraw",LOCAL_STORAGE_APP_STATE:"excalidraw-state",LOCAL_STORAGE_COLLAB:"excalidraw-collab",LOCAL_STORAGE_THEME:"excalidraw-theme",LOCAL_STORAGE_DEBUG:"excalidraw-debug",VERSION_DATA_STATE:"version-dataState",VERSION_FILES:"version-files",IDB_LIBRARY:"excalidraw-library",__LEGACY_LOCAL_STORAGE_LIBRARY:"excalidraw-library"},T9e={AUTH_STATE_COOKIE:"excplus-auth"},Lu=document.cookie.includes(T9e.AUTH_STATE_COOKIE),I9e=e=>{try{localStorage.setItem(An.LOCAL_STORAGE_COLLAB,JSON.stringify({username:e}))}catch(t){console.error(t)}},GY=()=>{try{const e=localStorage.getItem(An.LOCAL_STORAGE_COLLAB);if(e)return JSON.parse(e).username}catch(e){console.error(e)}return null},XY=()=>{let e=null,t=null;try{e=localStorage.getItem(An.LOCAL_STORAGE_ELEMENTS),t=localStorage.getItem(An.LOCAL_STORAGE_APP_STATE)}catch(s){console.error(s)}let n=[];if(e)try{n=JSON.parse(e)}catch(s){console.error(s)}let i=null;if(t)try{i={...da(),...rG(JSON.parse(t))}}catch(s){console.error(s)}return{elements:n,appState:i}},jY=()=>{try{const e=localStorage.getItem(An.LOCAL_STORAGE_ELEMENTS);return(e==null?void 0:e.length)||0}catch(e){return console.error(e),0}},S9e=()=>{try{const e=localStorage.getItem(An.LOCAL_STORAGE_APP_STATE),t=localStorage.getItem(An.LOCAL_STORAGE_COLLAB),n=(e==null?void 0:e.length)||0,i=(t==null?void 0:t.length)||0;return n+i+jY()}catch(e){return console.error(e),0}},x9e=500,iD=ul(e=>{e({scene:jY(),total:S9e()})},x9e),C9e=e=>{const[t,n]=L.useState({scene:0,total:0});L.useEffect(()=>{iD(o=>{n(o)})},[e.elements,e.appState]),L.useEffect(()=>()=>iD.cancel(),[]);const i=u4();let s,r;return i!==kF?(r=i.slice(0,16).replace("T"," "),s=i.slice(21)):r=M("stats.versionNotAvailable"),N(Pa.StatsRows,{order:-1,children:[g(Pa.StatsRow,{heading:!0,children:M("stats.version")}),N(Pa.StatsRow,{style:{textAlign:"center",cursor:"pointer"},onClick:async()=>{try{await gd(u4()),e.setToast(M("toast.copyToClipboard"))}catch{}},title:M("stats.versionCopy"),children:[r,g("br",{}),s]}),g(Pa.StatsRow,{heading:!0,children:M("stats.storage")}),N(Pa.StatsRow,{columns:2,children:[g("div",{children:M("stats.scene")}),g("div",{children:BC(t.scene,1)})]}),N(Pa.StatsRow,{columns:2,children:[g("div",{children:M("stats.total")}),g("div",{children:BC(t.total,1)})]})]})},to=zp(),A9e=(e,t)=>{const[n,i]=tg(e);return L.useLayoutEffect(()=>{i(typeof t=="function"?t():t)},[]),[n,i]};class YY{constructor({getFiles:t,saveFiles:n}){F(this,"fetchingFiles",new Map);F(this,"erroredFiles_fetch",new Map);F(this,"savingFiles",new Map);F(this,"savedFiles",new Map);F(this,"erroredFiles_save",new Map);F(this,"_getFiles");F(this,"_saveFiles");F(this,"isFileTracked",t=>this.savedFiles.has(t)||this.savingFiles.has(t)||this.fetchingFiles.has(t)||this.erroredFiles_fetch.has(t)||this.erroredFiles_save.has(t));F(this,"isFileSavedOrBeingSaved",t=>{const n=this.getFileVersion(t);return this.savedFiles.get(t.id)===n||this.savingFiles.get(t.id)===n});F(this,"getFileVersion",t=>t.version??1);F(this,"saveFiles",async({elements:t,files:n})=>{const i=new Map;for(const s of t){const r=On(s)&&n[s.fileId];r&&!this.isFileSavedOrBeingSaved(r)&&(i.set(s.fileId,n[s.fileId]),this.savingFiles.set(s.fileId,this.getFileVersion(r)))}try{const{savedFiles:s,erroredFiles:r}=await this._saveFiles({addedFiles:i});for(const[o,a]of s)this.savedFiles.set(o,this.getFileVersion(a));for(const[o,a]of r)this.erroredFiles_save.set(o,this.getFileVersion(a));return{savedFiles:s,erroredFiles:r}}finally{for(const[s]of i)this.savingFiles.delete(s)}});F(this,"getFiles",async t=>{if(!t.length)return{loadedFiles:[],erroredFiles:new Map};for(const n of t)this.fetchingFiles.set(n,!0);try{const{loadedFiles:n,erroredFiles:i}=await this._getFiles(t);for(const s of n)this.savedFiles.set(s.id,this.getFileVersion(s));for(const[s]of i)this.erroredFiles_fetch.set(s,!0);return{loadedFiles:n,erroredFiles:i}}finally{for(const n of t)this.fetchingFiles.delete(n)}});F(this,"shouldPreventUnload",t=>t.some(n=>On(n)&&!n.isDeleted&&this.savingFiles.has(n.fileId)));F(this,"shouldUpdateImageElementStatus",t=>On(t)&&this.savedFiles.has(t.fileId)&&t.status==="pending");this._getFiles=t,this._saveFiles=n}reset(){this.fetchingFiles.clear(),this.savingFiles.clear(),this.savedFiles.clear(),this.erroredFiles_fetch.clear(),this.erroredFiles_save.clear()}}const bI=async({files:e,maxBytes:t,encryptionKey:n})=>{const i=[];for(const[s,r]of e){const o=new TextEncoder().encode(r.dataURL),a=await nX(o,{encryptionKey:n,metadata:{id:s,mimeType:r.mimeType,created:Date.now(),lastRetrieved:Date.now()}});if(o.byteLength>t)throw new Error(M("errors.fileTooBig",{maxSize:`${Math.trunc(t/1024/1024)}MB`}));i.push({id:s,buffer:a})}return i},sm=e=>{e.erroredFiles.size&&e.excalidrawAPI.updateScene({elements:e.excalidrawAPI.getSceneElementsIncludingDeleted().map(t=>On(t)&&e.erroredFiles.has(t.fileId)?Te(t,{status:"error"}):t),captureUpdate:q.NEVER})};var sD={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WY=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},M9e=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=e[n++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=e[n++],o=e[n++],a=e[n++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const r=e[n++],o=e[n++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},KY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<e.length;s+=3){const r=e[s],o=s+1<e.length,a=o?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,d=r>>2,u=(r&3)<<4|a>>4;let f=(a&15)<<2|c>>6,h=c&63;l||(h=64,o||(f=64)),i.push(n[d],n[u],n[f],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(WY(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):M9e(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<e.length;){const r=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const c=s<e.length?n[e.charAt(s)]:64;++s;const u=s<e.length?n[e.charAt(s)]:64;if(++s,r==null||a==null||c==null||u==null)throw new k9e;const f=r<<2|a>>4;if(i.push(f),c!==64){const h=a<<4&240|c>>2;if(i.push(h),u!==64){const m=c<<6&192|u;i.push(m)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class k9e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const R9e=function(e){const t=WY(e);return KY.encodeByteArray(t,!0)},c5=function(e){return R9e(e).replace(/\./g,"")},L9e=function(e){try{return KY.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D9e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9e=()=>D9e().__FIREBASE_DEFAULTS__,N9e=()=>{if(typeof process>"u"||typeof sD>"u")return;const e=sD.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},O9e=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&L9e(e[1]);return t&&JSON.parse(t)},yI=()=>{try{return P9e()||N9e()||O9e()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},F9e=e=>{var t,n;return(n=(t=yI())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},ZY=e=>{const t=F9e(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},qY=()=>{var e;return(e=yI())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QY(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",s=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[c5(JSON.stringify(n)),c5(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z9e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H9e(){var e;const t=(e=yI())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V9e(){return!H9e()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $9e(){try{return typeof indexedDB=="object"}catch{return!1}}function G9e(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var r;t(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X9e="FirebaseError";class qu extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=X9e,Object.setPrototypeOf(this,qu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,JY.prototype.create)}}class JY{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?j9e(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new qu(s,a,i)}}function j9e(e,t){return e.replace(Y9e,(n,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const Y9e=/\{\$([^}]+)}/g;function Kv(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const r=e[s],o=t[s];if(rD(r)&&rD(o)){if(!Kv(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function rD(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(e){return e&&e._delegate?e._delegate:e}class ug{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W9e{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new B9e;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Z9e(t))try{this.getOrInitializeService({instanceIdentifier:Ad})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Ad){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ad){return this.instances.has(t)}getOptions(t=Ad){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,n){var i;const s=this.normalizeInstanceIdentifier(n),r=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;r.add(t),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&t(o,s),()=>{r.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const s of i)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:K9e(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Ad){return this.component?this.component.multipleInstances?t:Ad:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K9e(e){return e===Ad?void 0:e}function Z9e(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9e{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new W9e(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ht||(ht={}));const Q9e={debug:ht.DEBUG,verbose:ht.VERBOSE,info:ht.INFO,warn:ht.WARN,error:ht.ERROR,silent:ht.SILENT},J9e=ht.INFO,e_e={[ht.DEBUG]:"log",[ht.VERBOSE]:"log",[ht.INFO]:"info",[ht.WARN]:"warn",[ht.ERROR]:"error"},t_e=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),s=e_e[t];if(s)console[s](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class eW{constructor(t){this.name=t,this._logLevel=J9e,this._logHandler=t_e,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ht))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Q9e[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ht.DEBUG,...t),this._logHandler(this,ht.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ht.VERBOSE,...t),this._logHandler(this,ht.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ht.INFO,...t),this._logHandler(this,ht.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ht.WARN,...t),this._logHandler(this,ht.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ht.ERROR,...t),this._logHandler(this,ht.ERROR,...t)}}const n_e=(e,t)=>t.some(n=>e instanceof n);let oD,aD;function i_e(){return oD||(oD=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s_e(){return aD||(aD=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tW=new WeakMap,Zv=new WeakMap,nW=new WeakMap,Q3=new WeakMap,EI=new WeakMap;function r_e(e){const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{n(kc(e.result)),s()},o=()=>{i(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&tW.set(n,e)}).catch(()=>{}),EI.set(t,e),t}function o_e(e){if(Zv.has(e))return;const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{n(),s()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)});Zv.set(e,t)}let qv={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Zv.get(e);if(t==="objectStoreNames")return e.objectStoreNames||nW.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kc(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function a_e(e){qv=e(qv)}function l_e(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(J3(this),t,...n);return nW.set(i,t.sort?t.sort():[t]),kc(i)}:s_e().includes(e)?function(...t){return e.apply(J3(this),t),kc(tW.get(this))}:function(...t){return kc(e.apply(J3(this),t))}}function c_e(e){return typeof e=="function"?l_e(e):(e instanceof IDBTransaction&&o_e(e),n_e(e,i_e())?new Proxy(e,qv):e)}function kc(e){if(e instanceof IDBRequest)return r_e(e);if(Q3.has(e))return Q3.get(e);const t=c_e(e);return t!==e&&(Q3.set(e,t),EI.set(t,e)),t}const J3=e=>EI.get(e);function d_e(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=kc(o);return i&&o.addEventListener("upgradeneeded",l=>{i(kc(o.result),l.oldVersion,l.newVersion,kc(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const u_e=["get","getKey","getAll","getAllKeys","count"],f_e=["put","add","delete","clear"],e7=new Map;function lD(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(e7.get(t))return e7.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=f_e.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||u_e.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return e7.set(t,r),r}a_e(e=>({...e,get:(t,n,i)=>lD(t,n)||e.get(t,n,i),has:(t,n)=>!!lD(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_e{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(g_e(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function g_e(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Qv="@firebase/app",cD="0.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=new eW("@firebase/app"),m_e="@firebase/app-compat",p_e="@firebase/analytics-compat",U_e="@firebase/analytics",b_e="@firebase/app-check-compat",y_e="@firebase/app-check",E_e="@firebase/auth",v_e="@firebase/auth-compat",__e="@firebase/database",w_e="@firebase/data-connect",T_e="@firebase/database-compat",I_e="@firebase/functions",S_e="@firebase/functions-compat",x_e="@firebase/installations",C_e="@firebase/installations-compat",A_e="@firebase/messaging",M_e="@firebase/messaging-compat",k_e="@firebase/performance",R_e="@firebase/performance-compat",L_e="@firebase/remote-config",D_e="@firebase/remote-config-compat",P_e="@firebase/storage",N_e="@firebase/storage-compat",O_e="@firebase/firestore",F_e="@firebase/vertexai",B_e="@firebase/firestore-compat",z_e="firebase",H_e="11.3.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv="[DEFAULT]",V_e={[Qv]:"fire-core",[m_e]:"fire-core-compat",[U_e]:"fire-analytics",[p_e]:"fire-analytics-compat",[y_e]:"fire-app-check",[b_e]:"fire-app-check-compat",[E_e]:"fire-auth",[v_e]:"fire-auth-compat",[__e]:"fire-rtdb",[w_e]:"fire-data-connect",[T_e]:"fire-rtdb-compat",[I_e]:"fire-fn",[S_e]:"fire-fn-compat",[x_e]:"fire-iid",[C_e]:"fire-iid-compat",[A_e]:"fire-fcm",[M_e]:"fire-fcm-compat",[k_e]:"fire-perf",[R_e]:"fire-perf-compat",[L_e]:"fire-rc",[D_e]:"fire-rc-compat",[P_e]:"fire-gcs",[N_e]:"fire-gcs-compat",[O_e]:"fire-fst",[B_e]:"fire-fst-compat",[F_e]:"fire-vertex","fire-js":"fire-js",[z_e]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5=new Map,$_e=new Map,e9=new Map;function dD(e,t){try{e.container.addComponent(t)}catch(n){wl.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function q0(e){const t=e.name;if(e9.has(t))return wl.debug(`There were multiple attempts to register component ${t}.`),!1;e9.set(t,e);for(const n of d5.values())dD(n,e);for(const n of $_e.values())dD(n,e);return!0}function iW(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function sW(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_e={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rc=new JY("app","Firebase",G_e);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_e{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ug("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Rc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW=H_e;function oW(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:Jv,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Rc.create("bad-app-name",{appName:String(s)});if(n||(n=qY()),!n)throw Rc.create("no-options");const r=d5.get(s);if(r){if(Kv(n,r.options)&&Kv(i,r.config))return r;throw Rc.create("duplicate-app",{appName:s})}const o=new q9e(s);for(const l of e9.values())o.addComponent(l);const a=new X_e(n,i,o);return d5.set(s,a),a}function aW(e=Jv){const t=d5.get(e);if(!t&&e===Jv&&qY())return oW();if(!t)throw Rc.create("no-app",{appName:e});return t}function Lc(e,t,n){var i;let s=(i=V_e[e])!==null&&i!==void 0?i:e;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${t}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),wl.warn(a.join(" "));return}q0(new ug(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_e="firebase-heartbeat-database",Y_e=1,Q0="firebase-heartbeat-store";let t7=null;function lW(){return t7||(t7=d_e(j_e,Y_e,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Q0)}catch(n){console.warn(n)}}}}).catch(e=>{throw Rc.create("idb-open",{originalErrorMessage:e.message})})),t7}async function W_e(e){try{const n=(await lW()).transaction(Q0),i=await n.objectStore(Q0).get(cW(e));return await n.done,i}catch(t){if(t instanceof qu)wl.warn(t.message);else{const n=Rc.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});wl.warn(n.message)}}}async function uD(e,t){try{const i=(await lW()).transaction(Q0,"readwrite");await i.objectStore(Q0).put(t,cW(e)),await i.done}catch(n){if(n instanceof qu)wl.warn(n.message);else{const i=Rc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});wl.warn(i.message)}}}function cW(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_e=1024,Z_e=30;class q_e{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new J_e(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=fD();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats.length>Z_e){const o=ewe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){wl.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=fD(),{heartbeatsToSend:i,unsentEntries:s}=Q_e(this._heartbeatsCache.heartbeats),r=c5(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return wl.warn(n),""}}}function fD(){return new Date().toISOString().substring(0,10)}function Q_e(e,t=K_e){const n=[];let i=e.slice();for(const s of e){const r=n.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),hD(n)>t){r.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),hD(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class J_e{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $9e()?G9e().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await W_e(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return uD(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return uD(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function hD(e){return c5(JSON.stringify({version:2,heartbeats:e})).length}function ewe(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function twe(e){q0(new ug("platform-logger",t=>new h_e(t),"PRIVATE")),q0(new ug("heartbeat",t=>new q_e(t),"PRIVATE")),Lc(Qv,cD,e),Lc(Qv,cD,"esm2017"),Lc("fire-js","")}twe("");var nwe="firebase",iwe="11.3.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lc(nwe,iwe,"app");var gD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Dc,dW;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(T,w){function S(){}S.prototype=w.prototype,T.D=w.prototype,T.prototype=new S,T.prototype.constructor=T,T.C=function(x,k,P){for(var D=Array(arguments.length-2),j=2;j<arguments.length;j++)D[j-2]=arguments[j];return w.prototype[k].apply(x,D)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,w,S){S||(S=0);var x=Array(16);if(typeof w=="string")for(var k=0;16>k;++k)x[k]=w.charCodeAt(S++)|w.charCodeAt(S++)<<8|w.charCodeAt(S++)<<16|w.charCodeAt(S++)<<24;else for(k=0;16>k;++k)x[k]=w[S++]|w[S++]<<8|w[S++]<<16|w[S++]<<24;w=T.g[0],S=T.g[1],k=T.g[2];var P=T.g[3],D=w+(P^S&(k^P))+x[0]+3614090360&4294967295;w=S+(D<<7&4294967295|D>>>25),D=P+(k^w&(S^k))+x[1]+3905402710&4294967295,P=w+(D<<12&4294967295|D>>>20),D=k+(S^P&(w^S))+x[2]+606105819&4294967295,k=P+(D<<17&4294967295|D>>>15),D=S+(w^k&(P^w))+x[3]+3250441966&4294967295,S=k+(D<<22&4294967295|D>>>10),D=w+(P^S&(k^P))+x[4]+4118548399&4294967295,w=S+(D<<7&4294967295|D>>>25),D=P+(k^w&(S^k))+x[5]+1200080426&4294967295,P=w+(D<<12&4294967295|D>>>20),D=k+(S^P&(w^S))+x[6]+2821735955&4294967295,k=P+(D<<17&4294967295|D>>>15),D=S+(w^k&(P^w))+x[7]+4249261313&4294967295,S=k+(D<<22&4294967295|D>>>10),D=w+(P^S&(k^P))+x[8]+1770035416&4294967295,w=S+(D<<7&4294967295|D>>>25),D=P+(k^w&(S^k))+x[9]+2336552879&4294967295,P=w+(D<<12&4294967295|D>>>20),D=k+(S^P&(w^S))+x[10]+4294925233&4294967295,k=P+(D<<17&4294967295|D>>>15),D=S+(w^k&(P^w))+x[11]+2304563134&4294967295,S=k+(D<<22&4294967295|D>>>10),D=w+(P^S&(k^P))+x[12]+1804603682&4294967295,w=S+(D<<7&4294967295|D>>>25),D=P+(k^w&(S^k))+x[13]+4254626195&4294967295,P=w+(D<<12&4294967295|D>>>20),D=k+(S^P&(w^S))+x[14]+2792965006&4294967295,k=P+(D<<17&4294967295|D>>>15),D=S+(w^k&(P^w))+x[15]+1236535329&4294967295,S=k+(D<<22&4294967295|D>>>10),D=w+(k^P&(S^k))+x[1]+4129170786&4294967295,w=S+(D<<5&4294967295|D>>>27),D=P+(S^k&(w^S))+x[6]+3225465664&4294967295,P=w+(D<<9&4294967295|D>>>23),D=k+(w^S&(P^w))+x[11]+643717713&4294967295,k=P+(D<<14&4294967295|D>>>18),D=S+(P^w&(k^P))+x[0]+3921069994&4294967295,S=k+(D<<20&4294967295|D>>>12),D=w+(k^P&(S^k))+x[5]+3593408605&4294967295,w=S+(D<<5&4294967295|D>>>27),D=P+(S^k&(w^S))+x[10]+38016083&4294967295,P=w+(D<<9&4294967295|D>>>23),D=k+(w^S&(P^w))+x[15]+3634488961&4294967295,k=P+(D<<14&4294967295|D>>>18),D=S+(P^w&(k^P))+x[4]+3889429448&4294967295,S=k+(D<<20&4294967295|D>>>12),D=w+(k^P&(S^k))+x[9]+568446438&4294967295,w=S+(D<<5&4294967295|D>>>27),D=P+(S^k&(w^S))+x[14]+3275163606&4294967295,P=w+(D<<9&4294967295|D>>>23),D=k+(w^S&(P^w))+x[3]+4107603335&4294967295,k=P+(D<<14&4294967295|D>>>18),D=S+(P^w&(k^P))+x[8]+1163531501&4294967295,S=k+(D<<20&4294967295|D>>>12),D=w+(k^P&(S^k))+x[13]+2850285829&4294967295,w=S+(D<<5&4294967295|D>>>27),D=P+(S^k&(w^S))+x[2]+4243563512&4294967295,P=w+(D<<9&4294967295|D>>>23),D=k+(w^S&(P^w))+x[7]+1735328473&4294967295,k=P+(D<<14&4294967295|D>>>18),D=S+(P^w&(k^P))+x[12]+2368359562&4294967295,S=k+(D<<20&4294967295|D>>>12),D=w+(S^k^P)+x[5]+4294588738&4294967295,w=S+(D<<4&4294967295|D>>>28),D=P+(w^S^k)+x[8]+2272392833&4294967295,P=w+(D<<11&4294967295|D>>>21),D=k+(P^w^S)+x[11]+1839030562&4294967295,k=P+(D<<16&4294967295|D>>>16),D=S+(k^P^w)+x[14]+4259657740&4294967295,S=k+(D<<23&4294967295|D>>>9),D=w+(S^k^P)+x[1]+2763975236&4294967295,w=S+(D<<4&4294967295|D>>>28),D=P+(w^S^k)+x[4]+1272893353&4294967295,P=w+(D<<11&4294967295|D>>>21),D=k+(P^w^S)+x[7]+4139469664&4294967295,k=P+(D<<16&4294967295|D>>>16),D=S+(k^P^w)+x[10]+3200236656&4294967295,S=k+(D<<23&4294967295|D>>>9),D=w+(S^k^P)+x[13]+681279174&4294967295,w=S+(D<<4&4294967295|D>>>28),D=P+(w^S^k)+x[0]+3936430074&4294967295,P=w+(D<<11&4294967295|D>>>21),D=k+(P^w^S)+x[3]+3572445317&4294967295,k=P+(D<<16&4294967295|D>>>16),D=S+(k^P^w)+x[6]+76029189&4294967295,S=k+(D<<23&4294967295|D>>>9),D=w+(S^k^P)+x[9]+3654602809&4294967295,w=S+(D<<4&4294967295|D>>>28),D=P+(w^S^k)+x[12]+3873151461&4294967295,P=w+(D<<11&4294967295|D>>>21),D=k+(P^w^S)+x[15]+530742520&4294967295,k=P+(D<<16&4294967295|D>>>16),D=S+(k^P^w)+x[2]+3299628645&4294967295,S=k+(D<<23&4294967295|D>>>9),D=w+(k^(S|~P))+x[0]+4096336452&4294967295,w=S+(D<<6&4294967295|D>>>26),D=P+(S^(w|~k))+x[7]+1126891415&4294967295,P=w+(D<<10&4294967295|D>>>22),D=k+(w^(P|~S))+x[14]+2878612391&4294967295,k=P+(D<<15&4294967295|D>>>17),D=S+(P^(k|~w))+x[5]+4237533241&4294967295,S=k+(D<<21&4294967295|D>>>11),D=w+(k^(S|~P))+x[12]+1700485571&4294967295,w=S+(D<<6&4294967295|D>>>26),D=P+(S^(w|~k))+x[3]+2399980690&4294967295,P=w+(D<<10&4294967295|D>>>22),D=k+(w^(P|~S))+x[10]+4293915773&4294967295,k=P+(D<<15&4294967295|D>>>17),D=S+(P^(k|~w))+x[1]+2240044497&4294967295,S=k+(D<<21&4294967295|D>>>11),D=w+(k^(S|~P))+x[8]+1873313359&4294967295,w=S+(D<<6&4294967295|D>>>26),D=P+(S^(w|~k))+x[15]+4264355552&4294967295,P=w+(D<<10&4294967295|D>>>22),D=k+(w^(P|~S))+x[6]+2734768916&4294967295,k=P+(D<<15&4294967295|D>>>17),D=S+(P^(k|~w))+x[13]+1309151649&4294967295,S=k+(D<<21&4294967295|D>>>11),D=w+(k^(S|~P))+x[4]+4149444226&4294967295,w=S+(D<<6&4294967295|D>>>26),D=P+(S^(w|~k))+x[11]+3174756917&4294967295,P=w+(D<<10&4294967295|D>>>22),D=k+(w^(P|~S))+x[2]+718787259&4294967295,k=P+(D<<15&4294967295|D>>>17),D=S+(P^(k|~w))+x[9]+3951481745&4294967295,T.g[0]=T.g[0]+w&4294967295,T.g[1]=T.g[1]+(k+(D<<21&4294967295|D>>>11))&4294967295,T.g[2]=T.g[2]+k&4294967295,T.g[3]=T.g[3]+P&4294967295}i.prototype.u=function(T,w){w===void 0&&(w=T.length);for(var S=w-this.blockSize,x=this.B,k=this.h,P=0;P<w;){if(k==0)for(;P<=S;)s(this,T,P),P+=this.blockSize;if(typeof T=="string"){for(;P<w;)if(x[k++]=T.charCodeAt(P++),k==this.blockSize){s(this,x),k=0;break}}else for(;P<w;)if(x[k++]=T[P++],k==this.blockSize){s(this,x),k=0;break}}this.h=k,this.o+=w},i.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var w=1;w<T.length-8;++w)T[w]=0;var S=8*this.o;for(w=T.length-8;w<T.length;++w)T[w]=S&255,S/=256;for(this.u(T),T=Array(16),w=S=0;4>w;++w)for(var x=0;32>x;x+=8)T[S++]=this.g[w]>>>x&255;return T};function r(T,w){var S=a;return Object.prototype.hasOwnProperty.call(S,T)?S[T]:S[T]=w(T)}function o(T,w){this.h=w;for(var S=[],x=!0,k=T.length-1;0<=k;k--){var P=T[k]|0;x&&P==w||(S[k]=P,x=!1)}this.g=S}var a={};function l(T){return-128<=T&&128>T?r(T,function(w){return new o([w|0],0>w?-1:0)}):new o([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return u;if(0>T)return U(c(-T));for(var w=[],S=1,x=0;T>=S;x++)w[x]=T/S|0,S*=4294967296;return new o(w,0)}function d(T,w){if(T.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(T.charAt(0)=="-")return U(d(T.substring(1),w));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(w,8)),x=u,k=0;k<T.length;k+=8){var P=Math.min(8,T.length-k),D=parseInt(T.substring(k,k+P),w);8>P?(P=c(Math.pow(w,P)),x=x.j(P).add(c(D))):(x=x.j(S),x=x.add(c(D)))}return x}var u=l(0),f=l(1),h=l(16777216);e=o.prototype,e.m=function(){if(p(this))return-U(this).m();for(var T=0,w=1,S=0;S<this.g.length;S++){var x=this.i(S);T+=(0<=x?x:4294967296+x)*w,w*=4294967296}return T},e.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(m(this))return"0";if(p(this))return"-"+U(this).toString(T);for(var w=c(Math.pow(T,6)),S=this,x="";;){var k=_(S,w).g;S=b(S,k.j(w));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(T);if(S=k,m(S))return P+x;for(;6>P.length;)P="0"+P;x=P+x}},e.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function m(T){if(T.h!=0)return!1;for(var w=0;w<T.g.length;w++)if(T.g[w]!=0)return!1;return!0}function p(T){return T.h==-1}e.l=function(T){return T=b(this,T),p(T)?-1:m(T)?0:1};function U(T){for(var w=T.g.length,S=[],x=0;x<w;x++)S[x]=~T.g[x];return new o(S,~T.h).add(f)}e.abs=function(){return p(this)?U(this):this},e.add=function(T){for(var w=Math.max(this.g.length,T.g.length),S=[],x=0,k=0;k<=w;k++){var P=x+(this.i(k)&65535)+(T.i(k)&65535),D=(P>>>16)+(this.i(k)>>>16)+(T.i(k)>>>16);x=D>>>16,P&=65535,D&=65535,S[k]=D<<16|P}return new o(S,S[S.length-1]&-2147483648?-1:0)};function b(T,w){return T.add(U(w))}e.j=function(T){if(m(this)||m(T))return u;if(p(this))return p(T)?U(this).j(U(T)):U(U(this).j(T));if(p(T))return U(this.j(U(T)));if(0>this.l(h)&&0>T.l(h))return c(this.m()*T.m());for(var w=this.g.length+T.g.length,S=[],x=0;x<2*w;x++)S[x]=0;for(x=0;x<this.g.length;x++)for(var k=0;k<T.g.length;k++){var P=this.i(x)>>>16,D=this.i(x)&65535,j=T.i(k)>>>16,G=T.i(k)&65535;S[2*x+2*k]+=D*G,y(S,2*x+2*k),S[2*x+2*k+1]+=P*G,y(S,2*x+2*k+1),S[2*x+2*k+1]+=D*j,y(S,2*x+2*k+1),S[2*x+2*k+2]+=P*j,y(S,2*x+2*k+2)}for(x=0;x<w;x++)S[x]=S[2*x+1]<<16|S[2*x];for(x=w;x<2*w;x++)S[x]=0;return new o(S,0)};function y(T,w){for(;(T[w]&65535)!=T[w];)T[w+1]+=T[w]>>>16,T[w]&=65535,w++}function v(T,w){this.g=T,this.h=w}function _(T,w){if(m(w))throw Error("division by zero");if(m(T))return new v(u,u);if(p(T))return w=_(U(T),w),new v(U(w.g),U(w.h));if(p(w))return w=_(T,U(w)),new v(U(w.g),w.h);if(30<T.g.length){if(p(T)||p(w))throw Error("slowDivide_ only works with positive integers.");for(var S=f,x=w;0>=x.l(T);)S=I(S),x=I(x);var k=R(S,1),P=R(x,1);for(x=R(x,2),S=R(S,2);!m(x);){var D=P.add(x);0>=D.l(T)&&(k=k.add(S),P=D),x=R(x,1),S=R(S,1)}return w=b(T,k.j(w)),new v(k,w)}for(k=u;0<=T.l(w);){for(S=Math.max(1,Math.floor(T.m()/w.m())),x=Math.ceil(Math.log(S)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),P=c(S),D=P.j(w);p(D)||0<D.l(T);)S-=x,P=c(S),D=P.j(w);m(P)&&(P=f),k=k.add(P),T=b(T,D)}return new v(k,T)}e.A=function(T){return _(this,T).h},e.and=function(T){for(var w=Math.max(this.g.length,T.g.length),S=[],x=0;x<w;x++)S[x]=this.i(x)&T.i(x);return new o(S,this.h&T.h)},e.or=function(T){for(var w=Math.max(this.g.length,T.g.length),S=[],x=0;x<w;x++)S[x]=this.i(x)|T.i(x);return new o(S,this.h|T.h)},e.xor=function(T){for(var w=Math.max(this.g.length,T.g.length),S=[],x=0;x<w;x++)S[x]=this.i(x)^T.i(x);return new o(S,this.h^T.h)};function I(T){for(var w=T.g.length+1,S=[],x=0;x<w;x++)S[x]=T.i(x)<<1|T.i(x-1)>>>31;return new o(S,T.h)}function R(T,w){var S=w>>5;w%=32;for(var x=T.g.length-S,k=[],P=0;P<x;P++)k[P]=0<w?T.i(P+S)>>>w|T.i(P+S+1)<<32-w:T.i(P+S);return new o(k,T.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,dW=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Dc=o}).apply(typeof gD<"u"?gD:typeof self<"u"?self:typeof window<"u"?window:{});var y2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uW,rm,fW,mb,t9,hW,gW,mW;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,A,O){return E==Array.prototype||E==Object.prototype||(E[A]=O.value),E};function n(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof y2=="object"&&y2];for(var A=0;A<E.length;++A){var O=E[A];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var i=n(this);function s(E,A){if(A)e:{var O=i;E=E.split(".");for(var H=0;H<E.length-1;H++){var K=E[H];if(!(K in O))break e;O=O[K]}E=E[E.length-1],H=O[E],A=A(H),A!=H&&A!=null&&t(O,E,{configurable:!0,writable:!0,value:A})}}function r(E,A){E instanceof String&&(E+="");var O=0,H=!1,K={next:function(){if(!H&&O<E.length){var J=O++;return{value:A(J,E[J]),done:!1}}return H=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}s("Array.prototype.values",function(E){return E||function(){return r(this,function(A,O){return O})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(E){var A=typeof E;return A=A!="object"?A:E?Array.isArray(E)?"array":A:"null",A=="array"||A=="object"&&typeof E.length=="number"}function c(E){var A=typeof E;return A=="object"&&E!=null||A=="function"}function d(E,A,O){return E.call.apply(E.bind,arguments)}function u(E,A,O){if(!E)throw Error();if(2<arguments.length){var H=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,H),E.apply(A,K)}}return function(){return E.apply(A,arguments)}}function f(E,A,O){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:u,f.apply(null,arguments)}function h(E,A){var O=Array.prototype.slice.call(arguments,1);return function(){var H=O.slice();return H.push.apply(H,arguments),E.apply(this,H)}}function m(E,A){function O(){}O.prototype=A.prototype,E.aa=A.prototype,E.prototype=new O,E.prototype.constructor=E,E.Qb=function(H,K,J){for(var ge=Array(arguments.length-2),Gt=2;Gt<arguments.length;Gt++)ge[Gt-2]=arguments[Gt];return A.prototype[K].apply(H,ge)}}function p(E){const A=E.length;if(0<A){const O=Array(A);for(let H=0;H<A;H++)O[H]=E[H];return O}return[]}function U(E,A){for(let O=1;O<arguments.length;O++){const H=arguments[O];if(l(H)){const K=E.length||0,J=H.length||0;E.length=K+J;for(let ge=0;ge<J;ge++)E[K+ge]=H[ge]}else E.push(H)}}class b{constructor(A,O){this.i=A,this.j=O,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function y(E){return/^[\s\xa0]*$/.test(E)}function v(){var E=a.navigator;return E&&(E=E.userAgent)?E:""}function _(E){return _[" "](E),E}_[" "]=function(){};var I=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function R(E,A,O){for(const H in E)A.call(O,E[H],H,E)}function T(E,A){for(const O in E)A.call(void 0,E[O],O,E)}function w(E){const A={};for(const O in E)A[O]=E[O];return A}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(E,A){let O,H;for(let K=1;K<arguments.length;K++){H=arguments[K];for(O in H)E[O]=H[O];for(let J=0;J<S.length;J++)O=S[J],Object.prototype.hasOwnProperty.call(H,O)&&(E[O]=H[O])}}function k(E){var A=1;E=E.split(":");const O=[];for(;0<A&&E.length;)O.push(E.shift()),A--;return E.length&&O.push(E.join(":")),O}function P(E){a.setTimeout(()=>{throw E},0)}function D(){var E=X;let A=null;return E.g&&(A=E.g,E.g=E.g.next,E.g||(E.h=null),A.next=null),A}class j{constructor(){this.h=this.g=null}add(A,O){const H=G.get();H.set(A,O),this.h?this.h.next=H:this.g=H,this.h=H}}var G=new b(()=>new V,E=>E.reset());class V{constructor(){this.next=this.g=this.h=null}set(A,O){this.h=A,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let B,z=!1,X=new j,Y=()=>{const E=a.Promise.resolve(void 0);B=()=>{E.then(ee)}};var ee=()=>{for(var E;E=D();){try{E.h.call(E.g)}catch(O){P(O)}var A=G;A.j(E),100>A.h&&(A.h++,E.next=A.g,A.g=E)}z=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oe(E,A){this.type=E,this.g=this.target=A,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var Fe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var E=!1,A=Object.defineProperty({},"passive",{get:function(){E=!0}});try{const O=()=>{};a.addEventListener("test",O,A),a.removeEventListener("test",O,A)}catch{}return E}();function Ge(E,A){if(oe.call(this,E?E.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,E){var O=this.type=E.type,H=E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:null;if(this.target=E.target||E.srcElement,this.g=A,A=E.relatedTarget){if(I){e:{try{_(A.nodeName);var K=!0;break e}catch{}K=!1}K||(A=null)}}else O=="mouseover"?A=E.fromElement:O=="mouseout"&&(A=E.toElement);this.relatedTarget=A,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0),this.button=E.button,this.key=E.key||"",this.ctrlKey=E.ctrlKey,this.altKey=E.altKey,this.shiftKey=E.shiftKey,this.metaKey=E.metaKey,this.pointerId=E.pointerId||0,this.pointerType=typeof E.pointerType=="string"?E.pointerType:Me[E.pointerType]||"",this.state=E.state,this.i=E,E.defaultPrevented&&Ge.aa.h.call(this)}}m(Ge,oe);var Me={2:"touch",3:"pen",4:"mouse"};Ge.prototype.h=function(){Ge.aa.h.call(this);var E=this.i;E.preventDefault?E.preventDefault():E.returnValue=!1};var Ne="closure_listenable_"+(1e6*Math.random()|0),et=0;function Ot(E,A,O,H,K){this.listener=E,this.proxy=null,this.src=A,this.type=O,this.capture=!!H,this.ha=K,this.key=++et,this.da=this.fa=!1}function Xe(E){E.da=!0,E.listener=null,E.proxy=null,E.src=null,E.ha=null}function je(E){this.src=E,this.g={},this.h=0}je.prototype.add=function(E,A,O,H,K){var J=E.toString();E=this.g[J],E||(E=this.g[J]=[],this.h++);var ge=yt(E,A,H,K);return-1<ge?(A=E[ge],O||(A.fa=!1)):(A=new Ot(A,this.src,J,!!H,K),A.fa=O,E.push(A)),A};function Jt(E,A){var O=A.type;if(O in E.g){var H=E.g[O],K=Array.prototype.indexOf.call(H,A,void 0),J;(J=0<=K)&&Array.prototype.splice.call(H,K,1),J&&(Xe(A),E.g[O].length==0&&(delete E.g[O],E.h--))}}function yt(E,A,O,H){for(var K=0;K<E.length;++K){var J=E[K];if(!J.da&&J.listener==A&&J.capture==!!O&&J.ha==H)return K}return-1}var ss="closure_lm_"+(1e6*Math.random()|0),Gr={};function ba(E,A,O,H,K){if(Array.isArray(A)){for(var J=0;J<A.length;J++)ba(E,A[J],O,H,K);return null}return O=aS(O),E&&E[Ne]?E.K(A,O,c(H)?!!H.capture:!1,K):It(E,A,O,!1,H,K)}function It(E,A,O,H,K,J){if(!A)throw Error("Invalid event type");var ge=c(K)?!!K.capture:!!K,Gt=EE(E);if(Gt||(E[ss]=Gt=new je(E)),O=Gt.add(A,O,H,ge,J),O.proxy)return O;if(H=ui(),O.proxy=H,H.src=E,H.listener=O,E.addEventListener)Fe||(K=ge),K===void 0&&(K=!1),E.addEventListener(A.toString(),H,K);else if(E.attachEvent)E.attachEvent(jg(A.toString()),H);else if(E.addListener&&E.removeListener)E.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return O}function ui(){function E(O){return A.call(E.src,E.listener,O)}const A=yE;return E}function Ts(E,A,O,H,K){if(Array.isArray(A))for(var J=0;J<A.length;J++)Ts(E,A[J],O,H,K);else H=c(H)?!!H.capture:!!H,O=aS(O),E&&E[Ne]?(E=E.i,A=String(A).toString(),A in E.g&&(J=E.g[A],O=yt(J,O,H,K),-1<O&&(Xe(J[O]),Array.prototype.splice.call(J,O,1),J.length==0&&(delete E.g[A],E.h--)))):E&&(E=EE(E))&&(A=E.g[A.toString()],E=-1,A&&(E=yt(A,O,H,K)),(O=-1<E?A[E]:null)&&Rl(O))}function Rl(E){if(typeof E!="number"&&E&&!E.da){var A=E.src;if(A&&A[Ne])Jt(A.i,E);else{var O=E.type,H=E.proxy;A.removeEventListener?A.removeEventListener(O,H,E.capture):A.detachEvent?A.detachEvent(jg(O),H):A.addListener&&A.removeListener&&A.removeListener(H),(O=EE(A))?(Jt(O,E),O.h==0&&(O.src=null,A[ss]=null)):Xe(E)}}}function jg(E){return E in Gr?Gr[E]:Gr[E]="on"+E}function yE(E,A){if(E.da)E=!0;else{A=new Ge(A,this);var O=E.listener,H=E.ha||E.src;E.fa&&Rl(E),E=O.call(H,A)}return E}function EE(E){return E=E[ss],E instanceof je?E:null}var vE="__closure_events_fn_"+(1e9*Math.random()>>>0);function aS(E){return typeof E=="function"?E:(E[vE]||(E[vE]=function(A){return E.handleEvent(A)}),E[vE])}function Hi(){se.call(this),this.i=new je(this),this.M=this,this.F=null}m(Hi,se),Hi.prototype[Ne]=!0,Hi.prototype.removeEventListener=function(E,A,O,H){Ts(this,E,A,O,H)};function rs(E,A){var O,H=E.F;if(H)for(O=[];H;H=H.F)O.push(H);if(E=E.M,H=A.type||A,typeof A=="string")A=new oe(A,E);else if(A instanceof oe)A.target=A.target||E;else{var K=A;A=new oe(H,E),x(A,K)}if(K=!0,O)for(var J=O.length-1;0<=J;J--){var ge=A.g=O[J];K=sU(ge,H,!0,A)&&K}if(ge=A.g=E,K=sU(ge,H,!0,A)&&K,K=sU(ge,H,!1,A)&&K,O)for(J=0;J<O.length;J++)ge=A.g=O[J],K=sU(ge,H,!1,A)&&K}Hi.prototype.N=function(){if(Hi.aa.N.call(this),this.i){var E=this.i,A;for(A in E.g){for(var O=E.g[A],H=0;H<O.length;H++)Xe(O[H]);delete E.g[A],E.h--}}this.F=null},Hi.prototype.K=function(E,A,O,H){return this.i.add(String(E),A,!1,O,H)},Hi.prototype.L=function(E,A,O,H){return this.i.add(String(E),A,!0,O,H)};function sU(E,A,O,H){if(A=E.i.g[String(A)],!A)return!0;A=A.concat();for(var K=!0,J=0;J<A.length;++J){var ge=A[J];if(ge&&!ge.da&&ge.capture==O){var Gt=ge.listener,Ii=ge.ha||ge.src;ge.fa&&Jt(E.i,ge),K=Gt.call(Ii,H)!==!1&&K}}return K&&!H.defaultPrevented}function lS(E,A,O){if(typeof E=="function")O&&(E=f(E,O));else if(E&&typeof E.handleEvent=="function")E=f(E.handleEvent,E);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:a.setTimeout(E,A||0)}function cS(E){E.g=lS(()=>{E.g=null,E.i&&(E.i=!1,cS(E))},E.l);const A=E.h;E.h=null,E.m.apply(null,A)}class aZ extends se{constructor(A,O){super(),this.m=A,this.l=O,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:cS(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yg(E){se.call(this),this.h=E,this.g={}}m(Yg,se);var dS=[];function uS(E){R(E.g,function(A,O){this.g.hasOwnProperty(O)&&Rl(A)},E),E.g={}}Yg.prototype.N=function(){Yg.aa.N.call(this),uS(this)},Yg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _E=a.JSON.stringify,lZ=a.JSON.parse,cZ=class{stringify(E){return a.JSON.stringify(E,void 0)}parse(E){return a.JSON.parse(E,void 0)}};function wE(){}wE.prototype.h=null;function fS(E){return E.h||(E.h=E.i())}function hS(){}var Wg={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function TE(){oe.call(this,"d")}m(TE,oe);function IE(){oe.call(this,"c")}m(IE,oe);var md={},gS=null;function rU(){return gS=gS||new Hi}md.La="serverreachability";function mS(E){oe.call(this,md.La,E)}m(mS,oe);function Kg(E){const A=rU();rs(A,new mS(A))}md.STAT_EVENT="statevent";function pS(E,A){oe.call(this,md.STAT_EVENT,E),this.stat=A}m(pS,oe);function os(E){const A=rU();rs(A,new pS(A,E))}md.Ma="timingevent";function US(E,A){oe.call(this,md.Ma,E),this.size=A}m(US,oe);function Zg(E,A){if(typeof E!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){E()},A)}function qg(){this.g=!0}qg.prototype.xa=function(){this.g=!1};function dZ(E,A,O,H,K,J){E.info(function(){if(E.g)if(J)for(var ge="",Gt=J.split("&"),Ii=0;Ii<Gt.length;Ii++){var St=Gt[Ii].split("=");if(1<St.length){var Vi=St[0];St=St[1];var $i=Vi.split("_");ge=2<=$i.length&&$i[1]=="type"?ge+(Vi+"="+St+"&"):ge+(Vi+"=redacted&")}}else ge=null;else ge=J;return"XMLHTTP REQ ("+H+") [attempt "+K+"]: "+A+`
`+O+`
`+ge})}function uZ(E,A,O,H,K,J,ge){E.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+K+"]: "+A+`
`+O+`
`+J+" "+ge})}function nf(E,A,O,H){E.info(function(){return"XMLHTTP TEXT ("+A+"): "+hZ(E,O)+(H?" "+H:"")})}function fZ(E,A){E.info(function(){return"TIMEOUT: "+A})}qg.prototype.info=function(){};function hZ(E,A){if(!E.g)return A;if(!A)return null;try{var O=JSON.parse(A);if(O){for(E=0;E<O.length;E++)if(Array.isArray(O[E])){var H=O[E];if(!(2>H.length)){var K=H[1];if(Array.isArray(K)&&!(1>K.length)){var J=K[0];if(J!="noop"&&J!="stop"&&J!="close")for(var ge=1;ge<K.length;ge++)K[ge]=""}}}}return _E(O)}catch{return A}}var oU={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bS={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},SE;function aU(){}m(aU,wE),aU.prototype.g=function(){return new XMLHttpRequest},aU.prototype.i=function(){return{}},SE=new aU;function Ll(E,A,O,H){this.j=E,this.i=A,this.l=O,this.R=H||1,this.U=new Yg(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yS}function yS(){this.i=null,this.g="",this.h=!1}var ES={},xE={};function CE(E,A,O){E.L=1,E.v=uU(ya(A)),E.m=O,E.P=!0,vS(E,null)}function vS(E,A){E.F=Date.now(),lU(E),E.A=ya(E.v);var O=E.A,H=E.R;Array.isArray(H)||(H=[String(H)]),PS(O.i,"t",H),E.C=0,O=E.j.J,E.h=new yS,E.g=JS(E.j,O?A:null,!E.m),0<E.O&&(E.M=new aZ(f(E.Y,E,E.g),E.O)),A=E.U,O=E.g,H=E.ca;var K="readystatechange";Array.isArray(K)||(K&&(dS[0]=K.toString()),K=dS);for(var J=0;J<K.length;J++){var ge=ba(O,K[J],H||A.handleEvent,!1,A.h||A);if(!ge)break;A.g[ge.key]=ge}A=E.H?w(E.H):{},E.m?(E.u||(E.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",E.g.ea(E.A,E.u,E.m,A)):(E.u="GET",E.g.ea(E.A,E.u,null,A)),Kg(),dZ(E.i,E.u,E.A,E.l,E.R,E.m)}Ll.prototype.ca=function(E){E=E.target;const A=this.M;A&&Ea(E)==3?A.j():this.Y(E)},Ll.prototype.Y=function(E){try{if(E==this.g)e:{const $i=Ea(this.g);var A=this.g.Ba();const of=this.g.Z();if(!(3>$i)&&($i!=3||this.g&&(this.h.h||this.g.oa()||VS(this.g)))){this.J||$i!=4||A==7||(A==8||0>=of?Kg(3):Kg(2)),AE(this);var O=this.g.Z();this.X=O;t:if(_S(this)){var H=VS(this.g);E="";var K=H.length,J=Ea(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pd(this),Qg(this);var ge="";break t}this.h.i=new a.TextDecoder}for(A=0;A<K;A++)this.h.h=!0,E+=this.h.i.decode(H[A],{stream:!(J&&A==K-1)});H.length=0,this.h.g+=E,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=O==200,uZ(this.i,this.u,this.A,this.l,this.R,$i,O),this.o){if(this.T&&!this.K){t:{if(this.g){var Gt,Ii=this.g;if((Gt=Ii.g?Ii.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Gt)){var St=Gt;break t}}St=null}if(O=St)nf(this.i,this.l,O,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ME(this,O);else{this.o=!1,this.s=3,os(12),pd(this),Qg(this);break e}}if(this.P){O=!0;let Xr;for(;!this.J&&this.C<ge.length;)if(Xr=gZ(this,ge),Xr==xE){$i==4&&(this.s=4,os(14),O=!1),nf(this.i,this.l,null,"[Incomplete Response]");break}else if(Xr==ES){this.s=4,os(15),nf(this.i,this.l,ge,"[Invalid Chunk]"),O=!1;break}else nf(this.i,this.l,Xr,null),ME(this,Xr);if(_S(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$i!=4||ge.length!=0||this.h.h||(this.s=1,os(16),O=!1),this.o=this.o&&O,!O)nf(this.i,this.l,ge,"[Invalid Chunked Response]"),pd(this),Qg(this);else if(0<ge.length&&!this.W){this.W=!0;var Vi=this.j;Vi.g==this&&Vi.ba&&!Vi.M&&(Vi.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),NE(Vi),Vi.M=!0,os(11))}}else nf(this.i,this.l,ge,null),ME(this,ge);$i==4&&pd(this),this.o&&!this.J&&($i==4?KS(this.j,this):(this.o=!1,lU(this)))}else kZ(this.g),O==400&&0<ge.indexOf("Unknown SID")?(this.s=3,os(12)):(this.s=0,os(13)),pd(this),Qg(this)}}}catch{}finally{}};function _S(E){return E.g?E.u=="GET"&&E.L!=2&&E.j.Ca:!1}function gZ(E,A){var O=E.C,H=A.indexOf(`
`,O);return H==-1?xE:(O=Number(A.substring(O,H)),isNaN(O)?ES:(H+=1,H+O>A.length?xE:(A=A.slice(H,H+O),E.C=H+O,A)))}Ll.prototype.cancel=function(){this.J=!0,pd(this)};function lU(E){E.S=Date.now()+E.I,wS(E,E.I)}function wS(E,A){if(E.B!=null)throw Error("WatchDog timer not null");E.B=Zg(f(E.ba,E),A)}function AE(E){E.B&&(a.clearTimeout(E.B),E.B=null)}Ll.prototype.ba=function(){this.B=null;const E=Date.now();0<=E-this.S?(fZ(this.i,this.A),this.L!=2&&(Kg(),os(17)),pd(this),this.s=2,Qg(this)):wS(this,this.S-E)};function Qg(E){E.j.G==0||E.J||KS(E.j,E)}function pd(E){AE(E);var A=E.M;A&&typeof A.ma=="function"&&A.ma(),E.M=null,uS(E.U),E.g&&(A=E.g,E.g=null,A.abort(),A.ma())}function ME(E,A){try{var O=E.j;if(O.G!=0&&(O.g==E||kE(O.h,E))){if(!E.K&&kE(O.h,E)&&O.G==3){try{var H=O.Da.g.parse(A)}catch{H=null}if(Array.isArray(H)&&H.length==3){var K=H;if(K[0]==0){e:if(!O.u){if(O.g)if(O.g.F+3e3<E.F)UU(O),mU(O);else break e;PE(O),os(18)}}else O.za=K[1],0<O.za-O.T&&37500>K[2]&&O.F&&O.v==0&&!O.C&&(O.C=Zg(f(O.Za,O),6e3));if(1>=SS(O.h)&&O.ca){try{O.ca()}catch{}O.ca=void 0}}else bd(O,11)}else if((E.K||O.g==E)&&UU(O),!y(A))for(K=O.Da.g.parse(A),A=0;A<K.length;A++){let St=K[A];if(O.T=St[0],St=St[1],O.G==2)if(St[0]=="c"){O.K=St[1],O.ia=St[2];const Vi=St[3];Vi!=null&&(O.la=Vi,O.j.info("VER="+O.la));const $i=St[4];$i!=null&&(O.Aa=$i,O.j.info("SVER="+O.Aa));const of=St[5];of!=null&&typeof of=="number"&&0<of&&(H=1.5*of,O.L=H,O.j.info("backChannelRequestTimeoutMs_="+H)),H=O;const Xr=E.g;if(Xr){const yU=Xr.g?Xr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yU){var J=H.h;J.g||yU.indexOf("spdy")==-1&&yU.indexOf("quic")==-1&&yU.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(RE(J,J.h),J.h=null))}if(H.D){const OE=Xr.g?Xr.g.getResponseHeader("X-HTTP-Session-Id"):null;OE&&(H.ya=OE,en(H.I,H.D,OE))}}O.G=3,O.l&&O.l.ua(),O.ba&&(O.R=Date.now()-E.F,O.j.info("Handshake RTT: "+O.R+"ms")),H=O;var ge=E;if(H.qa=QS(H,H.J?H.ia:null,H.W),ge.K){xS(H.h,ge);var Gt=ge,Ii=H.L;Ii&&(Gt.I=Ii),Gt.B&&(AE(Gt),lU(Gt)),H.g=ge}else YS(H);0<O.i.length&&pU(O)}else St[0]!="stop"&&St[0]!="close"||bd(O,7);else O.G==3&&(St[0]=="stop"||St[0]=="close"?St[0]=="stop"?bd(O,7):DE(O):St[0]!="noop"&&O.l&&O.l.ta(St),O.v=0)}}Kg(4)}catch{}}var mZ=class{constructor(E,A){this.g=E,this.map=A}};function TS(E){this.l=E||10,a.PerformanceNavigationTiming?(E=a.performance.getEntriesByType("navigation"),E=0<E.length&&(E[0].nextHopProtocol=="hq"||E[0].nextHopProtocol=="h2")):E=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=E?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function IS(E){return E.h?!0:E.g?E.g.size>=E.j:!1}function SS(E){return E.h?1:E.g?E.g.size:0}function kE(E,A){return E.h?E.h==A:E.g?E.g.has(A):!1}function RE(E,A){E.g?E.g.add(A):E.h=A}function xS(E,A){E.h&&E.h==A?E.h=null:E.g&&E.g.has(A)&&E.g.delete(A)}TS.prototype.cancel=function(){if(this.i=CS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const E of this.g.values())E.cancel();this.g.clear()}};function CS(E){if(E.h!=null)return E.i.concat(E.h.D);if(E.g!=null&&E.g.size!==0){let A=E.i;for(const O of E.g.values())A=A.concat(O.D);return A}return p(E.i)}function pZ(E){if(E.V&&typeof E.V=="function")return E.V();if(typeof Map<"u"&&E instanceof Map||typeof Set<"u"&&E instanceof Set)return Array.from(E.values());if(typeof E=="string")return E.split("");if(l(E)){for(var A=[],O=E.length,H=0;H<O;H++)A.push(E[H]);return A}A=[],O=0;for(H in E)A[O++]=E[H];return A}function UZ(E){if(E.na&&typeof E.na=="function")return E.na();if(!E.V||typeof E.V!="function"){if(typeof Map<"u"&&E instanceof Map)return Array.from(E.keys());if(!(typeof Set<"u"&&E instanceof Set)){if(l(E)||typeof E=="string"){var A=[];E=E.length;for(var O=0;O<E;O++)A.push(O);return A}A=[],O=0;for(const H in E)A[O++]=H;return A}}}function AS(E,A){if(E.forEach&&typeof E.forEach=="function")E.forEach(A,void 0);else if(l(E)||typeof E=="string")Array.prototype.forEach.call(E,A,void 0);else for(var O=UZ(E),H=pZ(E),K=H.length,J=0;J<K;J++)A.call(void 0,H[J],O&&O[J],E)}var MS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bZ(E,A){if(E){E=E.split("&");for(var O=0;O<E.length;O++){var H=E[O].indexOf("="),K=null;if(0<=H){var J=E[O].substring(0,H);K=E[O].substring(H+1)}else J=E[O];A(J,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Ud(E){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,E instanceof Ud){this.h=E.h,cU(this,E.j),this.o=E.o,this.g=E.g,dU(this,E.s),this.l=E.l;var A=E.i,O=new t1;O.i=A.i,A.g&&(O.g=new Map(A.g),O.h=A.h),kS(this,O),this.m=E.m}else E&&(A=String(E).match(MS))?(this.h=!1,cU(this,A[1]||"",!0),this.o=Jg(A[2]||""),this.g=Jg(A[3]||"",!0),dU(this,A[4]),this.l=Jg(A[5]||"",!0),kS(this,A[6]||"",!0),this.m=Jg(A[7]||"")):(this.h=!1,this.i=new t1(null,this.h))}Ud.prototype.toString=function(){var E=[],A=this.j;A&&E.push(e1(A,RS,!0),":");var O=this.g;return(O||A=="file")&&(E.push("//"),(A=this.o)&&E.push(e1(A,RS,!0),"@"),E.push(encodeURIComponent(String(O)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.s,O!=null&&E.push(":",String(O))),(O=this.l)&&(this.g&&O.charAt(0)!="/"&&E.push("/"),E.push(e1(O,O.charAt(0)=="/"?vZ:EZ,!0))),(O=this.i.toString())&&E.push("?",O),(O=this.m)&&E.push("#",e1(O,wZ)),E.join("")};function ya(E){return new Ud(E)}function cU(E,A,O){E.j=O?Jg(A,!0):A,E.j&&(E.j=E.j.replace(/:$/,""))}function dU(E,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);E.s=A}else E.s=null}function kS(E,A,O){A instanceof t1?(E.i=A,TZ(E.i,E.h)):(O||(A=e1(A,_Z)),E.i=new t1(A,E.h))}function en(E,A,O){E.i.set(A,O)}function uU(E){return en(E,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),E}function Jg(E,A){return E?A?decodeURI(E.replace(/%25/g,"%2525")):decodeURIComponent(E):""}function e1(E,A,O){return typeof E=="string"?(E=encodeURI(E).replace(A,yZ),O&&(E=E.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E):null}function yZ(E){return E=E.charCodeAt(0),"%"+(E>>4&15).toString(16)+(E&15).toString(16)}var RS=/[#\/\?@]/g,EZ=/[#\?:]/g,vZ=/[#\?]/g,_Z=/[#\?@]/g,wZ=/#/g;function t1(E,A){this.h=this.g=null,this.i=E||null,this.j=!!A}function Dl(E){E.g||(E.g=new Map,E.h=0,E.i&&bZ(E.i,function(A,O){E.add(decodeURIComponent(A.replace(/\+/g," ")),O)}))}e=t1.prototype,e.add=function(E,A){Dl(this),this.i=null,E=sf(this,E);var O=this.g.get(E);return O||this.g.set(E,O=[]),O.push(A),this.h+=1,this};function LS(E,A){Dl(E),A=sf(E,A),E.g.has(A)&&(E.i=null,E.h-=E.g.get(A).length,E.g.delete(A))}function DS(E,A){return Dl(E),A=sf(E,A),E.g.has(A)}e.forEach=function(E,A){Dl(this),this.g.forEach(function(O,H){O.forEach(function(K){E.call(A,K,H,this)},this)},this)},e.na=function(){Dl(this);const E=Array.from(this.g.values()),A=Array.from(this.g.keys()),O=[];for(let H=0;H<A.length;H++){const K=E[H];for(let J=0;J<K.length;J++)O.push(A[H])}return O},e.V=function(E){Dl(this);let A=[];if(typeof E=="string")DS(this,E)&&(A=A.concat(this.g.get(sf(this,E))));else{E=Array.from(this.g.values());for(let O=0;O<E.length;O++)A=A.concat(E[O])}return A},e.set=function(E,A){return Dl(this),this.i=null,E=sf(this,E),DS(this,E)&&(this.h-=this.g.get(E).length),this.g.set(E,[A]),this.h+=1,this},e.get=function(E,A){return E?(E=this.V(E),0<E.length?String(E[0]):A):A};function PS(E,A,O){LS(E,A),0<O.length&&(E.i=null,E.g.set(sf(E,A),p(O)),E.h+=O.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const E=[],A=Array.from(this.g.keys());for(var O=0;O<A.length;O++){var H=A[O];const J=encodeURIComponent(String(H)),ge=this.V(H);for(H=0;H<ge.length;H++){var K=J;ge[H]!==""&&(K+="="+encodeURIComponent(String(ge[H]))),E.push(K)}}return this.i=E.join("&")};function sf(E,A){return A=String(A),E.j&&(A=A.toLowerCase()),A}function TZ(E,A){A&&!E.j&&(Dl(E),E.i=null,E.g.forEach(function(O,H){var K=H.toLowerCase();H!=K&&(LS(this,H),PS(this,K,O))},E)),E.j=A}function IZ(E,A){const O=new qg;if(a.Image){const H=new Image;H.onload=h(Pl,O,"TestLoadImage: loaded",!0,A,H),H.onerror=h(Pl,O,"TestLoadImage: error",!1,A,H),H.onabort=h(Pl,O,"TestLoadImage: abort",!1,A,H),H.ontimeout=h(Pl,O,"TestLoadImage: timeout",!1,A,H),a.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=E}else A(!1)}function SZ(E,A){const O=new qg,H=new AbortController,K=setTimeout(()=>{H.abort(),Pl(O,"TestPingServer: timeout",!1,A)},1e4);fetch(E,{signal:H.signal}).then(J=>{clearTimeout(K),J.ok?Pl(O,"TestPingServer: ok",!0,A):Pl(O,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(K),Pl(O,"TestPingServer: error",!1,A)})}function Pl(E,A,O,H,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),H(O)}catch{}}function xZ(){this.g=new cZ}function CZ(E,A,O){const H=O||"";try{AS(E,function(K,J){let ge=K;c(K)&&(ge=_E(K)),A.push(H+J+"="+encodeURIComponent(ge))})}catch(K){throw A.push(H+"type="+encodeURIComponent("_badmap")),K}}function fU(E){this.l=E.Ub||null,this.j=E.eb||!1}m(fU,wE),fU.prototype.g=function(){return new hU(this.l,this.j)},fU.prototype.i=function(E){return function(){return E}}({});function hU(E,A){Hi.call(this),this.D=E,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(hU,Hi),e=hU.prototype,e.open=function(E,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=E,this.A=A,this.readyState=1,i1(this)},e.send=function(E){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};E&&(A.body=E),(this.D||a).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,n1(this)),this.readyState=0},e.Sa=function(E){if(this.g&&(this.l=E,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=E.headers,this.readyState=2,i1(this)),this.g&&(this.readyState=3,i1(this),this.g)))if(this.responseType==="arraybuffer")E.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in E){if(this.j=E.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;NS(this)}else E.text().then(this.Ra.bind(this),this.ga.bind(this))};function NS(E){E.j.read().then(E.Pa.bind(E)).catch(E.ga.bind(E))}e.Pa=function(E){if(this.g){if(this.o&&E.value)this.response.push(E.value);else if(!this.o){var A=E.value?E.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!E.done}))&&(this.response=this.responseText+=A)}E.done?n1(this):i1(this),this.readyState==3&&NS(this)}},e.Ra=function(E){this.g&&(this.response=this.responseText=E,n1(this))},e.Qa=function(E){this.g&&(this.response=E,n1(this))},e.ga=function(){this.g&&n1(this)};function n1(E){E.readyState=4,E.l=null,E.j=null,E.v=null,i1(E)}e.setRequestHeader=function(E,A){this.u.append(E,A)},e.getResponseHeader=function(E){return this.h&&this.h.get(E.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const E=[],A=this.h.entries();for(var O=A.next();!O.done;)O=O.value,E.push(O[0]+": "+O[1]),O=A.next();return E.join(`\r
`)};function i1(E){E.onreadystatechange&&E.onreadystatechange.call(E)}Object.defineProperty(hU.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(E){this.m=E?"include":"same-origin"}});function OS(E){let A="";return R(E,function(O,H){A+=H,A+=":",A+=O,A+=`\r
`}),A}function LE(E,A,O){e:{for(H in O){var H=!1;break e}H=!0}H||(O=OS(O),typeof E=="string"?O!=null&&encodeURIComponent(String(O)):en(E,A,O))}function _n(E){Hi.call(this),this.headers=new Map,this.o=E||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(_n,Hi);var AZ=/^https?$/i,MZ=["POST","PUT"];e=_n.prototype,e.Ha=function(E){this.J=E},e.ea=function(E,A,O,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+E);A=A?A.toUpperCase():"GET",this.D=E,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():SE.g(),this.v=this.o?fS(this.o):fS(SE),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(A,String(E),!0),this.B=!1}catch(J){FS(this,J);return}if(E=O||"",O=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var K in H)O.set(K,H[K]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const J of H.keys())O.set(J,H.get(J));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(O.keys()).find(J=>J.toLowerCase()=="content-type"),K=a.FormData&&E instanceof a.FormData,!(0<=Array.prototype.indexOf.call(MZ,A,void 0))||H||K||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ge]of O)this.g.setRequestHeader(J,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{HS(this),this.u=!0,this.g.send(E),this.u=!1}catch(J){FS(this,J)}};function FS(E,A){E.h=!1,E.g&&(E.j=!0,E.g.abort(),E.j=!1),E.l=A,E.m=5,BS(E),gU(E)}function BS(E){E.A||(E.A=!0,rs(E,"complete"),rs(E,"error"))}e.abort=function(E){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=E||7,rs(this,"complete"),rs(this,"abort"),gU(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gU(this,!0)),_n.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?zS(this):this.bb())},e.bb=function(){zS(this)};function zS(E){if(E.h&&typeof o<"u"&&(!E.v[1]||Ea(E)!=4||E.Z()!=2)){if(E.u&&Ea(E)==4)lS(E.Ea,0,E);else if(rs(E,"readystatechange"),Ea(E)==4){E.h=!1;try{const ge=E.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var O;if(!(O=A)){var H;if(H=ge===0){var K=String(E.D).match(MS)[1]||null;!K&&a.self&&a.self.location&&(K=a.self.location.protocol.slice(0,-1)),H=!AZ.test(K?K.toLowerCase():"")}O=H}if(O)rs(E,"complete"),rs(E,"success");else{E.m=6;try{var J=2<Ea(E)?E.g.statusText:""}catch{J=""}E.l=J+" ["+E.Z()+"]",BS(E)}}finally{gU(E)}}}}function gU(E,A){if(E.g){HS(E);const O=E.g,H=E.v[0]?()=>{}:null;E.g=null,E.v=null,A||rs(E,"ready");try{O.onreadystatechange=H}catch{}}}function HS(E){E.I&&(a.clearTimeout(E.I),E.I=null)}e.isActive=function(){return!!this.g};function Ea(E){return E.g?E.g.readyState:0}e.Z=function(){try{return 2<Ea(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(E){if(this.g){var A=this.g.responseText;return E&&A.indexOf(E)==0&&(A=A.substring(E.length)),lZ(A)}};function VS(E){try{if(!E.g)return null;if("response"in E.g)return E.g.response;switch(E.H){case"":case"text":return E.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in E.g)return E.g.mozResponseArrayBuffer}return null}catch{return null}}function kZ(E){const A={};E=(E.g&&2<=Ea(E)&&E.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<E.length;H++){if(y(E[H]))continue;var O=k(E[H]);const K=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const J=A[K]||[];A[K]=J,J.push(O)}T(A,function(H){return H.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function s1(E,A,O){return O&&O.internalChannelParams&&O.internalChannelParams[E]||A}function $S(E){this.Aa=0,this.i=[],this.j=new qg,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=s1("failFast",!1,E),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=s1("baseRetryDelayMs",5e3,E),this.cb=s1("retryDelaySeedMs",1e4,E),this.Wa=s1("forwardChannelMaxRetries",2,E),this.wa=s1("forwardChannelRequestTimeoutMs",2e4,E),this.pa=E&&E.xmlHttpFactory||void 0,this.Xa=E&&E.Tb||void 0,this.Ca=E&&E.useFetchStreams||!1,this.L=void 0,this.J=E&&E.supportsCrossDomainXhr||!1,this.K="",this.h=new TS(E&&E.concurrentRequestLimit),this.Da=new xZ,this.P=E&&E.fastHandshake||!1,this.O=E&&E.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=E&&E.Rb||!1,E&&E.xa&&this.j.xa(),E&&E.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&E&&E.detectBufferingProxy||!1,this.ja=void 0,E&&E.longPollingTimeout&&0<E.longPollingTimeout&&(this.ja=E.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=$S.prototype,e.la=8,e.G=1,e.connect=function(E,A,O,H){os(0),this.W=E,this.H=A||{},O&&H!==void 0&&(this.H.OSID=O,this.H.OAID=H),this.F=this.X,this.I=QS(this,null,this.W),pU(this)};function DE(E){if(GS(E),E.G==3){var A=E.U++,O=ya(E.I);if(en(O,"SID",E.K),en(O,"RID",A),en(O,"TYPE","terminate"),r1(E,O),A=new Ll(E,E.j,A),A.L=2,A.v=uU(ya(O)),O=!1,a.navigator&&a.navigator.sendBeacon)try{O=a.navigator.sendBeacon(A.v.toString(),"")}catch{}!O&&a.Image&&(new Image().src=A.v,O=!0),O||(A.g=JS(A.j,null),A.g.ea(A.v)),A.F=Date.now(),lU(A)}qS(E)}function mU(E){E.g&&(NE(E),E.g.cancel(),E.g=null)}function GS(E){mU(E),E.u&&(a.clearTimeout(E.u),E.u=null),UU(E),E.h.cancel(),E.s&&(typeof E.s=="number"&&a.clearTimeout(E.s),E.s=null)}function pU(E){if(!IS(E.h)&&!E.s){E.s=!0;var A=E.Ga;B||Y(),z||(B(),z=!0),X.add(A,E),E.B=0}}function RZ(E,A){return SS(E.h)>=E.h.j-(E.s?1:0)?!1:E.s?(E.i=A.D.concat(E.i),!0):E.G==1||E.G==2||E.B>=(E.Va?0:E.Wa)?!1:(E.s=Zg(f(E.Ga,E,A),ZS(E,E.B)),E.B++,!0)}e.Ga=function(E){if(this.s)if(this.s=null,this.G==1){if(!E){this.U=Math.floor(1e5*Math.random()),E=this.U++;const K=new Ll(this,this.j,E);let J=this.o;if(this.S&&(J?(J=w(J),x(J,this.S)):J=this.S),this.m!==null||this.O||(K.H=J,J=null),this.P)e:{for(var A=0,O=0;O<this.i.length;O++){t:{var H=this.i[O];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(A+=H,4096<A){A=O;break e}if(A===4096||O===this.i.length-1){A=O+1;break e}}A=1e3}else A=1e3;A=jS(this,K,A),O=ya(this.I),en(O,"RID",E),en(O,"CVER",22),this.D&&en(O,"X-HTTP-Session-Id",this.D),r1(this,O),J&&(this.O?A="headers="+encodeURIComponent(String(OS(J)))+"&"+A:this.m&&LE(O,this.m,J)),RE(this.h,K),this.Ua&&en(O,"TYPE","init"),this.P?(en(O,"$req",A),en(O,"SID","null"),K.T=!0,CE(K,O,null)):CE(K,O,A),this.G=2}}else this.G==3&&(E?XS(this,E):this.i.length==0||IS(this.h)||XS(this))};function XS(E,A){var O;A?O=A.l:O=E.U++;const H=ya(E.I);en(H,"SID",E.K),en(H,"RID",O),en(H,"AID",E.T),r1(E,H),E.m&&E.o&&LE(H,E.m,E.o),O=new Ll(E,E.j,O,E.B+1),E.m===null&&(O.H=E.o),A&&(E.i=A.D.concat(E.i)),A=jS(E,O,1e3),O.I=Math.round(.5*E.wa)+Math.round(.5*E.wa*Math.random()),RE(E.h,O),CE(O,H,A)}function r1(E,A){E.H&&R(E.H,function(O,H){en(A,H,O)}),E.l&&AS({},function(O,H){en(A,H,O)})}function jS(E,A,O){O=Math.min(E.i.length,O);var H=E.l?f(E.l.Na,E.l,E):null;e:{var K=E.i;let J=-1;for(;;){const ge=["count="+O];J==-1?0<O?(J=K[0].g,ge.push("ofs="+J)):J=0:ge.push("ofs="+J);let Gt=!0;for(let Ii=0;Ii<O;Ii++){let St=K[Ii].g;const Vi=K[Ii].map;if(St-=J,0>St)J=Math.max(0,K[Ii].g-100),Gt=!1;else try{CZ(Vi,ge,"req"+St+"_")}catch{H&&H(Vi)}}if(Gt){H=ge.join("&");break e}}}return E=E.i.splice(0,O),A.D=E,H}function YS(E){if(!E.g&&!E.u){E.Y=1;var A=E.Fa;B||Y(),z||(B(),z=!0),X.add(A,E),E.v=0}}function PE(E){return E.g||E.u||3<=E.v?!1:(E.Y++,E.u=Zg(f(E.Fa,E),ZS(E,E.v)),E.v++,!0)}e.Fa=function(){if(this.u=null,WS(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var E=2*this.R;this.j.info("BP detection timer enabled: "+E),this.A=Zg(f(this.ab,this),E)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,os(10),mU(this),WS(this))};function NE(E){E.A!=null&&(a.clearTimeout(E.A),E.A=null)}function WS(E){E.g=new Ll(E,E.j,"rpc",E.Y),E.m===null&&(E.g.H=E.o),E.g.O=0;var A=ya(E.qa);en(A,"RID","rpc"),en(A,"SID",E.K),en(A,"AID",E.T),en(A,"CI",E.F?"0":"1"),!E.F&&E.ja&&en(A,"TO",E.ja),en(A,"TYPE","xmlhttp"),r1(E,A),E.m&&E.o&&LE(A,E.m,E.o),E.L&&(E.g.I=E.L);var O=E.g;E=E.ia,O.L=1,O.v=uU(ya(A)),O.m=null,O.P=!0,vS(O,E)}e.Za=function(){this.C!=null&&(this.C=null,mU(this),PE(this),os(19))};function UU(E){E.C!=null&&(a.clearTimeout(E.C),E.C=null)}function KS(E,A){var O=null;if(E.g==A){UU(E),NE(E),E.g=null;var H=2}else if(kE(E.h,A))O=A.D,xS(E.h,A),H=1;else return;if(E.G!=0){if(A.o)if(H==1){O=A.m?A.m.length:0,A=Date.now()-A.F;var K=E.B;H=rU(),rs(H,new US(H,O)),pU(E)}else YS(E);else if(K=A.s,K==3||K==0&&0<A.X||!(H==1&&RZ(E,A)||H==2&&PE(E)))switch(O&&0<O.length&&(A=E.h,A.i=A.i.concat(O)),K){case 1:bd(E,5);break;case 4:bd(E,10);break;case 3:bd(E,6);break;default:bd(E,2)}}}function ZS(E,A){let O=E.Ta+Math.floor(Math.random()*E.cb);return E.isActive()||(O*=2),O*A}function bd(E,A){if(E.j.info("Error code "+A),A==2){var O=f(E.fb,E),H=E.Xa;const K=!H;H=new Ud(H||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||cU(H,"https"),uU(H),K?IZ(H.toString(),O):SZ(H.toString(),O)}else os(2);E.G=0,E.l&&E.l.sa(A),qS(E),GS(E)}e.fb=function(E){E?(this.j.info("Successfully pinged google.com"),os(2)):(this.j.info("Failed to ping google.com"),os(1))};function qS(E){if(E.G=0,E.ka=[],E.l){const A=CS(E.h);(A.length!=0||E.i.length!=0)&&(U(E.ka,A),U(E.ka,E.i),E.h.i.length=0,p(E.i),E.i.length=0),E.l.ra()}}function QS(E,A,O){var H=O instanceof Ud?ya(O):new Ud(O);if(H.g!="")A&&(H.g=A+"."+H.g),dU(H,H.s);else{var K=a.location;H=K.protocol,A=A?A+"."+K.hostname:K.hostname,K=+K.port;var J=new Ud(null);H&&cU(J,H),A&&(J.g=A),K&&dU(J,K),O&&(J.l=O),H=J}return O=E.D,A=E.ya,O&&A&&en(H,O,A),en(H,"VER",E.la),r1(E,H),H}function JS(E,A,O){if(A&&!E.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=E.Ca&&!E.pa?new _n(new fU({eb:O})):new _n(E.pa),A.Ha(E.J),A}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ex(){}e=ex.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function bU(){}bU.prototype.g=function(E,A){return new zs(E,A)};function zs(E,A){Hi.call(this),this.g=new $S(A),this.l=E,this.h=A&&A.messageUrlParams||null,E=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(E?E["X-Client-Protocol"]="webchannel":E={"X-Client-Protocol":"webchannel"}),this.g.o=E,E=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(E?E["X-WebChannel-Content-Type"]=A.messageContentType:E={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(E?E["X-WebChannel-Client-Profile"]=A.va:E={"X-WebChannel-Client-Profile":A.va}),this.g.S=E,(E=A&&A.Sb)&&!y(E)&&(this.g.m=E),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!y(A)&&(this.g.D=A,E=this.h,E!==null&&A in E&&(E=this.h,A in E&&delete E[A])),this.j=new rf(this)}m(zs,Hi),zs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zs.prototype.close=function(){DE(this.g)},zs.prototype.o=function(E){var A=this.g;if(typeof E=="string"){var O={};O.__data__=E,E=O}else this.u&&(O={},O.__data__=_E(E),E=O);A.i.push(new mZ(A.Ya++,E)),A.G==3&&pU(A)},zs.prototype.N=function(){this.g.l=null,delete this.j,DE(this.g),delete this.g,zs.aa.N.call(this)};function tx(E){TE.call(this),E.__headers__&&(this.headers=E.__headers__,this.statusCode=E.__status__,delete E.__headers__,delete E.__status__);var A=E.__sm__;if(A){e:{for(const O in A){E=O;break e}E=void 0}(this.i=E)&&(E=this.i,A=A!==null&&E in A?A[E]:void 0),this.data=A}else this.data=E}m(tx,TE);function nx(){IE.call(this),this.status=1}m(nx,IE);function rf(E){this.g=E}m(rf,ex),rf.prototype.ua=function(){rs(this.g,"a")},rf.prototype.ta=function(E){rs(this.g,new tx(E))},rf.prototype.sa=function(E){rs(this.g,new nx)},rf.prototype.ra=function(){rs(this.g,"b")},bU.prototype.createWebChannel=bU.prototype.g,zs.prototype.send=zs.prototype.o,zs.prototype.open=zs.prototype.m,zs.prototype.close=zs.prototype.close,mW=function(){return new bU},gW=function(){return rU()},hW=md,t9={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},oU.NO_ERROR=0,oU.TIMEOUT=8,oU.HTTP_ERROR=6,mb=oU,bS.COMPLETE="complete",fW=bS,hS.EventType=Wg,Wg.OPEN="a",Wg.CLOSE="b",Wg.ERROR="c",Wg.MESSAGE="d",Hi.prototype.listen=Hi.prototype.K,rm=hS,_n.prototype.listenOnce=_n.prototype.L,_n.prototype.getLastError=_n.prototype.Ka,_n.prototype.getLastErrorCode=_n.prototype.Ba,_n.prototype.getStatus=_n.prototype.Z,_n.prototype.getResponseJson=_n.prototype.Oa,_n.prototype.getResponseText=_n.prototype.oa,_n.prototype.send=_n.prototype.ea,_n.prototype.setWithCredentials=_n.prototype.Ha,uW=_n}).apply(typeof y2<"u"?y2:typeof self<"u"?self:typeof window<"u"?window:{});const mD="@firebase/firestore",pD="4.7.8";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Wi.UNAUTHENTICATED=new Wi(null),Wi.GOOGLE_CREDENTIALS=new Wi("google-credentials-uid"),Wi.FIRST_PARTY=new Wi("first-party-uid"),Wi.MOCK_USER=new Wi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vg="11.3.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=new eW("@firebase/firestore");function Cf(){return Du.logLevel}function Ee(e,...t){if(Du.logLevel<=ht.DEBUG){const n=t.map(vI);Du.debug(`Firestore (${Vg}): ${e}`,...n)}}function Tl(e,...t){if(Du.logLevel<=ht.ERROR){const n=t.map(vI);Du.error(`Firestore (${Vg}): ${e}`,...n)}}function fg(e,...t){if(Du.logLevel<=ht.WARN){const n=t.map(vI);Du.warn(`Firestore (${Vg}): ${e}`,...n)}}function vI(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(e="Unexpected state"){const t=`FIRESTORE (${Vg}) INTERNAL ASSERTION FAILED: `+e;throw Tl(t),new Error(t)}function jt(e,t){e||De()}function at(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ae extends qu{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class swe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Wi.UNAUTHENTICATED))}shutdown(){}}class rwe{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class owe{constructor(t){this.t=t,this.currentUser=Wi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){jt(this.o===void 0);let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let r=new Pc;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Pc,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=r;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Pc)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(jt(typeof i.accessToken=="string"),new pW(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return jt(t===null||typeof t=="string"),new Wi(t)}}class awe{constructor(t,n,i){this.l=t,this.h=n,this.P=i,this.type="FirstParty",this.user=Wi.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class lwe{constructor(t,n,i){this.l=t,this.h=n,this.P=i}getToken(){return Promise.resolve(new awe(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(Wi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class UD{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cwe{constructor(t,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,sW(t)&&t.settings.appCheckToken&&(this.V=t.settings.appCheckToken)}start(t,n){jt(this.o===void 0);const i=r=>{r.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,Ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>i(r))};const s=r=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?s(r):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new UD(this.V));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(jt(typeof n.token=="string"),this.R=n.token,new UD(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dwe(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=dwe(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<n&&(i+=t.charAt(s[r]%62))}return i}}function gt(e,t){return e<t?-1:e>t?1:0}function hg(e,t,n){return e.length===t.length&&e.every((i,s)=>n(i,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=-62135596800,yD=1e6;class wi{static now(){return wi.fromMillis(Date.now())}static fromDate(t){return wi.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*yD);return new wi(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<bD)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ae(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yD}_compareTo(t){return this.seconds===t.seconds?gt(this.nanoseconds,t.nanoseconds):gt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-bD;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{static fromTimestamp(t){return new Be(t)}static min(){return new Be(new wi(0,0))}static max(){return new Be(new wi(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED="__name__";class Fo{constructor(t,n,i){n===void 0?n=0:n>t.length&&De(),i===void 0?i=t.length-n:i>t.length-n&&De(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Fo.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Fo?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let s=0;s<i;s++){const r=Fo.compareSegments(t.get(s),n.get(s));if(r!==0)return r}return Math.sign(t.length-n.length)}static compareSegments(t,n){const i=Fo.isNumericId(t),s=Fo.isNumericId(n);return i&&!s?-1:!i&&s?1:i&&s?Fo.extractNumericId(t).compare(Fo.extractNumericId(n)):t<n?-1:t>n?1:0}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Dc.fromString(t.substring(4,t.length-2))}}class fn extends Fo{construct(t,n,i){return new fn(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new Ae(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(s=>s.length>0))}return new fn(n)}static emptyPath(){return new fn([])}}const uwe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qi extends Fo{construct(t,n,i){return new qi(t,n,i)}static isValidIdentifier(t){return uwe.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qi.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ED}static keyField(){return new qi([ED])}static fromServerFormat(t){const n=[];let i="",s=0;const r=()=>{if(i.length===0)throw new Ae(ae.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new Ae(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ae(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new Ae(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new qi(n)}static emptyPath(){return new qi([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.path=t}static fromPath(t){return new Pe(fn.fromString(t))}static fromName(t){return new Pe(fn.fromString(t).popFirst(5))}static empty(){return new Pe(fn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&fn.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return fn.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pe(new fn(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0=-1;function fwe(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=Be.fromTimestamp(i===1e9?new wi(n+1,0):new wi(n,i));return new Jc(s,Pe.empty(),t)}function hwe(e){return new Jc(e.readTime,e.key,J0)}class Jc{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new Jc(Be.min(),Pe.empty(),J0)}static max(){return new Jc(Be.max(),Pe.empty(),J0)}}function gwe(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Pe.comparator(e.documentKey,t.documentKey),n!==0?n:gt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mwe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pwe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rE(e){if(e.code!==ae.FAILED_PRECONDITION||e.message!==mwe)throw e;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&De(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new ie((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(n,r).next(i,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof ie?n:ie.resolve(n)}catch(n){return ie.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):ie.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):ie.reject(n)}static resolve(t){return new ie((n,i)=>{n(t)})}static reject(t){return new ie((n,i)=>{i(t)})}static waitFor(t){return new ie((n,i)=>{let s=0,r=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++r,o&&r===s&&n()},l=>i(l))}),o=!0,r===s&&n()})}static or(t){let n=ie.resolve(!1);for(const i of t)n=n.next(s=>s?ie.resolve(s):i());return n}static forEach(t,n){const i=[];return t.forEach((s,r)=>{i.push(n.call(this,s,r))}),this.waitFor(i)}static mapArray(t,n){return new ie((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;n(t[c]).next(d=>{o[c]=d,++a,a===r&&i(o)},d=>s(d))}})}static doWhile(t,n){return new ie((i,s)=>{const r=()=>{t()===!0?n().next(()=>{r()},s):i()};r()})}}function Uwe(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function $g(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}oE.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bwe=-1;function Jp(e){return e==null}function u5(e){return e===0&&1/e==-1/0}function ywe(e){return typeof e=="number"&&Number.isInteger(e)&&!u5(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW="";function Ewe(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=vD(t)),t=vwe(e.get(n),t);return vD(t)}function vwe(e,t){let n=t;const i=e.length;for(let s=0;s<i;s++){const r=e.charAt(s);switch(r){case"\0":n+="";break;case bW:n+="";break;default:n+=r}}return n}function vD(e){return e+bW+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Qu(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function yW(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(t,n){this.comparator=t,this.root=n||Ri.EMPTY}insert(t,n){return new zn(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ri.BLACK,null,null))}remove(t){return new zn(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ri.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return n+i.left.size;s<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new E2(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new E2(this.root,t,this.comparator,!1)}getReverseIterator(){return new E2(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new E2(this.root,t,this.comparator,!0)}}class E2{constructor(t,n,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=n?i(t.key,n):1,n&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ri{constructor(t,n,i,s,r){this.key=t,this.value=n,this.color=i??Ri.RED,this.left=s??Ri.EMPTY,this.right=r??Ri.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,s,r){return new Ri(t??this.key,n??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,n,i),null):r===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ri.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Ri.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw De();const t=this.left.check();if(t!==this.right.check())throw De();return t+(this.isRed()?0:1)}}Ri.EMPTY=null,Ri.RED=!0,Ri.BLACK=!1;Ri.EMPTY=new class{constructor(){this.size=0}get key(){throw De()}get value(){throw De()}get color(){throw De()}get left(){throw De()}get right(){throw De()}copy(t,n,i,s,r){return this}insert(t,n,i){return new Ri(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(t){this.comparator=t,this.data=new zn(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new wD(this.data.getIterator())}getIteratorFrom(t){return new wD(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof li)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new li(this.comparator);return n.data=t,n}}class wD{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t){this.fields=t,t.sort(qi.comparator)}static empty(){return new Mr([])}unionWith(t){let n=new li(qi.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new Mr(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return hg(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EW extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new EW("Invalid base64 string: "+r):r}}(t);return new Bi(n)}static fromUint8Array(t){const n=function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r}(t);return new Bi(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return gt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Bi.EMPTY_BYTE_STRING=new Bi("");const _we=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ed(e){if(jt(!!e),typeof e=="string"){let t=0;const n=_we.exec(e);if(jt(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Nn(e.seconds),nanos:Nn(e.nanos)}}function Nn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function td(e){return typeof e=="string"?Bi.fromBase64String(e):Bi.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW="server_timestamp",_W="__type__",wW="__previous_value__",TW="__local_write_time__";function _I(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[_W])===null||n===void 0?void 0:n.stringValue)===vW}function aE(e){const t=e.mapValue.fields[wW];return _I(t)?aE(t):t}function ep(e){const t=ed(e.mapValue.fields[TW].timestampValue);return new wi(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wwe{constructor(t,n,i,s,r,o,a,l,c){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const f5="(default)";class tp{constructor(t,n){this.projectId=t,this.database=n||f5}static empty(){return new tp("","")}get isDefaultDatabase(){return this.database===f5}isEqual(t){return t instanceof tp&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW="__type__",Twe="__max__",v2={mapValue:{}},SW="__vector__",h5="value";function nd(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?_I(e)?4:Swe(e)?9007199254740991:Iwe(e)?10:11:De()}function ua(e,t){if(e===t)return!0;const n=nd(e);if(n!==nd(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ep(e).isEqual(ep(t));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=ed(s.timestampValue),a=ed(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,r){return td(s.bytesValue).isEqual(td(r.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,r){return Nn(s.geoPointValue.latitude)===Nn(r.geoPointValue.latitude)&&Nn(s.geoPointValue.longitude)===Nn(r.geoPointValue.longitude)}(e,t);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return Nn(s.integerValue)===Nn(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=Nn(s.doubleValue),a=Nn(r.doubleValue);return o===a?u5(o)===u5(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return hg(e.arrayValue.values||[],t.arrayValue.values||[],ua);case 10:case 11:return function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(_D(o)!==_D(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ua(o[l],a[l])))return!1;return!0}(e,t);default:return De()}}function np(e,t){return(e.values||[]).find(n=>ua(n,t))!==void 0}function gg(e,t){if(e===t)return 0;const n=nd(e),i=nd(t);if(n!==i)return gt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return gt(e.booleanValue,t.booleanValue);case 2:return function(r,o){const a=Nn(r.integerValue||r.doubleValue),l=Nn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(e,t);case 3:return TD(e.timestampValue,t.timestampValue);case 4:return TD(ep(e),ep(t));case 5:return gt(e.stringValue,t.stringValue);case 6:return function(r,o){const a=td(r),l=td(o);return a.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=gt(a[c],l[c]);if(d!==0)return d}return gt(a.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(r,o){const a=gt(Nn(r.latitude),Nn(o.latitude));return a!==0?a:gt(Nn(r.longitude),Nn(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ID(e.arrayValue,t.arrayValue);case 10:return function(r,o){var a,l,c,d;const u=r.fields||{},f=o.fields||{},h=(a=u[h5])===null||a===void 0?void 0:a.arrayValue,m=(l=f[h5])===null||l===void 0?void 0:l.arrayValue,p=gt(((c=h==null?void 0:h.values)===null||c===void 0?void 0:c.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:ID(h,m)}(e.mapValue,t.mapValue);case 11:return function(r,o){if(r===v2.mapValue&&o===v2.mapValue)return 0;if(r===v2.mapValue)return 1;if(o===v2.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let u=0;u<l.length&&u<d.length;++u){const f=gt(l[u],d[u]);if(f!==0)return f;const h=gg(a[l[u]],c[d[u]]);if(h!==0)return h}return gt(l.length,d.length)}(e.mapValue,t.mapValue);default:throw De()}}function TD(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return gt(e,t);const n=ed(e),i=ed(t),s=gt(n.seconds,i.seconds);return s!==0?s:gt(n.nanos,i.nanos)}function ID(e,t){const n=e.values||[],i=t.values||[];for(let s=0;s<n.length&&s<i.length;++s){const r=gg(n[s],i[s]);if(r)return r}return gt(n.length,i.length)}function mg(e){return n9(e)}function n9(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=ed(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return td(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Pe.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",s=!0;for(const r of n.values||[])s?s=!1:i+=",",i+=n9(r);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${n9(n.fields[o])}`;return s+"}"}(e.mapValue):De()}function pb(e){switch(nd(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=aE(e);return t?16+pb(t):16;case 5:return 2*e.stringValue.length;case 6:return td(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,r)=>s+pb(r),0)}(e.arrayValue);case 10:case 11:return function(i){let s=0;return Qu(i.fields,(r,o)=>{s+=r.length+pb(o)}),s}(e.mapValue);default:throw De()}}function i9(e){return!!e&&"integerValue"in e}function wI(e){return!!e&&"arrayValue"in e}function SD(e){return!!e&&"nullValue"in e}function xD(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function n7(e){return!!e&&"mapValue"in e}function Iwe(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[IW])===null||n===void 0?void 0:n.stringValue)===SW}function jm(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Qu(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=jm(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=jm(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Swe(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Twe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(t){this.value=t}static empty(){return new As({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!n7(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=jm(n)}setAll(t){let n=qi.emptyPath(),i={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,s),i={},s=[],n=a.popLast()}o?i[a.lastSegment()]=jm(o):s.push(a.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,i,s)}delete(t){const n=this.field(t.popLast());n7(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return ua(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=n.mapValue.fields[t.get(i)];n7(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,i){Qu(n,(s,r)=>t[s]=r);for(const s of i)delete t[s]}clone(){return new As(jm(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(t,n,i,s,r,o,a){this.key=t,this.documentType=n,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new bi(t,0,Be.min(),Be.min(),Be.min(),As.empty(),0)}static newFoundDocument(t,n,i,s){return new bi(t,1,n,Be.min(),i,s,0)}static newNoDocument(t,n){return new bi(t,2,n,Be.min(),Be.min(),As.empty(),0)}static newUnknownDocument(t,n){return new bi(t,3,n,Be.min(),Be.min(),As.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=As.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=As.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Be.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof bi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new bi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(t,n){this.position=t,this.inclusive=n}}function CD(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const r=t[s],o=e.position[s];if(r.field.isKeyField()?i=Pe.comparator(Pe.fromName(o.referenceValue),n.key):i=gg(o,n.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function AD(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ua(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(t,n="asc"){this.field=t,this.dir=n}}function xwe(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xW{}class ai extends xW{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new Awe(t,n,i):n==="array-contains"?new Rwe(t,i):n==="in"?new Lwe(t,i):n==="not-in"?new Dwe(t,i):n==="array-contains-any"?new Pwe(t,i):new ai(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new Mwe(t,i):new kwe(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(gg(n,this.value)):n!==null&&nd(this.value)===nd(n)&&this.matchesComparison(gg(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return De()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fa extends xW{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new fa(t,n)}matches(t){return CW(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function CW(e){return e.op==="and"}function AW(e){return Cwe(e)&&CW(e)}function Cwe(e){for(const t of e.filters)if(t instanceof fa)return!1;return!0}function s9(e){if(e instanceof ai)return e.field.canonicalString()+e.op.toString()+mg(e.value);if(AW(e))return e.filters.map(t=>s9(t)).join(",");{const t=e.filters.map(n=>s9(n)).join(",");return`${e.op}(${t})`}}function MW(e,t){return e instanceof ai?function(i,s){return s instanceof ai&&i.op===s.op&&i.field.isEqual(s.field)&&ua(i.value,s.value)}(e,t):e instanceof fa?function(i,s){return s instanceof fa&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((r,o,a)=>r&&MW(o,s.filters[a]),!0):!1}(e,t):void De()}function kW(e){return e instanceof ai?function(n){return`${n.field.canonicalString()} ${n.op} ${mg(n.value)}`}(e):e instanceof fa?function(n){return n.op.toString()+" {"+n.getFilters().map(kW).join(" ,")+"}"}(e):"Filter"}class Awe extends ai{constructor(t,n,i){super(t,n,i),this.key=Pe.fromName(i.referenceValue)}matches(t){const n=Pe.comparator(t.key,this.key);return this.matchesComparison(n)}}class Mwe extends ai{constructor(t,n){super(t,"in",n),this.keys=RW("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class kwe extends ai{constructor(t,n){super(t,"not-in",n),this.keys=RW("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function RW(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>Pe.fromName(i.referenceValue))}class Rwe extends ai{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return wI(n)&&np(n.arrayValue,this.value)}}class Lwe extends ai{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&np(this.value.arrayValue,n)}}class Dwe extends ai{constructor(t,n){super(t,"not-in",n)}matches(t){if(np(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!np(this.value.arrayValue,n)}}class Pwe extends ai{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!wI(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>np(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nwe{constructor(t,n=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.le=null}}function MD(e,t=null,n=[],i=[],s=null,r=null,o=null){return new Nwe(e,t,n,i,s,r,o)}function TI(e){const t=at(e);if(t.le===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>s9(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),Jp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>mg(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>mg(i)).join(",")),t.le=n}return t.le}function II(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!xwe(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!MW(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!AD(e.startAt,t.startAt)&&AD(e.endAt,t.endAt)}function r9(e){return Pe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t,n=null,i=[],s=[],r=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Owe(e,t,n,i,s,r,o,a){return new lE(e,t,n,i,s,r,o,a)}function SI(e){return new lE(e)}function kD(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Fwe(e){return e.collectionGroup!==null}function Ym(e){const t=at(e);if(t.he===null){t.he=[];const n=new Set;for(const r of t.explicitOrderBy)t.he.push(r),n.add(r.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new li(qi.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||t.he.push(new m5(r,i))}),n.has(qi.keyField().canonicalString())||t.he.push(new m5(qi.keyField(),i))}return t.he}function ea(e){const t=at(e);return t.Pe||(t.Pe=Bwe(t,Ym(e))),t.Pe}function Bwe(e,t){if(e.limitType==="F")return MD(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const r=s.dir==="desc"?"asc":"desc";return new m5(s.field,r)});const n=e.endAt?new g5(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new g5(e.startAt.position,e.startAt.inclusive):null;return MD(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function o9(e,t,n){return new lE(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function cE(e,t){return II(ea(e),ea(t))&&e.limitType===t.limitType}function LW(e){return`${TI(ea(e))}|lt:${e.limitType}`}function Af(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(s=>kW(s)).join(", ")}]`),Jp(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(s=>mg(s)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(s=>mg(s)).join(",")),`Target(${i})`}(ea(e))}; limitType=${e.limitType})`}function dE(e,t){return t.isFoundDocument()&&function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):Pe.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)}(e,t)&&function(i,s){for(const r of Ym(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(e,t)&&function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0}(e,t)&&function(i,s){return!(i.startAt&&!function(o,a,l){const c=CD(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,Ym(i),s)||i.endAt&&!function(o,a,l){const c=CD(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,Ym(i),s))}(e,t)}function zwe(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function DW(e){return(t,n)=>{let i=!1;for(const s of Ym(e)){const r=Hwe(s,t,n);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function Hwe(e,t,n){const i=e.field.isKeyField()?Pe.comparator(t.key,n.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?gg(l,c):De()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return De()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[n]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Qu(this.inner,(n,i)=>{for(const[s,r]of i)t(s,r)})}isEmpty(){return yW(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vwe=new zn(Pe.comparator);function id(){return Vwe}const PW=new zn(Pe.comparator);function om(...e){let t=PW;for(const n of e)t=t.insert(n.key,n);return t}function $we(e){let t=PW;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function jd(){return Wm()}function NW(){return Wm()}function Wm(){return new Ju(e=>e.toString(),(e,t)=>e.isEqual(t))}const Gwe=new li(Pe.comparator);function Tt(...e){let t=Gwe;for(const n of e)t=t.add(n);return t}const Xwe=new li(gt);function jwe(){return Xwe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:u5(t)?"-0":t}}function OW(e){return{integerValue:""+e}}function Ywe(e,t){return ywe(t)?OW(t):xI(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(){this._=void 0}}function Wwe(e,t,n){return e instanceof p5?function(s,r){const o={fields:{[_W]:{stringValue:vW},[TW]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&_I(r)&&(r=aE(r)),r&&(o.fields[wW]=r),{mapValue:o}}(n,t):e instanceof ip?FW(e,t):e instanceof sp?BW(e,t):function(s,r){const o=Zwe(s,r),a=RD(o)+RD(s.Ie);return i9(o)&&i9(s.Ie)?OW(a):xI(s.serializer,a)}(e,t)}function Kwe(e,t,n){return e instanceof ip?FW(e,t):e instanceof sp?BW(e,t):n}function Zwe(e,t){return e instanceof U5?function(i){return i9(i)||function(r){return!!r&&"doubleValue"in r}(i)}(t)?t:{integerValue:0}:null}class p5 extends uE{}class ip extends uE{constructor(t){super(),this.elements=t}}function FW(e,t){const n=zW(t);for(const i of e.elements)n.some(s=>ua(s,i))||n.push(i);return{arrayValue:{values:n}}}class sp extends uE{constructor(t){super(),this.elements=t}}function BW(e,t){let n=zW(t);for(const i of e.elements)n=n.filter(s=>!ua(s,i));return{arrayValue:{values:n}}}class U5 extends uE{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function RD(e){return Nn(e.integerValue||e.doubleValue)}function zW(e){return wI(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function qwe(e,t){return e.field.isEqual(t.field)&&function(i,s){return i instanceof ip&&s instanceof ip||i instanceof sp&&s instanceof sp?hg(i.elements,s.elements,ua):i instanceof U5&&s instanceof U5?ua(i.Ie,s.Ie):i instanceof p5&&s instanceof p5}(e.transform,t.transform)}class Ir{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Ir}static exists(t){return new Ir(void 0,t)}static updateTime(t){return new Ir(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Ub(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class fE{}function HW(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new CI(e.key,Ir.none()):new eU(e.key,e.data,Ir.none());{const n=e.data,i=As.empty();let s=new li(qi.comparator);for(let r of t.fields)if(!s.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new ef(e.key,i,new Mr(s.toArray()),Ir.none())}}function Qwe(e,t,n){e instanceof eU?function(s,r,o){const a=s.value.clone(),l=DD(s.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof ef?function(s,r,o){if(!Ub(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=DD(s.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(VW(s)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Km(e,t,n,i){return e instanceof eU?function(r,o,a,l){if(!Ub(r.precondition,o))return a;const c=r.value.clone(),d=PD(r.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,i):e instanceof ef?function(r,o,a,l){if(!Ub(r.precondition,o))return a;const c=PD(r.fieldTransforms,l,o),d=o.data;return d.setAll(VW(r)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(e,t,n,i):function(r,o,a){return Ub(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function LD(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&hg(i,s,(r,o)=>qwe(r,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class eU extends fE{constructor(t,n,i,s=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ef extends fE{constructor(t,n,i,s,r=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function VW(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function DD(e,t,n){const i=new Map;jt(e.length===n.length);for(let s=0;s<n.length;s++){const r=e[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,Kwe(o,a,n[s]))}return i}function PD(e,t,n){const i=new Map;for(const s of e){const r=s.transform,o=n.data.field(s.field);i.set(s.field,Wwe(r,o,t))}return i}class CI extends fE{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $W extends fE{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jwe{constructor(t,n,i,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&Qwe(r,t,i[s])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=Km(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=Km(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=NW();return this.mutations.forEach(s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=n.has(s.key)?null:a;const l=HW(o,a);l!==null&&i.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Be.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Tt())}isEqual(t){return this.batchId===t.batchId&&hg(this.mutations,t.mutations,(n,i)=>LD(n,i))&&hg(this.baseMutations,t.baseMutations,(n,i)=>LD(n,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eTe{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tTe{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $n,ft;function nTe(e){switch(e){case ae.OK:return De();case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return De()}}function GW(e){if(e===void 0)return Tl("GRPC error has no .code"),ae.UNKNOWN;switch(e){case $n.OK:return ae.OK;case $n.CANCELLED:return ae.CANCELLED;case $n.UNKNOWN:return ae.UNKNOWN;case $n.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case $n.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case $n.INTERNAL:return ae.INTERNAL;case $n.UNAVAILABLE:return ae.UNAVAILABLE;case $n.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case $n.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case $n.NOT_FOUND:return ae.NOT_FOUND;case $n.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case $n.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case $n.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case $n.ABORTED:return ae.ABORTED;case $n.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case $n.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case $n.DATA_LOSS:return ae.DATA_LOSS;default:return De()}}(ft=$n||($n={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iTe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sTe=new Dc([4294967295,4294967295],0);function ND(e){const t=iTe().encode(e),n=new dW;return n.update(t),new Uint8Array(n.digest())}function OD(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new Dc([n,i],0),new Dc([s,r],0)]}class AI{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new am(`Invalid padding: ${n}`);if(i<0)throw new am(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new am(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new am(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*t.length-n,this.de=Dc.fromNumber(this.Ee)}Ae(t,n,i){let s=t.add(n.multiply(Dc.fromNumber(i)));return s.compare(sTe)===1&&(s=new Dc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.de).toNumber()}Re(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.Ee===0)return!1;const n=ND(t),[i,s]=OD(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,s,r);if(!this.Re(o))return!1}return!0}static create(t,n,i){const s=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new AI(r,s,n);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.Ee===0)return;const n=ND(t),[i,s]=OD(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,s,r);this.Ve(o)}}Ve(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class am extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(t,n,i,s,r){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const s=new Map;return s.set(t,tU.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new hE(Be.min(),s,new zn(gt),id(),Tt())}}class tU{constructor(t,n,i,s,r){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new tU(i,n,Tt(),Tt(),Tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(t,n,i,s){this.me=t,this.removedTargetIds=n,this.key=i,this.fe=s}}class XW{constructor(t,n){this.targetId=t,this.ge=n}}class jW{constructor(t,n,i=Bi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=s}}class FD{constructor(){this.pe=0,this.ye=BD(),this.we=Bi.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(t){t.approximateByteSize()>0&&(this.be=!0,this.we=t)}Fe(){let t=Tt(),n=Tt(),i=Tt();return this.ye.forEach((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:i=i.add(s);break;default:De()}}),new tU(this.we,this.Se,t,n,i)}Me(){this.be=!1,this.ye=BD()}xe(t,n){this.be=!0,this.ye=this.ye.insert(t,n)}Oe(t){this.be=!0,this.ye=this.ye.remove(t)}Ne(){this.pe+=1}Be(){this.pe-=1,jt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class rTe{constructor(t){this.ke=t,this.qe=new Map,this.Qe=id(),this.$e=_2(),this.Ke=_2(),this.Ue=new zn(gt)}We(t){for(const n of t.me)t.fe&&t.fe.isFoundDocument()?this.Ge(n,t.fe):this.ze(n,t.key,t.fe);for(const n of t.removedTargetIds)this.ze(n,t.key,t.fe)}je(t){this.forEachTarget(t,n=>{const i=this.He(n);switch(t.state){case 0:this.Je(n)&&i.Ce(t.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(t.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(n);break;case 3:this.Je(n)&&(i.Le(),i.Ce(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),i.Ce(t.resumeToken));break;default:De()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.qe.forEach((i,s)=>{this.Je(s)&&n(s)})}Ze(t){const n=t.targetId,i=t.ge.count,s=this.Xe(n);if(s){const r=s.target;if(r9(r))if(i===0){const o=new Pe(r.path);this.ze(n,o,bi.newNoDocument(o,Be.min()))}else jt(i===1);else{const o=this.et(n);if(o!==i){const a=this.tt(t),l=a?this.nt(a,t,o):1;if(l!==0){this.Ye(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(n,c)}}}}}tt(t){const n=t.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=n;let o,a;try{o=td(i).toUint8Array()}catch(l){if(l instanceof EW)return fg("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new AI(o,s,r)}catch(l){return fg(l instanceof am?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(t,n,i){return n.ge.count===i-this.st(t,n.targetId)?0:2}st(t,n){const i=this.ke.getRemoteKeysForTarget(n);let s=0;return i.forEach(r=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.ze(n,r,null),s++)}),s}ot(t){const n=new Map;this.qe.forEach((r,o)=>{const a=this.Xe(o);if(a){if(r.current&&r9(a.target)){const l=new Pe(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,bi.newNoDocument(l,t))}r.ve&&(n.set(o,r.Fe()),r.Me())}});let i=Tt();this.Ke.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(r))}),this.Qe.forEach((r,o)=>o.setReadTime(t));const s=new hE(t,n,this.Ue,this.Qe,i);return this.Qe=id(),this.$e=_2(),this.Ke=_2(),this.Ue=new zn(gt),s}Ge(t,n){if(!this.Je(t))return;const i=this.ut(t,n.key)?2:0;this.He(t).xe(n.key,i),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t)),this.Ke=this.Ke.insert(n.key,this.ct(n.key).add(t))}ze(t,n,i){if(!this.Je(t))return;const s=this.He(t);this.ut(t,n)?s.xe(n,1):s.Oe(n),this.Ke=this.Ke.insert(n,this.ct(n).delete(t)),this.Ke=this.Ke.insert(n,this.ct(n).add(t)),i&&(this.Qe=this.Qe.insert(n,i))}removeTarget(t){this.qe.delete(t)}et(t){const n=this.He(t).Fe();return this.ke.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ne(t){this.He(t).Ne()}He(t){let n=this.qe.get(t);return n||(n=new FD,this.qe.set(t,n)),n}ct(t){let n=this.Ke.get(t);return n||(n=new li(gt),this.Ke=this.Ke.insert(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new li(gt),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||Ee("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.qe.get(t);return n&&n.De?null:this.ke.lt(t)}Ye(t){this.qe.set(t,new FD),this.ke.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ut(t,n){return this.ke.getRemoteKeysForTarget(t).has(n)}}function _2(){return new zn(Pe.comparator)}function BD(){return new zn(Pe.comparator)}const oTe={asc:"ASCENDING",desc:"DESCENDING"},aTe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lTe={and:"AND",or:"OR"};class cTe{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function a9(e,t){return e.useProto3Json||Jp(t)?t:{value:t}}function b5(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function YW(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function dTe(e,t){return b5(e,t.toTimestamp())}function ol(e){return jt(!!e),Be.fromTimestamp(function(n){const i=ed(n);return new wi(i.seconds,i.nanos)}(e))}function MI(e,t){return l9(e,t).canonicalString()}function l9(e,t){const n=function(s){return new fn(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?n:n.child(t)}function WW(e){const t=fn.fromString(e);return jt(JW(t)),t}function y5(e,t){return MI(e.databaseId,t.path)}function Zm(e,t){const n=WW(t);if(n.get(1)!==e.databaseId.projectId)throw new Ae(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ae(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Pe(ZW(n))}function KW(e,t){return MI(e.databaseId,t)}function uTe(e){const t=WW(e);return t.length===4?fn.emptyPath():ZW(t)}function zD(e){return new fn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ZW(e){return jt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function HD(e,t,n){return{name:y5(e,t),fields:n.value.mapValue.fields}}function fTe(e,t){return"found"in t?function(i,s){jt(!!s.found),s.found.name,s.found.updateTime;const r=Zm(i,s.found.name),o=ol(s.found.updateTime),a=s.found.createTime?ol(s.found.createTime):Be.min(),l=new As({mapValue:{fields:s.found.fields}});return bi.newFoundDocument(r,o,a,l)}(e,t):"missing"in t?function(i,s){jt(!!s.missing),jt(!!s.readTime);const r=Zm(i,s.missing),o=ol(s.readTime);return bi.newNoDocument(r,o)}(e,t):De()}function hTe(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:De()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=function(c,d){return c.useProto3Json?(jt(d===void 0||typeof d=="string"),Bi.fromBase64String(d||"")):(jt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Bi.fromUint8Array(d||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const d=c.code===void 0?ae.UNKNOWN:GW(c.code);return new Ae(d,c.message||"")}(o);n=new jW(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=Zm(e,i.document.name),r=ol(i.document.updateTime),o=i.document.createTime?ol(i.document.createTime):Be.min(),a=new As({mapValue:{fields:i.document.fields}}),l=bi.newFoundDocument(s,r,o,a),c=i.targetIds||[],d=i.removedTargetIds||[];n=new bb(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=Zm(e,i.document),r=i.readTime?ol(i.readTime):Be.min(),o=bi.newNoDocument(s,r),a=i.removedTargetIds||[];n=new bb([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=Zm(e,i.document),r=i.removedTargetIds||[];n=new bb([],r,s,null)}else{if(!("filter"in t))return De();{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new tTe(s,r),a=i.targetId;n=new XW(a,o)}}return n}function gTe(e,t){let n;if(t instanceof eU)n={update:HD(e,t.key,t.value)};else if(t instanceof CI)n={delete:y5(e,t.key)};else if(t instanceof ef)n={update:HD(e,t.key,t.data),updateMask:_Te(t.fieldMask)};else{if(!(t instanceof $W))return De();n={verify:y5(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(r,o){const a=o.transform;if(a instanceof p5)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ip)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof sp)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof U5)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw De()}(0,i))),t.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:dTe(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:De()}(e,t.precondition)),n}function mTe(e,t){return{documents:[KW(e,t.path)]}}function pTe(e,t){const n={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=KW(e,s);const r=function(c){if(c.length!==0)return QW(fa.create(c,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:Mf(f.field),direction:yTe(f.dir)}}(d))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=a9(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ht:n,parent:s}}function UTe(e){let t=uTe(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){jt(i===1);const d=n.from[0];d.allDescendants?s=d.collectionId:t=t.child(d.collectionId)}let r=[];n.where&&(r=function(u){const f=qW(u);return f instanceof fa&&AW(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(u){return u.map(f=>function(m){return new m5(kf(m.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(u){let f;return f=typeof u=="object"?u.value:u,Jp(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(u){const f=!!u.before,h=u.values||[];return new g5(h,f)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const f=!u.before,h=u.values||[];return new g5(h,f)}(n.endAt)),Owe(t,s,o,r,a,"F",l,c)}function bTe(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return De()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function qW(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=kf(n.unaryFilter.field);return ai.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=kf(n.unaryFilter.field);return ai.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=kf(n.unaryFilter.field);return ai.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=kf(n.unaryFilter.field);return ai.create(o,"!=",{nullValue:"NULL_VALUE"});default:return De()}}(e):e.fieldFilter!==void 0?function(n){return ai.create(kf(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return De()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return fa.create(n.compositeFilter.filters.map(i=>qW(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return De()}}(n.compositeFilter.op))}(e):De()}function yTe(e){return oTe[e]}function ETe(e){return aTe[e]}function vTe(e){return lTe[e]}function Mf(e){return{fieldPath:e.canonicalString()}}function kf(e){return qi.fromServerFormat(e.fieldPath)}function QW(e){return e instanceof ai?function(n){if(n.op==="=="){if(xD(n.value))return{unaryFilter:{field:Mf(n.field),op:"IS_NAN"}};if(SD(n.value))return{unaryFilter:{field:Mf(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(xD(n.value))return{unaryFilter:{field:Mf(n.field),op:"IS_NOT_NAN"}};if(SD(n.value))return{unaryFilter:{field:Mf(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mf(n.field),op:ETe(n.op),value:n.value}}}(e):e instanceof fa?function(n){const i=n.getFilters().map(s=>QW(s));return i.length===1?i[0]:{compositeFilter:{op:vTe(n.op),filters:i}}}(e):De()}function _Te(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function JW(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(t,n,i,s,r=Be.min(),o=Be.min(),a=Bi.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new gc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new gc(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new gc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new gc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wTe{constructor(t){this.Tt=t}}function TTe(e){const t=UTe({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?o9(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ITe{constructor(){this.Tn=new STe}addToCollectionParentIndex(t,n){return this.Tn.add(n),ie.resolve()}getCollectionParents(t,n){return ie.resolve(this.Tn.getEntries(n))}addFieldIndex(t,n){return ie.resolve()}deleteFieldIndex(t,n){return ie.resolve()}deleteAllFieldIndexes(t){return ie.resolve()}createTargetIndexes(t,n){return ie.resolve()}getDocumentsMatchingTarget(t,n){return ie.resolve(null)}getIndexType(t,n){return ie.resolve(0)}getFieldIndexes(t,n){return ie.resolve([])}getNextCollectionGroupToUpdate(t){return ie.resolve(null)}getMinOffset(t,n){return ie.resolve(Jc.min())}getMinOffsetFromCollectionGroup(t,n){return ie.resolve(Jc.min())}updateCollectionGroup(t,n,i){return ie.resolve()}updateIndexEntries(t,n){return ie.resolve()}}class STe{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n]||new li(fn.comparator),r=!s.has(i);return this.index[n]=s.add(i),r}has(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n];return s&&s.has(i)}getEntries(t){return(this.index[t]||new li(fn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eK=41943040;class Cs{static withCacheSize(t){return new Cs(t,Cs.DEFAULT_COLLECTION_PERCENTILE,Cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs.DEFAULT_COLLECTION_PERCENTILE=10,Cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Cs.DEFAULT=new Cs(eK,Cs.DEFAULT_COLLECTION_PERCENTILE,Cs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Cs.DISABLED=new Cs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(t){this.$n=t}next(){return this.$n+=2,this.$n}static Kn(){return new pg(0)}static Un(){return new pg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D="LruGarbageCollector",xTe=1048576;function GD([e,t],[n,i]){const s=gt(e,n);return s===0?gt(t,i):s}class CTe{constructor(t){this.Hn=t,this.buffer=new li(GD),this.Jn=0}Yn(){return++this.Jn}Zn(t){const n=[t,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();GD(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ATe{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(t){Ee($D,`Garbage collection scheduled in ${t}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){$g(n)?Ee($D,"Ignoring IndexedDB error during garbage collection: ",n):await rE(n)}await this.er(3e5)})}}class MTe{constructor(t,n){this.tr=t,this.params=n}calculateTargetCount(t,n){return this.tr.nr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return ie.resolve(oE.ae);const i=new CTe(n);return this.tr.forEachTarget(t,s=>i.Zn(s.sequenceNumber)).next(()=>this.tr.rr(t,s=>i.Zn(s))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.tr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.tr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(VD)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),VD):this.ir(t,n))}getCacheSize(t){return this.tr.getCacheSize(t)}ir(t,n){let i,s,r,o,a,l,c;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),s=this.params.maximumSequenceNumbersToCollect):s=u,o=Date.now(),this.nthSequenceNumber(t,s))).next(u=>(i=u,a=Date.now(),this.removeTargets(t,i,n))).next(u=>(r=u,l=Date.now(),this.removeOrphanedDocuments(t,i))).next(u=>(c=Date.now(),Cf()<=ht.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${u} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:u})))}}function kTe(e,t){return new MTe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RTe{constructor(){this.changes=new Ju(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,bi.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ie.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LTe{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DTe{constructor(t,n,i,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(i=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(i!==null&&Km(i.mutation,s,Mr.empty(),wi.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,Tt()).next(()=>i))}getLocalViewOfDocuments(t,n,i=Tt()){const s=jd();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,i).next(r=>{let o=om();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=jd();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,Tt()))}populateOverlays(t,n,i){const s=[];return i.forEach(r=>{n.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(t,s).next(r=>{r.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,s){let r=id();const o=Wm(),a=function(){return Wm()}();return n.forEach((l,c)=>{const d=i.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof ef)?r=r.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Km(d.mutation,c,d.mutation.getFieldMask(),wi.now())):o.set(c.key,Mr.empty())}),this.recalculateAndSaveOverlays(t,r).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var u;return a.set(c,new LTe(d,(u=o.get(c))!==null&&u!==void 0?u:null))}),a))}recalculateAndSaveOverlays(t,n){const i=Wm();let s=new zn((o,a)=>o-a),r=Tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=i.get(l)||Mr.empty();d=a.applyToLocalView(c,d),i.set(l,d);const u=(s.get(a.batchId)||Tt()).add(l);s=s.insert(a.batchId,u)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,u=NW();d.forEach(f=>{if(!r.has(f)){const h=HW(n.get(f),i.get(f));h!==null&&u.set(f,h),r=r.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,u))}return ie.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,s){return function(o){return Pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):Fwe(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,s):this.getDocumentsMatchingCollectionQuery(t,n,i,s)}getNextDocuments(t,n,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,s-r.size):ie.resolve(jd());let a=J0,l=r;return o.next(c=>ie.forEach(c,(d,u)=>(a<u.largestBatchId&&(a=u.largestBatchId),r.get(d)?ie.resolve():this.remoteDocumentCache.getEntry(t,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(t,c,r)).next(()=>this.computeViews(t,l,c,Tt())).next(d=>({batchId:a,changes:$we(d)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Pe(n)).next(i=>{let s=om();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,i,s){const r=n.collectionGroup;let o=om();return this.indexManager.getCollectionParents(t,r).next(a=>ie.forEach(a,l=>{const c=function(u,f){return new lE(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,l.child(r));return this.getDocumentsMatchingCollectionQuery(t,c,i,s).next(d=>{d.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,r,s))).next(o=>{r.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,bi.newInvalidDocument(d)))});let a=om();return o.forEach((l,c)=>{const d=r.get(l);d!==void 0&&Km(d.mutation,c,Mr.empty(),wi.now()),dE(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PTe{constructor(t){this.serializer=t,this.dr=new Map,this.Ar=new Map}getBundleMetadata(t,n){return ie.resolve(this.dr.get(n))}saveBundleMetadata(t,n){return this.dr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ol(s.createTime)}}(n)),ie.resolve()}getNamedQuery(t,n){return ie.resolve(this.Ar.get(n))}saveNamedQuery(t,n){return this.Ar.set(n.name,function(s){return{name:s.name,query:TTe(s.bundledQuery),readTime:ol(s.readTime)}}(n)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NTe{constructor(){this.overlays=new zn(Pe.comparator),this.Rr=new Map}getOverlay(t,n){return ie.resolve(this.overlays.get(n))}getOverlays(t,n){const i=jd();return ie.forEach(n,s=>this.getOverlay(t,s).next(r=>{r!==null&&i.set(s,r)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((s,r)=>{this.Et(t,n,r)}),ie.resolve()}removeOverlaysForBatchId(t,n,i){const s=this.Rr.get(i);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.Rr.delete(i)),ie.resolve()}getOverlaysForCollection(t,n,i){const s=jd(),r=n.length+1,o=new Pe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&s.set(l.getKey(),l)}return ie.resolve(s)}getOverlaysForCollectionGroup(t,n,i,s){let r=new zn((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>i){let d=r.get(c.largestBatchId);d===null&&(d=jd(),r=r.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=jd(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return ie.resolve(a)}Et(t,n,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.Rr.get(s.largestBatchId).delete(i.key);this.Rr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new eTe(n,i));let r=this.Rr.get(n);r===void 0&&(r=Tt(),this.Rr.set(n,r)),this.Rr.set(n,r.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OTe{constructor(){this.sessionToken=Bi.EMPTY_BYTE_STRING}getSessionToken(t){return ie.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(){this.Vr=new li(mi.mr),this.gr=new li(mi.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(t,n){const i=new mi(t,n);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.wr(new mi(t,n))}Sr(t,n){t.forEach(i=>this.removeReference(i,n))}br(t){const n=new Pe(new fn([])),i=new mi(n,t),s=new mi(n,t+1),r=[];return this.gr.forEachInRange([i,s],o=>{this.wr(o),r.push(o.key)}),r}Dr(){this.Vr.forEach(t=>this.wr(t))}wr(t){this.Vr=this.Vr.delete(t),this.gr=this.gr.delete(t)}vr(t){const n=new Pe(new fn([])),i=new mi(n,t),s=new mi(n,t+1);let r=Tt();return this.gr.forEachInRange([i,s],o=>{r=r.add(o.key)}),r}containsKey(t){const n=new mi(t,0),i=this.Vr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class mi{constructor(t,n){this.key=t,this.Cr=n}static mr(t,n){return Pe.comparator(t.key,n.key)||gt(t.Cr,n.Cr)}static pr(t,n){return gt(t.Cr,n.Cr)||Pe.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FTe{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new li(mi.mr)}checkEmpty(t){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,s){const r=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Jwe(r,n,i,s);this.mutationQueue.push(o);for(const a of s)this.Mr=this.Mr.add(new mi(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(t,n){return ie.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,s=this.Nr(i),r=s<0?0:s;return ie.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?bwe:this.Fr-1)}getAllMutationBatches(t){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new mi(n,0),s=new mi(n,Number.POSITIVE_INFINITY),r=[];return this.Mr.forEachInRange([i,s],o=>{const a=this.Or(o.Cr);r.push(a)}),ie.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new li(gt);return n.forEach(s=>{const r=new mi(s,0),o=new mi(s,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([r,o],a=>{i=i.add(a.Cr)})}),ie.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,s=i.length+1;let r=i;Pe.isDocumentKey(r)||(r=r.child(""));const o=new mi(new Pe(r),0);let a=new li(gt);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Cr)),!0)},o),ie.resolve(this.Br(a))}Br(t){const n=[];return t.forEach(i=>{const s=this.Or(i);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){jt(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return ie.forEach(n.mutations,s=>{const r=new mi(s.key,n.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Mr=i})}qn(t){}containsKey(t,n){const i=new mi(n,0),s=this.Mr.firstAfterOrEqual(i);return ie.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,ie.resolve()}Lr(t,n){return this.Nr(t)}Nr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Or(t){const n=this.Nr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BTe{constructor(t){this.kr=t,this.docs=function(){return new zn(Pe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,s=this.docs.get(i),r=s?s.size:0,o=this.kr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return ie.resolve(i?i.document.mutableCopy():bi.newInvalidDocument(n))}getEntries(t,n){let i=id();return n.forEach(s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():bi.newInvalidDocument(s))}),ie.resolve(i)}getDocumentsMatchingQuery(t,n,i,s){let r=id();const o=n.path,a=new Pe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||gwe(hwe(d),i)<=0||(s.has(d.key)||dE(n,d))&&(r=r.insert(d.key,d.mutableCopy()))}return ie.resolve(r)}getAllFromCollectionGroup(t,n,i,s){De()}qr(t,n){return ie.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new zTe(this)}getSize(t){return ie.resolve(this.size)}}class zTe extends RTe{constructor(t){super(),this.Ir=t}applyChanges(t){const n=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?n.push(this.Ir.addEntry(t,s)):this.Ir.removeEntry(i)}),ie.waitFor(n)}getFromCache(t,n){return this.Ir.getEntry(t,n)}getAllFromCache(t,n){return this.Ir.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HTe{constructor(t){this.persistence=t,this.Qr=new Ju(n=>TI(n),II),this.lastRemoteSnapshotVersion=Be.min(),this.highestTargetId=0,this.$r=0,this.Kr=new kI,this.targetCount=0,this.Ur=pg.Kn()}forEachTarget(t,n){return this.Qr.forEach((i,s)=>n(s)),ie.resolve()}getLastRemoteSnapshotVersion(t){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ie.resolve(this.$r)}allocateTargetId(t){return this.highestTargetId=this.Ur.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.$r&&(this.$r=n),ie.resolve()}zn(t){this.Qr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Ur=new pg(n),this.highestTargetId=n),t.sequenceNumber>this.$r&&(this.$r=t.sequenceNumber)}addTargetData(t,n){return this.zn(n),this.targetCount+=1,ie.resolve()}updateTargetData(t,n){return this.zn(n),ie.resolve()}removeTargetData(t,n){return this.Qr.delete(n.target),this.Kr.br(n.targetId),this.targetCount-=1,ie.resolve()}removeTargets(t,n,i){let s=0;const r=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Qr.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),ie.waitFor(r).next(()=>s)}getTargetCount(t){return ie.resolve(this.targetCount)}getTargetData(t,n){const i=this.Qr.get(n)||null;return ie.resolve(i)}addMatchingKeys(t,n,i){return this.Kr.yr(n,i),ie.resolve()}removeMatchingKeys(t,n,i){this.Kr.Sr(n,i);const s=this.persistence.referenceDelegate,r=[];return s&&n.forEach(o=>{r.push(s.markPotentiallyOrphaned(t,o))}),ie.waitFor(r)}removeMatchingKeysForTargetId(t,n){return this.Kr.br(n),ie.resolve()}getMatchingKeysForTargetId(t,n){const i=this.Kr.vr(n);return ie.resolve(i)}containsKey(t,n){return ie.resolve(this.Kr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tK{constructor(t,n){this.Wr={},this.overlays={},this.Gr=new oE(0),this.zr=!1,this.zr=!0,this.jr=new OTe,this.referenceDelegate=t(this),this.Hr=new HTe(this),this.indexManager=new ITe,this.remoteDocumentCache=function(s){return new BTe(s)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new wTe(n),this.Yr=new PTe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new NTe,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.Wr[t.toKey()];return i||(i=new FTe(n,this.referenceDelegate),this.Wr[t.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(t,n,i){Ee("MemoryPersistence","Starting transaction:",t);const s=new VTe(this.Gr.next());return this.referenceDelegate.Zr(),i(s).next(r=>this.referenceDelegate.Xr(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}ei(t,n){return ie.or(Object.values(this.Wr).map(i=>()=>i.containsKey(t,n)))}}class VTe extends pwe{constructor(t){super(),this.currentSequenceNumber=t}}class RI{constructor(t){this.persistence=t,this.ti=new kI,this.ni=null}static ri(t){return new RI(t)}get ii(){if(this.ni)return this.ni;throw De()}addReference(t,n,i){return this.ti.addReference(i,n),this.ii.delete(i.toString()),ie.resolve()}removeReference(t,n,i){return this.ti.removeReference(i,n),this.ii.add(i.toString()),ie.resolve()}markPotentiallyOrphaned(t,n){return this.ii.add(n.toString()),ie.resolve()}removeTarget(t,n){this.ti.br(n.targetId).forEach(s=>this.ii.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(r=>this.ii.add(r.toString()))}).next(()=>i.removeTargetData(t,n))}Zr(){this.ni=new Set}Xr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.ii,i=>{const s=Pe.fromPath(i);return this.si(t,s).next(r=>{r||n.removeEntry(s,Be.min())})}).next(()=>(this.ni=null,n.apply(t)))}updateLimboDocument(t,n){return this.si(t,n).next(i=>{i?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(t){return 0}si(t,n){return ie.or([()=>ie.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.ei(t,n)])}}class E5{constructor(t,n){this.persistence=t,this.oi=new Ju(i=>Ewe(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=kTe(this,n)}static ri(t,n){return new E5(t,n)}Zr(){}Xr(t){return ie.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}nr(t){const n=this.sr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(s=>i+s))}sr(t){let n=0;return this.rr(t,i=>{n++}).next(()=>n)}rr(t,n){return ie.forEach(this.oi,(i,s)=>this.ar(t,i,s).next(r=>r?ie.resolve():n(s)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.qr(t,o=>this.ar(t,o,n).next(a=>{a||(i++,r.removeEntry(o,Be.min()))})).next(()=>r.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.oi.set(n,t.currentSequenceNumber),ie.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),ie.resolve()}removeReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),ie.resolve()}updateLimboDocument(t,n){return this.oi.set(n,t.currentSequenceNumber),ie.resolve()}Jr(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=pb(t.data.value)),n}ar(t,n,i){return ie.or([()=>this.persistence.ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const s=this.oi.get(n);return ie.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(t,n,i,s){this.targetId=t,this.fromCache=n,this.Hi=i,this.Ji=s}static Yi(t,n){let i=Tt(),s=Tt();for(const r of n.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new LI(t,n.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Te{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GTe{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return V9e()?8:Uwe(z9e())>0?6:4}()}initialize(t,n){this.ns=t,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(t,n,i,s){const r={result:null};return this.rs(t,n).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ss(t,n,s,i).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new $Te;return this._s(t,n,o).next(a=>{if(r.result=a,this.Xi)return this.us(t,n,o,a.size)})}).next(()=>r.result)}us(t,n,i,s){return i.documentReadCount<this.es?(Cf()<=ht.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",Af(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ie.resolve()):(Cf()<=ht.DEBUG&&Ee("QueryEngine","Query:",Af(n),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ts*s?(Cf()<=ht.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",Af(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ea(n))):ie.resolve())}rs(t,n){if(kD(n))return ie.resolve(null);let i=ea(n);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=o9(n,null,"F"),i=ea(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(r=>{const o=Tt(...r);return this.ns.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.cs(n,a);return this.ls(n,c,o,l.readTime)?this.rs(t,o9(n,null,"F")):this.hs(t,c,n,l)}))})))}ss(t,n,i,s){return kD(n)||s.isEqual(Be.min())?ie.resolve(null):this.ns.getDocuments(t,i).next(r=>{const o=this.cs(n,r);return this.ls(n,o,i,s)?ie.resolve(null):(Cf()<=ht.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Af(n)),this.hs(t,o,n,fwe(s,J0)).next(a=>a))})}cs(t,n){let i=new li(DW(t));return n.forEach((s,r)=>{dE(t,r)&&(i=i.add(r))}),i}ls(t,n,i,s){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const r=t.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}_s(t,n,i){return Cf()<=ht.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",Af(n)),this.ns.getDocumentsMatchingQuery(t,n,Jc.min(),i)}hs(t,n,i,s){return this.ns.getDocumentsMatchingQuery(t,i,s).next(r=>(n.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI="LocalStore",XTe=3e8;class jTe{constructor(t,n,i,s){this.persistence=t,this.Ps=n,this.serializer=s,this.Ts=new zn(gt),this.Is=new Ju(r=>TI(r),II),this.Es=new Map,this.ds=t.getRemoteDocumentCache(),this.Hr=t.getTargetCache(),this.Yr=t.getBundleCache(),this.As(i)}As(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new DTe(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ts))}}function YTe(e,t,n,i){return new jTe(e,t,n,i)}async function nK(e,t){const n=at(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let s;return n.mutationQueue.getAllMutationBatches(i).next(r=>(s=r,n.As(t),n.mutationQueue.getAllMutationBatches(i))).next(r=>{const o=[],a=[];let l=Tt();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of r){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(i,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function iK(e){const t=at(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Hr.getLastRemoteSnapshotVersion(n))}function WTe(e,t){const n=at(e),i=t.snapshotVersion;let s=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});s=n.Ts;const a=[];t.targetChanges.forEach((d,u)=>{const f=s.get(u);if(!f)return;a.push(n.Hr.removeMatchingKeys(r,d.removedDocuments,u).next(()=>n.Hr.addMatchingKeys(r,d.addedDocuments,u)));let h=f.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(u)!==null?h=h.withResumeToken(Bi.EMPTY_BYTE_STRING,Be.min()).withLastLimboFreeSnapshotVersion(Be.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,i)),s=s.insert(u,h),function(p,U,b){return p.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=XTe?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(f,h,d)&&a.push(n.Hr.updateTargetData(r,h))});let l=id(),c=Tt();if(t.documentUpdates.forEach(d=>{t.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(r,d))}),a.push(KTe(r,o,t.documentUpdates).next(d=>{l=d.Vs,c=d.fs})),!i.isEqual(Be.min())){const d=n.Hr.getLastRemoteSnapshotVersion(r).next(u=>n.Hr.setTargetsMetadata(r,r.currentSequenceNumber,i));a.push(d)}return ie.waitFor(a).next(()=>o.apply(r)).next(()=>n.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(n.Ts=s,r))}function KTe(e,t,n){let i=Tt(),s=Tt();return n.forEach(r=>i=i.add(r)),t.getEntries(e,i).next(r=>{let o=id();return n.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Be.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):Ee(DI,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:s}})}function ZTe(e,t){const n=at(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return n.Hr.getTargetData(i,t).next(r=>r?(s=r,ie.resolve(s)):n.Hr.allocateTargetId(i).next(o=>(s=new gc(t,o,"TargetPurposeListen",i.currentSequenceNumber),n.Hr.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=n.Ts.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(i.targetId,i),n.Is.set(t,i.targetId)),i})}async function c9(e,t,n){const i=at(e),s=i.Ts.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!$g(o))throw o;Ee(DI,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ts=i.Ts.remove(t),i.Is.delete(s.target)}function XD(e,t,n){const i=at(e);let s=Be.min(),r=Tt();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const u=at(l),f=u.Is.get(d);return f!==void 0?ie.resolve(u.Ts.get(f)):u.Hr.getTargetData(c,d)}(i,o,ea(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>i.Ps.getDocumentsMatchingQuery(o,t,n?s:Be.min(),n?r:Tt())).next(a=>(qTe(i,zwe(t),a),{documents:a,gs:r})))}function qTe(e,t,n){let i=e.Es.get(t)||Be.min();n.forEach((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),e.Es.set(t,i)}class jD{constructor(){this.activeTargetIds=jwe()}Ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}vs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}bs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class QTe{constructor(){this.ho=new jD,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.ho.Ds(t),this.Po[t]||"not-current"}updateQueryState(t,n,i){this.Po[t]=n}removeLocalQueryTarget(t){this.ho.vs(t)}isLocalQueryTarget(t){return this.ho.activeTargetIds.has(t)}clearQueryState(t){delete this.Po[t]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(t){return this.ho.activeTargetIds.has(t)}start(){return this.ho=new jD,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JTe{To(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD="ConnectivityMonitor";class WD{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(t){this.Vo.push(t)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Ee(YD,"Network connectivity changed: AVAILABLE");for(const t of this.Vo)t(0)}Ro(){Ee(YD,"Network connectivity changed: UNAVAILABLE");for(const t of this.Vo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w2=null;function d9(){return w2===null?w2=function(){return 268435456+Math.round(2147483648*Math.random())}():w2++,"0x"+w2.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i7="RestConnection",eIe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class tIe{get fo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.po=n+"://"+t.host,this.yo=`projects/${i}/databases/${s}`,this.wo=this.databaseId.database===f5?`project_id=${i}`:`project_id=${i}&database_id=${s}`}So(t,n,i,s,r){const o=d9(),a=this.bo(t,n.toUriEncodedString());Ee(i7,`Sending RPC '${t}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,s,r),this.vo(t,a,l,i).then(c=>(Ee(i7,`Received RPC '${t}' ${o}: `,c),c),c=>{throw fg(i7,`RPC '${t}' ${o} failed with error: `,c,"url: ",a,"request:",i),c})}Co(t,n,i,s,r,o){return this.So(t,n,i,s,r)}Do(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vg}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,r)=>t[r]=s),i&&i.headers.forEach((s,r)=>t[r]=s)}bo(t,n){const i=eIe[t];return`${this.po}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nIe{constructor(t){this.Fo=t.Fo,this.Mo=t.Mo}xo(t){this.Oo=t}No(t){this.Bo=t}Lo(t){this.ko=t}onMessage(t){this.qo=t}close(){this.Mo()}send(t){this.Fo(t)}Qo(){this.Oo()}$o(){this.Bo()}Ko(t){this.ko(t)}Uo(t){this.qo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="WebChannelConnection";class iIe extends tIe{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}vo(t,n,i,s){const r=d9();return new Promise((o,a)=>{const l=new uW;l.setWithCredentials(!0),l.listenOnce(fW.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case mb.NO_ERROR:const d=l.getResponseJson();Ee(Xi,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(d)),o(d);break;case mb.TIMEOUT:Ee(Xi,`RPC '${t}' ${r} timed out`),a(new Ae(ae.DEADLINE_EXCEEDED,"Request time out"));break;case mb.HTTP_ERROR:const u=l.getStatus();if(Ee(Xi,`RPC '${t}' ${r} failed with status:`,u,"response text:",l.getResponseText()),u>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(U){const b=U.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(b)>=0?b:ae.UNKNOWN}(h.status);a(new Ae(m,h.message))}else a(new Ae(ae.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Ae(ae.UNAVAILABLE,"Connection failed."));break;default:De()}}finally{Ee(Xi,`RPC '${t}' ${r} completed.`)}});const c=JSON.stringify(s);Ee(Xi,`RPC '${t}' ${r} sending request:`,s),l.send(n,"POST",c,i,15)})}Wo(t,n,i){const s=d9(),r=[this.po,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=mW(),a=gW(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,n,i),l.encodeInitMessageHeaders=!0;const d=r.join("");Ee(Xi,`Creating RPC '${t}' stream ${s}: ${d}`,l);const u=o.createWebChannel(d,l);let f=!1,h=!1;const m=new nIe({Fo:U=>{h?Ee(Xi,`Not sending because RPC '${t}' stream ${s} is closed:`,U):(f||(Ee(Xi,`Opening RPC '${t}' stream ${s} transport.`),u.open(),f=!0),Ee(Xi,`RPC '${t}' stream ${s} sending:`,U),u.send(U))},Mo:()=>u.close()}),p=(U,b,y)=>{U.listen(b,v=>{try{y(v)}catch(_){setTimeout(()=>{throw _},0)}})};return p(u,rm.EventType.OPEN,()=>{h||(Ee(Xi,`RPC '${t}' stream ${s} transport opened.`),m.Qo())}),p(u,rm.EventType.CLOSE,()=>{h||(h=!0,Ee(Xi,`RPC '${t}' stream ${s} transport closed`),m.Ko())}),p(u,rm.EventType.ERROR,U=>{h||(h=!0,fg(Xi,`RPC '${t}' stream ${s} transport errored:`,U),m.Ko(new Ae(ae.UNAVAILABLE,"The operation could not be completed")))}),p(u,rm.EventType.MESSAGE,U=>{var b;if(!h){const y=U.data[0];jt(!!y);const v=y,_=(v==null?void 0:v.error)||((b=v[0])===null||b===void 0?void 0:b.error);if(_){Ee(Xi,`RPC '${t}' stream ${s} received error:`,_);const I=_.status;let R=function(S){const x=$n[S];if(x!==void 0)return GW(x)}(I),T=_.message;R===void 0&&(R=ae.INTERNAL,T="Unknown error status: "+I+" with message "+_.message),h=!0,m.Ko(new Ae(R,T)),u.close()}else Ee(Xi,`RPC '${t}' stream ${s} received:`,y),m.Uo(y)}}),p(a,hW.STAT_EVENT,U=>{U.stat===t9.PROXY?Ee(Xi,`RPC '${t}' stream ${s} detected buffering proxy`):U.stat===t9.NOPROXY&&Ee(Xi,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.$o()},0),m}}function s7(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gE(e){return new cTe(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(t,n,i=1e3,s=1.5,r=6e4){this.Ti=t,this.timerId=n,this.Go=i,this.zo=s,this.jo=r,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(t){this.cancel();const n=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),s=Math.max(0,n-i);s>0&&Ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,s,()=>(this.Yo=Date.now(),t())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD="PersistentStream";class sIe{constructor(t,n,i,s,r,o,a,l){this.Ti=t,this.n_=i,this.r_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new PI(t,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(t){this.E_(),this.stream.send(t)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(t,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,t!==4?this.a_.reset():n&&n.code===ae.RESOURCE_EXHAUSTED?(Tl(n.toString()),Tl("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const t=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.i_===n&&this.V_(i,s)},i=>{t(()=>{const s=new Ae(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(s)})})}V_(t,n){const i=this.R_(this.i_);this.stream=this.f_(t,n),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(s=>{i(()=>this.m_(s))}),this.stream.onMessage(s=>{i(()=>++this.__==1?this.g_(s):this.onNext(s))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(t){return Ee(KD,`close with error: ${t}`),this.stream=null,this.close(4,t)}R_(t){return n=>{this.Ti.enqueueAndForget(()=>this.i_===t?n():(Ee(KD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rIe extends sIe{constructor(t,n,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s,o),this.serializer=r}f_(t,n){return this.connection.Wo("Listen",t,n)}g_(t){return this.onNext(t)}onNext(t){this.a_.reset();const n=hTe(this.serializer,t),i=function(r){if(!("targetChange"in r))return Be.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?Be.min():o.readTime?ol(o.readTime):Be.min()}(t);return this.listener.p_(n,i)}y_(t){const n={};n.database=zD(this.serializer),n.addTarget=function(r,o){let a;const l=o.target;if(a=r9(l)?{documents:mTe(r,l)}:{query:pTe(r,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YW(r,o.resumeToken);const c=a9(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Be.min())>0){a.readTime=b5(r,o.snapshotVersion.toTimestamp());const c=a9(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const i=bTe(this.serializer,t);i&&(n.labels=i),this.I_(n)}w_(t){const n={};n.database=zD(this.serializer),n.removeTarget=t,this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oIe{}class aIe extends oIe{constructor(t,n,i,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=s,this.F_=!1}M_(){if(this.F_)throw new Ae(ae.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.So(t,l9(n,i),s,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Ae(ae.UNKNOWN,r.toString())})}Co(t,n,i,s,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(t,l9(n,i),s,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ae(ae.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class lIe{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(t){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.L_("Offline")))}set(t){this.Q_(),this.x_=0,t==="Online"&&(this.N_=!1),this.L_(t)}L_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}k_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Tl(n),this.N_=!1):Ee("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="RemoteStore";class cIe{constructor(t,n,i,s,r){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=r,this.z_.To(o=>{i.enqueueAndForget(async()=>{iU(this)&&(Ee(Ug,"Restarting streams for network reachability change."),await async function(l){const c=at(l);c.W_.add(4),await nU(c),c.j_.set("Unknown"),c.W_.delete(4),await mE(c)}(this))})}),this.j_=new lIe(i,s)}}async function mE(e){if(iU(e))for(const t of e.G_)await t(!0)}async function nU(e){for(const t of e.G_)await t(!1)}function sK(e,t){const n=at(e);n.U_.has(t.targetId)||(n.U_.set(t.targetId,t),BI(n)?FI(n):Gg(n).c_()&&OI(n,t))}function NI(e,t){const n=at(e),i=Gg(n);n.U_.delete(t),i.c_()&&rK(n,t),n.U_.size===0&&(i.c_()?i.P_():iU(n)&&n.j_.set("Unknown"))}function OI(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Be.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Gg(e).y_(t)}function rK(e,t){e.H_.Ne(t),Gg(e).w_(t)}function FI(e){e.H_=new rTe({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.U_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),Gg(e).start(),e.j_.B_()}function BI(e){return iU(e)&&!Gg(e).u_()&&e.U_.size>0}function iU(e){return at(e).W_.size===0}function oK(e){e.H_=void 0}async function dIe(e){e.j_.set("Online")}async function uIe(e){e.U_.forEach((t,n)=>{OI(e,t)})}async function fIe(e,t){oK(e),BI(e)?(e.j_.q_(t),FI(e)):e.j_.set("Unknown")}async function hIe(e,t,n){if(e.j_.set("Online"),t instanceof jW&&t.state===2&&t.cause)try{await async function(s,r){const o=r.cause;for(const a of r.targetIds)s.U_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.U_.delete(a),s.H_.removeTarget(a))}(e,t)}catch(i){Ee(Ug,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await ZD(e,i)}else if(t instanceof bb?e.H_.We(t):t instanceof XW?e.H_.Ze(t):e.H_.je(t),!n.isEqual(Be.min()))try{const i=await iK(e.localStore);n.compareTo(i)>=0&&await function(r,o){const a=r.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=r.U_.get(c);d&&r.U_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=r.U_.get(l);if(!d)return;r.U_.set(l,d.withResumeToken(Bi.EMPTY_BYTE_STRING,d.snapshotVersion)),rK(r,l);const u=new gc(d.target,l,c,d.sequenceNumber);OI(r,u)}),r.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(i){Ee(Ug,"Failed to raise snapshot:",i),await ZD(e,i)}}async function ZD(e,t,n){if(!$g(t))throw t;e.W_.add(1),await nU(e),e.j_.set("Offline"),n||(n=()=>iK(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ee(Ug,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await mE(e)})}async function qD(e,t){const n=at(e);n.asyncQueue.verifyOperationInProgress(),Ee(Ug,"RemoteStore received new credentials");const i=iU(n);n.W_.add(3),await nU(n),i&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await mE(n)}async function gIe(e,t){const n=at(e);t?(n.W_.delete(2),await mE(n)):t||(n.W_.add(2),await nU(n),n.j_.set("Unknown"))}function Gg(e){return e.J_||(e.J_=function(n,i,s){const r=at(n);return r.M_(),new rIe(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(e.datastore,e.asyncQueue,{xo:dIe.bind(null,e),No:uIe.bind(null,e),Lo:fIe.bind(null,e),p_:hIe.bind(null,e)}),e.G_.push(async t=>{t?(e.J_.h_(),BI(e)?FI(e):e.j_.set("Unknown")):(await e.J_.stop(),oK(e))})),e.J_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(t,n,i,s,r){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new Pc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,s,r){const o=Date.now()+i,a=new zI(t,n,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ae(ae.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function aK(e,t){if(Tl("AsyncQueue",`${t}: ${e}`),$g(e))return new Ae(ae.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{static emptySet(t){return new xh(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Pe.comparator(n.key,i.key):(n,i)=>Pe.comparator(n.key,i.key),this.keyedMap=om(),this.sortedSet=new zn(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof xh)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new xh;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(){this.Z_=new zn(Pe.comparator)}track(t){const n=t.doc.key,i=this.Z_.get(n);i?t.type!==0&&i.type===3?this.Z_=this.Z_.insert(n,t):t.type===3&&i.type!==1?this.Z_=this.Z_.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Z_=this.Z_.remove(n):t.type===1&&i.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):De():this.Z_=this.Z_.insert(n,t)}X_(){const t=[];return this.Z_.inorderTraversal((n,i)=>{t.push(i)}),t}}class bg{constructor(t,n,i,s,r,o,a,l,c){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,i,s,r){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new bg(t,n,xh.emptySet(n),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&cE(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==i[s].type||!n[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mIe{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(t=>t.ra())}}class pIe{constructor(){this.queries=JD(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,i){const s=at(n),r=s.queries;s.queries=JD(),r.forEach((o,a)=>{for(const l of a.ta)l.onError(i)})})(this,new Ae(ae.ABORTED,"Firestore shutting down"))}}function JD(){return new Ju(e=>LW(e),cE)}async function UIe(e,t){const n=at(e);let i=3;const s=t.query;let r=n.queries.get(s);r?!r.na()&&t.ra()&&(i=2):(r=new mIe,i=t.ra()?0:1);try{switch(i){case 0:r.ea=await n.onListen(s,!0);break;case 1:r.ea=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=aK(o,`Initialization of query '${Af(t.query)}' failed`);return void t.onError(a)}n.queries.set(s,r),r.ta.push(t),t.sa(n.onlineState),r.ea&&t.oa(r.ea)&&HI(n)}async function bIe(e,t){const n=at(e),i=t.query;let s=3;const r=n.queries.get(i);if(r){const o=r.ta.indexOf(t);o>=0&&(r.ta.splice(o,1),r.ta.length===0?s=t.ra()?0:1:!r.na()&&t.ra()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function yIe(e,t){const n=at(e);let i=!1;for(const s of t){const r=s.query,o=n.queries.get(r);if(o){for(const a of o.ta)a.oa(s)&&(i=!0);o.ea=s}}i&&HI(n)}function EIe(e,t,n){const i=at(e),s=i.queries.get(t);if(s)for(const r of s.ta)r.onError(n);i.queries.delete(t)}function HI(e){e.ia.forEach(t=>{t.next()})}var u9,eP;(eP=u9||(u9={}))._a="default",eP.Cache="cache";class vIe{constructor(t,n,i){this.query=t,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new bg(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.ua?this.la(t)&&(this.aa.next(t),n=!0):this.ha(t,this.onlineState)&&(this.Pa(t),n=!0),this.ca=t,n}onError(t){this.aa.error(t)}sa(t){this.onlineState=t;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,t)&&(this.Pa(this.ca),n=!0),n}ha(t,n){if(!t.fromCache||!this.ra())return!0;const i=n!=="Offline";return(!this.options.Ta||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}la(t){if(t.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(t){t=bg.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ua=!0,this.aa.next(t)}ra(){return this.options.source!==u9.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lK{constructor(t){this.key=t}}class cK{constructor(t){this.key=t}}class _Ie{constructor(t,n){this.query=t,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Tt(),this.mutatedKeys=Tt(),this.ya=DW(t),this.wa=new xh(this.ya)}get Sa(){return this.fa}ba(t,n){const i=n?n.Da:new QD,s=n?n.wa:this.wa;let r=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((d,u)=>{const f=s.get(d),h=dE(this.query,u)?u:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let U=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(i.track({type:3,doc:h}),U=!0):this.va(f,h)||(i.track({type:2,doc:h}),U=!0,(l&&this.ya(h,l)>0||c&&this.ya(h,c)<0)&&(a=!0)):!f&&h?(i.track({type:0,doc:h}),U=!0):f&&!h&&(i.track({type:1,doc:f}),U=!0,(l||c)&&(a=!0)),U&&(h?(o=o.add(h),r=p?r.add(d):r.delete(d)):(o=o.delete(d),r=r.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),r=r.delete(d.key),i.track({type:1,doc:d})}return{wa:o,Da:i,ls:a,mutatedKeys:r}}va(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,s){const r=this.wa;this.wa=t.wa,this.mutatedKeys=t.mutatedKeys;const o=t.Da.X_();o.sort((d,u)=>function(h,m){const p=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return De()}};return p(h)-p(m)}(d.type,u.type)||this.ya(d.doc,u.doc)),this.Ca(i),s=s!=null&&s;const a=n&&!s?this.Fa():[],l=this.pa.size===0&&this.current&&!s?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new bg(this.query,t.wa,r,o,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new QD,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(t){return!this.fa.has(t)&&!!this.wa.has(t)&&!this.wa.get(t).hasLocalMutations}Ca(t){t&&(t.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=t.current)}Fa(){if(!this.current)return[];const t=this.pa;this.pa=Tt(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const n=[];return t.forEach(i=>{this.pa.has(i)||n.push(new cK(i))}),this.pa.forEach(i=>{t.has(i)||n.push(new lK(i))}),n}Oa(t){this.fa=t.gs,this.pa=Tt();const n=this.ba(t.documents);return this.applyChanges(n,!0)}Na(){return bg.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const VI="SyncEngine";class wIe{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class TIe{constructor(t){this.key=t,this.Ba=!1}}class IIe{constructor(t,n,i,s,r,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Ju(a=>LW(a),cE),this.qa=new Map,this.Qa=new Set,this.$a=new zn(Pe.comparator),this.Ka=new Map,this.Ua=new kI,this.Wa={},this.Ga=new Map,this.za=pg.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function SIe(e,t,n=!0){const i=gK(e);let s;const r=i.ka.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.Na()):s=await dK(i,t,n,!0),s}async function xIe(e,t){const n=gK(e);await dK(n,t,!0,!1)}async function dK(e,t,n,i){const s=await ZTe(e.localStore,ea(t)),r=s.targetId,o=e.sharedClientState.addLocalQueryTarget(r,n);let a;return i&&(a=await CIe(e,t,r,o==="current",s.resumeToken)),e.isPrimaryClient&&n&&sK(e.remoteStore,s),a}async function CIe(e,t,n,i,s){e.Ha=(u,f,h)=>async function(p,U,b,y){let v=U.view.ba(b);v.ls&&(v=await XD(p.localStore,U.query,!1).then(({documents:T})=>U.view.ba(T,v)));const _=y&&y.targetChanges.get(U.targetId),I=y&&y.targetMismatches.get(U.targetId)!=null,R=U.view.applyChanges(v,p.isPrimaryClient,_,I);return nP(p,U.targetId,R.Ma),R.snapshot}(e,u,f,h);const r=await XD(e.localStore,t,!0),o=new _Ie(t,r.gs),a=o.ba(r.documents),l=tU.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",s),c=o.applyChanges(a,e.isPrimaryClient,l);nP(e,n,c.Ma);const d=new wIe(t,n,o);return e.ka.set(t,d),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function AIe(e,t,n){const i=at(e),s=i.ka.get(t),r=i.qa.get(s.targetId);if(r.length>1)return i.qa.set(s.targetId,r.filter(o=>!cE(o,t))),void i.ka.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await c9(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),n&&NI(i.remoteStore,s.targetId),f9(i,s.targetId)}).catch(rE)):(f9(i,s.targetId),await c9(i.localStore,s.targetId,!0))}async function MIe(e,t){const n=at(e),i=n.ka.get(t),s=n.qa.get(i.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),NI(n.remoteStore,i.targetId))}async function uK(e,t){const n=at(e);try{const i=await WTe(n.localStore,t);t.targetChanges.forEach((s,r)=>{const o=n.Ka.get(r);o&&(jt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Ba=!0:s.modifiedDocuments.size>0?jt(o.Ba):s.removedDocuments.size>0&&(jt(o.Ba),o.Ba=!1))}),await hK(n,i,t)}catch(i){await rE(i)}}function tP(e,t,n){const i=at(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const s=[];i.ka.forEach((r,o)=>{const a=o.view.sa(t);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=at(o);l.onlineState=a;let c=!1;l.queries.forEach((d,u)=>{for(const f of u.ta)f.sa(a)&&(c=!0)}),c&&HI(l)}(i.eventManager,t),s.length&&i.La.p_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function kIe(e,t,n){const i=at(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.Ka.get(t),r=s&&s.key;if(r){let o=new zn(Pe.comparator);o=o.insert(r,bi.newNoDocument(r,Be.min()));const a=Tt().add(r),l=new hE(Be.min(),new Map,new zn(gt),o,a);await uK(i,l),i.$a=i.$a.remove(r),i.Ka.delete(t),$I(i)}else await c9(i.localStore,t,!1).then(()=>f9(i,t,n)).catch(rE)}function f9(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.qa.get(t))e.ka.delete(i),n&&e.La.Ja(i,n);e.qa.delete(t),e.isPrimaryClient&&e.Ua.br(t).forEach(i=>{e.Ua.containsKey(i)||fK(e,i)})}function fK(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);n!==null&&(NI(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ka.delete(n),$I(e))}function nP(e,t,n){for(const i of n)i instanceof lK?(e.Ua.addReference(i.key,t),RIe(e,i)):i instanceof cK?(Ee(VI,"Document no longer in limbo: "+i.key),e.Ua.removeReference(i.key,t),e.Ua.containsKey(i.key)||fK(e,i.key)):De()}function RIe(e,t){const n=t.key,i=n.path.canonicalString();e.$a.get(n)||e.Qa.has(i)||(Ee(VI,"New document in limbo: "+n),e.Qa.add(i),$I(e))}function $I(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new Pe(fn.fromString(t)),i=e.za.next();e.Ka.set(i,new TIe(n)),e.$a=e.$a.insert(n,i),sK(e.remoteStore,new gc(ea(SI(n.path)),i,"TargetPurposeLimboResolution",oE.ae))}}async function hK(e,t,n){const i=at(e),s=[],r=[],o=[];i.ka.isEmpty()||(i.ka.forEach((a,l)=>{o.push(i.Ha(l,t,n).then(c=>{var d;if((c||n)&&i.isPrimaryClient){const u=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;i.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=LI.Yi(l.targetId,c);r.push(u)}}))}),await Promise.all(o),i.La.p_(s),await async function(l,c){const d=at(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>ie.forEach(c,f=>ie.forEach(f.Hi,h=>d.persistence.referenceDelegate.addReference(u,f.targetId,h)).next(()=>ie.forEach(f.Ji,h=>d.persistence.referenceDelegate.removeReference(u,f.targetId,h)))))}catch(u){if(!$g(u))throw u;Ee(DI,"Failed to update sequence numbers: "+u)}for(const u of c){const f=u.targetId;if(!u.fromCache){const h=d.Ts.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.Ts=d.Ts.insert(f,p)}}}(i.localStore,r))}async function LIe(e,t){const n=at(e);if(!n.currentUser.isEqual(t)){Ee(VI,"User change. New user:",t.toKey());const i=await nK(n.localStore,t);n.currentUser=t,function(r,o){r.Ga.forEach(a=>{a.forEach(l=>{l.reject(new Ae(ae.CANCELLED,o))})}),r.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await hK(n,i.Rs)}}function DIe(e,t){const n=at(e),i=n.Ka.get(t);if(i&&i.Ba)return Tt().add(i.key);{let s=Tt();const r=n.qa.get(t);if(!r)return s;for(const o of r){const a=n.ka.get(o);s=s.unionWith(a.view.Sa)}return s}}function gK(e){const t=at(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=uK.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=DIe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=kIe.bind(null,t),t.La.p_=yIe.bind(null,t.eventManager),t.La.Ja=EIe.bind(null,t.eventManager),t}class v5{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=gE(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),await this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)}tu(t,n){return null}nu(t,n){return null}eu(t){return YTe(this.persistence,new GTe,t.initialUser,this.serializer)}Xa(t){return new tK(RI.ri,this.serializer)}Za(t){return new QTe}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}v5.provider={build:()=>new v5};class PIe extends v5{constructor(t){super(),this.cacheSizeBytes=t}tu(t,n){jt(this.persistence.referenceDelegate instanceof E5);const i=this.persistence.referenceDelegate.garbageCollector;return new ATe(i,t.asyncQueue,n)}Xa(t){const n=this.cacheSizeBytes!==void 0?Cs.withCacheSize(this.cacheSizeBytes):Cs.DEFAULT;return new tK(i=>E5.ri(i,n),this.serializer)}}class h9{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>tP(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=LIe.bind(null,this.syncEngine),await gIe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new pIe}()}createDatastore(t){const n=gE(t.databaseInfo.databaseId),i=function(r){return new iIe(r)}(t.databaseInfo);return function(r,o,a,l){return new aIe(r,o,a,l)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,s,r,o,a){return new cIe(i,s,r,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>tP(this.syncEngine,n,0),function(){return WD.D()?new WD:new JTe}())}createSyncEngine(t,n){return function(s,r,o,a,l,c,d){const u=new IIe(s,r,o,a,l,c);return d&&(u.ja=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(s){const r=at(s);Ee(Ug,"RemoteStore shutting down."),r.W_.add(5),await nU(r),r.z_.shutdown(),r.j_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}h9.provider={build:()=>new h9};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NIe{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.iu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.iu(this.observer.error,t):Tl("Uncaught Error in snapshot listener:",t.toString()))}su(){this.muted=!0}iu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OIe{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ae(ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,r){const o=at(s),a={documents:r.map(u=>y5(o.serializer,u))},l=await o.Co("BatchGetDocuments",o.serializer.databaseId,fn.emptyPath(),a,r.length),c=new Map;l.forEach(u=>{const f=fTe(o.serializer,u);c.set(f.key.toString(),f)});const d=[];return r.forEach(u=>{const f=c.get(u.toString());jt(!!f),d.push(f)}),d}(this.datastore,t);return n.forEach(i=>this.recordVersion(i)),n}set(t,n){this.write(n.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,n){try{this.write(n.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new CI(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,i)=>{const s=Pe.fromPath(i);this.mutations.push(new $W(s,this.precondition(s)))}),await async function(i,s){const r=at(i),o={writes:s.map(a=>gTe(r.serializer,a))};await r.So("Commit",r.serializer.databaseId,fn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let n;if(t.isFoundDocument())n=t.version;else{if(!t.isNoDocument())throw De();n=Be.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!n.isEqual(i))throw new Ae(ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),n)}precondition(t){const n=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&n?n.isEqual(Be.min())?Ir.exists(!1):Ir.updateTime(n):Ir.none()}preconditionForUpdate(t){const n=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&n){if(n.isEqual(Be.min()))throw new Ae(ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ir.updateTime(n)}return Ir.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FIe{constructor(t,n,i,s,r){this.asyncQueue=t,this.datastore=n,this.options=i,this.updateFunction=s,this.deferred=r,this.Tu=i.maxAttempts,this.a_=new PI(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(async()=>{const t=new OIe(this.datastore),n=this.du(t);n&&n.then(i=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(i)}).catch(s=>{this.Au(s)}))}).catch(i=>{this.Au(i)})})}du(t){try{const n=this.updateFunction(t);return!Jp(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Au(t){this.Tu>0&&this.Ru(t)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(t)}Ru(t){if(t.name==="FirebaseError"){const n=t.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!nTe(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="FirestoreClient";class BIe{constructor(t,n,i,s,r){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=s,this.user=Wi.UNAUTHENTICATED,this.clientId=UW.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,async o=>{Ee(sd,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(Ee(sd,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Pc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=aK(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function r7(e,t){e.asyncQueue.verifyOperationInProgress(),Ee(sd,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async s=>{i.isEqual(s)||(await nK(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function iP(e,t){e.asyncQueue.verifyOperationInProgress();const n=await zIe(e);Ee(sd,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>qD(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>qD(t.remoteStore,s)),e._onlineComponents=t}async function zIe(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ee(sd,"Using user provided OfflineComponentProvider");try{await r7(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(s){return s.name==="FirebaseError"?s.code===ae.FAILED_PRECONDITION||s.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;fg("Error using user provided cache. Falling back to memory cache: "+n),await r7(e,new v5)}}else Ee(sd,"Using default OfflineComponentProvider"),await r7(e,new PIe(void 0));return e._offlineComponents}async function mK(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ee(sd,"Using user provided OnlineComponentProvider"),await iP(e,e._uninitializedComponentsProvider._online)):(Ee(sd,"Using default OnlineComponentProvider"),await iP(e,new h9))),e._onlineComponents}function HIe(e){return mK(e).then(t=>t.datastore)}async function VIe(e){const t=await mK(e),n=t.eventManager;return n.onListen=SIe.bind(null,t.syncEngine),n.onUnlisten=AIe.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=xIe.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=MIe.bind(null,t.syncEngine),n}function $Ie(e,t,n={}){const i=new Pc;return e.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const d=new NIe({next:f=>{d.su(),o.enqueueAndForget(()=>bIe(r,u));const h=f.docs.has(a);!h&&f.fromCache?c.reject(new Ae(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&l&&l.source==="server"?c.reject(new Ae(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),u=new vIe(SI(a.path),d,{includeMetadataChanges:!0,Ta:!0});return UIe(r,u)}(await VIe(e),e.asyncQueue,t,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pK(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GIe(e,t,n){if(!n)throw new Ae(ae.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function XIe(e,t,n,i){if(t===!0&&i===!0)throw new Ae(ae.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function rP(e){if(!Pe.isDocumentKey(e))throw new Ae(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function GI(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":De()}function _5(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ae(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=GI(e);throw new Ae(ae.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UK="firestore.googleapis.com",oP=!0;class aP{constructor(t){var n,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Ae(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=UK,this.ssl=oP}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:oP;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=eK;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<xTe)throw new Ae(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}XIe("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pK((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ae(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ae(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ae(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class XI{constructor(t,n,i,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aP({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ae(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ae(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aP(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new swe;switch(i.type){case"firstParty":return new lwe(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ae(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=sP.get(n);i&&(Ee("ComponentProvider","Removing Datastore"),sP.delete(n),i.terminate())}(this),Promise.resolve()}}function jIe(e,t,n,i={}){var s;const r=(e=_5(e,XI))._getSettings(),o=`${t}:${n}`;if(r.host!==UK&&r.host!==o&&fg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=Wi.MOCK_USER;else{a=QY(i.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Ae(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Wi(c)}e._authCredentials=new rwe(new pW(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new jI(this.firestore,t,this._query)}}class Fr{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rp(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Fr(this.firestore,t,this._key)}}class rp extends jI{constructor(t,n,i){super(t,n,SI(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Fr(this.firestore,null,new Pe(t))}withConverter(t){return new rp(this.firestore,t,this._path)}}function bK(e,t,...n){if(e=wo(e),arguments.length===1&&(t=UW.newId()),GIe("doc","path",t),e instanceof XI){const i=fn.fromString(t,...n);return rP(i),new Fr(e,null,new Pe(i))}{if(!(e instanceof Fr||e instanceof rp))throw new Ae(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(fn.fromString(t,...n));return rP(i),new Fr(e.firestore,e instanceof rp?e.converter:null,new Pe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP="AsyncQueue";class cP{constructor(t=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new PI(this,"async_queue_retry"),this.Su=()=>{const i=s7();i&&Ee(lP,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=t;const n=s7();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Du(),this.vu(t)}enterRestrictedMode(t){if(!this.mu){this.mu=!0,this.yu=t||!1;const n=s7();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(t){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Pc;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Vu.push(t),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(t){if(!$g(t))throw t;Ee(lP,"Operation failed with retryable error: "+t)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(t){const n=this.bu.then(()=>(this.pu=!0,t().catch(i=>{this.gu=i,this.pu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw Tl("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.pu=!1,i))));return this.bu=n,n}enqueueAfterDelay(t,n,i){this.Du(),this.wu.indexOf(t)>-1&&(n=0);const s=zI.createAndSchedule(this,t,n,i,r=>this.Fu(r));return this.fu.push(s),s}Du(){this.gu&&De()}verifyOperationInProgress(){}async Mu(){let t;do t=this.bu,await t;while(t!==this.bu)}xu(t){for(const n of this.fu)if(n.timerId===t)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Mu()})}Nu(t){this.wu.push(t)}Fu(t){const n=this.fu.indexOf(t);this.fu.splice(n,1)}}class YI extends XI{constructor(t,n,i,s){super(t,n,i,s),this.type="firestore",this._queue=new cP,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new cP(t),this._firestoreClient=void 0,await t}}}function YIe(e,t){const n=typeof e=="object"?e:aW(),i=typeof e=="string"?e:f5,s=iW(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=ZY("firestore");r&&jIe(s,...r)}return s}function yK(e){if(e._terminated)throw new Ae(ae.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||WIe(e),e._firestoreClient}function WIe(e){var t,n,i;const s=e._freezeSettings(),r=function(a,l,c,d){return new wwe(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,pK(d.experimentalLongPollingOptions),d.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new BIe(e._authCredentials,e._appCheckCredentials,e._queue,r,e._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Il(Bi.fromBase64String(t))}catch(n){throw new Ae(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Il(Bi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new Ae(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qi(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new Ae(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Ae(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return gt(this._lat,t._lat)||gt(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KIe=/^__.*__$/;class ZIe{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new ef(t,this.data,this.fieldMask,n,this.fieldTransforms):new eU(t,this.data,n,this.fieldTransforms)}}class EK{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new ef(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function vK(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw De()}}class qI{constructor(t,n,i,s,r,o){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Bu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(t){return new qI(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.$u(t),s}Ku(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.Bu(),s}Uu(t){return this.ku({path:void 0,Qu:!0})}Wu(t){return w5(t,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let t=0;t<this.path.length;t++)this.$u(this.path.get(t))}$u(t){if(t.length===0)throw this.Wu("Document fields must not be empty");if(vK(this.Lu)&&KIe.test(t))throw this.Wu('Document fields cannot begin and end with "__"')}}class qIe{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||gE(t)}ju(t,n,i,s=!1){return new qI({Lu:t,methodName:n,zu:i,path:qi.emptyPath(),Qu:!1,Gu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function QIe(e){const t=e._freezeSettings(),n=gE(e._databaseId);return new qIe(e._databaseId,!!t.ignoreUndefinedProperties,n)}function JIe(e,t,n,i,s,r={}){const o=e.ju(r.merge||r.mergeFields?2:0,t,n,s);QI("Data must be an object, but it was:",o,i);const a=_K(i,o);let l,c;if(r.merge)l=new Mr(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const d=[];for(const u of r.mergeFields){const f=g9(t,u,n);if(!o.contains(f))throw new Ae(ae.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);TK(d,f)||d.push(f)}l=new Mr(d),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new ZIe(new As(a),l,c)}class UE extends WI{_toFieldTransform(t){if(t.Lu!==2)throw t.Lu===1?t.Wu(`${this._methodName}() can only appear at the top level of your update data`):t.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof UE}}function eSe(e,t,n,i){const s=e.ju(1,t,n);QI("Data must be an object, but it was:",s,i);const r=[],o=As.empty();Qu(i,(l,c)=>{const d=JI(t,l,n);c=wo(c);const u=s.Ku(d);if(c instanceof UE)r.push(d);else{const f=bE(c,u);f!=null&&(r.push(d),o.set(d,f))}});const a=new Mr(r);return new EK(o,a,s.fieldTransforms)}function tSe(e,t,n,i,s,r){const o=e.ju(1,t,n),a=[g9(t,i,n)],l=[s];if(r.length%2!=0)throw new Ae(ae.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(g9(t,r[f])),l.push(r[f+1]);const c=[],d=As.empty();for(let f=a.length-1;f>=0;--f)if(!TK(c,a[f])){const h=a[f];let m=l[f];m=wo(m);const p=o.Ku(h);if(m instanceof UE)c.push(h);else{const U=bE(m,p);U!=null&&(c.push(h),d.set(h,U))}}const u=new Mr(c);return new EK(d,u,o.fieldTransforms)}function bE(e,t){if(wK(e=wo(e)))return QI("Unsupported field value:",t,e),_K(e,t);if(e instanceof WI)return function(i,s){if(!vK(s.Lu))throw s.Wu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Wu(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&t.Lu!==4)throw t.Wu("Nested arrays are not supported");return function(i,s){const r=[];let o=0;for(const a of i){let l=bE(a,s.Uu(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(e,t)}return function(i,s){if((i=wo(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Ywe(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=wi.fromDate(i);return{timestampValue:b5(s.serializer,r)}}if(i instanceof wi){const r=new wi(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:b5(s.serializer,r)}}if(i instanceof KI)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Il)return{bytesValue:YW(s.serializer,i._byteString)};if(i instanceof Fr){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:MI(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof ZI)return function(o,a){return{mapValue:{fields:{[IW]:{stringValue:SW},[h5]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return xI(a.serializer,c)})}}}}}}(i,s);throw s.Wu(`Unsupported field value: ${GI(i)}`)}(e,t)}function _K(e,t){const n={};return yW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qu(e,(i,s)=>{const r=bE(s,t.qu(i));r!=null&&(n[i]=r)}),{mapValue:{fields:n}}}function wK(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof wi||e instanceof KI||e instanceof Il||e instanceof Fr||e instanceof WI||e instanceof ZI)}function QI(e,t,n){if(!wK(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const i=GI(n);throw i==="an object"?t.Wu(e+" a custom object"):t.Wu(e+" "+i)}}function g9(e,t,n){if((t=wo(t))instanceof pE)return t._internalPath;if(typeof t=="string")return JI(e,t);throw w5("Field path arguments must be of type string or ",e,!1,void 0,n)}const nSe=new RegExp("[~\\*/\\[\\]]");function JI(e,t,n){if(t.search(nSe)>=0)throw w5(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new pE(...t.split("."))._internalPath}catch{throw w5(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function w5(e,t,n,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${s}`),l+=")"),new Ae(ae.INVALID_ARGUMENT,a+e+l)}function TK(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(t,n,i,s,r){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Fr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new iSe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(IK("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iSe extends T5{data(){return super.data()}}function IK(e,t){return typeof t=="string"?JI(e,t):t instanceof pE?t._internalPath:t._delegate._internalPath}class SK{convertValue(t,n="none"){switch(nd(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Nn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(td(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw De()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Qu(t,(s,r)=>{i[s]=this.convertValue(r,n)}),i}convertVectorValue(t){var n,i,s;const r=(s=(i=(n=t.fields)===null||n===void 0?void 0:n[h5].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(o=>Nn(o.doubleValue));return new ZI(r)}convertGeoPoint(t){return new KI(Nn(t.latitude),Nn(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=aE(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(ep(t));default:return null}}convertTimestamp(t){const n=ed(t);return new wi(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=fn.fromString(t);jt(JW(i));const s=new tp(i.get(1),i.get(3)),r=new Pe(i.popFirst(5));return s.isEqual(n)||Tl(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sSe(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class rSe extends SK{constructor(t){super(),this.firestore=t}convertBytes(t){return new Il(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Fr(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class eS extends T5{constructor(t,n,i,s,r,o){super(t,n,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new oSe(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(IK("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class oSe extends eS{data(t={}){return super.data(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aSe(e){e=_5(e,Fr);const t=_5(e.firestore,YI);return $Ie(yK(t),e._key).then(n=>lSe(t,e,n))}class CK extends SK{constructor(t){super(),this.firestore=t}convertBytes(t){return new Il(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Fr(this.firestore,null,n)}}function lSe(e,t,n){const i=n.docs.get(t._key),s=new CK(e);return new eS(e,s,t._key,i,new xK(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cSe={maxAttempts:5};function lm(e,t){if((e=wo(e)).firestore!==t)throw new Ae(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dSe{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=QIe(t)}get(t){const n=lm(t,this._firestore),i=new rSe(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return De();const r=s[0];if(r.isFoundDocument())return new T5(this._firestore,i,r.key,r,n.converter);if(r.isNoDocument())return new T5(this._firestore,i,n._key,null,n.converter);throw De()})}set(t,n,i){const s=lm(t,this._firestore),r=sSe(s.converter,n,i),o=JIe(this._dataReader,"Transaction.set",s._key,r,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(t,n,i,...s){const r=lm(t,this._firestore);let o;return o=typeof(n=wo(n))=="string"||n instanceof pE?tSe(this._dataReader,"Transaction.update",r._key,n,i,s):eSe(this._dataReader,"Transaction.update",r._key,n),this._transaction.update(r._key,o),this}delete(t){const n=lm(t,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uSe extends dSe{constructor(t,n){super(t,n),this._firestore=t}get(t){const n=lm(t,this._firestore),i=new CK(this._firestore);return super.get(t).then(s=>new eS(this._firestore,i,n._key,s._document,new xK(!1,!1),n.converter))}}function fSe(e,t,n){e=_5(e,YI);const i=Object.assign(Object.assign({},cSe),n);return function(r){if(r.maxAttempts<1)throw new Ae(ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,o,a){const l=new Pc;return r.asyncQueue.enqueueAndForget(async()=>{const c=await HIe(r);new FIe(r.asyncQueue,c,a,o,l).Iu()}),l.promise}(yK(e),s=>t(new uSe(e,s)),i)}(function(t,n=!0){(function(s){Vg=s})(rW),q0(new ug("firestore",(i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new YI(new owe(i.getProvider("auth-internal")),new cwe(o,i.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ae(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tp(c.options.projectId,d)}(o,s),o);return r=Object.assign({useFetchStreams:n},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),Lc(mD,pD,t),Lc(mD,pD,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AK="firebasestorage.googleapis.com",MK="storageBucket",hSe=2*60*1e3,gSe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei extends qu{constructor(t,n,i=0){super(o7(t),`Firebase Storage: ${n} (${o7(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ei.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return o7(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jn;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Jn||(Jn={}));function o7(e){return"storage/"+e}function tS(){const e="An unknown error occurred, please check the error payload for server response.";return new ei(Jn.UNKNOWN,e)}function mSe(e){return new ei(Jn.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function pSe(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ei(Jn.UNAUTHENTICATED,e)}function USe(){return new ei(Jn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function bSe(e){return new ei(Jn.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function ySe(){return new ei(Jn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ESe(){return new ei(Jn.CANCELED,"User canceled the upload/download.")}function vSe(e){return new ei(Jn.INVALID_URL,"Invalid URL '"+e+"'.")}function _Se(e){return new ei(Jn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function wSe(){return new ei(Jn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+MK+"' property when initializing the app?")}function TSe(){return new ei(Jn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ISe(e){return new ei(Jn.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function m9(e){return new ei(Jn.INVALID_ARGUMENT,e)}function kK(){return new ei(Jn.APP_DELETED,"The Firebase app was deleted.")}function SSe(e){return new ei(Jn.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function qm(e,t){return new ei(Jn.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function P1(e){throw new ei(Jn.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=tr.makeFromUrl(t,n)}catch{return new tr(t,"")}if(i.path==="")return i;throw _Se(t)}static makeFromUrl(t,n){let i=null;const s="([A-Za-z0-9.\\-_]+)";function r(_){_.path.charAt(_.path.length-1)==="/"&&(_.path_=_.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(_){_.path_=decodeURIComponent(_.path)}const d="v[A-Za-z0-9_]+",u=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",h=new RegExp(`^https?://${u}/${d}/b/${s}/o${f}`,"i"),m={bucket:1,path:3},p=n===AK?"(?:storage.googleapis.com|storage.cloud.google.com)":n,U="([^?#]*)",b=new RegExp(`^https?://${p}/${s}/${U}`,"i"),v=[{regex:a,indices:l,postModify:r},{regex:h,indices:m,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let _=0;_<v.length;_++){const I=v[_],R=I.regex.exec(t);if(R){const T=R[I.indices.bucket];let w=R[I.indices.path];w||(w=""),i=new tr(T,w),I.postModify(i);break}}if(i==null)throw vSe(t);return i}}class xSe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CSe(e,t,n){let i=1,s=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...U){c||(c=!0,t.apply(null,U))}function u(U){s=setTimeout(()=>{s=null,e(h,l())},U)}function f(){r&&clearTimeout(r)}function h(U,...b){if(c){f();return}if(U){f(),d.call(null,U,...b);return}if(l()||o){f(),d.call(null,U,...b);return}i<64&&(i*=2);let v;a===1?(a=2,v=0):v=(i+Math.random())*1e3,u(v)}let m=!1;function p(U){m||(m=!0,f(),!c&&(s!==null?(U||(a=2),clearTimeout(s),u(0)):U||(a=1)))}return u(0),r=setTimeout(()=>{o=!0,p(!0)},n),p}function ASe(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MSe(e){return e!==void 0}function kSe(e){return typeof e=="object"&&!Array.isArray(e)}function RK(e){return typeof e=="string"||e instanceof String}function dP(e){return nS()&&e instanceof Blob}function nS(){return typeof Blob<"u"}function uP(e,t,n,i){if(i<t)throw m9(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw m9(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RSe(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function LSe(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const s=t(i)+"="+t(e[i]);n=n+s+"&"}return n=n.slice(0,-1),n}var ou;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(ou||(ou={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DSe(e,t){const n=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,r=t.indexOf(e)!==-1;return n||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PSe{constructor(t,n,i,s,r,o,a,l,c,d,u,f=!0){this.url_=t,this.method_=n,this.headers_=i,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((h,m)=>{this.resolve_=h,this.reject_=m,this.start_()})}start_(){const t=(i,s)=>{if(s){i(!1,new T2(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===ou.NO_ERROR,l=r.getStatus();if(!a||DSe(l,this.additionalRetryCodes_)&&this.retry){const d=r.getErrorCode()===ou.ABORT;i(!1,new T2(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new T2(c,r))})},n=(i,s)=>{const r=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());MSe(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=tS();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?kK():ESe();o(l)}else{const l=ySe();o(l)}};this.canceled_?n(!1,new T2(!1,null,!0)):this.backoffId_=CSe(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&ASe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class T2{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function NSe(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function OSe(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function FSe(e,t){t&&(e["X-Firebase-GMPID"]=t)}function BSe(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function zSe(e,t,n,i,s,r,o=!0){const a=LSe(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return FSe(c,t),NSe(c,n),OSe(c,r),BSe(c,i),new PSe(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HSe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function VSe(...e){const t=HSe();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(nS())return new Blob(e);throw new ei(Jn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function $Se(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GSe(e){if(typeof atob>"u")throw ISe("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class a7{constructor(t,n){this.data=t,this.contentType=n||null}}function XSe(e,t){switch(e){case Yo.RAW:return new a7(LK(t));case Yo.BASE64:case Yo.BASE64URL:return new a7(DK(e,t));case Yo.DATA_URL:return new a7(YSe(t),WSe(t))}throw tS()}function LK(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const r=i,o=e.charCodeAt(++n);i=65536|(r&1023)<<10|o&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function jSe(e){let t;try{t=decodeURIComponent(e)}catch{throw qm(Yo.DATA_URL,"Malformed data URL.")}return LK(t)}function DK(e,t){switch(e){case Yo.BASE64:{const s=t.indexOf("-")!==-1,r=t.indexOf("_")!==-1;if(s||r)throw qm(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Yo.BASE64URL:{const s=t.indexOf("+")!==-1,r=t.indexOf("/")!==-1;if(s||r)throw qm(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=GSe(t)}catch(s){throw s.message.includes("polyfill")?s:qm(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}class PK{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw qm(Yo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=KSe(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function YSe(e){const t=new PK(e);return t.base64?DK(Yo.BASE64,t.rest):jSe(t.rest)}function WSe(e){return new PK(e).contentType}function KSe(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(t,n){let i=0,s="";dP(t)?(this.data_=t,i=t.size,s=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(t,n){if(dP(this.data_)){const i=this.data_,s=$Se(i,t,n);return s===null?null:new oc(s)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new oc(i,!0)}}static getBlob(...t){if(nS()){const n=t.map(i=>i instanceof oc?i.data_:i);return new oc(VSe.apply(null,n))}else{const n=t.map(o=>RK(o)?XSe(Yo.RAW,o).data:o.data_);let i=0;n.forEach(o=>{i+=o.byteLength});const s=new Uint8Array(i);let r=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[r++]=o[a]}),new oc(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZSe(e){let t;try{t=JSON.parse(e)}catch{return null}return kSe(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qSe(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function QSe(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function NK(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JSe(e,t){return t}class as{constructor(t,n,i,s){this.server=t,this.local=n||t,this.writable=!!i,this.xform=s||JSe}}let I2=null;function exe(e){return!RK(e)||e.length<2?e:NK(e)}function txe(){if(I2)return I2;const e=[];e.push(new as("bucket")),e.push(new as("generation")),e.push(new as("metageneration")),e.push(new as("name","fullPath",!0));function t(r,o){return exe(o)}const n=new as("name");n.xform=t,e.push(n);function i(r,o){return o!==void 0?Number(o):o}const s=new as("size");return s.xform=i,e.push(s),e.push(new as("timeCreated")),e.push(new as("updated")),e.push(new as("md5Hash",null,!0)),e.push(new as("cacheControl",null,!0)),e.push(new as("contentDisposition",null,!0)),e.push(new as("contentEncoding",null,!0)),e.push(new as("contentLanguage",null,!0)),e.push(new as("contentType",null,!0)),e.push(new as("metadata","customMetadata",!0)),I2=e,I2}function nxe(e,t){function n(){const i=e.bucket,s=e.fullPath,r=new tr(i,s);return t._makeStorageReference(r)}Object.defineProperty(e,"ref",{get:n})}function ixe(e,t,n){const i={};i.type="file";const s=n.length;for(let r=0;r<s;r++){const o=n[r];i[o.local]=o.xform(i,t[o.server])}return nxe(i,e),i}function sxe(e,t,n){const i=ZSe(t);return i===null?null:ixe(e,i,n)}function rxe(e,t){const n={},i=t.length;for(let s=0;s<i;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class oxe{constructor(t,n,i,s){this.url=t,this.method=n,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function axe(e){if(!e)throw tS()}function lxe(e,t){function n(i,s){const r=sxe(e,s,t);return axe(r!==null),r}return n}function cxe(e){function t(n,i){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=USe():s=pSe():n.getStatus()===402?s=mSe(e.bucket):n.getStatus()===403?s=bSe(e.path):s=i,s.status=n.getStatus(),s.serverResponse=i.serverResponse,s}return t}function dxe(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function uxe(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=dxe(null,t)),i}function fxe(e,t,n,i,s){const r=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let v="";for(let _=0;_<2;_++)v=v+Math.random().toString().slice(2);return v}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=uxe(t,i,s),d=rxe(c,n),u="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",h=oc.getBlob(u,i,f);if(h===null)throw TSe();const m={name:c.fullPath},p=RSe(r,e.host,e._protocol),U="POST",b=e.maxUploadRetryTime,y=new oxe(p,U,lxe(e,n),b);return y.urlParams=m,y.headers=o,y.body=h.uploadData(),y.errorHandler=cxe(t),y}class hxe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ou.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ou.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ou.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,s){if(this.sent_)throw P1("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),s!==void 0)for(const r in s)s.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,s[r].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw P1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw P1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw P1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw P1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class gxe extends hxe{initXhr(){this.xhr_.responseType="text"}}function mxe(){return new gxe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(t,n){this._service=t,n instanceof tr?this._location=n:this._location=tr.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new Pu(t,n)}get root(){const t=new tr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return NK(this._location.path)}get storage(){return this._service}get parent(){const t=qSe(this._location.path);if(t===null)return null;const n=new tr(this._location.bucket,t);return new Pu(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw SSe(t)}}function pxe(e,t,n){e._throwIfRoot("uploadBytes");const i=fxe(e.storage,e._location,txe(),new oc(t,!0),n);return e.storage.makeRequestWithTokens(i,mxe).then(s=>({metadata:s,ref:e}))}function Uxe(e,t){const n=QSe(e._location.path,t),i=new tr(e._location.bucket,n);return new Pu(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bxe(e){return/^[A-Za-z]+:\/\//.test(e)}function yxe(e,t){return new Pu(e,t)}function OK(e,t){if(e instanceof iS){const n=e;if(n._bucket==null)throw wSe();const i=new Pu(n,n._bucket);return t!=null?OK(i,t):i}else return t!==void 0?Uxe(e,t):e}function Exe(e,t){if(t&&bxe(t)){if(e instanceof iS)return yxe(e,t);throw m9("To use ref(service, url), the first argument must be a Storage instance.")}else return OK(e,t)}function fP(e,t){const n=t==null?void 0:t[MK];return n==null?null:tr.makeFromBucketSpec(n,e)}function vxe(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=i;s&&(e._overrideAuthToken=typeof s=="string"?s:QY(s,e.app.options.projectId))}class iS{constructor(t,n,i,s,r){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=s,this._firebaseVersion=r,this._bucket=null,this._host=AK,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hSe,this._maxUploadRetryTime=gSe,this._requests=new Set,s!=null?this._bucket=tr.makeFromBucketSpec(s,this._host):this._bucket=fP(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=tr.makeFromBucketSpec(this._url,t):this._bucket=fP(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){uP("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){uP("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(sW(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Pu(this,t)}_makeRequest(t,n,i,s,r=!0){if(this._deleted)return new xSe(kK());{const o=zSe(t,this._appId,i,s,n,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,s).getPromise()}}const hP="@firebase/storage",gP="0.13.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FK="storage";function BK(e,t,n){return e=wo(e),pxe(e,t,n)}function zK(e,t){return e=wo(e),Exe(e,t)}function _xe(e=aW(),t){e=wo(e);const i=iW(e,FK).getImmediate({identifier:t}),s=ZY("storage");return s&&wxe(i,...s),i}function wxe(e,t,n,i={}){vxe(e,t,n,i)}function Txe(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new iS(n,i,s,t,rW)}function Ixe(){q0(new ug(FK,Txe,"PUBLIC").setMultipleInstances(!0)),Lc(hP,gP,""),Lc(hP,gP,"esm2017")}Ixe();let I5;try{I5=JSON.parse('{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}')}catch{console.warn('Error JSON parsing firebase config. Supplied value: {"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}'),I5={}}let l7=null,c7=null,d7=null;const HK=()=>(l7||(l7=oW(I5)),l7),VK=()=>(c7||(c7=YIe(HK())),c7),Sxe=()=>(d7||(d7=_xe(HK())),d7),$K=async()=>Sxe(),xxe=async(e,t)=>{const n=JSON.stringify(t),i=new TextEncoder().encode(n),{encryptedBuffer:s,iv:r}=await Hy(e,i);return{ciphertext:s,iv:r}},p9=async(e,t)=>{const n=e.ciphertext.toUint8Array(),i=e.iv.toUint8Array(),s=await H0(i,n,t),r=new TextDecoder("utf-8").decode(new Uint8Array(s));return JSON.parse(r)},Pd=class Pd{};F(Pd,"cache",new WeakMap),F(Pd,"get",t=>Pd.cache.get(t)),F(Pd,"set",(t,n)=>{Pd.cache.set(t,sc(n))});let op=Pd;const GK=(e,t)=>{if(e.socket&&e.roomId&&e.roomKey){const n=sc(t);return op.get(e.socket)===n}return!0},sS=async({prefix:e,files:t})=>{const n=await $K(),i=[],s=[];return await Promise.all(t.map(async({id:r,buffer:o})=>{try{const a=zK(n,`${e}/${r}`);await BK(a,o,{cacheControl:`public, max-age=${_9e}`}),s.push(r)}catch{i.push(r)}})),{savedFiles:s,erroredFiles:i}},mP=async(e,t)=>{const n=sc(e),{ciphertext:i,iv:s}=await xxe(t,e);return{sceneVersion:n,ciphertext:Il.fromUint8Array(new Uint8Array(i)),iv:Il.fromUint8Array(s)}},Cxe=async(e,t,n)=>{const{roomId:i,roomKey:s,socket:r}=e;if(!i||!s||!r||GK(e,t))return null;const o=VK(),a=bK(o,"scenes",i),l=await fSe(o,async d=>{const u=await d.get(a);if(!u.exists()){const U=await mP(t,s);return d.set(a,U),U}const f=u.data(),h=mc(Mu(await p9(f,s),null)),m=mc(pI(t,h,n)),p=await mP(m,s);return d.update(a,p),p}),c=mc(Mu(await p9(l,s),null));return op.set(r,c),c},Axe=async(e,t,n)=>{const i=VK(),s=bK(i,"scenes",e),r=await aSe(s);if(!r.exists())return null;const o=r.data(),a=mc(Mu(await p9(o,t),null,{deleteInvisibleElements:!0}));return n&&op.set(n,a),a},XK=async(e,t,n)=>{const i=[],s=new Map;return await Promise.all([...new Set(n)].map(async r=>{try{const o=`https://firebasestorage.googleapis.com/v0/b/${I5.storageBucket}/o/${encodeURIComponent(e.replace(/^\//,""))}%2F${r}`,a=await fetch(`${o}?alt=media`);if(a.status<400){const l=await a.arrayBuffer(),{data:c,metadata:d}=await iX(new Uint8Array(l),{decryptionKey:t}),u=new TextDecoder().decode(c);i.push({mimeType:d.mimeType||ve.binary,id:r,dataURL:u,created:(d==null?void 0:d.created)||Date.now(),lastRetrieved:(d==null?void 0:d.created)||Date.now()})}else s.set(r,!0)}catch(o){s.set(r,!0),console.error(o)}})),{loadedFiles:i,erroredFiles:s}},jK=e=>e.isDeleted?e.updated>Date.now()-v9e:!nl(e),mc=e=>e.filter(t=>jK(t)),Mxe="https://json.excalidraw.com/api/v2/",kxe="https://json.excalidraw.com/api/v2/post/",Rxe=async()=>{const e=new Uint8Array(w9e);return window.crypto.getRandomValues(e),rB(e)},YK=/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/,pP=e=>{const t=new URL(e).hash;return YK.test(t)},Lxe=e=>{const n=new URL(e).hash.match(YK);return n&&n[2].length!==22?(window.alert(M("alerts.invalidEncryptionKey")),null):n?{roomId:n[1],roomKey:n[2]}:null},Dxe=async()=>{const e=await Rxe(),t=await CT();if(!t)throw new Error("Couldn't generate room key");return{roomId:e,roomKey:t}},Pxe=e=>`${window.location.origin}${window.location.pathname}#room=${e.roomId},${e.roomKey}`,Nxe=async({buffer:e,decryptionKey:t})=>{let n;try{const r=e.slice(0,ab),o=e.slice(ab,e.byteLength);n=await H0(new Uint8Array(r),o,t)}catch{const o=new Uint8Array(ab);n=await H0(o,e,t)}const i=new window.TextDecoder("utf-8").decode(new Uint8Array(n)),s=JSON.parse(i);return{elements:s.elements||null,appState:s.appState||null}},Oxe=async(e,t)=>{try{const n=await fetch(`${Mxe}${e}`);if(!n.ok)return window.alert(M("alerts.importBackendFailed")),{};const i=await n.arrayBuffer();try{const{data:s}=await iX(new Uint8Array(i),{decryptionKey:t}),r=JSON.parse(new TextDecoder().decode(s));return{elements:r.elements||null,appState:r.appState||null}}catch(s){return console.warn("error when decoding shareLink data using the new format:",s),Nxe({buffer:i,decryptionKey:t})}}catch(n){return window.alert(M("alerts.importBackendFailed")),console.error(n),{}}},UP=async(e,t,n)=>{let i;return e!=null&&t!=null?i=ku(await Oxe(e,t),n==null?void 0:n.appState,n==null?void 0:n.elements,{repairBindings:!0,refreshDimensions:!1,deleteInvisibleElements:!0}):i=ku(n||null,null,null,{repairBindings:!0,deleteInvisibleElements:!0}),{elements:i.elements,appState:i.appState,files:i.files}},Fxe=async(e,t,n)=>{const i=await CT("string"),s=await nX(new TextEncoder().encode(zg(e,t,n,"database")),{encryptionKey:i});try{const r=new Map;for(const c of e)On(c)&&n[c.fileId]&&r.set(c.fileId,n[c.fileId]);const o=await bI({files:r,encryptionKey:i,maxBytes:UI}),l=await(await fetch(kxe,{method:"POST",body:s.buffer})).json();if(l.id){const c=new URL(window.location.href);c.hash=`json=${l.id},${i}`;const d=c.toString();return await sS({prefix:`/files/shareLinks/${l.id}`,files:o}),{url:d,errorMessage:null}}else if(l.error_class==="RequestTooLargeError")return{url:null,errorMessage:M("alerts.couldNotCreateShareableLinkTooBig")};return{url:null,errorMessage:M("alerts.couldNotCreateShareableLink")}}catch(r){return console.error(r),{url:null,errorMessage:M("alerts.couldNotCreateShareableLink")}}};function Bxe(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var i=function(){return indexedDB.databases().finally(n)};t=setInterval(i,100),i()}).finally(function(){return clearInterval(t)})}function tf(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function rS(e,t){const n=Bxe().then(()=>{const i=indexedDB.open(e);return i.onupgradeneeded=()=>i.result.createObjectStore(t),tf(i)});return(i,s)=>n.then(r=>s(r.transaction(t,i).objectStore(t)))}let u7;function Xg(){return u7||(u7=rS("keyval-store","keyval")),u7}function zxe(e,t=Xg()){return t("readonly",n=>tf(n.get(e)))}function WK(e,t,n=Xg()){return n("readwrite",i=>(i.put(t,e),tf(i.transaction)))}function Hxe(e,t=Xg()){return t("readwrite",n=>(e.forEach(i=>n.put(i[1],i[0])),tf(n.transaction)))}function Vxe(e,t=Xg()){return t("readonly",n=>Promise.all(e.map(i=>tf(n.get(i)))))}function $xe(e,t=Xg()){return t("readwrite",n=>(n.delete(e),tf(n.transaction)))}function Gxe(e,t){return e("readonly",n=>(n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},tf(n.transaction)))}function Xxe(e=Xg()){const t=[];return Gxe(e,n=>t.push([n.key,n.value])).then(()=>t)}class jxe{constructor(){F(this,"locks",new Map);F(this,"lock",t=>{this.locks.set(t,!0)});F(this,"unlock",t=>(this.locks.delete(t),!this.isLocked()))}isLocked(t){return t?this.locks.has(t):!!this.locks.size}}const S5={[An.VERSION_DATA_STATE]:-1,[An.VERSION_FILES]:-1},bP=e=>JSON.parse(localStorage.getItem(e)||"-1")>S5[e],KK=e=>{const t=Date.now();try{localStorage.setItem(e,JSON.stringify(t)),S5[e]=t}catch(n){console.error("error while updating browser state verison",n)}},Yxe=()=>{try{for(const e of Object.keys(S5))localStorage.setItem(e,JSON.stringify(-1)),S5[e]=-1}catch(e){console.error("error while resetting browser state verison",e)}},Qm=rS("files-db","files-store"),yb=Wt(!1);class Wxe extends YY{constructor(){super(...arguments);F(this,"clearObsoleteFiles",async n=>{await Xxe(Qm).then(i=>{for(const[s,r]of i)(!r.lastRetrieved||Date.now()-r.lastRetrieved>24*3600*1e3)&&!n.currentFileIds.includes(s)&&$xe(s,Qm)})})}}const Kxe=(e,t)=>{var i;const n=to.get(yb);try{const s=rG(t);((i=s.openSidebar)==null?void 0:i.name)===Rr.name&&s.openSidebar.tab===Jd&&(s.openSidebar=null),localStorage.setItem(An.LOCAL_STORAGE_ELEMENTS,JSON.stringify(Yt(e))),localStorage.setItem(An.LOCAL_STORAGE_APP_STATE,JSON.stringify(s)),KK(An.VERSION_DATA_STATE),n&&to.set(yb,!1)}catch(s){console.error(s),Zxe(s)&&!n&&to.set(yb,!0)}},Zxe=e=>e instanceof DOMException&&e.name==="QuotaExceededError",Si=class Si{};F(Si,"_save",ul(async(t,n,i,s)=>{Kxe(t,n),await Si.fileStorage.saveFiles({elements:t,files:i}),s()},m9e)),F(Si,"save",(t,n,i,s)=>{Si.isSavePaused()||Si._save(t,n,i,s)}),F(Si,"flushSave",()=>{Si._save.flush()}),F(Si,"locker",new jxe),F(Si,"pauseSave",t=>{Si.locker.lock(t)}),F(Si,"resumeSave",t=>{Si.locker.unlock(t)}),F(Si,"isSavePaused",()=>document.hidden||Si.locker.isLocked()),F(Si,"fileStorage",new Wxe({getFiles(t){return Vxe(t,Qm).then(async n=>{const i=[],s=new Map,r=[];n.forEach((o,a)=>{const l=t[a];if(o){const c={...o,lastRetrieved:Date.now()};r.push([l,c]),i.push(c)}else s.set(l,!0)});try{Hxe(r,Qm)}catch(o){console.warn(o)}return{loadedFiles:i,erroredFiles:s}})},async saveFiles({addedFiles:t}){const n=new Map,i=new Map;return KK(An.VERSION_FILES),await Promise.all([...t].map(async([s,r])=>{try{await WK(s,r,Qm),n.set(s,r)}catch(o){console.error(o),i.set(s,r)}})),{savedFiles:n,erroredFiles:i}}}));let Mi=Si;const Zr=class Zr{static async load(){return await zxe(Zr.key,Zr.store)||null}static save(t){return WK(Zr.key,t,Zr.store)}};F(Zr,"idb_name",An.IDB_LIBRARY),F(Zr,"key","libraryData"),F(Zr,"store",rS(`${Zr.idb_name}-db`,`${Zr.idb_name}-store`));let x5=Zr;class qxe{static load(){const t=localStorage.getItem(An.__LEGACY_LOCAL_STORAGE_LIBRARY);if(t!=null){const n=JSON.parse(t);if(n)return{libraryItems:n}}return null}static clear(){localStorage.removeItem(An.__LEGACY_LOCAL_STORAGE_LIBRARY)}}const U9=Wt({message:null,nonce:0}),ZK=({collabError:e})=>{const[t,n]=L.useState(!1),i=L.useRef(0);return L.useEffect(()=>(n(!0),i.current=window.setTimeout(()=>{n(!1)},1e3),()=>{window.clearTimeout(i.current)}),[e.message,e.nonce]),e.message?g(vl,{label:e.message,long:!0,children:g("div",{className:le("collab-errors-button",{"collab-errors-button-shake":t}),children:Rue})}):null};ZK.displayName="CollabError";class Qxe{constructor(t){F(this,"collab");F(this,"socket",null);F(this,"socketInitialized",!1);F(this,"roomId",null);F(this,"roomKey",null);F(this,"broadcastedElementVersions",new Map);F(this,"queueFileUpload",jo(async()=>{try{await this.collab.fileManager.saveFiles({elements:this.collab.excalidrawAPI.getSceneElementsIncludingDeleted(),files:this.collab.excalidrawAPI.getFiles()})}catch(i){i.name!=="AbortError"&&this.collab.excalidrawAPI.updateScene({appState:{errorMessage:i.message}})}let t=!1;const n=this.collab.excalidrawAPI.getSceneElementsIncludingDeleted().map(i=>this.collab.fileManager.shouldUpdateImageElementStatus(i)?(t=!0,Te(i,{status:"saved"})):i);t&&this.collab.excalidrawAPI.updateScene({elements:n,captureUpdate:q.NEVER})},U9e));F(this,"broadcastScene",async(t,n,i)=>{if(t===us.INIT&&!i)throw new Error("syncAll must be true when sending SCENE.INIT");const s=n.reduce((o,a)=>((i||!this.broadcastedElementVersions.has(a.id)||a.version>this.broadcastedElementVersions.get(a.id))&&jK(a)&&o.push(a),o),[]),r={type:t,payload:{elements:s}};for(const o of s)this.broadcastedElementVersions.set(o.id,o.version);this.queueFileUpload(),await this._broadcastSocketData(r)});F(this,"broadcastIdleChange",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:us.IDLE_STATUS,payload:{socketId:this.socket.id,userState:t,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});F(this,"broadcastMouseLocation",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:us.MOUSE_LOCATION,payload:{socketId:this.socket.id,pointer:t.pointer,button:t.button||"up",selectedElementIds:this.collab.excalidrawAPI.getAppState().selectedElementIds,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});F(this,"broadcastVisibleSceneBounds",(t,n)=>{var i;if((i=this.socket)!=null&&i.id){const s={type:us.USER_VISIBLE_SCENE_BOUNDS,payload:{socketId:this.socket.id,username:this.collab.state.username,sceneBounds:t.sceneBounds}};return this._broadcastSocketData(s,!0,n)}});F(this,"broadcastUserFollowed",t=>{var n;(n=this.socket)!=null&&n.id&&this.socket.emit(gb.USER_FOLLOW_CHANGE,t)});this.collab=t}open(t,n,i){return this.socket=t,this.roomId=n,this.roomKey=i,this.socket.on("init-room",()=>{this.socket&&(this.socket.emit("join-room",this.roomId),it("share","room joined"))}),this.socket.on("new-user",async s=>{this.broadcastScene(us.INIT,this.collab.getSceneElementsIncludingDeleted(),!0)}),this.socket.on("room-user-change",s=>{this.collab.setCollaborators(s)}),t}close(){this.socket&&(this.queueFileUpload.flush(),this.socket.close(),this.socket=null,this.roomId=null,this.roomKey=null,this.socketInitialized=!1,this.broadcastedElementVersions=new Map)}isOpen(){return!!(this.socketInitialized&&this.socket&&this.roomId&&this.roomKey)}async _broadcastSocketData(t,n=!1,i){var s;if(this.isOpen()){const r=JSON.stringify(t),o=new TextEncoder().encode(r),{encryptedBuffer:a,iv:l}=await Hy(this.roomKey,o);(s=this.socket)==null||s.emit(n?gb.SERVER_VOLATILE:gb.SERVER,i??this.roomId,a,l)}}}var Jxe={};const qK=Wt(null),b9=Wt(!1),QK=Wt(!1),JK=Wt(null);class eCe extends L.PureComponent{constructor(n){super(n);F(this,"portal");F(this,"fileManager");F(this,"excalidrawAPI");F(this,"activeIntervalId");F(this,"idleTimeoutId");F(this,"socketInitializationTimer");F(this,"lastBroadcastedOrReceivedSceneVersion",-1);F(this,"collaborators",new Map);F(this,"onUmmount",null);F(this,"onOfflineStatusToggle",()=>{to.set(QK,!window.navigator.onLine)});F(this,"isCollaborating",()=>to.get(b9));F(this,"setIsCollaborating",n=>{to.set(b9,n)});F(this,"onUnload",()=>{this.destroySocketClient({isUnload:!0})});F(this,"beforeUnload",ln(n=>{const i=mc(this.getSceneElementsIncludingDeleted());this.isCollaborating()&&(this.fileManager.shouldPreventUnload(i)||!GK(this.portal,i))&&(this.saveCollabRoomToFirebase(i),Jxe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?M_(n):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))}));F(this,"saveCollabRoomToFirebase",async n=>{try{const i=await Cxe(this.portal,n,this.excalidrawAPI.getAppState());this.resetErrorIndicator(),this.isCollaborating()&&i&&this.handleRemoteSceneUpdate(this._reconcileElements(i))}catch(i){const s=/is longer than.*?bytes/.test(i.message)?M("errors.collabSaveFailed_sizeExceeded"):M("errors.collabSaveFailed");(!this.state.dialogNotifiedErrors[s]||!this.isCollaborating())&&(this.setErrorDialog(s),this.setState({dialogNotifiedErrors:{...this.state.dialogNotifiedErrors,[s]:!0}})),this.isCollaborating()&&this.setErrorIndicator(s),console.error(i)}});F(this,"stopCollaboration",(n=!0)=>{if(this.queueBroadcastAllElements.cancel(),this.queueSaveToFirebase.cancel(),this.loadImageFiles.cancel(),this.resetErrorIndicator(!0),this.saveCollabRoomToFirebase(mc(this.excalidrawAPI.getSceneElementsIncludingDeleted())),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),!n)Mi.fileStorage.reset(),this.destroySocketClient();else if(window.confirm(M("alerts.collabStopOverridePrompt"))){Yxe(),window.history.pushState({},Tc,window.location.origin),this.destroySocketClient(),Mi.fileStorage.reset();const i=this.excalidrawAPI.getSceneElementsIncludingDeleted().map(s=>wt(s)&&s.status==="saved"?Te(s,{status:"pending"}):s);this.excalidrawAPI.updateScene({elements:i,captureUpdate:q.NEVER})}});F(this,"destroySocketClient",n=>{this.lastBroadcastedOrReceivedSceneVersion=-1,this.portal.close(),this.fileManager.reset(),n!=null&&n.isUnload||(this.setIsCollaborating(!1),this.setActiveRoomLink(null),this.collaborators=new Map,this.excalidrawAPI.updateScene({collaborators:this.collaborators}),Mi.resumeSave("collaboration"))});F(this,"fetchImageFilesFromFirebase",async n=>{const i=n.elements.filter(s=>On(s)&&!this.fileManager.isFileTracked(s.fileId)&&!s.isDeleted&&(n.forceFetchFiles?s.status!=="pending"||Date.now()-s.updated>1e4:s.status==="saved")).map(s=>s.fileId);return await this.fileManager.getFiles(i)});F(this,"decryptPayload",async(n,i,s)=>{try{const r=await H0(n,i,s),o=new TextDecoder("utf-8").decode(new Uint8Array(r));return JSON.parse(o)}catch(r){return window.alert(M("alerts.decryptFailed")),console.error(r),{type:us.INVALID_RESPONSE}}});F(this,"fallbackInitializationHandler",null);F(this,"startCollaboration",async n=>{if(this.state.username||pe(()=>import("./random-username.esm-__vdrxyo.js"),__vite__mapDeps([])).then(({getRandomUsername:l})=>{const c=l();this.setUsername(c)}),this.portal.socket)return null;let i,s;n?{roomId:i,roomKey:s}=n:({roomId:i,roomKey:s}=await Dxe(),window.history.pushState({},Tc,Pxe({roomId:i,roomKey:s})));const r=K5();this.setIsCollaborating(!0),Mi.pauseSave("collaboration");const{default:o}=await pe(()=>import("./index-ChGp7972.js"),__vite__mapDeps([])),a=()=>{this.initializeRoom({roomLinkData:n,fetchScene:!0}).then(l=>{r.resolve(l)})};this.fallbackInitializationHandler=a;try{this.portal.socket=this.portal.open(o("https://oss-collab.excalidraw.com",{transports:["websocket","polling"]}),i,s),this.portal.socket.once("connect_error",a)}catch(l){return console.error(l),this.setErrorDialog(l.message),null}if(n)this.excalidrawAPI.resetScene();else{const l=this.excalidrawAPI.getSceneElements().map(c=>wt(c)&&c.status==="saved"?Te(c,{status:"pending"}):c);this.excalidrawAPI.updateScene({elements:l,captureUpdate:q.NEVER}),this.saveCollabRoomToFirebase(mc(l))}return this.socketInitializationTimer=window.setTimeout(a,p9e),this.portal.socket.on("client-broadcast",async(l,c)=>{var u;if(!this.portal.roomKey)return;const d=await this.decryptPayload(c,l,this.portal.roomKey);switch(d.type){case us.INVALID_RESPONSE:return;case us.INIT:{if(!this.portal.socketInitialized){this.initializeRoom({fetchScene:!1});const f=d.payload.elements,h=this._reconcileElements(f);this.handleRemoteSceneUpdate(h),r.resolve({elements:h,scrollToContent:!0})}break}case us.UPDATE:this.handleRemoteSceneUpdate(this._reconcileElements(d.payload.elements));break;case us.MOUSE_LOCATION:{const{pointer:f,button:h,username:m,selectedElementIds:p}=d.payload,U=d.payload.socketId||d.payload.socketID;this.updateCollaborator(U,{pointer:f,button:h,selectedElementIds:p,username:m});break}case us.USER_VISIBLE_SCENE_BOUNDS:{const{sceneBounds:f,socketId:h}=d.payload,m=this.excalidrawAPI.getAppState();if(((u=m.userToFollow)==null?void 0:u.socketId)!==h){console.warn(`receiving remote client's (from ${h}) viewport bounds even though we're not subscribed to it!`);return}if(m.userToFollow&&m.followedBy.has(m.userToFollow.socketId))return;this.excalidrawAPI.updateScene({appState:uG({appState:m,bounds:f,fitToViewport:!0,viewportZoomFactor:1}).appState});break}case us.IDLE_STATUS:{const{userState:f,socketId:h,username:m}=d.payload;this.updateCollaborator(h,{userState:f,username:m});break}default:na(d,null)}}),this.portal.socket.on("first-in-room",async()=>{this.portal.socket&&this.portal.socket.off("first-in-room");const l=await this.initializeRoom({fetchScene:!0,roomLinkData:n});r.resolve(l)}),this.portal.socket.on(gb.USER_FOLLOW_ROOM_CHANGE,l=>{this.excalidrawAPI.updateScene({appState:{followedBy:new Set(l)}}),this.relayVisibleSceneBounds({force:!0})}),this.initializeIdleDetector(),this.setActiveRoomLink(window.location.href),r});F(this,"initializeRoom",async({fetchScene:n,roomLinkData:i})=>{if(clearTimeout(this.socketInitializationTimer),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),n&&i&&this.portal.socket){this.excalidrawAPI.resetScene();try{const s=await Axe(i.roomId,i.roomKey,this.portal.socket);if(s)return this.setLastBroadcastedOrReceivedSceneVersion(sc(s)),{elements:s,scrollToContent:!0}}catch(s){console.error(s)}finally{this.portal.socketInitialized=!0}}else this.portal.socketInitialized=!0;return null});F(this,"_reconcileElements",n=>{const i=this.getSceneElementsIncludingDeleted(),s=this.excalidrawAPI.getAppState(),r=Mu(n,null),o=pI(i,r,s);return this.setLastBroadcastedOrReceivedSceneVersion(sc(o)),o});F(this,"loadImageFiles",jo(async()=>{const{loadedFiles:n,erroredFiles:i}=await this.fetchImageFilesFromFirebase({elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()});this.excalidrawAPI.addFiles(n),sm({excalidrawAPI:this.excalidrawAPI,erroredFiles:i,elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()})},b9e));F(this,"handleRemoteSceneUpdate",n=>{this.excalidrawAPI.updateScene({elements:n,captureUpdate:q.NEVER}),this.loadImageFiles()});F(this,"onPointerMove",()=>{this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.idleTimeoutId=window.setTimeout(this.reportIdle,CC),this.activeIntervalId||(this.activeIntervalId=window.setInterval(this.reportActive,AC))});F(this,"onVisibilityChange",()=>{document.hidden?(this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.onIdleStateChange(Fd.AWAY)):(this.idleTimeoutId=window.setTimeout(this.reportIdle,CC),this.activeIntervalId=window.setInterval(this.reportActive,AC),this.onIdleStateChange(Fd.ACTIVE))});F(this,"reportIdle",()=>{this.onIdleStateChange(Fd.IDLE),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null)});F(this,"reportActive",()=>{this.onIdleStateChange(Fd.ACTIVE)});F(this,"initializeIdleDetector",()=>{document.addEventListener(te.POINTER_MOVE,this.onPointerMove),document.addEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange)});F(this,"updateCollaborator",(n,i)=>{var o;const s=new Map(this.collaborators),r=Object.assign({},s.get(n),i,{isCurrentUser:n===((o=this.portal.socket)==null?void 0:o.id)});s.set(n,r),this.collaborators=s,this.excalidrawAPI.updateScene({collaborators:s})});F(this,"setLastBroadcastedOrReceivedSceneVersion",n=>{this.lastBroadcastedOrReceivedSceneVersion=n});F(this,"getLastBroadcastedOrReceivedSceneVersion",()=>this.lastBroadcastedOrReceivedSceneVersion);F(this,"getSceneElementsIncludingDeleted",()=>this.excalidrawAPI.getSceneElementsIncludingDeleted());F(this,"onPointerUpdate",jo(n=>{n.pointersMap.size<2&&this.portal.socket&&this.portal.broadcastMouseLocation(n)},E9e));F(this,"relayVisibleSceneBounds",n=>{const i=this.excalidrawAPI.getAppState();this.portal.socket&&(i.followedBy.size>0||n!=null&&n.force)&&this.portal.broadcastVisibleSceneBounds({sceneBounds:pz(i)},`follow@${this.portal.socket.id}`)});F(this,"onIdleStateChange",n=>{this.portal.broadcastIdleChange(n)});F(this,"broadcastElements",n=>{sc(n)>this.getLastBroadcastedOrReceivedSceneVersion()&&(this.portal.broadcastScene(us.UPDATE,n,!1),this.lastBroadcastedOrReceivedSceneVersion=sc(n),this.queueBroadcastAllElements())});F(this,"syncElements",n=>{this.broadcastElements(n),this.queueSaveToFirebase()});F(this,"queueBroadcastAllElements",jo(()=>{this.portal.broadcastScene(us.UPDATE,this.excalidrawAPI.getSceneElementsIncludingDeleted(),!0);const n=this.getLastBroadcastedOrReceivedSceneVersion(),i=Math.max(n,sc(this.getSceneElementsIncludingDeleted()));this.setLastBroadcastedOrReceivedSceneVersion(i)},nD));F(this,"queueSaveToFirebase",jo(()=>{this.portal.socketInitialized&&this.saveCollabRoomToFirebase(mc(this.excalidrawAPI.getSceneElementsIncludingDeleted()))},nD,{leading:!1}));F(this,"setUsername",n=>{this.setState({username:n}),I9e(n)});F(this,"getUsername",()=>this.state.username);F(this,"setActiveRoomLink",n=>{this.setState({activeRoomLink:n}),to.set(JK,n)});F(this,"getActiveRoomLink",()=>this.state.activeRoomLink);F(this,"setErrorIndicator",n=>{to.set(U9,{message:n,nonce:Date.now()})});F(this,"resetErrorIndicator",(n=!1)=>{to.set(U9,{message:null,nonce:0}),n&&this.setState({dialogNotifiedErrors:{}})});F(this,"setErrorDialog",n=>{this.setState({errorMessage:n})});this.state={errorMessage:null,dialogNotifiedErrors:{},username:GY()||"",activeRoomLink:null},this.portal=new Qxe(this),this.fileManager=new YY({getFiles:async i=>{const{roomId:s,roomKey:r}=this.portal;if(!s||!r)throw new ng;return XK(`files/rooms/${s}`,r,i)},saveFiles:async({addedFiles:i})=>{const{roomId:s,roomKey:r}=this.portal;if(!s||!r)throw new ng;const{savedFiles:o,erroredFiles:a}=await sS({prefix:`${$Y.collabFiles}/${s}`,files:await bI({files:i,encryptionKey:r,maxBytes:UI})});return{savedFiles:o.reduce((l,c)=>{const d=i.get(c);return d&&l.set(c,d),l},new Map),erroredFiles:a.reduce((l,c)=>{const d=i.get(c);return d&&l.set(c,d),l},new Map)}}}),this.excalidrawAPI=n.excalidrawAPI,this.activeIntervalId=null,this.idleTimeoutId=null}componentDidMount(){window.addEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.addEventListener("online",this.onOfflineStatusToggle),window.addEventListener("offline",this.onOfflineStatusToggle),window.addEventListener(te.UNLOAD,this.onUnload);const n=this.excalidrawAPI.onUserFollow(o=>{this.portal.socket&&this.portal.broadcastUserFollowed(o)}),i=Tp(this.relayVisibleSceneBounds),s=this.excalidrawAPI.onScrollChange(()=>i());this.onUmmount=()=>{n(),s()},this.onOfflineStatusToggle();const r={isCollaborating:this.isCollaborating,onPointerUpdate:this.onPointerUpdate,startCollaboration:this.startCollaboration,syncElements:this.syncElements,fetchImageFilesFromFirebase:this.fetchImageFilesFromFirebase,stopCollaboration:this.stopCollaboration,setUsername:this.setUsername,getUsername:this.getUsername,getActiveRoomLink:this.getActiveRoomLink,setCollabError:this.setErrorDialog};to.set(qK,r)}componentWillUnmount(){var n;window.removeEventListener("online",this.onOfflineStatusToggle),window.removeEventListener("offline",this.onOfflineStatusToggle),window.removeEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.removeEventListener(te.UNLOAD,this.onUnload),window.removeEventListener(te.POINTER_MOVE,this.onPointerMove),window.removeEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),(n=this.onUmmount)==null||n.call(this)}setCollaborators(n){var s;const i=new Map;for(const r of n)i.set(r,Object.assign({},this.collaborators.get(r),{isCurrentUser:r===((s=this.portal.socket)==null?void 0:s.id)}));this.collaborators=i,this.excalidrawAPI.updateScene({collaborators:i})}render(){const{errorMessage:n}=this.state;return g(he,{children:n!=null&&g(QT,{onClose:()=>this.setErrorDialog(null),children:n})})}}const tCe=(e,t,n,i)=>{e.save(),e.strokeStyle=i,e.beginPath(),e.moveTo(n[0][0]*t,n[0][1]*t),e.lineTo(n[1][0]*t,n[1][1]*t),e.stroke(),e.restore()},nCe=(e,t,[n,i,s,r],o)=>{e.save(),e.strokeStyle=o,e.beginPath(),e.moveTo(n[0]*t,n[1]*t),e.bezierCurveTo(i[0]*t,i[1]*t,s[0]*t,s[1]*t,r[0]*t,r[1]*t),e.stroke(),e.restore()},iCe=(e,t)=>{e.strokeStyle="#888",e.save(),e.beginPath(),e.moveTo(-10*t,-10*t),e.lineTo(10*t,10*t),e.moveTo(10*t,-10*t),e.lineTo(-10*t,10*t),e.stroke(),e.save()},yP=(e,t,n,i,s,r,o)=>{if(!t.fixedPoint){console.warn("Binding must have a fixedPoint");return}const a=n.get(t.elementId),[l,c]=tl(t.fixedPoint,a,n);e.save(),e.strokeStyle=o,e.lineWidth=1,e.beginPath(),e.moveTo(l*i,c*i),e.bezierCurveTo(l*i-s,c*i-r,l*i-s,c*i+r,l*i,c*i),e.stroke(),e.restore()},EP=(e,t,n,i,s,r,o)=>{const a=n.get(e.elementId);if(!e.fixedPoint){console.warn("Binding must have a fixedPoint");return}const[l,c]=tl(e.fixedPoint,a,n);t.save(),t.strokeStyle=o,t.lineWidth=1,t.beginPath(),t.moveTo(l*i,c*i),t.bezierCurveTo(l*i+s,c*i+r,l*i+s,c*i-r,l*i,c*i),t.stroke(),t.restore()},sCe=(e,t,n)=>{const i=be(t),s=16;t.forEach(r=>{var o,a,l,c,d,u,f;if(!r.isDeleted){if(_e(r)){if(r.startBinding){if(!((a=(o=i.get(r.startBinding.elementId))==null?void 0:o.boundElements)!=null&&a.find(h=>h.id===r.id)))return;yP(e,r.startBinding,i,n,s,s,((l=r.startBinding)==null?void 0:l.mode)==="orbit"?"red":"black")}if(r.endBinding){if(!((d=(c=i.get(r.endBinding.elementId))==null?void 0:c.boundElements)!=null&&d.find(h=>h.id===r.id)))return;yP(e,r.endBinding,i,n,s,s,((u=r.endBinding)==null?void 0:u.mode)==="orbit"?"red":"black")}}Lr(r)&&((f=r.boundElements)!=null&&f.length)&&r.boundElements.forEach(h=>{var p,U;if(h.type!=="arrow")return;const m=i.get(h.id);m&&((p=m.startBinding)==null?void 0:p.elementId)===r.id&&EP(m.startBinding,e,i,n,s,s,"green"),m&&((U=m.endBinding)==null?void 0:U.elementId)===r.id&&EP(m.endBinding,e,i,n,s,s,"green")})}})},vP=(e,t,n)=>{e.forEach(i=>{switch(!0){case ute(i.data):tCe(t,n.zoom.value,i.data,i.color);break;case rte(i.data):nCe(t,n.zoom.value,i.data,i.color);break;default:throw new Error(`Unknown element type ${JSON.stringify(i)}`)}})},rCe=(e,t,n,i)=>{var a,l,c,d;const[s,r]=Vy(e,i),o=$y({canvas:e,scale:i,normalizedWidth:s,normalizedHeight:r,viewBackgroundColor:"transparent"});if(o.save(),o.translate(t.scrollX*t.zoom.value,t.scrollY*t.zoom.value),iCe(o,t.zoom.value),sCe(o,n,t.zoom.value),(a=window.visualDebug)!=null&&a.currentFrame&&((l=window.visualDebug)!=null&&l.data)&&window.visualDebug.data.length>0){const[u]=oCe();vP(window.visualDebug.data[u],o,t)}else(c=window.visualDebug)==null||c.data.forEach(u=>{vP(u,o,t)});window.visualDebug&&(window.visualDebug.data=((d=window.visualDebug)==null?void 0:d.data.map(u=>u.filter(f=>f.permanent)))??[])},oCe=()=>{var n,i,s;const e=((n=window.visualDebug)==null?void 0:n.currentFrame)??0,t=((i=window.visualDebug)==null?void 0:i.data.length)??0;return t>0?[e%t,((s=window.visualDebug)==null?void 0:s.currentFrame)??0]:[0,0]},aCe=Tp((e,t,n,i)=>{rCe(e,t,n,i)},{trailing:!0}),eZ=()=>{var e;return Array.isArray((e=window.visualDebug)==null?void 0:e.data)},lCe=({onChange:e})=>{const t=L.useCallback(()=>{var r,o;(!((r=window.visualDebug)!=null&&r.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1))&&(window.visualDebug.currentFrame=0),window.visualDebug.currentFrame+=1,e()},[e]),n=L.useCallback(()=>{var r,o,a;(!((r=window.visualDebug)!=null&&r.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1)||((a=window.visualDebug)==null?void 0:a.currentFrame)<1)&&(window.visualDebug.currentFrame=1),window.visualDebug.currentFrame-=1,e()},[e]),i=L.useCallback(()=>{window.visualDebug.currentFrame=void 0,e()},[e]),s=L.useCallback(()=>{window.visualDebug&&(window.visualDebug.currentFrame=void 0,window.visualDebug.data=[]),e()},[e]);return N(he,{children:[g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:s,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:Yc})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:n,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(ov,{flip:!0})})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:i,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:Wu})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-backward","aria-label":"Move backward",type:"button",onClick:t,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(ov,{})})})]})},cCe=de.forwardRef(({appState:e,scale:t},n)=>{const{width:i,height:s}=e;return g("canvas",{style:{width:i,height:s,position:"absolute",zIndex:2,pointerEvents:"none"},width:i*t,height:s*t,ref:n,children:"Debug Canvas"})}),dCe=()=>{const{t:e}=mn();return g("a",{className:"encrypted-icon tooltip",href:"https://plus.excalidraw.com/blog/end-to-end-encryption",target:"_blank",rel:"noopener","aria-label":e("encrypted.link"),children:g(vl,{label:e("encrypted.tooltip"),long:!0,children:Fue})})},uCe=de.memo(({onChange:e})=>g(PY,{children:N("div",{style:{display:"flex",gap:".5rem",alignItems:"center"},children:[eZ()&&g(lCe,{onChange:e}),!Lu&&g(dCe,{})]})}));function fCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function hCe(e,t){if(ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(ap(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function gCe(e){var t=hCe(e,"string");return ap(t)=="symbol"?t:t+""}function mCe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,gCe(i.key),i)}}function pCe(e,t,n){return t&&mCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var tZ=[],UCe=tZ.forEach,bCe=tZ.slice;function yCe(e){return UCe.call(bCe.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e}var _P=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,ECe=function(t,n,i){var s=i||{};s.path=s.path||"/";var r=encodeURIComponent(n),o=t+"="+r;if(s.maxAge>0){var a=s.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");o+="; Max-Age="+Math.floor(a)}if(s.domain){if(!_P.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!_P.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.sameSite){var l=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(l){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},wP={create:function(t,n,i,s){var r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};i&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+i*60*1e3)),s&&(r.domain=s),document.cookie=ECe(t,encodeURIComponent(n),r)},read:function(t){for(var n=t+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var r=i[s];r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(n)===0)return r.substring(n.length,r.length)}return null},remove:function(t){this.create(t,"",-1)}},vCe={name:"cookie",lookup:function(t){var n;if(t.lookupCookie&&typeof document<"u"){var i=wP.read(t.lookupCookie);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupCookie&&typeof document<"u"&&wP.create(n.lookupCookie,t,n.cookieMinutes,n.cookieDomain,n.cookieOptions)}},_Ce={name:"querystring",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));for(var s=i.substring(1),r=s.split("&"),o=0;o<r.length;o++){var a=r[o].indexOf("=");if(a>0){var l=r[o].substring(0,a);l===t.lookupQuerystring&&(n=r[o].substring(a+1))}}}return n}},N1=null,TP=function(){if(N1!==null)return N1;try{N1=window!=="undefined"&&window.localStorage!==null;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{N1=!1}return N1},wCe={name:"localStorage",lookup:function(t){var n;if(t.lookupLocalStorage&&TP()){var i=window.localStorage.getItem(t.lookupLocalStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupLocalStorage&&TP()&&window.localStorage.setItem(n.lookupLocalStorage,t)}},O1=null,IP=function(){if(O1!==null)return O1;try{O1=window!=="undefined"&&window.sessionStorage!==null;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{O1=!1}return O1},TCe={name:"sessionStorage",lookup:function(t){var n;if(t.lookupSessionStorage&&IP()){var i=window.sessionStorage.getItem(t.lookupSessionStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupSessionStorage&&IP()&&window.sessionStorage.setItem(n.lookupSessionStorage,t)}},ICe={name:"navigator",lookup:function(t){var n=[];if(typeof navigator<"u"){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)n.push(navigator.languages[i]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return n.length>0?n:void 0}},SCe={name:"htmlTag",lookup:function(t){var n,i=t.htmlTag||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(n=i.getAttribute("lang")),n}},xCe={name:"path",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof i[t.lookupFromPathIndex]!="string")return;n=i[t.lookupFromPathIndex].replace("/","")}else n=i[0].replace("/","")}return n}},CCe={name:"subdomain",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);i instanceof Array&&(typeof t.lookupFromSubdomainIndex=="number"?n=i[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n=i[0].replace("http://","").replace("https://","").replace(".",""))}return n}};function ACe(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}}var nZ=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fCe(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return pCe(e,[{key:"init",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=yCe(i,this.options||{},ACe()),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(vCe),this.addDetector(_Ce),this.addDetector(wCe),this.addDetector(TCe),this.addDetector(ICe),this.addDetector(SCe),this.addDetector(xCe),this.addDetector(CCe)}},{key:"addDetector",value:function(n){this.detectors[n.name]=n}},{key:"detect",value:function(n){var i=this;n||(n=this.options.order);var s=[];return n.forEach(function(r){if(i.detectors[r]){var o=i.detectors[r].lookup(i.options);o&&typeof o=="string"&&(o=[o]),o&&(s=s.concat(o))}}),this.services.languageUtils.getBestMatchFromCodes?s:s.length>0?s[0]:null}},{key:"cacheUserLanguage",value:function(n,i){var s=this;i||(i=this.options.caches),i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||i.forEach(function(r){s.detectors[r]&&s.detectors[r].cacheUserLanguage(n,s.options)}))}}]),e}();nZ.type="languageDetector";const oS=new nZ;oS.init({languageUtils:{}});const iZ=()=>{var i;const e=oS.detect(),t=Array.isArray(e)?e[0]:e;return(t?(i=Uy.find(s=>s.code.startsWith(t)))==null?void 0:i.code:null)||Yu.code},sZ=Wt(iZ()),MCe=()=>{const[e,t]=tg(sZ);return L.useEffect(()=>{oS.cacheUserLanguage(e)},[e]),[e,t]},kCe=({style:e})=>{const{t,langCode:n}=mn(),i=Nw(sZ);return g("select",{className:"dropdown-select dropdown-select__language",onChange:({target:s})=>i(s.value),value:n,"aria-label":t("buttons.selectLanguage"),style:e,children:Uy.map(s=>g("option",{value:s.code,children:s.label},s.code))})},RCe=de.memo(e=>N(Mt,{children:[g(Mt.DefaultItems.LoadScene,{}),g(Mt.DefaultItems.SaveToActiveFile,{}),g(Mt.DefaultItems.Export,{}),g(Mt.DefaultItems.SaveAsImage,{}),e.isCollabEnabled&&g(Mt.DefaultItems.LiveCollaborationTrigger,{isCollaborating:e.isCollaborating,onSelect:()=>e.onCollabDialogOpen()}),g(Mt.DefaultItems.CommandPalette,{className:"highlighted"}),g(Mt.DefaultItems.SearchMenu,{}),g(Mt.DefaultItems.Help,{}),g(Mt.DefaultItems.ClearCanvas,{}),g(Mt.Separator,{}),g(Mt.ItemLink,{icon:nv,href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=hamburger",className:"",children:"Excalidraw+"}),g(Mt.DefaultItems.Socials,{}),g(Mt.ItemLink,{icon:$V,href:`https://app.excalidraw.com${Lu?"":"/sign-up"}?utm_source=signin&utm_medium=app&utm_content=hamburger`,className:"highlighted",children:Lu?"Sign in":"Sign up"}),k_(),g(Mt.Separator,{}),g(Mt.DefaultItems.ToggleTheme,{allowSystemTheme:!0,theme:e.theme,onSelect:e.setTheme}),g(Mt.ItemCustom,{children:g(kCe,{style:{width:"100%"}})}),g(Mt.DefaultItems.ChangeCanvasBackground,{})]})),LCe=de.memo(e=>{const{t}=mn();let n;return Lu?n=t("welcomeScreen.app.center_heading_plus").split(/(Excalidraw\+)/).map((i,s)=>i==="Excalidraw+"?g("a",{style:{pointerEvents:Sd.inheritFromUI},href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenSignedInUser",children:"Excalidraw+"},s):i):n=t("welcomeScreen.app.center_heading"),N(cs,{children:[g(cs.Hints.MenuHint,{children:t("welcomeScreen.app.menuHint")}),g(cs.Hints.ToolbarHint,{}),g(cs.Hints.HelpHint,{}),N(cs.Center,{children:[g(cs.Center.Logo,{}),g(cs.Center.Heading,{children:n}),N(cs.Center.Menu,{children:[g(cs.Center.MenuItemLoadScene,{}),g(cs.Center.MenuItemHelp,{}),e.isCollabEnabled&&g(cs.Center.MenuItemLiveCollaborationTrigger,{onSelect:()=>e.onCollabDialogOpen()}),!Lu&&g(cs.Center.MenuItemLink,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenGuest",shortcut:null,icon:$V,children:"Sign up"})]})]})]})}),y9=async(e,t,n,i)=>{const s=await $K(),r=`${eB(12)}`,o=await CT(),a=await Hy(o,zg(e,t,n,"database")),l=new Blob([a.iv,new Uint8Array(a.encryptedBuffer)],{type:ve.binary}),c=zK(s,`/migrations/scenes/${r}`);await BK(c,l,{customMetadata:{data:JSON.stringify({version:2,name:i}),created:Date.now().toString()}});const d=new Map;for(const u of e)On(u)&&n[u.fileId]&&d.set(u.fileId,n[u.fileId]);if(d.size){const u=await bI({files:d,encryptionKey:o,maxBytes:UI});await sS({prefix:`/migrations/files/scenes/${r}`,files:u})}window.open(`https://app.excalidraw.com/import?excalidraw=${r},${o}`)},DCe=({elements:e,appState:t,files:n,name:i,onError:s,onSuccess:r})=>{const{t:o}=mn();return N(Yv,{color:"primary",children:[g("div",{className:"Card-icon",children:g(OY,{style:{"--color-logo-icon":"#fff",width:"2.8rem",height:"2.8rem"}})}),g("h2",{children:"Excalidraw+"}),g("div",{className:"Card-details",children:o("exportDialog.excalidrawplus_description")}),g(We,{className:"Card-button",type:"button",title:o("exportDialog.excalidrawplus_button"),"aria-label":o("exportDialog.excalidrawplus_button"),showAriaLabel:!0,onClick:async()=>{try{it("export","eplus",`ui (${Ip()})`),await y9(e,t,n,i),r()}catch(a){console.error(a),a.name!=="AbortError"&&s(new Error(o("exportDialog.excalidrawplus_exportError")))}}})]})};class PCe extends de.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1,sentryEventId:"",localStorage:""})}render(){return this.state.hasError?this.errorSplash():this.props.children}componentDidCatch(n,i){const s={};for(const[r,o]of Object.entries({...localStorage}))try{s[r]=JSON.parse(o)}catch{s[r]=o}Cw(r=>{r.setExtras(i);const o=Rw(n);this.setState(a=>({hasError:!0,sentryEventId:o,localStorage:JSON.stringify(s)}))})}selectTextArea(n){n.target!==document.activeElement&&(n.preventDefault(),n.target.select())}async createGithubIssue(){let n="";try{const i=(await pe(()=>import("./bug-issue-template-BID_ABWq.js"),__vite__mapDeps([]))).default;n=encodeURIComponent(i(this.state.sentryEventId))}catch(i){console.error(i)}window.open(`https://github.com/excalidraw/excalidraw/issues/new?body=${n}`,"_blank","noopener noreferrer")}errorSplash(){return g("div",{className:"ErrorSplash excalidraw",children:N("div",{className:"ErrorSplash-messageContainer",children:[g("div",{className:"ErrorSplash-paragraph bigger align-center",children:g(Rs,{i18nKey:"errorSplash.headingMain",button:n=>g("button",{onClick:()=>window.location.reload(),children:n})})}),N("div",{className:"ErrorSplash-paragraph align-center",children:[g(Rs,{i18nKey:"errorSplash.clearCanvasMessage",button:n=>g("button",{onClick:()=>{try{localStorage.clear(),window.location.reload()}catch(i){console.error(i)}},children:n})}),g("br",{}),N("div",{className:"smaller",children:[g("span",{role:"img","aria-label":"warning",children:""}),M("errorSplash.clearCanvasCaveat"),g("span",{role:"img","aria-hidden":"true",children:""})]})]}),N("div",{children:[g("div",{className:"ErrorSplash-paragraph",children:M("errorSplash.trackedToSentry",{eventId:this.state.sentryEventId})}),g("div",{className:"ErrorSplash-paragraph",children:g(Rs,{i18nKey:"errorSplash.openIssueMessage",button:n=>g("button",{onClick:()=>this.createGithubIssue(),children:n})})}),g("div",{className:"ErrorSplash-paragraph",children:N("div",{className:"ErrorSplash-details",children:[g("label",{children:M("errorSplash.sceneContent")}),g("textarea",{rows:5,onPointerDown:this.selectTextArea,readOnly:!0,value:this.state.localStorage})]})})]})]})})}}const rZ=Wt({isOpen:!1}),NCe=()=>{const e=window.navigator,t=/Apple/.test(e.vendor),n=e.appVersion.indexOf("Win")!==-1;return t?Lue:n?Pue:jw},OCe=({collabAPI:e,activeRoomLink:t,handleClose:n})=>{const{t:i}=mn(),[,s]=L.useState(!1),r=L.useRef(0),o=L.useRef(null),a="share"in navigator,{onCopy:l,copyStatus:c}=JT(),d=async()=>{var f;try{await gd(t)}catch{e.setCollabError(i("errors.copyToSystemClipboardFailed"))}s(!0),r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{s(!1)},3e3),(f=o.current)==null||f.select()},u=async()=>{try{await navigator.share({title:i("roomDialog.shareTitle"),text:i("roomDialog.shareTitle"),url:t})}catch{}};return N(he,{children:[g("h3",{className:"ShareDialog__active__header",children:i("labels.liveCollaboration").replace(/\./g,"")}),g(Ru,{defaultValue:e.getUsername(),placeholder:"Your name",label:"Your name",onChange:e.setUsername,onKeyDown:f=>f.key===$.ENTER&&n()}),N("div",{className:"ShareDialog__active__linkRow",children:[g(Ru,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:t}),a&&g(Or,{size:"large",variant:"icon",label:"Share",icon:NCe(),className:"ShareDialog__active__share",onClick:u}),g(Or,{size:"large",label:i("buttons.copyLink"),icon:Vp,status:c,onClick:()=>{d(),l()}})]}),N("div",{className:"ShareDialog__active__description",children:[N("p",{children:[N("span",{role:"img","aria-hidden":"true",className:"ShareDialog__active__description__emoji",children:[""," "]}),i("roomDialog.desc_privacy")]}),g("p",{children:i("roomDialog.desc_exitSession")})]}),g("div",{className:"ShareDialog__active__actions",children:g(Or,{size:"large",variant:"outlined",color:"danger",label:i("roomDialog.button_stopSession"),icon:Tfe,onClick:()=>{it("share","room closed"),e.stopCollaboration(),e.isCollaborating()||n()}})})]})},FCe=e=>{const{t}=mn(),{collabAPI:n}=e,i=n?N(he,{children:[g("div",{className:"ShareDialog__picker__header",children:t("labels.liveCollaboration").replace(/\./g,"")}),N("div",{className:"ShareDialog__picker__description",children:[g("div",{style:{marginBottom:"1em"},children:t("roomDialog.desc_intro")}),t("roomDialog.desc_privacy")]}),g("div",{className:"ShareDialog__picker__button",children:g(Or,{size:"large",label:t("roomDialog.button_startSession"),icon:wfe,onClick:()=>{it("share","room creation",`ui (${Ip()})`),n.startCollaboration(null)}})}),e.type==="share"&&g("div",{className:"ShareDialog__separator",children:g("span",{children:t("shareDialog.or")})})]}):null;return N(he,{children:[i,e.type==="share"&&N(he,{children:[g("div",{className:"ShareDialog__picker__header",children:t("exportDialog.link_title")}),g("div",{className:"ShareDialog__picker__description",children:t("exportDialog.link_details")}),g("div",{className:"ShareDialog__picker__button",children:g(Or,{size:"large",label:t("exportDialog.link_button"),icon:D6,onClick:async()=>{await e.onExportToBackend(),e.handleClose()}})})]})]})},BCe=e=>{const t=yh(JK);return g(dr,{size:"small",onCloseRequest:e.handleClose,title:!1,children:g("div",{className:"ShareDialog",children:e.collabAPI&&t?g(OCe,{collabAPI:e.collabAPI,activeRoomLink:t,handleClose:e.handleClose}):g(FCe,{...e})})})},zCe=e=>{const[t,n]=tg(rZ),{openDialog:i}=di();return L.useEffect(()=>{i&&n({isOpen:!1})},[i,n]),t.isOpen?g(BCe,{handleClose:()=>n({isOpen:!1}),collabAPI:e.collabAPI,onExportToBackend:e.onExportToBackend,type:t.type}):null},SP=()=>{var e;return(e=window.matchMedia)==null?void 0:e.call(window,"(prefers-color-scheme: dark)")},HCe=()=>{const[e,t]=L.useState(()=>localStorage.getItem(An.LOCAL_STORAGE_THEME)||Se.LIGHT),[n,i]=L.useState(Se.LIGHT);return L.useEffect(()=>{const s=SP(),r=a=>{i(a.matches?Se.DARK:Se.LIGHT)};e==="system"&&(s==null||s.addEventListener("change",r));const o=a=>{!a[$.CTRL_OR_CMD]&&a.altKey&&a.shiftKey&&a.code===ot.D&&(a.preventDefault(),a.stopImmediatePropagation(),t(n===Se.DARK?Se.LIGHT:Se.DARK))};return document.addEventListener(te.KEYDOWN,o,{capture:!0}),()=>{s==null||s.removeEventListener("change",r),document.removeEventListener(te.KEYDOWN,o,{capture:!0})}},[e,n,t]),L.useLayoutEffect(()=>{var s;localStorage.setItem(An.LOCAL_STORAGE_THEME,e),i(e==="system"?(s=SP())!=null&&s.matches?Se.DARK:Se.LIGHT:e)},[e]),{editorTheme:n,appTheme:e,setAppTheme:t}},VCe=({excalidrawAPI:e})=>N(he,{children:[g(u9e,{generate:async({frame:t,children:n})=>{const i=e.getAppState(),s=await JEe({elements:n,appState:{...i,exportBackground:!0,viewBackgroundColor:i.viewBackgroundColor},exportingFrame:t,files:e.getFiles(),mimeType:ve.jpg}),r=await vX(s),o=PB(n),a=await fetch("https://oss-ai.excalidraw.com/v1/ai/diagram-to-code/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({texts:o,image:r,theme:i.theme})});if(!a.ok){const l=await a.text(),c=Ote(l);if(!c)throw new Error(l);if(c.statusCode===429)return{html:`<html>
                <body style="margin: 0; text-align: center">
                <div style="display: flex; align-items: center; justify-content: center; flex-direction: column; height: 100vh; padding: 0 60px">
                  <div style="color:red">Too many requests today,</br>please try again tomorrow!</div>
                  </br>
                  </br>
                  <div>You can also try <a href="https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=d2c" target="_blank" rel="noopener">Excalidraw+</a> to get more requests.</div>
                </div>
                </body>
                </html>`};throw new Error(c.message||l)}try{const{html:l}=await a.json();if(!l)throw new Error("Generation failed (invalid response)");return{html:l}}catch{throw new Error("Generation failed (invalid response)")}}}),g(CY,{onTextSubmit:async t=>{try{const n=await fetch("https://oss-ai.excalidraw.com/v1/ai/text-to-diagram/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({prompt:t})}),i=n.headers.has("X-Ratelimit-Limit")?parseInt(n.headers.get("X-Ratelimit-Limit")||"0",10):void 0,s=n.headers.has("X-Ratelimit-Remaining")?parseInt(n.headers.get("X-Ratelimit-Remaining")||"0",10):void 0,r=await n.json();if(!n.ok){if(n.status===429)return{rateLimit:i,rateLimitRemaining:s,error:new Error("Too many requests today, please try again tomorrow!")};throw new Error(r.message||"Generation failed...")}const o=r.generatedResponse;if(!o)throw new Error("Generation failed...");return{generatedResponse:o,rateLimit:i,rateLimitRemaining:s}}catch{throw new Error("Request failed")}}})]}),$Ce="REQUEST_SCENE",S2="https://app.excalidraw.com",GCe=async({rawElementsString:e,rawAppStateString:t})=>{if(!e||!t)throw new ao("Elements or appstate is missing.");try{const n=JSON.parse(e);if(!n.length)throw new ao("Scene is empty, nothing to export.");const i=JSON.parse(t),s=n.reduce((o,a)=>("fileId"in a&&a.fileId&&o.push(a.fileId),o),[]),r=await Mi.fileStorage.getFiles(s);return{type:"SCENE_DATA",elements:n,appState:i,files:r}}catch(n){throw n instanceof ao?n:new ao("Failed to parse scene data.")}},XCe=async({token:e,publicKey:t})=>{try{const[n,i,s]=e.split(".");if(!n||!i||!s)throw new ao("Invalid JWT format");const r=MR(i),o=MR(s),a=`${n}.${i}`,l=Uint8Array.from(o,p=>p.charCodeAt(0)),c=t.replace(/-----\w+ PUBLIC KEY-----/g,""),d=Uint8Array.from(atob(c),p=>p.charCodeAt(0)),u=await crypto.subtle.importKey("spki",d,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!0,["verify"]);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",u,l,new TextEncoder().encode(a)))throw new Error("Invalid JWT");const h=JSON.parse(r),m=Math.floor(Date.now()/1e3);if(h.exp&&h.exp<m)throw new Error("JWT has expired")}catch(n){throw console.error("Failed to verify JWT:",n),new Error(n instanceof Error?n.message:"Invalid JWT")}},jCe=()=>{const e=L.useRef(!1);return L.useLayoutEffect(()=>{const t=async n=>{if(n.origin!==S2)throw new ao("Invalid origin");if(n.data.type===$Ce){if(!n.data.jwt)throw new ao("JWT is missing");try{try{await XCe({token:n.data.jwt,publicKey:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`})}catch(s){throw console.error(`Failed to verify JWT: ${s.message}`),new ao("Failed to verify JWT")}const i=await GCe({rawAppStateString:localStorage.getItem(An.LOCAL_STORAGE_APP_STATE),rawElementsString:localStorage.getItem(An.LOCAL_STORAGE_ELEMENTS)});n.source.postMessage(i,{targetOrigin:S2})}catch(i){const s={type:"ERROR",message:i instanceof ao?i.message:"Failed to export scene data"};n.source.postMessage(s,{targetOrigin:S2})}}};if(window.addEventListener("message",t),!e.current){e.current=!0;const n={type:"READY"};window.parent.postMessage(n,S2)}return()=>{window.removeEventListener("message",t)}},[]),null},YCe=({isSignedIn:e})=>g("a",{href:e?"https://app.excalidraw.com":"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=guestBanner#excalidraw-redirect",target:"_blank",rel:"noopener",className:"plus-banner",children:"Excalidraw+"}),xP=({children:e,href:t})=>g("a",{href:t,target:"_blank",rel:"noopener",className:"link-button",children:g(Or,{children:e})}),WCe=()=>{const{theme:e,openSidebar:t}=di();return N(s5,{children:[N(s5.TabTriggers,{children:[g(xs.TabTrigger,{tab:"comments",style:{opacity:(t==null?void 0:t.tab)==="comments"?1:.4},children:Qfe}),g(xs.TabTrigger,{tab:"presentation",style:{opacity:(t==null?void 0:t.tab)==="presentation"?1:.4},children:Jfe})]}),g(xs.Tab,{tab:"comments",children:N("div",{className:"app-sidebar-promo-container",children:[g("div",{className:"app-sidebar-promo-image",style:{"--image-source":`url(/oss_promo_comments_${e===Se.DARK?"dark":"light"}.jpg)`,opacity:.7}}),g("div",{className:"app-sidebar-promo-text",children:"Make comments with Excalidraw+"}),g(xP,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=comments_promo#excalidraw-redirect",children:"Sign up now"})]})}),g(xs.Tab,{tab:"presentation",className:"px-3",children:N("div",{className:"app-sidebar-promo-container",children:[g("div",{className:"app-sidebar-promo-image",style:{"--image-source":`url(/oss_promo_presentations_${e===Se.DARK?"dark":"light"}.svg)`,backgroundSize:"60%",opacity:.4}}),g("div",{className:"app-sidebar-promo-text",children:"Create presentations with Excalidraw+"}),g(xP,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=presentations_promo#excalidraw-redirect",children:"Sign up now"})]})})]})};var KCe={};zY();window.EXCALIDRAW_THROTTLE_RENDER=!0;let Rf=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Rf=e});let oZ=!1;if(window.self!==window.top)try{const e=new URL(document.referrer),t=new URL(window.location.href);e.origin===t.origin&&(oZ=!0)}catch{}const CP={title:M("overwriteConfirm.modal.shareableLink.title"),description:g(Rs,{i18nKey:"overwriteConfirm.modal.shareableLink.description",bold:e=>g("strong",{children:e}),br:()=>g("br",{})}),actionLabel:M("overwriteConfirm.modal.shareableLink.button"),color:"danger"},E9=async e=>{var c,d;const n=new URLSearchParams(window.location.search).get("id"),i=window.location.hash.match(/^#json=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/),s=window.location.hash.match(/^#url=(.*)$/),r=XY();let o=await UP(null,null,r),a=Lxe(window.location.href);const l=!!(n||i||a);if(l)if(!o.elements.length||a||await Vv(CP))i&&(o=await UP(i[1],i[2],r)),o.scrollToContent=!0,a||window.history.replaceState({},Tc,window.location.origin);else{if(document.hidden)return new Promise((u,f)=>{window.addEventListener("focus",()=>E9(e).then(u).catch(f),{once:!0})});a=null,window.history.replaceState({},Tc,window.location.origin)}else if(s){window.history.replaceState({},Tc,window.location.origin);const u=s[1];try{const f=await fetch(window.decodeURIComponent(u)),h=await PT(await f.blob(),null,null);if(!o.elements.length||await Vv(CP))return{scene:h,isExternalScene:l}}catch{return{scene:{appState:{errorMessage:M("alerts.invalidSceneUrl")}},isExternalScene:l}}}if(a&&e.collabAPI){const{excalidrawAPI:u}=e,f=await e.collabAPI.startCollaboration(a);return{scene:{...f,appState:{...mX({...f==null?void 0:f.appState,theme:((c=r==null?void 0:r.appState)==null?void 0:c.theme)||((d=f==null?void 0:f.appState)==null?void 0:d.theme)},u.getAppState()),isLoading:!1},elements:pI((f==null?void 0:f.elements)||[],u.getSceneElementsIncludingDeleted(),u.getAppState())},isExternalScene:!0,id:a.roomId,key:a.roomKey}}else if(o)return l&&i?{scene:o,isExternalScene:l,id:i[1],key:i[2]}:{scene:o,isExternalScene:!1};return{scene:null,isExternalScene:!1}},ZCe=()=>{const[e,t]=L.useState(""),n=Lte(),{editorTheme:i,appTheme:s,setAppTheme:r}=HCe(),[o,a]=MCe(),l=Hn(),c=L.useRef({promise:null});c.current.promise||(c.current.promise=K5());const d=L.useRef(null);L.useEffect(()=>{it("load","frame",Ip()),setTimeout(()=>{it("load","version",u4())},vee)},[]);const[u,f]=$X(),[,h]=tg(rZ),[m]=tg(qK),[p]=A9e(b9,()=>pP(window.location.href)),U=yh(U9);r8e({excalidrawAPI:u,adapter:x5,migrationAdapter:qxe});const[,b]=L.useState(!1);L.useEffect(()=>{},[u]),L.useEffect(()=>{if(!u||!n&&!m)return;const P=(B,z=!1)=>{var X;if(B.scene)if(m!=null&&m.isCollaborating())B.scene.elements&&m.fetchImageFilesFromFirebase({elements:B.scene.elements,forceFetchFiles:!0}).then(({loadedFiles:Y,erroredFiles:ee})=>{u.addFiles(Y),sm({excalidrawAPI:u,erroredFiles:ee,elements:u.getSceneElementsIncludingDeleted()})});else{const Y=((X=B.scene.elements)==null?void 0:X.reduce((ee,se)=>On(se)?ee.concat(se.fileId):ee,[]))||[];B.isExternalScene?XK(`${$Y.shareLinkFiles}/${B.id}`,B.key,Y).then(({loadedFiles:ee,erroredFiles:se})=>{u.addFiles(ee),sm({excalidrawAPI:u,erroredFiles:se,elements:u.getSceneElementsIncludingDeleted()})}):z&&(Y.length&&Mi.fileStorage.getFiles(Y).then(({loadedFiles:ee,erroredFiles:se})=>{ee.length&&u.addFiles(ee),sm({excalidrawAPI:u,erroredFiles:se,elements:u.getSceneElementsIncludingDeleted()})}),Mi.fileStorage.clearObsoleteFiles({currentFileIds:Y}))}};E9({collabAPI:m,excalidrawAPI:u}).then(async B=>{P(B,!0),c.current.promise.resolve(B.scene)});const D=async B=>{B.preventDefault(),Lv()||(m!=null&&m.isCollaborating()&&!pP(window.location.href)&&m.stopCollaboration(!1),u.updateScene({appState:{isLoading:!0}}),E9({collabAPI:m,excalidrawAPI:u}).then(X=>{P(X),X.scene&&u.updateScene({...X.scene,...ku(X.scene,null,null,{repairBindings:!0}),captureUpdate:q.IMMEDIATELY})}))},j=ul(()=>{if(!document.hidden&&(m&&!m.isCollaborating()||n)){if(bP(An.VERSION_DATA_STATE)){const B=XY(),z=GY();a(iZ()),u.updateScene({...B,captureUpdate:q.NEVER}),x5.load().then(X=>{X&&u.updateLibrary({libraryItems:X.libraryItems})}),m==null||m.setUsername(z||"")}if(bP(An.VERSION_FILES)){const B=u.getSceneElementsIncludingDeleted(),z=u.getFiles(),X=(B==null?void 0:B.reduce((Y,ee)=>On(ee)&&!z[ee.fileId]?Y.concat(ee.fileId):Y,[]))||[];X.length&&Mi.fileStorage.getFiles(X).then(({loadedFiles:Y,erroredFiles:ee})=>{Y.length&&u.addFiles(Y),sm({excalidrawAPI:u,erroredFiles:ee,elements:u.getSceneElementsIncludingDeleted()})})}}},y9e),G=()=>{Mi.flushSave()},V=B=>{(B.type===te.BLUR||document.hidden)&&Mi.flushSave(),(B.type===te.VISIBILITY_CHANGE||B.type===te.FOCUS)&&j()};return window.addEventListener(te.HASHCHANGE,D,!1),window.addEventListener(te.UNLOAD,G,!1),window.addEventListener(te.BLUR,V,!1),document.addEventListener(te.VISIBILITY_CHANGE,V,!1),window.addEventListener(te.FOCUS,V,!1),()=>{window.removeEventListener(te.HASHCHANGE,D,!1),window.removeEventListener(te.UNLOAD,G,!1),window.removeEventListener(te.BLUR,V,!1),window.removeEventListener(te.FOCUS,V,!1),document.removeEventListener(te.VISIBILITY_CHANGE,V,!1)}},[n,m,u,a]),L.useEffect(()=>{const P=D=>{Mi.flushSave(),u&&Mi.fileStorage.shouldPreventUnload(u.getSceneElements())&&(KCe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?M_(D):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))};return window.addEventListener(te.BEFORE_UNLOAD,P),()=>{window.removeEventListener(te.BEFORE_UNLOAD,P)}},[u]);const y=(P,D,j)=>{m!=null&&m.isCollaborating()&&m.syncElements(P),Mi.isSavePaused()||Mi.save(P,D,j,()=>{if(u){let G=!1;const V=u.getSceneElementsIncludingDeleted().map(B=>{if(Mi.fileStorage.shouldUpdateImageElementStatus(B)){const z=Te(B,{status:"saved"});return z!==B&&(G=!0),z}return B});G&&u.updateScene({elements:V,captureUpdate:q.NEVER})}}),d.current&&u&&aCe(d.current,D,P,window.devicePixelRatio)},[v,_]=L.useState(null),I=async(P,D,j)=>{if(P.length===0)throw new Error(M("alerts.cannotExportEmptyCanvas"));try{const{url:G,errorMessage:V}=await Fxe(P,{...D,viewBackgroundColor:D.exportBackground?D.viewBackgroundColor:da().viewBackgroundColor},j);if(V)throw new Error(V);G&&_(G)}catch(G){if(G.name!=="AbortError"){const{width:V,height:B}=D;throw console.error(G,{width:V,height:B,devicePixelRatio:window.devicePixelRatio}),new Error(G.message)}}},R=(P,D)=>g(C9e,{setToast:j=>u.setToast({message:j}),appState:D,elements:P}),T=yh(QK),w=yh(yb),S=L.useCallback(()=>h({isOpen:!0,type:"collaborationOnly"}),[h]);if(oZ)return g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"100%"},children:g("h1",{children:"I'm not a pretzel!"})});const x={label:"Excalidraw+",category:ct.links,predicate:!0,icon:g("div",{style:{width:14},children:nv}),keywords:["plus","cloud","server"],perform:()=>{window.open("https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}},k={label:"Sign up",category:ct.links,predicate:!0,icon:g("div",{style:{width:14},children:nv}),keywords:["excalidraw","plus","cloud","server","signin","login","signup"],perform:()=>{window.open("https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}};return g("div",{style:{height:"100%"},className:le("excalidraw-app",{"is-collaborating":p}),children:N(VY,{excalidrawAPI:f,onChange:y,initialData:c.current.promise,isCollaborating:p,onPointerUpdate:m==null?void 0:m.onPointerUpdate,UIOptions:{canvasActions:{toggleTheme:!0,export:{onExportToBackend:I,renderCustomUI:u?(P,D,j)=>g(DCe,{elements:P,appState:D,files:j,name:u.getName(),onError:G=>{u==null||u.updateScene({appState:{errorMessage:G.message}})},onSuccess:()=>{u.updateScene({appState:{openDialog:null}})}}):void 0}}},langCode:o,renderCustomStats:R,detectScroll:!1,handleKeyboardGlobally:!0,autoFocus:!0,theme:i,renderTopRightUI:P=>P||!m||n?null:N("div",{className:"excalidraw-ui-top-right",children:[(u==null?void 0:u.getEditorInterface().formFactor)==="desktop"&&g(YCe,{isSignedIn:Lu}),U.message&&g(ZK,{collabError:U}),g(NY,{isCollaborating:p,onSelect:()=>h({isOpen:!0,type:"share"}),editorInterface:l})]}),onLinkOpen:(P,D)=>{P.link&&mh(P.link)&&(D.preventDefault(),u==null||u.scrollToContent(P.link,{animate:!0}))},children:[g(RCe,{onCollabDialogOpen:S,isCollaborating:p,isCollabEnabled:!n,theme:s,setTheme:P=>r(P),refresh:()=>b(P=>!P)}),g(LCe,{onCollabDialogOpen:S,isCollabEnabled:!n}),N(Xd,{children:[g(Xd.Actions.ExportToImage,{}),g(Xd.Actions.SaveToDisk,{}),u&&g(Xd.Action,{title:M("overwriteConfirm.action.excalidrawPlus.title"),actionLabel:M("overwriteConfirm.action.excalidrawPlus.button"),onClick:()=>{y9(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())},children:M("overwriteConfirm.action.excalidrawPlus.description")})]}),g(uCe,{onChange:()=>u==null?void 0:u.refresh()}),u&&g(VCe,{excalidrawAPI:u}),g(HY,{}),p&&T&&g("div",{className:"alertalert--warning",children:M("alerts.collabOfflineWarning")}),w&&g("div",{className:"alert alert--danger",children:M("alerts.localStorageQuotaExceeded")}),v&&g(g9e,{link:v,onCloseRequest:()=>_(null),setErrorMessage:t}),u&&!n&&g(eCe,{excalidrawAPI:u}),g(zCe,{collabAPI:m,onExportToBackend:async()=>{if(u)try{await I(u.getSceneElements(),u.getAppState(),u.getFiles())}catch(P){t(P.message)}}}),g(WCe,{}),e&&g(QT,{onClose:()=>t(""),children:e}),g(uL,{customCommandPaletteItems:[{label:M("labels.liveCollaboration"),category:ct.app,keywords:["team","multiplayer","share","public","session","invite"],icon:Yw,perform:()=>{h({isOpen:!0,type:"collaborationOnly"})}},{label:M("roomDialog.button_stopSession"),category:ct.app,predicate:()=>!!(m!=null&&m.isCollaborating()),keywords:["stop","session","end","leave","close","exit","collaboration"],perform:()=>{m&&(m.stopCollaboration(),m.isCollaborating()||h({isOpen:!1}))}},{label:M("labels.share"),category:ct.app,predicate:!0,icon:jw,keywords:["link","shareable","readonly","export","publish","snapshot","url","collaborate","invite"],perform:async()=>{h({isOpen:!0,type:"share"})}},{label:"GitHub",icon:Gw,category:ct.links,predicate:!0,keywords:["issues","bugs","requests","report","features","social","community"],perform:()=>{window.open("https://github.com/excalidraw/excalidraw","_blank","noopener noreferrer")}},{label:M("labels.followUs"),icon:DV,category:ct.links,predicate:!0,keywords:["twitter","contact","social","community"],perform:()=>{window.open("https://x.com/excalidraw","_blank","noopener noreferrer")}},{label:M("labels.discordChat"),category:ct.links,predicate:!0,icon:LV,keywords:["chat","talk","contact","bugs","requests","report","feedback","suggestions","social","community"],perform:()=>{window.open("https://discord.gg/UexuTaE","_blank","noopener noreferrer")}},{label:"YouTube",icon:GV,category:ct.links,predicate:!0,keywords:["features","tutorials","howto","help","community"],perform:()=>{window.open("https://youtube.com/@excalidraw","_blank","noopener noreferrer")}},...Lu?[{...k,label:"Sign in / Go to Excalidraw+"}]:[x,k],{label:M("overwriteConfirm.action.excalidrawPlus.button"),category:ct.export,icon:Due,predicate:!0,keywords:["plus","export","save","backup"],perform:()=>{u&&y9(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())}},{...uL.defaultItems.toggleTheme,perform:()=>{r(i===Se.DARK?Se.LIGHT:Se.DARK)}},{label:M("labels.installPWA"),category:ct.app,predicate:()=>!!Rf,perform:()=>{Rf&&(Rf.prompt(),Rf.userChoice.then(()=>{Rf=null}))}}]}),eZ()&&u&&g(cCe,{appState:u.getAppState(),scale:window.devicePixelRatio,ref:d})]})})},qCe=()=>window.location.pathname==="/excalidraw-plus-export"?g(jCe,{}):g(PCe,{children:g(nue,{store:to,children:g(ZCe,{})})});window.__EXCALIDRAW_SHA__="";const QCe=document.getElementById("root"),JCe=LJ.createRoot(QCe);NJ();JCe.render(g(L.StrictMode,{children:g(qCe,{})}));export{pe as _,$a as c,Sl as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/subset-worker.chunk-CVR6pt27.js","assets/subset-shared.chunk-D3ioWSie.js","assets/pica-W-nGnTwG.js","assets/_commonjs-dynamic-modules-TDtrdbi3.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=index-D1792Kp_.js.map
